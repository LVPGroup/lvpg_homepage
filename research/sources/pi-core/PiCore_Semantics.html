<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Theory PiCore_Semantics (Isabelle2016: February 2016)</title>
<link media="all" rel="stylesheet" type="text/css" href="isabelle.css"/>
</head>

<body>
<div class="head"><h1>Theory PiCore_Semantics</h1>

<span class="command">theory</span> <span class="name">PiCore_Semantics</span><br/>
<span class="keyword">imports</span> <a href="PiCore_Language.html"><span class="name">PiCore_Language</span></a><br/>

</div>
<div class="source">
<pre class="source"><span class="comment">(*
Created by Yongwang Zhao (ywzhao@ntu.edu.sg, zhaoyw@buaa.edu.cn)
School of Computer Engineering, Nanyang Technological University, Singapore
and School of Computer Science &amp; Engineering, Beihang University, China
*)</span><span class="">
</span><span class="">
</span><span class="keyword1">section</span><span class=""> </span><span class="cartouche">&#8249;Small-step Operational Semantics of PiCore Language&#8250;</span><span class="">
</span><span class="">
</span><span class="keyword1">theory</span><span class=""> </span><span class="">PiCore_Semantics</span><span class="">
</span><span class="keyword2">imports</span><span class=""> </span><span class="">PiCore_Language</span><span class="">
</span><span class="keyword2">begin</span><span class="">
</span><span class="">
</span><span class="keyword1">subsection</span><span class=""> </span><span class="cartouche">&#8249;Datatypes for Semantics&#8250;</span><span class="">
</span><span class="">
</span><span class="keyword1">datatype</span><span class=""> </span><span class="">cmd</span><span class=""> </span><span class="delimiter">=</span><span class=""> </span><span class="">CMP</span><span class="">
</span><span class="">
</span><span class="keyword1">datatype</span><span class=""> </span><span class="delimiter">(</span><span class="tfree">&#39;l</span><span class="delimiter">,</span><span class="tfree">&#39;k</span><span class="delimiter">,</span><span class="tfree">&#39;s</span><span class="delimiter">)</span><span class=""> </span><span class="">act</span><span class=""> </span><span class="delimiter">=</span><span class=""> </span><span class="">Cmd</span><span class=""> </span><span class="">cmd</span><span class="">      
</span><span class="">    </span><span class="delimiter">|</span><span class=""> </span><span class="">EvtEnt</span><span class=""> </span><span class="string">&quot;(&#39;l,&#39;k,&#39;s) event&quot;</span><span class=""> 
</span><span class="">
</span><span class="keyword1">record</span><span class=""> </span><span class="delimiter">(</span><span class="tfree">&#39;l</span><span class="delimiter">,</span><span class="tfree">&#39;k</span><span class="delimiter">,</span><span class="tfree">&#39;s</span><span class="delimiter">)</span><span class=""> </span><span class="">actk</span><span class=""> </span><span class="delimiter">=</span><span class="">  </span><span class="">Act</span><span class="">  </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;(&#39;l,&#39;k,&#39;s) act&quot;</span><span class=""> 
</span><span class="">                              </span><span class="">K</span><span class="">   </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;k&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1">definition</span><span class=""> </span><span class="">get_actk</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;(&#39;l,&#39;k,&#39;s) act &#8658; &#39;k &#8658; (&#39;l,&#39;k,&#39;s) actk&quot;</span><span class=""> </span><span class="delimiter">(</span><span class="string">&quot;_&#9839;_&quot;</span><span class=""> </span><span class="delimiter">[</span><span class="">91</span><span class="delimiter">,</span><span class="">91</span><span class="delimiter">]</span><span class=""> </span><span class="">90</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword2">where</span><span class=""> </span><span class="string">&quot;get_actk a k &#8801; &#10631;Act=a, K=k&#10632;&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1">type_synonym</span><span class=""> </span><span class="delimiter">(</span><span class="tfree">&#39;l</span><span class="delimiter">,</span><span class="tfree">&#39;k</span><span class="delimiter">,</span><span class="tfree">&#39;s</span><span class="delimiter">)</span><span class=""> </span><span class="">x</span><span class=""> </span><span class="delimiter">=</span><span class=""> </span><span class="string">&quot;&#39;k &#8658; (&#39;l,&#39;k,&#39;s) event&quot;</span><span class=""> 
</span><span class="">
</span><span class="keyword1">type_synonym</span><span class=""> </span><span class="tfree">&#39;s</span><span class=""> </span><span class="">pconf</span><span class=""> </span><span class="delimiter">=</span><span class=""> </span><span class="string">&quot;((&#39;s prog) option) &#215; &#39;s&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1">definition</span><span class=""> </span><span class="">getspc_p</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;s pconf &#8658; (&#39;s prog) option&quot;</span><span class=""> </span><span class="keyword2">where</span><span class="">
</span><span class="">  </span><span class="string">&quot;getspc_p conf &#8801; fst conf&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1">definition</span><span class=""> </span><span class="">gets_p</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;s pconf &#8658; &#39;s&quot;</span><span class=""> </span><span class="keyword2">where</span><span class="">
</span><span class="">  </span><span class="string">&quot;gets_p conf &#8801; snd conf&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1">type_synonym</span><span class=""> </span><span class="delimiter">(</span><span class="tfree">&#39;l</span><span class="delimiter">,</span><span class="tfree">&#39;k</span><span class="delimiter">,</span><span class="tfree">&#39;s</span><span class="delimiter">)</span><span class=""> </span><span class="">econf</span><span class=""> </span><span class="delimiter">=</span><span class=""> </span><span class="string">&quot;((&#39;l,&#39;k,&#39;s) event) &#215; (&#39;s &#215; ((&#39;l,&#39;k,&#39;s) x) )&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1">definition</span><span class=""> </span><span class="">getspc_e</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;(&#39;l,&#39;k,&#39;s) econf &#8658; (&#39;l,&#39;k,&#39;s) event&quot;</span><span class=""> </span><span class="keyword2">where</span><span class="">
</span><span class="">  </span><span class="string">&quot;getspc_e conf &#8801; fst conf&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1">definition</span><span class=""> </span><span class="">gets_e</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;(&#39;l,&#39;k,&#39;s) econf &#8658; &#39;s&quot;</span><span class=""> </span><span class="keyword2">where</span><span class="">
</span><span class="">  </span><span class="string">&quot;gets_e conf &#8801; fst (snd conf)&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1">definition</span><span class=""> </span><span class="">getx_e</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;(&#39;l,&#39;k,&#39;s) econf &#8658; (&#39;l,&#39;k,&#39;s) x&quot;</span><span class=""> </span><span class="keyword2">where</span><span class="">
</span><span class="">  </span><span class="string">&quot;getx_e conf &#8801; snd (snd conf)&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1">type_synonym</span><span class=""> </span><span class="delimiter">(</span><span class="tfree">&#39;l</span><span class="delimiter">,</span><span class="tfree">&#39;k</span><span class="delimiter">,</span><span class="tfree">&#39;s</span><span class="delimiter">)</span><span class=""> </span><span class="">esconf</span><span class=""> </span><span class="delimiter">=</span><span class=""> </span><span class="string">&quot;((&#39;l,&#39;k,&#39;s) esys) &#215; (&#39;s &#215; ((&#39;l,&#39;k,&#39;s) x) )&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1">definition</span><span class=""> </span><span class="">getspc_es</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;(&#39;l,&#39;k,&#39;s) esconf &#8658; (&#39;l,&#39;k,&#39;s) esys&quot;</span><span class=""> </span><span class="keyword2">where</span><span class="">
</span><span class="">  </span><span class="string">&quot;getspc_es conf &#8801; fst conf&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1">definition</span><span class=""> </span><span class="">gets_es</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;(&#39;l,&#39;k,&#39;s) esconf &#8658; &#39;s&quot;</span><span class=""> </span><span class="keyword2">where</span><span class="">
</span><span class="">  </span><span class="string">&quot;gets_es conf &#8801; fst (snd conf)&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1">definition</span><span class=""> </span><span class="">getx_es</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;(&#39;l,&#39;k,&#39;s) esconf &#8658; (&#39;l,&#39;k,&#39;s) x&quot;</span><span class=""> </span><span class="keyword2">where</span><span class="">
</span><span class="">  </span><span class="string">&quot;getx_es conf &#8801; snd (snd conf)&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1">type_synonym</span><span class=""> </span><span class="delimiter">(</span><span class="tfree">&#39;l</span><span class="delimiter">,</span><span class="tfree">&#39;k</span><span class="delimiter">,</span><span class="tfree">&#39;s</span><span class="delimiter">)</span><span class=""> </span><span class="">pesconf</span><span class=""> </span><span class="delimiter">=</span><span class=""> </span><span class="string">&quot;((&#39;l,&#39;k,&#39;s) paresys) &#215; (&#39;s &#215; ((&#39;l,&#39;k,&#39;s) x) )&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1">definition</span><span class=""> </span><span class="">getspc</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;(&#39;l,&#39;k,&#39;s) pesconf &#8658; (&#39;l,&#39;k,&#39;s) paresys&quot;</span><span class=""> </span><span class="keyword2">where</span><span class="">
</span><span class="">  </span><span class="string">&quot;getspc conf &#8801; fst conf&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1">definition</span><span class=""> </span><span class="">gets</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;(&#39;l,&#39;k,&#39;s) pesconf &#8658; &#39;s&quot;</span><span class=""> </span><span class="keyword2">where</span><span class="">
</span><span class="">  </span><span class="string">&quot;gets conf &#8801; fst (snd conf)&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1">definition</span><span class=""> </span><span class="">getx</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;(&#39;l,&#39;k,&#39;s) pesconf &#8658; (&#39;l,&#39;k,&#39;s) x&quot;</span><span class=""> </span><span class="keyword2">where</span><span class="">
</span><span class="">  </span><span class="string">&quot;getx conf &#8801; snd (snd conf)&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1">definition</span><span class=""> </span><span class="">getact</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;(&#39;l,&#39;k,&#39;s) actk &#8658; (&#39;l,&#39;k,&#39;s) act&quot;</span><span class=""> </span><span class="keyword2">where</span><span class="">
</span><span class="">  </span><span class="string">&quot;getact a &#8801; Act a&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1">definition</span><span class=""> </span><span class="">getk</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;(&#39;l,&#39;k,&#39;s) actk &#8658; &#39;k&quot;</span><span class=""> </span><span class="keyword2">where</span><span class="">
</span><span class="">  </span><span class="string">&quot;getk a &#8801; K a&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1">subsection</span><span class=""> </span><span class="cartouche">&#8249;Semantics of Programs&#8250;</span><span class="">
</span><span class="">
</span><span class="keyword1">inductive_set</span><span class="">
</span><span class="">  </span><span class="">ptran</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;(&#39;s pconf &#215; &#39;s pconf) set&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2">and</span><span class=""> </span><span class="">ptran&#39;</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;s pconf &#8658; &#39;s pconf &#8658; bool&quot;</span><span class="">   </span><span class="delimiter">(</span><span class="string">&quot;_ -c&#8594; _&quot;</span><span class=""> </span><span class="delimiter">[</span><span class="">81</span><span class="delimiter">,</span><span class="">81</span><span class="delimiter">]</span><span class=""> </span><span class="">80</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword2">and</span><span class=""> </span><span class="">ptrans</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;s pconf &#8658; &#39;s pconf &#8658; bool&quot;</span><span class="">   </span><span class="delimiter">(</span><span class="string">&quot;_ -c*&#8594; _&quot;</span><span class=""> </span><span class="delimiter">[</span><span class="">81</span><span class="delimiter">,</span><span class="">81</span><span class="delimiter">]</span><span class=""> </span><span class="">80</span><span class="delimiter">)</span><span class="">
</span><span class="keyword2">where</span><span class="">
</span><span class="">  </span><span class="string">&quot;P -c&#8594; Q &#8801; (P,Q) &#8712; ptran&quot;</span><span class="">
</span><span class="delimiter">|</span><span class=""> </span><span class="string">&quot;P -c*&#8594; Q &#8801; (P,Q) &#8712;ptran^*&quot;</span><span class=""> 
</span><span class="">
</span><span class="delimiter">|</span><span class=""> </span><span class="">Basic</span><span class="delimiter">:</span><span class="">  </span><span class="string">&quot;(Some (Basic f), s) -c&#8594; (None, f s)&quot;</span><span class="">
</span><span class="delimiter">|</span><span class=""> </span><span class="">Seq1</span><span class="delimiter">:</span><span class="">   </span><span class="string">&quot;(Some P0, s) -c&#8594; (None, t) &#10233; (Some (Seq P0 P1), s) -c&#8594; (Some P1, t)&quot;</span><span class="">
</span><span class="delimiter">|</span><span class=""> </span><span class="">Seq2</span><span class="delimiter">:</span><span class="">    </span><span class="string">&quot;(Some P0, s) -c&#8594; (Some P2, t) &#10233; (Some(Seq P0 P1), s) -c&#8594; (Some(Seq P2 P1), t)&quot;</span><span class="">
</span><span class="delimiter">|</span><span class=""> </span><span class="">CondT</span><span class="delimiter">:</span><span class="">  </span><span class="string">&quot;s&#8712;b  &#10233; (Some(Cond b P1 P2), s) -c&#8594; (Some P1, s)&quot;</span><span class="">
</span><span class="delimiter">|</span><span class=""> </span><span class="">CondF</span><span class="delimiter">:</span><span class="">  </span><span class="string">&quot;s&#8713;b &#10233; (Some(Cond b P1 P2), s) -c&#8594; (Some P2, s)&quot;</span><span class="">
</span><span class="delimiter">|</span><span class=""> </span><span class="">WhileF</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;s&#8713;b &#10233; (Some(While b P), s) -c&#8594; (None, s)&quot;</span><span class="">
</span><span class="delimiter">|</span><span class=""> </span><span class="">WhileT</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;s&#8712;b  &#10233; (Some(While b P), s) -c&#8594; (Some(Seq P (While b P)), s)&quot;</span><span class="">
</span><span class="delimiter">|</span><span class=""> </span><span class="">Await</span><span class="delimiter">:</span><span class="">  </span><span class="string">&quot;&#10214;s&#8712;b; (Some P, s) -c*&#8594; (None, t)&#10215; &#10233; (Some(Await b P), s) -c&#8594; (None, t)&quot;</span><span class=""> 
</span><span class="delimiter">|</span><span class=""> </span><span class="">Nondt</span><span class="delimiter">:</span><span class="">  </span><span class="string">&quot;(s,t)&#8712;r &#10233; (Some(Nondt r), s) -c&#8594; (None, t)&quot;</span><span class="">
</span><span class="">
</span><span class="keyword2">monos</span><span class=""> </span><span class="string">&quot;rtrancl_mono&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1">subsection</span><span class=""> </span><span class="cartouche">&#8249;Semantics of Events&#8250;</span><span class="">
</span><span class="">
</span><span class="keyword1">inductive_set</span><span class="">
</span><span class="">  </span><span class="">etran</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;((&#39;l,&#39;k,&#39;s) econf &#215; (&#39;l,&#39;k,&#39;s) actk &#215; (&#39;l,&#39;k,&#39;s) econf) set&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2">and</span><span class=""> </span><span class="">etran&#39;</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;(&#39;l,&#39;k,&#39;s) econf &#8658; (&#39;l,&#39;k,&#39;s) actk &#8658; (&#39;l,&#39;k,&#39;s) econf &#8658; bool&quot;</span><span class="">   </span><span class="delimiter">(</span><span class="string">&quot;_ -et-_&#8594; _&quot;</span><span class=""> </span><span class="delimiter">[</span><span class="">81</span><span class="delimiter">,</span><span class="">81</span><span class="delimiter">,</span><span class="">81</span><span class="delimiter">]</span><span class=""> </span><span class="">80</span><span class="delimiter">)</span><span class="">
</span><span class="keyword2">where</span><span class="">
</span><span class="">  </span><span class="string">&quot;P -et-t&#8594; Q &#8801; (P,t,Q) &#8712; etran&quot;</span><span class="">
</span><span class="delimiter">|</span><span class=""> </span><span class="">AnonyEvent</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(P, s) -c&#8594; (Q, t) &#10233; (AnonyEvent P, s, x) -et-(Cmd CMP)&#9839;k&#8594; (AnonyEvent Q, t, x)&quot;</span><span class="">
</span><span class="delimiter">|</span><span class=""> </span><span class="">EventEntry</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#10214;P = body e; s &#8712; guard e; x&#39; = x(k:= BasicEvent e)&#10215; 
                &#10233; (BasicEvent e, s, x) -et-(EvtEnt (BasicEvent e))&#9839;k&#8594; ((AnonyEvent (Some P)), s, x&#39;)&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1">subsection</span><span class=""> </span><span class="cartouche">&#8249;Semantics of Event Systems&#8250;</span><span class="">
</span><span class="">
</span><span class="keyword1">inductive_set</span><span class="">
</span><span class="">  </span><span class="">estran</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;((&#39;l,&#39;k,&#39;s) esconf &#215; (&#39;l,&#39;k,&#39;s) actk &#215; (&#39;l,&#39;k,&#39;s) esconf) set&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2">and</span><span class=""> </span><span class="">estran&#39;</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;(&#39;l,&#39;k,&#39;s) esconf &#8658; (&#39;l,&#39;k,&#39;s) actk &#8658; (&#39;l,&#39;k,&#39;s) esconf &#8658; bool&quot;</span><span class="">  
</span><span class="">        </span><span class="delimiter">(</span><span class="string">&quot;_ -es-_&#8594; _&quot;</span><span class=""> </span><span class="delimiter">[</span><span class="">81</span><span class="delimiter">,</span><span class="">81</span><span class="delimiter">]</span><span class=""> </span><span class="">80</span><span class="delimiter">)</span><span class="">
</span><span class="keyword2">where</span><span class="">
</span><span class="">  </span><span class="string">&quot;P -es-t&#8594; Q &#8801; (P,t,Q) &#8712; estran&quot;</span><span class="">
</span><span class="delimiter">|</span><span class=""> </span><span class="">EvtOccur</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#10214;evt&#8712; evts; (evt, (s, x)) -et-(EvtEnt evt)&#9839;k&#8594; (e, (s, x&#39;)) &#10215; 
              &#10233; (EvtSys evts, (s, x)) -es-(EvtEnt evt)&#9839;k&#8594; (EvtSeq e (EvtSys evts), (s, x&#39;))&quot;</span><span class="">
</span><span class="delimiter">|</span><span class=""> </span><span class="">EvtSeq1</span><span class="delimiter">:</span><span class="">  </span><span class="string">&quot;&#10214;(e, s, x) -et-act&#9839;k&#8594; (e&#39;, s&#39;, x); e&#39; &#8800; AnonyEvent None&#10215; 
              &#10233; (EvtSeq e es, s, x) -es-act&#9839;k&#8594; (EvtSeq e&#39; es, s&#39;, x)&quot;</span><span class="">
</span><span class="delimiter">|</span><span class=""> </span><span class="">EvtSeq2</span><span class="delimiter">:</span><span class="">  </span><span class="string">&quot;&#10214;(e, s, x) -et-act&#9839;k&#8594; (e&#39;, s&#39;, x); e&#39; = AnonyEvent None&#10215; 
              &#10233; (EvtSeq e es, s, x) -es-act&#9839;k&#8594; (es, s&#39;, x)&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1">subsection</span><span class=""> </span><span class="cartouche">&#8249;Semantics of Parallel Event Systems&#8250;</span><span class="">
</span><span class="">
</span><span class="keyword1">inductive_set</span><span class="">
</span><span class="">  </span><span class="">pestran</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;((&#39;l,&#39;k,&#39;s) pesconf &#215; (&#39;l,&#39;k,&#39;s) actk &#215; (&#39;l,&#39;k,&#39;s) pesconf) set&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2">and</span><span class=""> </span><span class="">pestran&#39;</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;(&#39;l,&#39;k,&#39;s) pesconf &#8658; (&#39;l,&#39;k,&#39;s) actk 
                      &#8658; (&#39;l,&#39;k,&#39;s) pesconf &#8658; bool&quot;</span><span class="">  </span><span class="delimiter">(</span><span class="string">&quot;_ -pes-_&#8594; _&quot;</span><span class=""> </span><span class="delimiter">[</span><span class="">70</span><span class="delimiter">,</span><span class="">70</span><span class="delimiter">]</span><span class=""> </span><span class="">60</span><span class="delimiter">)</span><span class="">
</span><span class="keyword2">where</span><span class="">
</span><span class="">  </span><span class="string">&quot;P -pes-t&#8594; Q &#8801; (P,t,Q) &#8712; pestran&quot;</span><span class="">
</span><span class="">  </span><span class="delimiter">|</span><span class=""> </span><span class="">ParES</span><span class="delimiter">:</span><span class="">  </span><span class="string">&quot;(pes(k), (s, x)) -es-(a&#9839;k)&#8594; (es&#39;, (s&#39;, x&#39;)) &#10233; (pes, (s, x)) -pes-(a&#9839;k)&#8594; (pes(k:=es&#39;), (s&#39;, x&#39;))&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1">subsection</span><span class=""> </span><span class="cartouche">&#8249;Lemmas&#8250;</span><span class="">
</span><span class="keyword1">subsubsection</span><span class=""> </span><span class="cartouche">&#8249;programs&#8250;</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">list_eq_if</span><span class=""> </span><span class="delimiter">[</span><span class="">rule_format</span><span class="delimiter">]</span><span class="delimiter">:</span><span class=""> 
</span><span class="">  </span><span class="string">&quot;&#8704;ys. xs=ys &#10230; (length xs = length ys) &#10230; (&#8704;i&lt;length xs. xs!i=ys!i)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">xs</span><span class="delimiter">)</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">list_eq</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(length xs = length ys &#8743; (&#8704;i&lt;length xs. xs!i=ys!i)) = (xs=ys)&quot;</span><span class="">
</span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">iffI</span><span class="delimiter">)</span><span class="">
</span><span class=""> </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="">clarify</span><span class="">
</span><span class=""> </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">erule</span><span class=""> </span><span class="">nth_equalityI</span><span class="delimiter">)</span><span class="">
</span><span class=""> </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="">simp</span><span class="delimiter">+</span><span class="">
</span><span class="keyword1"><span class="improper">done</span></span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">nth_tl</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#10214; ys!0=a; ys&#8800;[] &#10215; &#10233; ys=(a#(tl ys))&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">cases</span><span class=""> </span><span class="">ys</span><span class="delimiter">)</span><span class=""> </span><span class="">simp_all</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">nth_tl_if</span><span class=""> </span><span class="delimiter">[</span><span class="">rule_format</span><span class="delimiter">]</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;ys&#8800;[] &#10230; ys!0=a &#10230; P ys &#10230; P (a#(tl ys))&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">ys</span><span class="delimiter">)</span><span class=""> </span><span class="">simp_all</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">nth_tl_onlyif</span><span class=""> </span><span class="delimiter">[</span><span class="">rule_format</span><span class="delimiter">]</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;ys&#8800;[] &#10230; ys!0=a &#10230; P (a#(tl ys)) &#10230; P ys&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">ys</span><span class="delimiter">)</span><span class=""> </span><span class="">simp_all</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">seq_not_eq1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;Seq c1 c2&#8800;c1&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">c1</span><span class="delimiter">)</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">seq_not_eq2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;Seq c1 c2&#8800;c2&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">c2</span><span class="delimiter">)</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">if_not_eq1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;Cond b c1 c2 &#8800;c1&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">c1</span><span class="delimiter">)</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">if_not_eq2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;Cond b c1 c2&#8800;c2&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">c2</span><span class="delimiter">)</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">
</span><span class="keyword1">lemmas</span><span class=""> </span><span class="">seq_and_if_not_eq</span><span class=""> </span><span class="delimiter">[</span><span class="">simp</span><span class="delimiter">]</span><span class=""> </span><span class="delimiter">=</span><span class=""> </span><span class="">seq_not_eq1</span><span class=""> </span><span class="">seq_not_eq2</span><span class=""> 
</span><span class="">seq_not_eq1</span><span class=""> </span><span class="delimiter">[</span><span class="">THEN</span><span class=""> </span><span class="">not_sym</span><span class="delimiter">]</span><span class=""> </span><span class="">seq_not_eq2</span><span class=""> </span><span class="delimiter">[</span><span class="">THEN</span><span class=""> </span><span class="">not_sym</span><span class="delimiter">]</span><span class=""> 
</span><span class="">if_not_eq1</span><span class=""> </span><span class="">if_not_eq2</span><span class=""> </span><span class="">if_not_eq1</span><span class=""> </span><span class="delimiter">[</span><span class="">THEN</span><span class=""> </span><span class="">not_sym</span><span class="delimiter">]</span><span class=""> </span><span class="">if_not_eq2</span><span class=""> </span><span class="delimiter">[</span><span class="">THEN</span><span class=""> </span><span class="">not_sym</span><span class="delimiter">]</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">prog_not_eq_in_ctran_aux</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2">assumes</span><span class=""> </span><span class="">c</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(P,s) -c&#8594; (Q,t)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2">shows</span><span class=""> </span><span class="string">&quot;P&#8800;Q&quot;</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">c</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">x1</span><span class=""> </span><span class="delimiter">&#8801;</span><span class=""> </span><span class="string">&quot;(P,s)&quot;</span><span class=""> </span><span class="">x2</span><span class=""> </span><span class="delimiter">&#8801;</span><span class=""> </span><span class="string">&quot;(Q,t)&quot;</span><span class=""> </span><span class="">arbitrary</span><span class="delimiter">:</span><span class=""> </span><span class="">P</span><span class=""> </span><span class="">s</span><span class=""> </span><span class="">Q</span><span class=""> </span><span class="">t</span><span class="delimiter">)</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">prog_not_eq_in_ctran</span><span class=""> </span><span class="delimiter">[</span><span class="">simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#172; (P,s) -c&#8594; (P,t)&quot;</span><span class="">
</span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="">clarify</span><span class="">
</span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">drule</span><span class=""> </span><span class="">prog_not_eq_in_ctran_aux</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="improper">done</span></span><span class="">
</span><span class="">
</span><span class="keyword1">subsubsection</span><span class=""> </span><span class="cartouche">&#8249;Events&#8250;</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">ent_spec1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(ev, s, x) -et-(EvtEnt be)&#9839;k&#8594; (e2, s1, x1) &#10233; ev = be&quot;</span><span class=""> 
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">etran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">done</span></span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">ent_spec</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;ec1 -et-(EvtEnt (BasicEvent ev))&#9839;k&#8594; ec2 &#10233; getspc_e ec1 = BasicEvent ev&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">ent_spec1</span><span class=""> </span><span class="">getspc_e_def</span><span class=""> </span><span class="">prod.collapse</span><span class="delimiter">)</span><span class=""> 
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">ent_spec2&#39;</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(ev, s, x) -et-(EvtEnt (BasicEvent e))&#9839;k&#8594; (e2, s1, x1) 
                    &#10233; s &#8712; guard e &#8743; s = s1
                                &#8743; e2 = AnonyEvent (Some (body e)) &#8743; x1 = x (k := BasicEvent e)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">etran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">done</span></span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">ent_spec2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;ec1 -et-(EvtEnt (BasicEvent ev))&#9839;k&#8594; ec2 
                    &#10233; gets_e ec1 &#8712; guard ev &#8743; gets_e ec1 = gets_e ec2
                                &#8743; getspc_e ec2 = AnonyEvent (Some (body ev)) &#8743; getx_e ec2 = (getx_e ec1) (k := BasicEvent ev)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">using</span><span class=""> </span><span class="">getspc_e_def</span><span class=""> </span><span class="">getx_e_def</span><span class=""> </span><span class="">gets_e_def</span><span class=""> </span><span class="">ent_spec2&#39;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">surjective_pairing</span><span class="delimiter">)</span><span class=""> 
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">no_tran2basic0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(e1, s, x) -et-t&#8594; (e2, s1, x1) &#10233; &#172;(&#8707;e. e2 = BasicEvent e)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">etran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">done</span></span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">no_tran2basic</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#172;(&#8707;t ec1. ec1 -et-t&#8594; (BasicEvent ev, s, x))&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">using</span><span class=""> </span><span class="">no_tran2basic0</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">prod.collapse</span><span class="delimiter">)</span><span class=""> 
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">noevtent_notran0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(BasicEvent e, s, x) -et-(a&#9839;k)&#8594; (e2, s1, x1) &#10233; a = EvtEnt (BasicEvent e)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">etran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">done</span></span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">noevtent_notran</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;ec1 = (BasicEvent e, s, x) &#10233; &#172; (&#8707;k. ec1 -et-(EvtEnt (BasicEvent e))&#9839;k&#8594; ec2) 
                        &#10233; &#172; (ec1 -et-t&#8594; ec2)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">    </span><span class="keyword3">assume</span><span class=""> </span><span class="">p0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;ec1 = (BasicEvent e, s, x)&quot;</span><span class=""> </span><span class="keyword2">and</span><span class="">
</span><span class="">           </span><span class="">p1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#172; (&#8707;k. ec1 -et-(EvtEnt (BasicEvent e))&#9839;k&#8594; ec2)&quot;</span><span class="">
</span><span class="">    </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="string">&quot;&#172; (ec1 -et-t&#8594; ec2)&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">      </span><span class="keyword1">{</span><span class="">
</span><span class="">        </span><span class="keyword3">assume</span><span class=""> </span><span class="">a0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;ec1 -et-t&#8594; ec2&quot;</span><span class="">
</span><span class="">        </span><span class="keyword1">with</span><span class=""> </span><span class="">p0</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">a1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;getact t = EvtEnt (BasicEvent e)&quot;</span><span class="">  </span><span class="keyword1">using</span><span class=""> </span><span class="">getact_def</span><span class=""> </span><span class="">noevtent_notran0</span><span class=""> </span><span class="">get_actk_def</span><span class="">
</span><span class="">          </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">cases</span><span class=""> </span><span class="">prod_cases3</span><span class=""> </span><span class="">select_convs</span><span class="delimiter">(</span><span class="">1</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="">
</span><span class="">        </span><span class="keyword1">from</span><span class=""> </span><span class="">a0</span><span class=""> </span><span class="keyword3">obtain</span><span class=""> </span><span class="">k</span><span class=""> </span><span class="keyword2">where</span><span class=""> </span><span class="string">&quot;k = getk t&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">        </span><span class="keyword1">with</span><span class=""> </span><span class="">p1</span><span class=""> </span><span class="">a0</span><span class=""> </span><span class="">a1</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;ec1 -et-(EvtEnt (BasicEvent e))&#9839;k&#8594; ec2&quot;</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">get_actk_def</span><span class=""> </span><span class="">getact_def</span><span class=""> 
</span><span class="">          </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">cases</span><span class=""> </span><span class="">select_convs</span><span class="delimiter">(</span><span class="">1</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="">
</span><span class="">        </span><span class="keyword1">with</span><span class=""> </span><span class="">p1</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">False</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">      </span><span class="keyword1">}</span><span class="">
</span><span class="">      </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">      </span><span class="keyword1">qed</span><span class="">
</span><span class="">  </span><span class="keyword1">qed</span><span class="">
</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">evt_not_eq_in_tran_aux</span><span class="delimiter">:</span><span class="string">&quot;(P,s,x) -et-et&#8594; (Q,t,y) &#10233; P &#8800; Q&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">erule</span><span class=""> </span><span class="">etran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">prog_not_eq_in_ctran_aux</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">evt_not_eq_in_tran</span><span class=""> </span><span class="delimiter">[</span><span class="">simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#172; (P,s,x) -et-et&#8594; (P,t,y)&quot;</span><span class="">
</span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="">clarify</span><span class="">
</span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">drule</span><span class=""> </span><span class="">evt_not_eq_in_tran_aux</span><span class="delimiter">)</span><span class="">
</span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="keyword1"><span class="improper">done</span></span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">evt_not_eq_in_tran2</span><span class=""> </span><span class="delimiter">[</span><span class="">simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#172;(&#8707;et. (P,s,x) -et-et&#8594; (P,t,y))&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">
</span><span class="keyword1">subsubsection</span><span class=""> </span><span class="cartouche">&#8249;Event Systems&#8250;</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">esconf_trip</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#10214;gets_es c = s; getspc_es c = spc; getx_es c = x&#10215; &#10233; c = (spc,s,x)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">gets_es_def</span><span class=""> </span><span class="">getspc_es_def</span><span class=""> </span><span class="">getx_es_def</span><span class=""> </span><span class="">prod.collapse</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">evtseq_tran_evtseq</span><span class="delimiter">:</span><span class=""> 
</span><span class="">  </span><span class="string">&quot;&#10214;(EvtSeq e1 es, s1, x1) -es-et&#8594; (es2, t1, y1); es2 &#8800; es&#10215; &#10233; &#8707;e. es2 = EvtSeq e es&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">estran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">done</span></span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">evtseq_tran_evtseq_anony</span><span class="delimiter">:</span><span class=""> 
</span><span class="">  </span><span class="string">&quot;&#10214;(EvtSeq e1 es, s1, x1) -es-et&#8594; (es2, t1, y1); es2 &#8800; es&#10215; &#10233; &#8707;e. es2 = EvtSeq e es &#8743; is_anonyevt e&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">estran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">event.exhaust</span><span class=""> </span><span class="">is_anonyevt.simps</span><span class="delimiter">(</span><span class="">1</span><span class="delimiter">)</span><span class=""> </span><span class="">no_tran2basic0</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="">simp</span><span class=""> 
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">evtseq_tran_evtsys</span><span class="delimiter">:</span><span class=""> 
</span><span class="">  </span><span class="string">&quot;&#10214;(EvtSeq e1 es, s1, x1) -es-et&#8594; (es2, t1, y1); &#172;(&#8707;e. es2 = EvtSeq e es)&#10215; &#10233; es2 = es&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">estran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">done</span></span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">evtseq_tran_exist_etran</span><span class="delimiter">:</span><span class=""> 
</span><span class="">  </span><span class="string">&quot;(EvtSeq e1 es, s1, x1) -es-et&#8594; (EvtSeq e2 es, t1, y1) &#10233; &#8707;t. (e1, s1, x1) -et-t&#8594; (e2, t1, y1)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">estran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">add.right_neutral</span><span class=""> </span><span class="">add_Suc_right</span><span class=""> </span><span class="">esys.inject</span><span class="delimiter">(</span><span class="">1</span><span class="delimiter">)</span><span class=""> </span><span class="">esys.size</span><span class="delimiter">(</span><span class="">3</span><span class="delimiter">)</span><span class=""> </span><span class="">lessI</span><span class=""> </span><span class="">not_less_eq</span><span class=""> </span><span class="">trans_less_add2</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">evtseq_tran_0_exist_etran</span><span class="delimiter">:</span><span class=""> 
</span><span class="">  </span><span class="string">&quot;(EvtSeq e1 es, s1, x1) -es-et&#8594; (es, t1, y1) &#10233; &#8707;t. (e1, s1, x1) -et-t&#8594; (AnonyEvent (None), t1, y1)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">estran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="delimiter">(</span><span class="">no_types</span><span class="delimiter">,</span><span class=""> </span><span class="">hide_lams</span><span class="delimiter">)</span><span class=""> </span><span class="">add.commute</span><span class=""> </span><span class="">add_Suc_right</span><span class=""> </span><span class="">esys.size</span><span class="delimiter">(</span><span class="">3</span><span class="delimiter">)</span><span class=""> </span><span class="">not_less_eq</span><span class=""> </span><span class="">trans_less_add2</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">  
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">notrans_to_basicevt_insameesys</span><span class="delimiter">:</span><span class=""> 
</span><span class="">  </span><span class="string">&quot;&#10214;(es1, s1, x1) -es-et&#8594; (es2, s2, x2); &#8707;e. es1 = EvtSeq e esys&#10215; &#10233; &#172;(&#8707;e. es2 = EvtSeq (BasicEvent e) esys)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">estran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">etran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">etran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">evtseq_tran_exist_etran</span><span class=""> </span><span class="">no_tran2basic</span><span class="delimiter">)</span><span class="">
</span><span class="">  
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">evtseq_tran_sys_or_seq</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="string">&quot;(EvtSeq e1 es, s1, x1) -es-et&#8594; (es2, t1, y1) &#10233; es2 = es &#8744; (&#8707;e. es2 = EvtSeq e es)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">meson</span><span class=""> </span><span class="">evtseq_tran_evtseq</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">evtseq_tran_sys_or_seq_anony</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="string">&quot;(EvtSeq e1 es, s1, x1) -es-et&#8594; (es2, t1, y1) &#10233; es2 = es &#8744; (&#8707;e. es2 = EvtSeq e es &#8743; is_anonyevt e)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">meson</span><span class=""> </span><span class="">evtseq_tran_evtseq_anony</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">evtseq_no_evtent</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="string">&quot;&#10214;(EvtSeq e1 es, s1, x1) -es-t&#9839;k&#8594; (es2, s2, x2);is_anonyevt e1&#10215; &#10233; &#172;(&#8707;e. t = EvtEnt e)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">estran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">etran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">etran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">done</span></span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">evtseq_no_evtent2</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="string">&quot;&#10214;esc1 -es-t&#9839;k&#8594; esc2; getspc_es esc1 = EvtSeq e esys; is_anonyevt e&#10215; &#10233; &#172;(&#8707;e. t = EvtEnt e)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">    </span><span class="keyword3">assume</span><span class=""> </span><span class="">p0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;esc1 -es-t&#9839;k&#8594; esc2&quot;</span><span class="">
</span><span class="">      </span><span class="keyword2">and</span><span class="">  </span><span class="">p1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;getspc_es esc1 = EvtSeq e esys&quot;</span><span class="">
</span><span class="">      </span><span class="keyword2">and</span><span class="">  </span><span class="">p2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;is_anonyevt e&quot;</span><span class="">
</span><span class="">    </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">obtain</span><span class=""> </span><span class="">es1</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">s1</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">x1</span><span class=""> </span><span class="keyword2">where</span><span class=""> </span><span class="">a1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;esc1 = (es1,s1,x1)&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">prod_cases3</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">    </span><span class="keyword1">from</span><span class=""> </span><span class="">p0</span><span class=""> </span><span class="keyword3">obtain</span><span class=""> </span><span class="">es2</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">s2</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">x2</span><span class=""> </span><span class="keyword2">where</span><span class=""> </span><span class="">a2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;esc2 = (es2,s2,x2)&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">prod_cases3</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">    </span><span class="keyword1">from</span><span class=""> </span><span class="">p1</span><span class=""> </span><span class="">a1</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;es1 = EvtSeq e esys&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class="">getspc_es_def</span><span class="delimiter">)</span><span class="">
</span><span class="">    </span><span class="keyword1">with</span><span class=""> </span><span class="">p0</span><span class=""> </span><span class="">p2</span><span class=""> </span><span class="">a1</span><span class=""> </span><span class="">a2</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">evtseq_no_evtent</span><span class="delimiter">[</span><span class="">of</span><span class=""> </span><span class="">e</span><span class=""> </span><span class="">esys</span><span class=""> </span><span class="">s1</span><span class=""> </span><span class="">x1</span><span class=""> </span><span class="">t</span><span class=""> </span><span class="">k</span><span class=""> </span><span class="">es2</span><span class=""> </span><span class="">s2</span><span class=""> </span><span class="">x2</span><span class="delimiter">]</span><span class="">
</span><span class="">      </span><span class="keyword1">by</span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword1">qed</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">esys_not_eseq</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;getspc_es esc = EvtSys es &#10233; &#172;(&#8707;e esys. getspc_es esc = EvtSeq e esys)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class="">getspc_es_def</span><span class="delimiter">)</span><span class="">
</span><span class="">  
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">eseq_not_esys</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;getspc_es esc = EvtSeq e esys &#10233; &#172;(&#8707;es. getspc_es esc = EvtSys es)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class="">getspc_es_def</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">evtent_is_basicevt</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(es, s, x) -es-EvtEnt e&#9839;k&#8594; (es&#39;, s&#39;, x&#39;) &#10233; &#8707;e&#39;. e = BasicEvent e&#39;&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">estran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">etran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">etran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="">simp</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">etran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="">simp</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="">auto</span><span class="delimiter">[</span><span class="">1</span><span class="delimiter">]</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">ent_spec1</span><span class=""> </span><span class="">event.exhaust</span><span class=""> </span><span class="">evtseq_no_evtent</span><span class=""> </span><span class="">get_actk_def</span><span class=""> </span><span class="">is_anonyevt.simps</span><span class="delimiter">(</span><span class="">1</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">  
</span><span class="">  </span><span class="keyword1"><span class="improper">done</span></span><span class="">
</span><span class="">  
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">evtent_is_basicevt_inevtseq</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#10214;(EvtSeq e es,s1,x1) -es-EvtEnt e1&#9839;k&#8594; (esc2,s2,x2)&#10215; 
    &#10233; e = e1 &#8743; (&#8707;e&#39;. e = BasicEvent e&#39;)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">estran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">etran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">etran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">etran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="">auto</span><span class="delimiter">[</span><span class="">1</span><span class="delimiter">]</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">ent_spec1</span><span class=""> </span><span class="">esys.inject</span><span class="delimiter">(</span><span class="">1</span><span class="delimiter">)</span><span class=""> </span><span class="">evtent_is_basicevt</span><span class=""> </span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="">
</span><span class="">  
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">evtent_is_basicevt_inevtseq2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#10214;esc1 -es-EvtEnt e1&#9839;k&#8594; esc2; getspc_es esc1 = EvtSeq e es&#10215; 
    &#10233; e = e1 &#8743; (&#8707;e&#39;. e = BasicEvent e&#39;)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">    </span><span class="keyword3">assume</span><span class=""> </span><span class="">p0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;esc1 -es-EvtEnt e1&#9839;k&#8594; esc2&quot;</span><span class="">
</span><span class="">      </span><span class="keyword2">and</span><span class="">  </span><span class="">p1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;getspc_es esc1 = EvtSeq e es&quot;</span><span class="">
</span><span class="">    </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">obtain</span><span class=""> </span><span class="">es1</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">s1</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">x1</span><span class=""> </span><span class="keyword2">where</span><span class=""> </span><span class="">a0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;esc1 = (es1,s1,x1)&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">prod_cases3</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">    </span><span class="keyword1">moreover</span><span class="">
</span><span class="">    </span><span class="keyword1">from</span><span class=""> </span><span class="">p0</span><span class=""> </span><span class="keyword3">obtain</span><span class=""> </span><span class="">es2</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">s2</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">x2</span><span class=""> </span><span class="keyword2">where</span><span class=""> </span><span class="">a1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;esc2 = (es2,s2,x2)&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">prod_cases3</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">    </span><span class="keyword1">ultimately</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> 
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">p0</span><span class=""> </span><span class="">p1</span><span class=""> </span><span class="">evtent_is_basicevt_inevtseq</span><span class="delimiter">[</span><span class="">of</span><span class=""> </span><span class="">e</span><span class=""> </span><span class="">es</span><span class=""> </span><span class="">s1</span><span class=""> </span><span class="">x1</span><span class=""> </span><span class="">e1</span><span class=""> </span><span class="">k</span><span class=""> </span><span class="">es2</span><span class=""> </span><span class="">s2</span><span class=""> </span><span class="">x2</span><span class="delimiter">]</span><span class=""> </span><span class="">getspc_es_def</span><span class="delimiter">[</span><span class="">of</span><span class=""> </span><span class="">esc1</span><span class="delimiter">]</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">  </span><span class="keyword1">qed</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">evtsysent_evtent0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(EvtSys es, s, x) -es-t&#8594; (EvtSeq ev (EvtSys es), s1,x1) &#10233;
        s = s1 &#8743; (&#8707;evt e. evt &#8712; es &#8743; evt = BasicEvent e &#8743; Act t = EvtEnt (BasicEvent e) &#8743;
            (BasicEvent e, s, x) -et-t&#8594; (ev, s1, x1))&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">estran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">prefer</span></span><span class=""> </span><span class="">2</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">prefer</span></span><span class=""> </span><span class="">2</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">etran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">conjI</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1">using</span><span class=""> </span><span class="">get_actk_def</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">esys.inject</span><span class="delimiter">(</span><span class="">1</span><span class="delimiter">)</span><span class=""> </span><span class="">esys.inject</span><span class="delimiter">(</span><span class="">2</span><span class="delimiter">)</span><span class=""> </span><span class="">select_convs</span><span class="delimiter">(</span><span class="">1</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">evtsysent_evtent</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(EvtSys es, s, x) -es-(EvtEnt (BasicEvent e))&#9839;k&#8594; (EvtSeq ev (EvtSys es), s1,x1) &#10233;
        s = s1 &#8743; BasicEvent e &#8712; es &#8743; (BasicEvent e, s, x) -et-(EvtEnt (BasicEvent e))&#9839;k&#8594; (ev, s1, x1)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">estran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">ent_spec1</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">done</span></span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">evtsysent_evtent2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(EvtSys es, s, x) -es-(EvtEnt ev)&#9839;k&#8594; (esc2, s1,x1) &#10233;
        s = s1 &#8743; (ev&#8712;es)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">estran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">ent_spec1</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">done</span></span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">evtsysent_evtent3</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#10214;esc1 -es-(EvtEnt ev)&#9839;k&#8594; esc2; getspc_es esc1 = EvtSys es&#10215; &#10233;
        (ev&#8712;es)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">    </span><span class="keyword3">assume</span><span class=""> </span><span class="">p0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;esc1 -es-(EvtEnt ev)&#9839;k&#8594; esc2&quot;</span><span class="">
</span><span class="">      </span><span class="keyword2">and</span><span class="">  </span><span class="">p1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;getspc_es esc1 = EvtSys es&quot;</span><span class="">
</span><span class="">    </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">obtain</span><span class=""> </span><span class="">es1</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">s1</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">x1</span><span class=""> </span><span class="keyword2">where</span><span class=""> </span><span class="">a0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;esc1 = (es1,s1,x1)&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">prod_cases3</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">    </span><span class="keyword1">moreover</span><span class="">
</span><span class="">    </span><span class="keyword1">from</span><span class=""> </span><span class="">p0</span><span class=""> </span><span class="keyword3">obtain</span><span class=""> </span><span class="">es2</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">s2</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">x2</span><span class=""> </span><span class="keyword2">where</span><span class=""> </span><span class="">a1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;esc2 = (es2,s2,x2)&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">prod_cases3</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">    </span><span class="keyword1">from</span><span class=""> </span><span class="">p1</span><span class=""> </span><span class="">a0</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;es1 = EvtSys es&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class="">getspc_es_def</span><span class="delimiter">)</span><span class="">
</span><span class="">    </span><span class="keyword1">with</span><span class=""> </span><span class="">a0</span><span class=""> </span><span class="">a1</span><span class=""> </span><span class="">p0</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">evtsysent_evtent2</span><span class="delimiter">[</span><span class="">of</span><span class=""> </span><span class="">es</span><span class=""> </span><span class="">s1</span><span class=""> </span><span class="">x1</span><span class=""> </span><span class="">ev</span><span class=""> </span><span class="">k</span><span class=""> </span><span class="">es2</span><span class=""> </span><span class="">s2</span><span class=""> </span><span class="">x2</span><span class="delimiter">]</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword1">qed</span><span class="">
</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">evtsys_evtent</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(EvtSys es, s, x) -es-t&#8594; (es2, s1,x1) &#10233; &#8707;e. es2 = EvtSeq e (EvtSys es)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">estran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">done</span></span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">act_in_es_notchgstate</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#10214;(es, s, x) -es-(Cmd c)&#9839;k&#8594; (es&#39;, s&#39;, x&#39;)&#10215; &#10233; x = x&#39;&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">estran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">cmd_enable_impl_anonyevt</span><span class="delimiter">:</span><span class=""> 
</span><span class="">    </span><span class="string">&quot;&#10214;(es, s, x) -es-(Cmd c)&#9839;k&#8594; (es&#39;, s&#39;, x&#39;)&#10215; 
        &#10233; &#8707;e e&#39; es1. es = EvtSeq e es1 &#8743; e = AnonyEvent e&#39;&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">estran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">etran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">etran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">done</span></span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">cmd_enable_impl_notesys</span><span class="delimiter">:</span><span class=""> 
</span><span class="">    </span><span class="string">&quot;&#10214;(es, s, x) -es-(Cmd c)&#9839;k&#8594; (es&#39;, s&#39;, x&#39;)&#10215; 
        &#10233; &#172;(&#8707;ess. es = EvtSys ess)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">estran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">done</span></span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">cmd_enable_impl_notesys2</span><span class="delimiter">:</span><span class=""> 
</span><span class="">    </span><span class="string">&quot;&#10214;esc1 -es-(Cmd c)&#9839;k&#8594; esc2&#10215; 
        &#10233; &#172;(&#8707;ess. getspc_es esc1 = EvtSys ess)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">    </span><span class="keyword3">assume</span><span class=""> </span><span class="">p0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;esc1 -es-(Cmd c)&#9839;k&#8594; esc2&quot;</span><span class="">
</span><span class="">    </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">obtain</span><span class=""> </span><span class="">es1</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">s1</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">x1</span><span class=""> </span><span class="keyword2">where</span><span class=""> </span><span class="">a0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;esc1 = (es1,s1,x1)&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">prod_cases3</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">    </span><span class="keyword1">moreover</span><span class="">
</span><span class="">    </span><span class="keyword1">from</span><span class=""> </span><span class="">p0</span><span class=""> </span><span class="keyword3">obtain</span><span class=""> </span><span class="">es2</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">s2</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">x2</span><span class=""> </span><span class="keyword2">where</span><span class=""> </span><span class="">a1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;esc2 = (es2,s2,x2)&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">prod_cases3</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">    </span><span class="keyword1">ultimately</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">p0</span><span class=""> </span><span class="">cmd_enable_impl_notesys</span><span class="delimiter">[</span><span class="">of</span><span class=""> </span><span class="">es1</span><span class=""> </span><span class="">s1</span><span class=""> </span><span class="">x1</span><span class=""> </span><span class="">c</span><span class=""> </span><span class="">k</span><span class=""> </span><span class="">es2</span><span class=""> </span><span class="">s2</span><span class=""> </span><span class="">x2</span><span class="delimiter">]</span><span class=""> </span><span class="">getspc_es_def</span><span class="delimiter">[</span><span class="">of</span><span class=""> </span><span class="">esc1</span><span class="delimiter">]</span><span class="">
</span><span class="">      </span><span class="keyword1">by</span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword1">qed</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">cmd_enable_impl_anonyevt2</span><span class="delimiter">:</span><span class=""> 
</span><span class="">    </span><span class="string">&quot;&#10214;esc1 -es-(Cmd c)&#9839;k&#8594; esc2&#10215; 
        &#10233; &#8707;e e&#39; es1. getspc_es esc1 = EvtSeq e es1 &#8743; e = AnonyEvent e&#39;&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">    </span><span class="keyword3">assume</span><span class=""> </span><span class="">p0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;esc1 -es-(Cmd c)&#9839;k&#8594; esc2&quot;</span><span class="">
</span><span class="">    </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">obtain</span><span class=""> </span><span class="">es1</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">s1</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">x1</span><span class=""> </span><span class="keyword2">where</span><span class=""> </span><span class="">a0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;esc1 = (es1,s1,x1)&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">prod_cases3</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">    </span><span class="keyword1">moreover</span><span class="">
</span><span class="">    </span><span class="keyword1">from</span><span class=""> </span><span class="">p0</span><span class=""> </span><span class="keyword3">obtain</span><span class=""> </span><span class="">es2</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">s2</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">x2</span><span class=""> </span><span class="keyword2">where</span><span class=""> </span><span class="">a1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;esc2 = (es2,s2,x2)&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">prod_cases3</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">    </span><span class="keyword1">ultimately</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">p0</span><span class=""> </span><span class="">cmd_enable_impl_anonyevt</span><span class="delimiter">[</span><span class="">of</span><span class=""> </span><span class="">es1</span><span class=""> </span><span class="">s1</span><span class=""> </span><span class="">x1</span><span class=""> </span><span class="">c</span><span class=""> </span><span class="">k</span><span class=""> </span><span class="">es2</span><span class=""> </span><span class="">s2</span><span class=""> </span><span class="">x2</span><span class="delimiter">]</span><span class=""> </span><span class="">getspc_es_def</span><span class="delimiter">[</span><span class="">of</span><span class=""> </span><span class="">esc1</span><span class="delimiter">]</span><span class="">
</span><span class="">      </span><span class="keyword1">by</span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword1">qed</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">entevt_notchgstate</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#10214;(es, s, x) -es-(EvtEnt (BasicEvent e))&#9839;k&#8594; (es&#39;, s&#39;, x&#39;)&#10215; &#10233; s = s&#39;&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">estran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">etran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">  </span><span class="keyword1">using</span><span class=""> </span><span class="">ent_spec2&#39;</span><span class=""> </span><span class="">get_actk_def</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">metis</span><span class=""> 
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">entevt_ines_notchg_otherx</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#10214;(es, s, x) -es-(EvtEnt e)&#9839;k&#8594; (es&#39;, s&#39;, x&#39;)&#10215; &#10233; (&#8704;k&#39;. k&#39;&#8800;k &#10230; x k&#39; = x&#39; k&#39;)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">estran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">etran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">done</span></span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">entevt_ines_notchg_otherx2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#10214;esc1 -es-(EvtEnt e)&#9839;k&#8594; esc2&#10215; 
          &#10233; (&#8704;k&#39;. k&#39;&#8800;k &#10230; (getx_es esc1) k&#39; = (getx_es esc2) k&#39;)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">    </span><span class="keyword3">assume</span><span class=""> </span><span class="">p0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;esc1 -es-(EvtEnt e)&#9839;k&#8594; esc2&quot;</span><span class="">
</span><span class="">    </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">obtain</span><span class=""> </span><span class="">es1</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">s1</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">x1</span><span class=""> </span><span class="keyword2">where</span><span class=""> </span><span class="">a0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;esc1 = (es1,s1,x1)&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">prod_cases3</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">    </span><span class="keyword1">moreover</span><span class="">
</span><span class="">    </span><span class="keyword1">from</span><span class=""> </span><span class="">p0</span><span class=""> </span><span class="keyword3">obtain</span><span class=""> </span><span class="">es2</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">s2</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">x2</span><span class=""> </span><span class="keyword2">where</span><span class=""> </span><span class="">a1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;esc2 = (es2,s2,x2)&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">prod_cases3</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">    </span><span class="keyword1">ultimately</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;&#8704;k&#39;. k&#39;&#8800;k &#10230; x1 k&#39; = x2 k&#39;&quot;</span><span class=""> 
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">entevt_ines_notchg_otherx</span><span class="delimiter">[</span><span class="">of</span><span class=""> </span><span class="">es1</span><span class=""> </span><span class="">s1</span><span class=""> </span><span class="">x1</span><span class=""> </span><span class="">e</span><span class=""> </span><span class="">k</span><span class=""> </span><span class="">es2</span><span class=""> </span><span class="">s2</span><span class=""> </span><span class="">x2</span><span class="delimiter">]</span><span class=""> </span><span class="">p0</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">    </span><span class="keyword1">with</span><span class=""> </span><span class="">a0</span><span class=""> </span><span class="">a1</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">getx_es_def</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">snd_conv</span><span class="delimiter">)</span><span class=""> 
</span><span class="">  </span><span class="keyword1">qed</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">cmd_ines_nchg_x</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#10214;(es, s, x) -es-(Cmd c)&#9839;k&#8594; (es&#39;, s&#39;, x&#39;)&#10215; &#10233; (&#8704;k. x&#39; k = x k)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">estran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">etran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">done</span></span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">cmd_ines_nchg_x2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#10214;esc1 -es-(Cmd c)&#9839;k&#8594; esc2&#10215; &#10233; (&#8704;k. (getx_es esc2) k = (getx_es esc1) k)&quot;</span><span class=""> 
</span><span class="">  </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">    </span><span class="keyword3">assume</span><span class=""> </span><span class="">p0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;esc1 -es-(Cmd c)&#9839;k&#8594; esc2&quot;</span><span class="">
</span><span class="">    </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">obtain</span><span class=""> </span><span class="">es1</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">s1</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">x1</span><span class=""> </span><span class="keyword2">where</span><span class=""> </span><span class="">a0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;esc1 = (es1,s1,x1)&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">prod_cases3</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">    </span><span class="keyword1">moreover</span><span class="">
</span><span class="">    </span><span class="keyword1">from</span><span class=""> </span><span class="">p0</span><span class=""> </span><span class="keyword3">obtain</span><span class=""> </span><span class="">es2</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">s2</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">x2</span><span class=""> </span><span class="keyword2">where</span><span class=""> </span><span class="">a1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;esc2 = (es2,s2,x2)&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">prod_cases3</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">    </span><span class="keyword1">ultimately</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;&#8704;k. x1 k = x2 k&quot;</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">cmd_ines_nchg_x</span><span class=""> </span><span class="delimiter">[</span><span class="">of</span><span class=""> </span><span class="">es1</span><span class=""> </span><span class="">s1</span><span class=""> </span><span class="">x1</span><span class=""> </span><span class="">c</span><span class=""> </span><span class="">k</span><span class=""> </span><span class="">es2</span><span class=""> </span><span class="">s2</span><span class=""> </span><span class="">x2</span><span class="delimiter">]</span><span class=""> </span><span class="">p0</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">    </span><span class="keyword1">with</span><span class=""> </span><span class="">a0</span><span class=""> </span><span class="">a1</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">getx_es_def</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">snd_conv</span><span class="delimiter">)</span><span class=""> 
</span><span class="">  </span><span class="keyword1">qed</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">entevt_ines_chg_selfx</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#10214;(es, s, x) -es-(EvtEnt e)&#9839;k&#8594; (es&#39;, s&#39;, x&#39;)&#10215; &#10233; x&#39; k = e&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">estran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">etran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">etran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">fun_upd_idem_iff</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">etran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">done</span></span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">entevt_ines_chg_selfx2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#10214;esc1 -es-(EvtEnt e)&#9839;k&#8594; esc2&#10215; &#10233; (getx_es esc2) k = e&quot;</span><span class=""> 
</span><span class="">  </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">    </span><span class="keyword3">assume</span><span class=""> </span><span class="">p0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;esc1 -es-(EvtEnt e)&#9839;k&#8594; esc2&quot;</span><span class="">
</span><span class="">    </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">obtain</span><span class=""> </span><span class="">es1</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">s1</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">x1</span><span class=""> </span><span class="keyword2">where</span><span class=""> </span><span class="">a0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;esc1 = (es1,s1,x1)&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">prod_cases3</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">    </span><span class="keyword1">moreover</span><span class="">
</span><span class="">    </span><span class="keyword1">from</span><span class=""> </span><span class="">p0</span><span class=""> </span><span class="keyword3">obtain</span><span class=""> </span><span class="">es2</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">s2</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">x2</span><span class=""> </span><span class="keyword2">where</span><span class=""> </span><span class="">a1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;esc2 = (es2,s2,x2)&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">prod_cases3</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">    </span><span class="keyword1">ultimately</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;x2 k = e&quot;</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">entevt_ines_chg_selfx</span><span class=""> </span><span class="">p0</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">    </span><span class="keyword1">with</span><span class=""> </span><span class="">a1</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">getx_es_def</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">snd_conv</span><span class="delimiter">)</span><span class=""> 
</span><span class="">  </span><span class="keyword1">qed</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">estran_impl_evtentorcmd</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#10214;(es, s, x) -es-t&#8594; (es&#39;, s&#39;, x&#39;)&#10215; 
  &#10233; (&#8707;e k. (es, s, x) -es-EvtEnt e&#9839;k&#8594; (es&#39;, s&#39;, x&#39;)) &#8744; (&#8707;c k. (es, s, x) -es-Cmd c&#9839;k&#8594; (es&#39;, s&#39;, x&#39;))&quot;</span><span class=""> 
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">estran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">etran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">etran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">etran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">done</span></span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">estran_impl_evtentorcmd&#39;</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#10214;(es, s, x) -es-t&#9839;k&#8594; (es&#39;, s&#39;, x&#39;)&#10215; 
  &#10233; (&#8707;e. (es, s, x) -es-EvtEnt e&#9839;k&#8594; (es&#39;, s&#39;, x&#39;)) &#8744; (&#8707;c. (es, s, x) -es-Cmd c&#9839;k&#8594; (es&#39;, s&#39;, x&#39;))&quot;</span><span class=""> 
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">estran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">get_actk_def</span><span class=""> </span><span class="">iffs</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">etran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">get_actk_def</span><span class=""> </span><span class="">iffs</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">get_actk_def</span><span class=""> </span><span class="">iffs</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">etran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">get_actk_def</span><span class=""> </span><span class="">iffs</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">get_actk_def</span><span class=""> </span><span class="">iffs</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">done</span></span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">estran_impl_evtentorcmd2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#10214;esc1 -es-t&#8594; esc2&#10215; 
  &#10233; (&#8707;e k. esc1 -es-EvtEnt e&#9839;k&#8594; esc2) &#8744; (&#8707;c k. esc1 -es-Cmd c&#9839;k&#8594; esc2)&quot;</span><span class=""> 
</span><span class="">  </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">    </span><span class="keyword3">assume</span><span class=""> </span><span class="">p0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;esc1 -es-t&#8594; esc2&quot;</span><span class="">
</span><span class="">    </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">obtain</span><span class=""> </span><span class="">es1</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">s1</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">x1</span><span class=""> </span><span class="keyword2">where</span><span class=""> </span><span class="">a0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;esc1 = (es1,s1,x1)&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">prod_cases3</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">    </span><span class="keyword1">moreover</span><span class="">
</span><span class="">    </span><span class="keyword1">from</span><span class=""> </span><span class="">p0</span><span class=""> </span><span class="keyword3">obtain</span><span class=""> </span><span class="">es2</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">s2</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">x2</span><span class=""> </span><span class="keyword2">where</span><span class=""> </span><span class="">a1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;esc2 = (es2,s2,x2)&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">prod_cases3</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">    </span><span class="keyword1">ultimately</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">p0</span><span class=""> </span><span class="">estran_impl_evtentorcmd</span><span class="delimiter">[</span><span class="">of</span><span class=""> </span><span class="">es1</span><span class=""> </span><span class="">s1</span><span class=""> </span><span class="">x1</span><span class=""> </span><span class="">t</span><span class=""> </span><span class="">es2</span><span class=""> </span><span class="">s2</span><span class=""> </span><span class="">x2</span><span class="delimiter">]</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">simp</span><span class=""> 
</span><span class="">  </span><span class="keyword1">qed</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">estran_impl_evtentorcmd2&#39;</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#10214;esc1 -es-t&#9839;k&#8594; esc2&#10215; 
  &#10233; (&#8707;e. esc1 -es-EvtEnt e&#9839;k&#8594; esc2) &#8744; (&#8707;c. esc1 -es-Cmd c&#9839;k&#8594; esc2)&quot;</span><span class=""> 
</span><span class="">  </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">    </span><span class="keyword3">assume</span><span class=""> </span><span class="">p0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;esc1 -es-t&#9839;k&#8594; esc2&quot;</span><span class="">
</span><span class="">    </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">obtain</span><span class=""> </span><span class="">es1</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">s1</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">x1</span><span class=""> </span><span class="keyword2">where</span><span class=""> </span><span class="">a0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;esc1 = (es1,s1,x1)&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">prod_cases3</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">    </span><span class="keyword1">moreover</span><span class="">
</span><span class="">    </span><span class="keyword1">from</span><span class=""> </span><span class="">p0</span><span class=""> </span><span class="keyword3">obtain</span><span class=""> </span><span class="">es2</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">s2</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">x2</span><span class=""> </span><span class="keyword2">where</span><span class=""> </span><span class="">a1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;esc2 = (es2,s2,x2)&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">prod_cases3</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">    </span><span class="keyword1">ultimately</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">p0</span><span class=""> </span><span class="">estran_impl_evtentorcmd&#39;</span><span class="delimiter">[</span><span class="">of</span><span class=""> </span><span class="">es1</span><span class=""> </span><span class="">s1</span><span class=""> </span><span class="">x1</span><span class=""> </span><span class="">t</span><span class=""> </span><span class="">k</span><span class=""> </span><span class="">es2</span><span class=""> </span><span class="">s2</span><span class=""> </span><span class="">x2</span><span class="delimiter">]</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">simp</span><span class=""> 
</span><span class="">  </span><span class="keyword1">qed</span><span class="">
</span><span class="">
</span><span class="">  
</span><span class="keyword1">subsubsection</span><span class=""> </span><span class="cartouche">&#8249;Parallel Event Systems&#8250;</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">pesconf_trip</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#10214;gets c = s; getspc c = spc; getx c = x&#10215; &#10233; c = (spc,s,x)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">gets_def</span><span class=""> </span><span class="">getspc_def</span><span class=""> </span><span class="">getx_def</span><span class=""> </span><span class="">prod.collapse</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">pestran_estran</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#10214;(pes, s, x) -pes-(a&#9839;k)&#8594; (pes&#39;, s&#39;, x&#39;)&#10215; &#10233; 
              &#8707;es&#39;. ((pes k, s, x) -es-(a&#9839;k)&#8594; (es&#39;, s&#39;, x&#39;)) &#8743; pes&#39; = pes(k:=es&#39;)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">pestran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">act_in_pes_notchgstate</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#10214;(pes, s, x) -pes-(Cmd c)&#9839;k&#8594; (pes&#39;, s&#39;, x&#39;)&#10215; &#10233; x = x&#39;&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">pestran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">estran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">done</span></span><span class="">
</span><span class="">
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">evtent_in_pes_notchgstate</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#10214;(pes, s, x) -pes-(EvtEnt e)&#9839;k&#8594; (pes&#39;, s&#39;, x&#39;)&#10215; &#10233; s = s&#39;&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">pestran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">estran.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">entevt_notchgstate</span><span class=""> </span><span class="">evtent_is_basicevt</span><span class=""> </span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">entevt_notchgstate</span><span class=""> </span><span class="">evtent_is_basicevt</span><span class=""> </span><span class="">get_actk_def</span><span class="delimiter">)</span><span class="">
</span><span class="">  
</span><span class="keyword1">lemma</span><span class=""> </span><span class="">evtent_in_pes_notchgstate2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#10214;esc1 -pes-(EvtEnt e)&#9839;k&#8594; esc2&#10215; &#10233; gets esc1 = gets esc2&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">using</span><span class=""> </span><span class="">evtent_in_pes_notchgstate</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">pesconf_trip</span><span class="delimiter">)</span><span class=""> 
</span><span class="">
</span><span class="keyword2">end</span><span class="">
</span></pre>

</div>
</body>
</html>
