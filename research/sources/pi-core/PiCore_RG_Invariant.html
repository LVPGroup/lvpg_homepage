<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Theory PiCore_RG_Invariant (Isabelle2016: February 2016)</title>
<link media="all" rel="stylesheet" type="text/css" href="isabelle.css"/>
</head>

<body>
<div class="head"><h1>Theory PiCore_RG_Invariant</h1>

<span class="command">theory</span> <span class="name">PiCore_RG_Invariant</span><br/>
<span class="keyword">imports</span> <a href="PiCore_RG_Prop.html"><span class="name">PiCore_RG_Prop</span></a><br/>

</div>
<div class="source">
<pre class="source"><span class="comment">(*
Created by Yongwang Zhao (ywzhao@ntu.edu.sg, zhaoyw@buaa.edu.cn)
School of Computer Engineering, Nanyang Technological University, Singapore
and School of Computer Science &amp; Engineering, Beihang University, China
*)</span><span class="">
</span><span class="">
</span><span class="keyword1">section</span><span class=""> </span><span class="cartouche">&#8249;Rely-guarantee-based Safety Reasoning&#8250;</span><span class="">
</span><span class="">
</span><span class="keyword1">theory</span><span class=""> </span><span class="">PiCore_RG_Invariant</span><span class="">
</span><span class="keyword2">imports</span><span class=""> </span><span class="">PiCore_RG_Prop</span><span class=""> 
</span><span class="keyword2">begin</span><span class="">
</span><span class="">
</span><span class="keyword1">type_synonym</span><span class=""> </span><span class="tfree">&#39;s</span><span class=""> </span><span class="">invariant</span><span class=""> </span><span class="delimiter">=</span><span class=""> </span><span class="string">&quot;&#39;s set&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1">definition</span><span class=""> </span><span class="">no_environment</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;(&#39;l,&#39;k,&#39;s) pesconfs &#8658; bool&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2">where</span><span class=""> </span><span class="string">&quot;no_environment pesl &#8801; (&#8704;j. Suc j &lt; length pesl &#10230; (&#8707;actk. pesl!j-pes-actk&#8594;pesl!Suc j))&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1">definition</span><span class=""> </span><span class="">invariant_of_pares</span><span class="delimiter">::</span><span class="string">&quot;(&#39;l,&#39;k,&#39;s) paresys &#8658; &#39;s set &#8658; &#39;s invariant &#8658; bool&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2">where</span><span class=""> </span><span class="string">&quot;invariant_of_pares pares init invar &#8801; 
          &#8704;s0 x0 pesl. s0&#8712;init &#8743; pesl&#8712;cpts_of_pes pares s0 x0 &#8743; no_environment pesl
                          &#10230; (&#8704;i&lt;length pesl. gets (pesl!i) &#8712; invar)&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1">theorem</span><span class=""> </span><span class="">invariant_theorem</span><span class="delimiter">:</span><span class="">
</span><span class="">  </span><span class="keyword2">assumes</span><span class=""> </span><span class="">parsys_sat_rg</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8866; pesf SAT [init, {}, UNIV, UNIV]&quot;</span><span class="">
</span><span class="">    </span><span class="keyword2">and</span><span class="">   </span><span class="">all_evts_are_basic</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8704;ef&#8712;all_evts pesf. is_basicevt (E<span class="hidden">&#8681;</span><sub>e</sub> ef)&quot;</span><span class="">
</span><span class="">    </span><span class="keyword2">and</span><span class="">   </span><span class="">evt_in_parsys_in_evtrgfs</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8704;erg&#8712;all_evts pesf. the (evtrgfs (E<span class="hidden">&#8681;</span><sub>e</sub> erg)) = snd erg&quot;</span><span class=""> 
</span><span class="">    </span><span class="keyword2">and</span><span class="">   </span><span class="">stb_invar</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8704;ef&#8712;all_evts pesf. stable invar (Guar<span class="hidden">&#8681;</span><sub>e</sub> ef)&quot;</span><span class="">
</span><span class="">    </span><span class="keyword2">and</span><span class="">   </span><span class="">init_in_invar</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;init&#8838;invar&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2">shows</span><span class=""> </span><span class="string">&quot;invariant_of_pares (paresys_spec pesf) init invar&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">  </span><span class="keyword1">{</span><span class="">
</span><span class="">    </span><span class="keyword3">fix</span><span class=""> </span><span class="">s0</span><span class=""> </span><span class="">x0</span><span class=""> </span><span class="">pesl</span><span class="">
</span><span class="">    </span><span class="keyword3">assume</span><span class=""> </span><span class="">a0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;s0&#8712;init&quot;</span><span class="">
</span><span class="">      </span><span class="keyword2">and</span><span class="">  </span><span class="">a1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;pesl&#8712;cpts_of_pes (paresys_spec pesf) s0 x0&quot;</span><span class="">
</span><span class="">      </span><span class="keyword2">and</span><span class="">  </span><span class="string">&quot;no_environment pesl&quot;</span><span class="">
</span><span class="">    </span><span class="keyword1">then</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">a2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8704;j. Suc j &lt; length pesl &#10230; (&#8707;actk. pesl!j-pes-actk&#8594;pesl!Suc j)&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class="">no_environment_def</span><span class="delimiter">)</span><span class="">
</span><span class="">    </span><span class="keyword1">from</span><span class=""> </span><span class="">a1</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">a3</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;pesl!0 = (paresys_spec pesf, s0, x0) &#8743; pesl&#8712;cpts_pes&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class="">cpts_of_pes_def</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">{</span><span class="">
</span><span class="">      </span><span class="keyword3">fix</span><span class=""> </span><span class="">i</span><span class="">
</span><span class="">      </span><span class="keyword3">assume</span><span class=""> </span><span class="">b0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;i&lt;length pesl&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">then</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;gets (pesl!i) &#8712; invar&quot;</span><span class="">
</span><span class="">        </span><span class="keyword1">proof</span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">i</span><span class="delimiter">)</span><span class="">
</span><span class="">          </span><span class="keyword3">case</span><span class=""> </span><span class="">0</span><span class=""> 
</span><span class="">          </span><span class="keyword1">with</span><span class=""> </span><span class="">a3</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;gets (pesl!0) = s0&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class="">gets_def</span><span class="delimiter">)</span><span class="">
</span><span class="">          </span><span class="keyword1">with</span><span class=""> </span><span class="">a0</span><span class=""> </span><span class="">init_in_invar</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?case</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">        </span><span class="keyword1">next</span><span class="">
</span><span class="">          </span><span class="keyword3">case</span><span class=""> </span><span class="delimiter">(</span><span class="">Suc</span><span class=""> </span><span class="">ni</span><span class="delimiter">)</span><span class="">
</span><span class="">          </span><span class="keyword3">assume</span><span class=""> </span><span class="">c0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;ni &lt; length pesl &#10233; gets (pesl ! ni) &#8712; invar&quot;</span><span class="">
</span><span class="">            </span><span class="keyword2">and</span><span class="">  </span><span class="">c1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;Suc ni &lt; length pesl&quot;</span><span class="">
</span><span class="">          </span><span class="keyword1">then</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">c2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;gets (pesl ! ni) &#8712; invar&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">          </span><span class="keyword1">from</span><span class=""> </span><span class="">a3</span><span class=""> </span><span class="">c1</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;pesl ! ni -pese&#8594; pesl ! Suc ni &#8744; (&#8707;et. pesl ! ni -pes-et&#8594; pesl ! Suc ni)&quot;</span><span class="">
</span><span class="">            </span><span class="keyword1">using</span><span class=""> </span><span class="">incpts_pes_impl_evnorcomptran</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">          </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?case</span><span class="">
</span><span class="">            </span><span class="keyword1">proof</span><span class="">
</span><span class="">              </span><span class="keyword3">assume</span><span class=""> </span><span class="">d0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;pesl ! ni -pese&#8594; pesl ! Suc ni&quot;</span><span class="">
</span><span class="">              </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">a2</span><span class=""> </span><span class="">c1</span><span class=""> </span><span class="">pes_tran_not_etran1</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">            </span><span class="keyword1">next</span><span class="">
</span><span class="">              </span><span class="keyword3">assume</span><span class=""> </span><span class="string">&quot;&#8707;et. pesl ! ni -pes-et&#8594; pesl ! Suc ni&quot;</span><span class="">
</span><span class="">              </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">obtain</span><span class=""> </span><span class="">et</span><span class=""> </span><span class="keyword2">where</span><span class=""> </span><span class="">d0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;pesl ! ni -pes-et&#8594; pesl ! Suc ni&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">              </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">obtain</span><span class=""> </span><span class="">act</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">k</span><span class=""> </span><span class="keyword2">where</span><span class=""> </span><span class="">d1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;et = act&#9839;k&quot;</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">get_actk_def</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">actk.cases</span><span class="delimiter">)</span><span class="">
</span><span class="">              </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class="">
</span><span class="">                </span><span class="keyword1">proof</span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">act</span><span class="delimiter">)</span><span class="">
</span><span class="">                  </span><span class="keyword3">case</span><span class=""> </span><span class="delimiter">(</span><span class="">Cmd</span><span class=""> </span><span class="">x</span><span class="delimiter">)</span><span class="">
</span><span class="">                  </span><span class="keyword3">assume</span><span class=""> </span><span class="">e0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;et = Cmd x&#9839;k&quot;</span><span class="">
</span><span class="">                  </span><span class="keyword1">have</span><span class=""> </span><span class="">e1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(gets (pesl!ni),gets (pesl!Suc ni))&#8712; Guar<span class="hidden">&#8681;</span><sub>f</sub> (the (evtrgfs (getx (pesl!ni) k)))&quot;</span><span class=""> 
</span><span class="">                    </span><span class="keyword1">using</span><span class=""> </span><span class="">act_cptpes_sat_guar_curevt_new2</span><span class="delimiter">[</span><span class="">of</span><span class=""> </span><span class="">pesf</span><span class=""> </span><span class="">init</span><span class=""> </span><span class="">UNIV</span><span class=""> </span><span class="">s0</span><span class=""> </span><span class="">evtrgfs</span><span class=""> </span><span class="">pesl</span><span class=""> </span><span class="">x0</span><span class="delimiter">]</span><span class=""> 
</span><span class="">                      </span><span class="">parsys_sat_rg</span><span class=""> </span><span class="">a0</span><span class=""> </span><span class="">all_evts_are_basic</span><span class=""> </span><span class="">evt_in_parsys_in_evtrgfs</span><span class=""> </span><span class="">a1</span><span class=""> </span><span class="">a2</span><span class=""> </span><span class="">c1</span><span class=""> </span><span class="">d0</span><span class=""> </span><span class="">e0</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">                  
</span><span class="">                  </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;&#8707;ef&#8712;all_evts pesf. getx (pesl!ni) k = E<span class="hidden">&#8681;</span><sub>e</sub> ef&quot;</span><span class=""> 
</span><span class="">                    </span><span class="keyword1">using</span><span class=""> </span><span class="">cur_evt_in_specevts</span><span class="delimiter">[</span><span class="">of</span><span class=""> </span><span class="">pesl</span><span class=""> </span><span class="">pesf</span><span class=""> </span><span class="">s0</span><span class=""> </span><span class="">x0</span><span class="delimiter">]</span><span class=""> </span><span class="">a1</span><span class=""> </span><span class="">a2</span><span class=""> </span><span class="">all_evts_are_basic</span><span class=""> </span><span class="">c1</span><span class=""> </span><span class="">d0</span><span class=""> </span><span class="">e0</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">                  </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">obtain</span><span class=""> </span><span class="">ef</span><span class=""> </span><span class="keyword2">where</span><span class=""> </span><span class="">e2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;ef&#8712;all_evts pesf &#8743; getx (pesl!ni) k = E<span class="hidden">&#8681;</span><sub>e</sub> ef&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">                  </span><span class="keyword1">with</span><span class=""> </span><span class="">e1</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;(gets (pesl!ni),gets (pesl!Suc ni))&#8712;Guar<span class="hidden">&#8681;</span><sub>e</sub> ef&quot;</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">evt_in_parsys_in_evtrgfs</span><span class="">
</span><span class="">                    </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">Guar<span class="hidden">&#8681;</span><sub>e</sub>_def</span><span class=""> </span><span class="">Guar<span class="hidden">&#8681;</span><sub>f</sub>_def</span><span class="delimiter">)</span><span class="">
</span><span class="">                  </span><span class="keyword1">with</span><span class=""> </span><span class="">stb_invar</span><span class=""> </span><span class="">e2</span><span class=""> </span><span class="">c2</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?case</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">meson</span><span class=""> </span><span class="">stable_def</span><span class="delimiter">)</span><span class=""> 
</span><span class="">                </span><span class="keyword1">next</span><span class="">
</span><span class="">                  </span><span class="keyword3">case</span><span class=""> </span><span class="delimiter">(</span><span class="">EvtEnt</span><span class=""> </span><span class="">x</span><span class="delimiter">)</span><span class="">
</span><span class="">                  </span><span class="keyword3">assume</span><span class=""> </span><span class="">e0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;et = EvtEnt x&#9839;k&quot;</span><span class="">
</span><span class="">                  </span><span class="keyword1">with</span><span class=""> </span><span class="">c2</span><span class=""> </span><span class="">d0</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?case</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">evtent_in_pes_notchgstate2</span><span class="delimiter">[</span><span class="">of</span><span class=""> </span><span class="string">&quot;pesl ! ni&quot;</span><span class=""> </span><span class="">x</span><span class=""> </span><span class="">k</span><span class=""> </span><span class="string">&quot;pesl ! Suc ni&quot;</span><span class="delimiter">]</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">                </span><span class="keyword1">qed</span><span class="">
</span><span class="">            </span><span class="keyword1">qed</span><span class="">
</span><span class="">        </span><span class="keyword1">qed</span><span class="">
</span><span class="">    </span><span class="keyword1">}</span><span class="">
</span><span class="">  </span><span class="keyword1">}</span><span class="">
</span><span class="">  </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">invariant_of_pares_def</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">  </span><span class="keyword1">qed</span><span class="">
</span><span class="">
</span><span class="keyword2">end</span></pre>

</div>
</body>
</html>
