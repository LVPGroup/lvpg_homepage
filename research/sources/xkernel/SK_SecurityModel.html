<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Theory SK_SecurityModel (Isabelle2016: February 2016)</title>
<link media="all" rel="stylesheet" type="text/css" href="isabelle.css"/>
</head>

<body>
<div class="head"><h1>Theory SK_SecurityModel</h1>

<span class="command">theory</span> <span class="name">SK_SecurityModel</span><br/>
<span class="keyword">imports</span> <a href="../../HOL/HOL/Main.html"><span class="name">Main</span></a><br/>

</div>
<div class="source">
<pre class="source"><span class="comment">(*
A refinement based formal specification and information flow security proofs 
for ARINC 653 compliant separation kernels
created by Yongwang ZHAO
School of Computer Science and Engineering, Nanyang Technological University, Singapore
School of Computer Science and Engineering, Beihang University, China
zhaoyongwang@gmail.com, ywzhao@ntu.edu.sg, zhaoyw@buaa.edu.cn
*)</span><span class="">
</span><span class="">
</span><span class="keyword1">section</span><span class=""> </span><span class="verbatim">{*Security Model of Separation Kernels*}</span><span class="">
</span><span class="keyword1">theory</span><span class=""> </span><span class="">SK_SecurityModel</span><span class="">
</span><span class="keyword2">imports</span><span class=""> </span><span class="">Main</span><span class="">
</span><span class="keyword2">begin</span><span class="">
</span><span class="">
</span><span class="keyword1">subsection</span><span class=""> </span><span class="verbatim">{* Security State Machine *}</span><span class="">
</span><span class="">
</span><span class="keyword1">locale</span><span class=""> </span><span class="">SM</span><span class=""> </span><span class="delimiter">=</span><span class="">
</span><span class="">  </span><span class="keyword2">fixes</span><span class=""> </span><span class="">s0</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="tfree">&#39;s</span><span class="">
</span><span class="">  </span><span class="keyword2">fixes</span><span class=""> </span><span class="">step</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;e &#8658; (&#39;s &#215; &#39;s) set&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2">fixes</span><span class=""> </span><span class="">domain</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;s &#8658; &#39;e &#8658; (&#39;d option)&quot;</span><span class="">
</span><span class="">  </span><span class="keyword2">fixes</span><span class=""> </span><span class="">sched</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="tfree">&#39;d</span><span class=""> 
</span><span class="">  </span><span class="keyword2">fixes</span><span class=""> </span><span class="">vpeq</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;s &#8658; &#39;d &#8658; &#39;s &#8658; bool&quot;</span><span class="">  </span><span class="delimiter">(</span><span class="string">&quot;(_ &#8764; _ &#8764; _)&quot;</span><span class="delimiter">)</span><span class=""> 
</span><span class="">  </span><span class="keyword2">fixes</span><span class=""> </span><span class="">interference</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;d &#8658; &#39;d &#8658; bool&quot;</span><span class=""> </span><span class="delimiter">(</span><span class="string">&quot;(_ &#8605; _)&quot;</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword2">assumes</span><span class=""> 
</span><span class="">    </span><span class="">vpeq_transitive_lemma</span><span class=""> </span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8704; s t r d. (s &#8764; d &#8764; t) &#8743; (t &#8764; d &#8764; r) &#10230; (s &#8764; d &#8764; r)&quot;</span><span class=""> </span><span class="keyword2">and</span><span class="">
</span><span class="">    </span><span class="">vpeq_symmetric_lemma</span><span class=""> </span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8704; s t d. (s &#8764; d &#8764; t) &#10230; (t &#8764; d &#8764; s)&quot;</span><span class=""> </span><span class="keyword2">and</span><span class="">
</span><span class="">    </span><span class="">vpeq_reflexive_lemma</span><span class=""> </span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8704; s d. (s &#8764; d &#8764; s)&quot;</span><span class=""> </span><span class="keyword2">and</span><span class="">
</span><span class="">    </span><span class="">sched_vpeq</span><span class=""> </span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8704;s t a. (s &#8764; sched &#8764; t) &#10230; (domain s a) = (domain t a)&quot;</span><span class=""> </span><span class="keyword2">and</span><span class="">
</span><span class="">    </span><span class="">sched_intf_all</span><span class=""> </span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8704;d. (sched &#8605; d)&quot;</span><span class=""> </span><span class="keyword2">and</span><span class="">
</span><span class="">    </span><span class="">no_intf_sched</span><span class=""> </span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8704;d. (d &#8605; sched) &#10230; d = sched&quot;</span><span class=""> </span><span class="keyword2">and</span><span class="">
</span><span class="">    </span><span class="">interf_reflexive</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8704;d. (d &#8605; d)&quot;</span><span class="">
</span><span class="keyword2">begin</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">definition</span><span class=""> </span><span class="">non_interference</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;d &#8658; &#39;d &#8658; bool&quot;</span><span class=""> </span><span class="delimiter">(</span><span class="string">&quot;(_ &#8726;&#8605; _)&quot;</span><span class="delimiter">)</span><span class="">
</span><span class="">      </span><span class="keyword2">where</span><span class=""> </span><span class="string">&quot;(u &#8726;&#8605;  v) &#8801; &#172; (u &#8605; v)&quot;</span><span class="">
</span><span class="">   
</span><span class="">    </span><span class="keyword1">definition</span><span class=""> </span><span class="">ivpeq</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;s &#8658; &#39;d set &#8658; &#39;s &#8658; bool&quot;</span><span class=""> </span><span class="delimiter">(</span><span class="string">&quot;(_ &#8776; _ &#8776; _)&quot;</span><span class="delimiter">)</span><span class="">
</span><span class="">    </span><span class="keyword2">where</span><span class=""> </span><span class="string">&quot;ivpeq s D t &#8801; &#8704; d &#8712; D. (s &#8764; d &#8764; t)&quot;</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">primrec</span><span class=""> </span><span class="">run</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;e list &#8658; (&#39;s &#215; &#39;s) set&quot;</span><span class=""> 
</span><span class="">      </span><span class="keyword2">where</span><span class=""> </span><span class="">run_Nil</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;run [] = Id&quot;</span><span class=""> </span><span class="delimiter">|</span><span class="">
</span><span class="">            </span><span class="">run_Cons</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;run (a#as) = step a O run as&quot;</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">definition</span><span class=""> </span><span class="">next_states</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;s &#8658; &#39;e &#8658; &#39;s set&quot;</span><span class="">
</span><span class="">      </span><span class="keyword2">where</span><span class=""> </span><span class="string">&quot;next_states s a &#8801; {Q. (s,Q)&#8712;step a}&quot;</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">definition</span><span class=""> </span><span class="">execute</span><span class="">  </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;e list &#8658; &#39;s &#8658; &#39;s set&quot;</span><span class=""> 
</span><span class="">      </span><span class="keyword2">where</span><span class=""> </span><span class="string">&quot;execute as s = Image (run as) {s} &quot;</span><span class=""> 
</span><span class="">
</span><span class="">    </span><span class="keyword1">definition</span><span class=""> </span><span class="">reachable</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;s &#8658; &#39;s &#8658; bool&quot;</span><span class=""> </span><span class="delimiter">(</span><span class="string">&quot;(_ &#8618; _)&quot;</span><span class=""> </span><span class="delimiter">[</span><span class="">70</span><span class="delimiter">,</span><span class="">71</span><span class="delimiter">]</span><span class=""> </span><span class="">60</span><span class="delimiter">)</span><span class=""> </span><span class="keyword2">where</span><span class="">
</span><span class="">      </span><span class="string">&quot;reachable s1 s2 &#8801;  (&#8707;as. (s1,s2) &#8712; run as)&quot;</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">definition</span><span class=""> </span><span class="">reachable0</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;s &#8658; bool&quot;</span><span class="">  </span><span class="keyword2">where</span><span class="">
</span><span class="">      </span><span class="string">&quot;reachable0 s &#8801; reachable s0 s&quot;</span><span class="">
</span><span class="">    
</span><span class="">   </span><span class="keyword1">declare</span><span class=""> </span><span class="">non_interference_def</span><span class="delimiter">[</span><span class="">cong</span><span class="delimiter">]</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">ivpeq_def</span><span class="delimiter">[</span><span class="">cong</span><span class="delimiter">]</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">next_states_def</span><span class="delimiter">[</span><span class="">cong</span><span class="delimiter">]</span><span class="">
</span><span class="">            </span><span class="">execute_def</span><span class="delimiter">[</span><span class="">cong</span><span class="delimiter">]</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">reachable_def</span><span class="delimiter">[</span><span class="">cong</span><span class="delimiter">]</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">reachable0_def</span><span class="delimiter">[</span><span class="">cong</span><span class="delimiter">]</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">run.simps</span><span class="delimiter">(</span><span class="">1</span><span class="delimiter">)</span><span class="delimiter">[</span><span class="">cong</span><span class="delimiter">]</span><span class=""> </span><span class="keyword2">and</span><span class="">
</span><span class="">            </span><span class="">run.simps</span><span class="delimiter">(</span><span class="">2</span><span class="delimiter">)</span><span class="delimiter">[</span><span class="">cong</span><span class="delimiter">]</span><span class=""> 
</span><span class="">  
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">reachable_s0</span><span class=""> </span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;reachable0 s0&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">SM.reachable_def</span><span class=""> </span><span class="">SM_axioms</span><span class=""> </span><span class="">pair_in_Id_conv</span><span class=""> </span><span class="">reachable0_def</span><span class=""> </span><span class="">run.simps</span><span class="delimiter">(</span><span class="">1</span><span class="delimiter">)</span><span class="delimiter">)</span><span class=""> 
</span><span class="">    
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">reachable_self</span><span class=""> </span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;reachable s s&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">reachable_def</span><span class=""> </span><span class="">run.simps</span><span class="delimiter">(</span><span class="">1</span><span class="delimiter">)</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">fastforce</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">reachable_step</span><span class=""> </span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(s,s&#39;)&#8712;step a &#10233; reachable s s&#39;&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">proof</span><span class="">-</span><span class="">
</span><span class="">        </span><span class="keyword3">assume</span><span class=""> </span><span class="">a0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(s,s&#39;)&#8712;step a&quot;</span><span class="">
</span><span class="">        </span><span class="keyword1">then</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;(s,s&#39;)&#8712;run [a]&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">          
</span><span class="">        </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">reachable_def</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">      </span><span class="keyword1">qed</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">run_trans</span><span class=""> </span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8704;C T V as bs. (C,T)&#8712;run as &#8743; (T,V)&#8712;run bs &#10230; (C,V)&#8712;run (as@bs)&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">      </span><span class="keyword1">{</span><span class="">
</span><span class="">        </span><span class="keyword3">fix</span><span class=""> </span><span class="">T</span><span class=""> </span><span class="">V</span><span class=""> </span><span class="">as</span><span class=""> </span><span class="">bs</span><span class="">
</span><span class="">        </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;&#8704;C. (C,T)&#8712;run as &#8743; (T,V)&#8712;run bs &#10230; (C,V)&#8712;run (as@bs)&quot;</span><span class="">
</span><span class="">          </span><span class="keyword1">proof</span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">as</span><span class="delimiter">)</span><span class="">
</span><span class="">            </span><span class="keyword3">case</span><span class=""> </span><span class="">Nil</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?case</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">          </span><span class="keyword1">next</span><span class="">
</span><span class="">            </span><span class="keyword3">case</span><span class=""> </span><span class="delimiter">(</span><span class="">Cons</span><span class=""> </span><span class="">c</span><span class=""> </span><span class="">cs</span><span class="delimiter">)</span><span class="">
</span><span class="">            </span><span class="keyword3">assume</span><span class=""> </span><span class="">a0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8704;C. (C, T) &#8712; run cs &#8743; (T, V) &#8712; run bs &#10230; (C, V) &#8712; run (cs @ bs)&quot;</span><span class="">
</span><span class="">            </span><span class="keyword3">show</span><span class=""> </span><span class="var">?case</span><span class="">
</span><span class="">              </span><span class="keyword1">proof</span><span class="">-</span><span class="">
</span><span class="">              </span><span class="keyword1">{</span><span class="">
</span><span class="">                </span><span class="keyword3">fix</span><span class=""> </span><span class="">C</span><span class="">
</span><span class="">                </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;(C, T) &#8712; run (c # cs) &#8743; (T, V) &#8712; run bs &#10230; (C, V) &#8712; run ((c # cs) @ bs) &quot;</span><span class="">
</span><span class="">                  </span><span class="keyword1">proof</span><span class="">
</span><span class="">                    </span><span class="keyword3">assume</span><span class=""> </span><span class="">b0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(C, T) &#8712; run (c # cs) &#8743; (T, V) &#8712; run bs&quot;</span><span class="">
</span><span class="">                    </span><span class="keyword1">from</span><span class=""> </span><span class="">b0</span><span class=""> </span><span class="keyword3">obtain</span><span class=""> </span><span class="">C&#39;</span><span class=""> </span><span class="keyword2">where</span><span class=""> </span><span class="">b2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(C,C&#39;)&#8712;step c &#8743; (C&#39;,T)&#8712;run cs&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">                    </span><span class="keyword1">with</span><span class=""> </span><span class="">a0</span><span class=""> </span><span class="">b0</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;(C&#39;,V)&#8712;run (cs@bs)&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">                    </span><span class="keyword1">with</span><span class=""> </span><span class="">b2</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="string">&quot;(C, V) &#8712; run ((c # cs) @ bs)&quot;</span><span class="">
</span><span class="">                      </span><span class="keyword1">using</span><span class=""> </span><span class="">append_Cons</span><span class=""> </span><span class="">relcomp.relcompI</span><span class=""> </span><span class="">run_Cons</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class=""> 
</span><span class="">                  </span><span class="keyword1">qed</span><span class="">
</span><span class="">              </span><span class="keyword1">}</span><span class="">
</span><span class="">              </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">              </span><span class="keyword1">qed</span><span class="">
</span><span class="">          </span><span class="keyword1">qed</span><span class="">
</span><span class="">      </span><span class="keyword1">}</span><span class="">
</span><span class="">      </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">      </span><span class="keyword1">qed</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">reachable_trans</span><span class=""> </span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#10214;reachable C T; reachable T V&#10215; &#10233; reachable C V&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">proof</span><span class="">-</span><span class="">
</span><span class="">        </span><span class="keyword3">assume</span><span class=""> </span><span class="">a0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;reachable C T&quot;</span><span class="">
</span><span class="">        </span><span class="keyword3">assume</span><span class=""> </span><span class="">a1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;reachable T V&quot;</span><span class="">
</span><span class="">        </span><span class="keyword1">from</span><span class=""> </span><span class="">a0</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;C = T &#8744; (&#8707;as. (C,T)&#8712;run as)&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">        </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class="">
</span><span class="">          </span><span class="keyword1">proof</span><span class="">
</span><span class="">            </span><span class="keyword3">assume</span><span class=""> </span><span class="">b0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;C = T&quot;</span><span class="">
</span><span class="">            </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> 
</span><span class="">              </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">                </span><span class="keyword1">from</span><span class=""> </span><span class="">a1</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;T = V &#8744; (&#8707;as. (T,V)&#8712;run as)&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">                </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class="">
</span><span class="">                  </span><span class="keyword1">proof</span><span class="">
</span><span class="">                    </span><span class="keyword3">assume</span><span class=""> </span><span class="">c0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;T=V&quot;</span><span class="">
</span><span class="">                    </span><span class="keyword1">with</span><span class=""> </span><span class="">a0</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">                  </span><span class="keyword1">next</span><span class="">
</span><span class="">                    </span><span class="keyword3">assume</span><span class=""> </span><span class="">c0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(&#8707;as. (T,V)&#8712;run as)&quot;</span><span class="">
</span><span class="">                    </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">a1</span><span class=""> </span><span class="">b0</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class=""> 
</span><span class="">                  </span><span class="keyword1">qed</span><span class="">
</span><span class="">              </span><span class="keyword1">qed</span><span class="">
</span><span class="">          </span><span class="keyword1">next</span><span class="">
</span><span class="">            </span><span class="keyword3">assume</span><span class=""> </span><span class="">b0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8707;as. (C,T)&#8712;run as&quot;</span><span class="">
</span><span class="">            </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class="">
</span><span class="">              </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">                </span><span class="keyword1">from</span><span class=""> </span><span class="">a1</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;T = V &#8744; (&#8707;as. (T,V)&#8712;run as)&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">                </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class="">
</span><span class="">                  </span><span class="keyword1">proof</span><span class="">
</span><span class="">                    </span><span class="keyword3">assume</span><span class=""> </span><span class="">c0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;T=V&quot;</span><span class="">
</span><span class="">                    </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">a0</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class=""> 
</span><span class="">                  </span><span class="keyword1">next</span><span class="">
</span><span class="">                    </span><span class="keyword3">assume</span><span class=""> </span><span class="">c0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(&#8707;as. (T,V)&#8712;run as)&quot;</span><span class="">
</span><span class="">                    </span><span class="keyword1">from</span><span class=""> </span><span class="">b0</span><span class=""> </span><span class="keyword3">obtain</span><span class=""> </span><span class="">as</span><span class=""> </span><span class="keyword2">where</span><span class=""> </span><span class="">d0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(C,T)&#8712;run as&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">                    </span><span class="keyword1">from</span><span class=""> </span><span class="">c0</span><span class=""> </span><span class="keyword3">obtain</span><span class=""> </span><span class="">bs</span><span class=""> </span><span class="keyword2">where</span><span class=""> </span><span class="">d1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(T,V)&#8712;run bs&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">                    </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">d0</span><span class="">  </span><span class="">run_trans</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">fastforce</span><span class="">
</span><span class="">                  </span><span class="keyword1">qed</span><span class="">
</span><span class="">              </span><span class="keyword1">qed</span><span class="">
</span><span class="">          </span><span class="keyword1">qed</span><span class="">
</span><span class="">      </span><span class="keyword1">qed</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">reachableStep</span><span class=""> </span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#10214;reachable0 C; (C,C&#39;)&#8712;step a&#10215; &#10233; reachable0 C&#39;&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">        </span><span class="keyword3">assume</span><span class=""> </span><span class="">a0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;reachable0 C&quot;</span><span class="">
</span><span class="">        </span><span class="keyword3">assume</span><span class=""> </span><span class="">a1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(C,C&#39;)&#8712;step a&quot;</span><span class="">
</span><span class="">        </span><span class="keyword1">from</span><span class=""> </span><span class="">a0</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;(C = s0) &#8744; (&#8707;as. (s0,C) &#8712; run as)&quot;</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">        </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="string">&quot;reachable0 C&#39;&quot;</span><span class="">
</span><span class="">          </span><span class="keyword1">proof</span><span class="">
</span><span class="">            </span><span class="keyword3">assume</span><span class=""> </span><span class="">b0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;C = s0&quot;</span><span class="">
</span><span class="">            </span><span class="keyword3">show</span><span class=""> </span><span class="string">&quot;reachable0 C&#39;&quot;</span><span class="">
</span><span class="">              </span><span class="keyword1">using</span><span class=""> </span><span class="">a1</span><span class=""> </span><span class="">b0</span><span class="">  </span><span class="">reachable_step</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class=""> 
</span><span class="">          </span><span class="keyword1">next</span><span class="">
</span><span class="">            </span><span class="keyword3">assume</span><span class=""> </span><span class="">b0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8707;as. (s0,C) &#8712; run as&quot;</span><span class="">
</span><span class="">            </span><span class="keyword3">show</span><span class=""> </span><span class="string">&quot;reachable0 C&#39;&quot;</span><span class="">
</span><span class="">              </span><span class="keyword1">using</span><span class=""> </span><span class="">a0</span><span class=""> </span><span class="">a1</span><span class=""> </span><span class="">reachable_step</span><span class=""> </span><span class="">reachable0_def</span><span class=""> </span><span class="">reachable_trans</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">          </span><span class="keyword1">qed</span><span class="">
</span><span class="">      </span><span class="keyword1">qed</span><span class="">
</span><span class="">    
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">reachable0_reach</span><span class=""> </span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#10214;reachable0 C; reachable C C&#39;&#10215; &#10233; reachable0 C&#39;&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class="">  </span><span class="">reachable_trans</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">fastforce</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">declare</span><span class=""> </span><span class="">reachable_def</span><span class="delimiter">[</span><span class="">cong</span><span class=""> </span><span class="">del</span><span class="delimiter">]</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">reachable0_def</span><span class="delimiter">[</span><span class="">cong</span><span class=""> </span><span class="">del</span><span class="delimiter">]</span><span class="">
</span><span class="">
</span><span class="keyword2">end</span><span class="">
</span><span class="">
</span><span class="">
</span><span class="keyword1">subsection</span><span class="verbatim">{* Information flow security properties *}</span><span class="">
</span><span class="">
</span><span class="keyword1">locale</span><span class=""> </span><span class="">SM_enabled</span><span class=""> </span><span class="delimiter">=</span><span class=""> </span><span class="">SM</span><span class=""> </span><span class="">s0</span><span class=""> </span><span class="">step</span><span class=""> </span><span class="">domain</span><span class=""> </span><span class="">sched</span><span class=""> </span><span class="">vpeq</span><span class=""> </span><span class="">interference</span><span class="">
</span><span class="">  </span><span class="keyword2">for</span><span class=""> </span><span class="">s0</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="tfree">&#39;s</span><span class=""> </span><span class="keyword2">and</span><span class="">
</span><span class="">       </span><span class="">step</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;e &#8658; (&#39;s &#215; &#39;s) set&quot;</span><span class=""> </span><span class="keyword2">and</span><span class="">
</span><span class="">       </span><span class="">domain</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;s &#8658; &#39;e &#8658; (&#39;d option)&quot;</span><span class=""> </span><span class="keyword2">and</span><span class="">
</span><span class="">       </span><span class="">sched</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="tfree">&#39;d</span><span class=""> </span><span class="keyword2">and</span><span class="">
</span><span class="">       </span><span class="">vpeq</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;s &#8658; &#39;d &#8658; &#39;s &#8658; bool&quot;</span><span class="">  </span><span class="delimiter">(</span><span class="string">&quot;(_ &#8764; _ &#8764; _)&quot;</span><span class="delimiter">)</span><span class=""> </span><span class="keyword2">and</span><span class="">
</span><span class="">       </span><span class="">interference</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;d &#8658; &#39;d &#8658; bool&quot;</span><span class=""> </span><span class="delimiter">(</span><span class="string">&quot;(_ &#8605; _)&quot;</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="delimiter">+</span><span class="">
</span><span class="">  </span><span class="keyword2">assumes</span><span class=""> </span><span class="">enabled0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8704;s a. reachable0 s &#10230; (&#8707; s&#39;. (s,s&#39;) &#8712; step a)&quot;</span><span class="">
</span><span class="keyword2">begin</span><span class="">
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">enabled</span><span class=""> </span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;reachable0 s &#10233; (&#8707; s&#39;. (s,s&#39;) &#8712; step a)&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">enabled0</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">enabled_ex</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8704;s es. reachable0 s &#10230; (&#8707; s&#39;. s&#39; &#8712; execute es s)&quot;</span><span class=""> 
</span><span class="">      </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">      </span><span class="keyword1">{</span><span class="">
</span><span class="">        </span><span class="keyword3">fix</span><span class=""> </span><span class="">es</span><span class="">
</span><span class="">        </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;&#8704;s. reachable0 s &#10230; (&#8707; s&#39;. s&#39; &#8712; execute es s)&quot;</span><span class="">
</span><span class="">          </span><span class="keyword1">proof</span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">es</span><span class="delimiter">)</span><span class="">
</span><span class="">            </span><span class="keyword3">case</span><span class=""> </span><span class="">Nil</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?case</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class=""> 
</span><span class="">          </span><span class="keyword1">next</span><span class="">
</span><span class="">            </span><span class="keyword3">case</span><span class=""> </span><span class="delimiter">(</span><span class="">Cons</span><span class=""> </span><span class="">a</span><span class=""> </span><span class="">as</span><span class="delimiter">)</span><span class="">
</span><span class="">            </span><span class="keyword3">assume</span><span class=""> </span><span class="">a0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8704;s. reachable0 s &#10230; (&#8707;s&#39;. s&#39; &#8712; execute as s)&quot;</span><span class="">
</span><span class="">            </span><span class="keyword3">show</span><span class=""> </span><span class="var">?case</span><span class=""> 
</span><span class="">              </span><span class="keyword1">proof</span><span class="">-</span><span class="">
</span><span class="">              </span><span class="keyword1">{</span><span class="">
</span><span class="">                </span><span class="keyword3">fix</span><span class=""> </span><span class="">s</span><span class="">
</span><span class="">                </span><span class="keyword3">assume</span><span class=""> </span><span class="">b0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;reachable0 s&quot;</span><span class="">
</span><span class="">                </span><span class="keyword1">have</span><span class=""> </span><span class="">b1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8707;s1. (s,s1)&#8712;step a&quot;</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">enabled</span><span class=""> </span><span class="">b0</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">                </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">obtain</span><span class=""> </span><span class="">s1</span><span class=""> </span><span class="keyword2">where</span><span class=""> </span><span class="">b2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(s,s1)&#8712;step a&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">                </span><span class="keyword1">with</span><span class=""> </span><span class="">a0</span><span class=""> </span><span class="">b0</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">b3</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8707;s&#39;. s&#39; &#8712; execute as s1&quot;</span><span class="">
</span><span class="">                  </span><span class="keyword1">using</span><span class=""> </span><span class="">reachableStep</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">                </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">obtain</span><span class=""> </span><span class="">s2</span><span class=""> </span><span class="keyword2">where</span><span class=""> </span><span class="">b4</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;s2&#8712;execute as s1&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">                </span><span class="keyword1">then</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;s2 &#8712; execute (a # as) s&quot;</span><span class="">
</span><span class="">                  </span><span class="keyword1">using</span><span class=""> </span><span class="">Image_singleton_iff</span><span class="">  </span><span class="">SM_axioms</span><span class=""> </span><span class="">b2</span><span class=""> </span><span class="">relcomp.simps</span><span class=""> </span><span class="">run_Cons</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">fastforce</span><span class=""> 
</span><span class="">                </span><span class="keyword1">then</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;&#8707;s&#39;. s&#39; &#8712; execute (a # as) s&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">              </span><span class="keyword1">}</span><span class="">
</span><span class="">              </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">              </span><span class="keyword1">qed</span><span class="">
</span><span class="">          </span><span class="keyword1">qed</span><span class="">
</span><span class="">      </span><span class="keyword1">}</span><span class="">
</span><span class="">      </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">      </span><span class="keyword1">qed</span><span class="">
</span><span class="">            
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">enabled_ex2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;reachable0 s &#10233; (&#8707; s&#39;. s&#39; &#8712; execute es s)&quot;</span><span class=""> 
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">enabled_ex</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">primrec</span><span class=""> </span><span class="">sources</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;e list &#8658; &#39;s &#8658; &#39;d &#8658; &#39;d set&quot;</span><span class=""> </span><span class="keyword2">where</span><span class="">
</span><span class="">      </span><span class="">sources_Nil</span><span class="delimiter">:</span><span class="string">&quot;sources [] s d = {d}&quot;</span><span class=""> </span><span class="delimiter">|</span><span class="">
</span><span class="">      </span><span class="">sources_Cons</span><span class="delimiter">:</span><span class="string">&quot;sources (a # as) s d = (&#8899;{sources as s&#39; d| s&#39;. (s,s&#39;) &#8712; step a}) &#8746; 
                              {w . w = the (domain s a) &#8743; (&#8707;v s&#39;. (w &#8605; v) &#8743; (s,s&#39;)&#8712;step a &#8743; v&#8712;sources as s&#39; d)}&quot;</span><span class="">
</span><span class="">    </span><span class="keyword1">declare</span><span class=""> </span><span class="">sources_Nil</span><span class=""> </span><span class="delimiter">[</span><span class="">simp</span><span class=""> </span><span class="">del</span><span class="delimiter">]</span><span class="">     
</span><span class="">    </span><span class="keyword1">declare</span><span class=""> </span><span class="">sources_Cons</span><span class=""> </span><span class="delimiter">[</span><span class="">simp</span><span class=""> </span><span class="">del</span><span class="delimiter">]</span><span class="">
</span><span class="">    
</span><span class="">    </span><span class="keyword1">primrec</span><span class=""> </span><span class="">ipurge</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;e list &#8658; &#39;d &#8658; &#39;s set &#8658; &#39;e list&quot;</span><span class=""> </span><span class="keyword2">where</span><span class="">
</span><span class="">      </span><span class="">ipurge_Nil</span><span class="delimiter">:</span><span class="">   </span><span class="string">&quot;ipurge [] u ss = []&quot;</span><span class=""> </span><span class="delimiter">|</span><span class="">
</span><span class="">      </span><span class="">ipurge_Cons</span><span class="delimiter">:</span><span class="">  </span><span class="string">&quot;ipurge (a#as) u ss = (if &#8707;s&#8712;ss. the (domain s a) &#8712; (sources (a#as) s u) then
                                              a # ipurge as u (&#8899;s&#8712;ss. {s&#39;. (s,s&#39;) &#8712; step a})
                                           else
                                              ipurge as u ss
                                          )&quot;</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">definition</span><span class=""> </span><span class="">observ_equivalence</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;s &#8658; &#39;e list &#8658; &#39;s &#8658; 
          &#39;e list &#8658; &#39;d &#8658; bool&quot;</span><span class=""> </span><span class="delimiter">(</span><span class="string">&quot;(_ &#8882; _ &#8773; _ &#8882; _ @ _)&quot;</span><span class="delimiter">)</span><span class="">
</span><span class="">      </span><span class="keyword2">where</span><span class=""> </span><span class="string">&quot;observ_equivalence s as t bs d &#8801; 
                &#8704;s&#39; t&#39;. ((s,s&#39;)&#8712; run as &#8743; (t,t&#39;)&#8712; run bs) &#10230;(s&#39; &#8764; d &#8764; t&#39;)&quot;</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">declare</span><span class=""> </span><span class="">observ_equivalence_def</span><span class="delimiter">[</span><span class="">cong</span><span class="delimiter">]</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">observ_equiv_sym</span><span class="delimiter">:</span><span class="">
</span><span class="">      </span><span class="string">&quot;(s &#8882; as &#8773; t &#8882; bs @ d) &#10233; (t &#8882; bs &#8773; s &#8882; as @ d)&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">observ_equivalence_def</span><span class=""> </span><span class="">vpeq_symmetric_lemma</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">    
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">observ_equiv_trans</span><span class="delimiter">:</span><span class="">
</span><span class="">      </span><span class="string">&quot;&#10214;reachable0 t; (s &#8882; as &#8773; t &#8882; bs @ d); (t &#8882; bs &#8773; x &#8882; cs @ d)&#10215; &#10233; (s &#8882; as &#8773; x &#8882; cs @ d)&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="">clarsimp</span><span class=""> 
</span><span class="">      </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">cut_tac</span><span class=""> </span><span class="">s</span><span class="delimiter">=</span><span class="">t</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">es</span><span class="delimiter">=</span><span class="">bs</span><span class=""> </span><span class="keyword2">in</span><span class=""> </span><span class="">enabled_ex2</span><span class="delimiter">)</span><span class="">
</span><span class="">      </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">      </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="">auto</span><span class="delimiter">[</span><span class="">1</span><span class="delimiter">]</span><span class="">
</span><span class="">      </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="delimiter">(</span><span class="">no_types</span><span class="delimiter">,</span><span class=""> </span><span class="">hide_lams</span><span class="delimiter">)</span><span class=""> </span><span class="">vpeq_transitive_lemma</span><span class="delimiter">)</span><span class="">
</span><span class="">      
</span><span class="">
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">exec_equiv_leftI</span><span class="delimiter">:</span><span class="">
</span><span class="">   </span><span class="string">&quot;&#10214;reachable0 C; &#8704; C&#39;. (C,C&#39;)&#8712;step a &#10230; (C&#39; &#8882; as &#8773; D &#8882; bs @ d)&#10215; &#10233; (C &#8882; (a # as) &#8773; D &#8882; bs @ d)&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">        </span><span class="keyword3">assume</span><span class=""> </span><span class="">a0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;reachable0 C&quot;</span><span class="">
</span><span class="">        </span><span class="keyword3">assume</span><span class=""> </span><span class="">a1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8704; C&#39;. (C,C&#39;)&#8712;step a &#10230; (C&#39; &#8882; as &#8773; D &#8882; bs @ d)&quot;</span><span class="">
</span><span class="">        </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;&#8704;S&#39; T&#39;. ((C,S&#39;)&#8712; run (a#as) &#8743; (D,T&#39;)&#8712; run bs) &#10230;(S&#39; &#8764; d &#8764; T&#39;)&quot;</span><span class=""> 
</span><span class="">          </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">          </span><span class="keyword1">{</span><span class="">
</span><span class="">            </span><span class="keyword3">fix</span><span class=""> </span><span class="">S&#39;</span><span class=""> </span><span class="">T&#39;</span><span class="">
</span><span class="">            </span><span class="keyword3">assume</span><span class=""> </span><span class="">b0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(C, S&#39;) &#8712; run (a # as) &#8743; (D, T&#39;) &#8712; run bs&quot;</span><span class="">
</span><span class="">            </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">obtain</span><span class=""> </span><span class="">C&#39;</span><span class=""> </span><span class="keyword2">where</span><span class=""> </span><span class="">b1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(C,C&#39;)&#8712;step a &#8743; (C&#39;,S&#39;)&#8712;run as&quot;</span><span class="">
</span><span class="">              </span><span class="keyword1">using</span><span class=""> </span><span class="">relcompEpair</span><span class=""> </span><span class="">run_Cons</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class=""> 
</span><span class="">            </span><span class="keyword1">with</span><span class=""> </span><span class="">a1</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">b2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(C&#39; &#8882; as &#8773; D &#8882; bs @ d)&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">            </span><span class="keyword1">with</span><span class=""> </span><span class="">b0</span><span class=""> </span><span class="">b1</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;S&#39; &#8764; d &#8764; T&#39;&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">          </span><span class="keyword1">}</span><span class="">
</span><span class="">          </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">          </span><span class="keyword1">qed</span><span class="">
</span><span class="">        </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="">fastforce</span><span class=""> 
</span><span class="">      </span><span class="keyword1">qed</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">exec_equiv_both</span><span class="delimiter">:</span><span class="">
</span><span class="">   </span><span class="string">&quot;&#10214;reachable0 C1; reachable0 C2; &#8704; C1&#39; C2&#39;. (C1,C1&#39;)&#8712;step a &#8743;(C2,C2&#39;)&#8712;step b&#10230; (C1&#39; &#8882; as &#8773; C2&#39; &#8882; bs @ u)&#10215; 
      &#10233; (C1 &#8882; (a # as) &#8773; C2 &#8882; (b # bs) @ u)&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">        </span><span class="keyword3">assume</span><span class=""> </span><span class="">a0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;reachable0 C1&quot;</span><span class="">
</span><span class="">        </span><span class="keyword3">assume</span><span class=""> </span><span class="">a1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;reachable0 C2&quot;</span><span class="">
</span><span class="">        </span><span class="keyword3">assume</span><span class=""> </span><span class="">a2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8704; C1&#39; C2&#39;. (C1,C1&#39;)&#8712;step a &#8743;(C2,C2&#39;)&#8712;step b&#10230; (C1&#39; &#8882; as &#8773; C2&#39; &#8882; bs @ u)&quot;</span><span class="">
</span><span class="">        </span><span class="keyword1">then</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;&#8704;S&#39; T&#39;. ((C1,S&#39;)&#8712; run (a # as) &#8743; (C2,T&#39;)&#8712; run (b # bs)) &#10230;(S&#39; &#8764; u &#8764; T&#39;)&quot;</span><span class="">
</span><span class="">          </span><span class="keyword1">using</span><span class=""> </span><span class="">relcompEpair</span><span class=""> </span><span class="">run_Cons</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">           
</span><span class="">        </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">                  
</span><span class="">      </span><span class="keyword1">qed</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">sources_refl</span><span class="delimiter">:</span><span class="string">&quot;reachable0 s &#10233; u &#8712; sources as s u&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">as</span><span class=""> </span><span class="">arbitrary</span><span class="delimiter">:</span><span class=""> </span><span class="">s</span><span class="delimiter">)</span><span class="">
</span><span class="">       </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">sources_Nil</span><span class="delimiter">)</span><span class="">
</span><span class="">      </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">sources_Cons</span><span class="delimiter">)</span><span class=""> 
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">enabled</span><span class=""> </span><span class="">reachableStep</span><span class="">  
</span><span class="">        </span><span class="keyword1">by</span><span class=""> </span><span class="">metis</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">scheduler_in_sources_Cons</span><span class="delimiter">:</span><span class="">
</span><span class="">      </span><span class="string">&quot;reachable0 s &#10233; the (domain s a) = sched &#10233; the (domain s a) &#8712; sources (a#as) s u&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">unfold</span><span class=""> </span><span class="">sources_Cons</span><span class="delimiter">)</span><span class="">
</span><span class="">      </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">erule</span><span class=""> </span><span class="">ssubst</span><span class="delimiter">)</span><span class="">
</span><span class="">      </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">UnI2</span><span class="delimiter">)</span><span class="">
</span><span class="">      </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">clarsimp</span><span class="delimiter">)</span><span class="">
</span><span class="">      </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule_tac</span><span class=""> </span><span class="">x</span><span class="delimiter">=</span><span class="">u</span><span class=""> </span><span class="keyword2">in</span><span class=""> </span><span class="">exI</span><span class="delimiter">)</span><span class="">
</span><span class="">      </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">safe</span><span class="delimiter">)</span><span class="">
</span><span class="">      </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">sched_intf_all</span><span class="delimiter">)</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">enabled</span><span class=""> </span><span class="">reachableStep</span><span class=""> </span><span class="">sources_refl</span><span class=""> 
</span><span class="">      </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">definition</span><span class=""> </span><span class="">noninterference_r</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;bool&quot;</span><span class="">
</span><span class="">      </span><span class="keyword2">where</span><span class=""> </span><span class="string">&quot;noninterference_r &#8801; &#8704;d as s. reachable0 s &#10230; (s &#8882; as &#8773; s &#8882; (ipurge as d {s}) @ d)&quot;</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">definition</span><span class=""> </span><span class="">noninterference</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;bool&quot;</span><span class="">
</span><span class="">      </span><span class="keyword2">where</span><span class=""> </span><span class="string">&quot;noninterference &#8801; &#8704;d as. (s0 &#8882; as &#8773; s0 &#8882; (ipurge as d {s0}) @ d)&quot;</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">definition</span><span class=""> </span><span class="">weak_noninterference</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;bool&quot;</span><span class="">
</span><span class="">      </span><span class="keyword2">where</span><span class=""> </span><span class="string">&quot;weak_noninterference &#8801; &#8704;d as bs. ipurge as d {s0} = ipurge bs d {s0}
                                                  &#10230; (s0 &#8882; as &#8773; s0 &#8882; bs @ d)&quot;</span><span class="">
</span><span class="">   
</span><span class="">    </span><span class="keyword1">definition</span><span class=""> </span><span class="">weak_noninterference_r</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;bool&quot;</span><span class="">
</span><span class="">      </span><span class="keyword2">where</span><span class=""> </span><span class="string">&quot;weak_noninterference_r &#8801; &#8704;d as bs s. reachable0 s &#8743; ipurge as d {s} = ipurge bs d {s}
                                                  &#10230; (s &#8882; as &#8773; s &#8882; bs @ d)&quot;</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">definition</span><span class=""> </span><span class="">noninfluence</span><span class="delimiter">::</span><span class="string">&quot;bool&quot;</span><span class=""> 
</span><span class="">      </span><span class="keyword2">where</span><span class=""> </span><span class="string">&quot;noninfluence &#8801; &#8704; d as s t . reachable0 s &#8743; reachable0 t &#8743; (s &#8776; (sources as s d) &#8776; t) 
                                &#8743; (s &#8764; sched &#8764; t) &#10230; (s &#8882; as &#8773; t &#8882; (ipurge as d {t}) @ d)&quot;</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">definition</span><span class=""> </span><span class="">noninfluence_gen</span><span class="delimiter">::</span><span class="string">&quot;bool&quot;</span><span class=""> 
</span><span class="">      </span><span class="keyword2">where</span><span class=""> </span><span class="string">&quot;noninfluence_gen &#8801; &#8704; d as s ts . reachable0 s &#8743; (&#8704;t&#8712;ts. reachable0 t) 
                                &#8743; (&#8704;t&#8712;ts. (s &#8776; (sources as s d) &#8776; t)) 
                                &#8743; (&#8704;t&#8712;ts. (s &#8764; sched &#8764; t)) 
                                &#10230; (&#8704;t&#8712;ts. (s &#8882; as &#8773; t &#8882; (ipurge as d ts) @ d))&quot;</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">definition</span><span class=""> </span><span class="">weak_noninfluence</span><span class=""> </span><span class="delimiter">::</span><span class="string">&quot;bool&quot;</span><span class=""> 
</span><span class="">      </span><span class="keyword2">where</span><span class=""> </span><span class="string">&quot;weak_noninfluence &#8801; &#8704; d as bs s t . reachable0 s &#8743; reachable0 t &#8743; (s &#8776; (sources as s d) &#8776; t) 
                                     &#8743; (s &#8764; sched &#8764; t) &#8743; ipurge as d {s} = ipurge bs d {s} 
                                     &#10230; (s &#8882; as &#8773; t &#8882; bs @ d)&quot;</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">definition</span><span class=""> </span><span class="">weak_noninfluence2</span><span class=""> </span><span class="delimiter">::</span><span class="string">&quot;bool&quot;</span><span class=""> 
</span><span class="">      </span><span class="keyword2">where</span><span class=""> </span><span class="string">&quot;weak_noninfluence2 &#8801; &#8704; d as bs s t . reachable0 s &#8743; reachable0 t &#8743; (s &#8776; (sources as s d) &#8776; t) 
                                     &#8743; (s &#8764; sched &#8764; t) &#8743; ipurge as d {s} = ipurge bs d {t} 
                                     &#10230; (s &#8882; as &#8773; t &#8882; bs @ d)&quot;</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">definition</span><span class=""> </span><span class="">nonleakage</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;bool&quot;</span><span class=""> 
</span><span class="">      </span><span class="keyword2">where</span><span class=""> </span><span class="string">&quot;nonleakage &#8801; &#8704;d as s t. reachable0 s &#8743; reachable0 t &#8743; (s &#8764; sched &#8764; t) 
                                      &#8743; (s &#8776; (sources as s d) &#8776; t) &#10230; (s &#8882; as &#8773; t &#8882; as @ d)&quot;</span><span class="">
</span><span class="keyword1">declare</span><span class=""> </span><span class="">noninterference_r_def</span><span class="delimiter">[</span><span class="">cong</span><span class="delimiter">]</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">noninterference_def</span><span class="delimiter">[</span><span class="">cong</span><span class="delimiter">]</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">weak_noninterference_def</span><span class="delimiter">[</span><span class="">cong</span><span class="delimiter">]</span><span class=""> </span><span class="keyword2">and</span><span class="">
</span><span class="">        </span><span class="">weak_noninterference_r_def</span><span class="delimiter">[</span><span class="">cong</span><span class="delimiter">]</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">noninfluence_def</span><span class="delimiter">[</span><span class="">cong</span><span class="delimiter">]</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">noninfluence_gen_def</span><span class="delimiter">[</span><span class="">cong</span><span class="delimiter">]</span><span class=""> </span><span class="keyword2">and</span><span class="">
</span><span class="">        </span><span class="">weak_noninfluence_def</span><span class="delimiter">[</span><span class="">cong</span><span class="delimiter">]</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">weak_noninfluence2_def</span><span class="delimiter">[</span><span class="">cong</span><span class="delimiter">]</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">nonleakage_def</span><span class="delimiter">[</span><span class="">cong</span><span class="delimiter">]</span><span class="">
</span><span class="">
</span><span class="">
</span><span class="keyword1">subsection</span><span class="verbatim">{* Unwinding conditions*}</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">definition</span><span class=""> </span><span class="">step_consistent</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;bool&quot;</span><span class=""> </span><span class="keyword2">where</span><span class="">
</span><span class="">      </span><span class="string">&quot;step_consistent &#8801; &#8704;a d s t. reachable0 s &#8743; reachable0 t &#8743; (s &#8764; d &#8764; t) &#8743; (s &#8764; sched &#8764; t) &#8743; 
                              (((the (domain s a)) &#8605; d) &#10230; (s &#8764; (the (domain s a)) &#8764; t)) &#10230; 
                              (&#8704; s&#39; t&#39;. (s,s&#39;) &#8712; step a &#8743; (t,t&#39;) &#8712; step a &#10230; (s&#39; &#8764;d&#8764; t&#39;))&quot;</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">definition</span><span class=""> </span><span class="">weak_step_consistent</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;bool&quot;</span><span class=""> </span><span class="keyword2">where</span><span class="">
</span><span class="">      </span><span class="string">&quot;weak_step_consistent &#8801; &#8704;a d s t. reachable0 s &#8743; reachable0 t &#8743; (s &#8764; d &#8764; t) &#8743; (s &#8764; sched &#8764; t) &#8743; 
                              ((the (domain s a)) &#8605; d) &#8743; (s &#8764; (the (domain s a)) &#8764; t) &#10230;
                              (&#8704; s&#39; t&#39;. (s,s&#39;) &#8712; step a &#8743; (t,t&#39;) &#8712; step a &#10230; (s&#39; &#8764;d&#8764; t&#39;))&quot;</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">definition</span><span class=""> </span><span class="">step_consistent_e</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;e &#8658; bool&quot;</span><span class=""> </span><span class="keyword2">where</span><span class="">
</span><span class="">      </span><span class="string">&quot;step_consistent_e a &#8801; &#8704;d s t. reachable0 s &#8743; reachable0 t &#8743; (s &#8764; d &#8764; t) &#8743; (s &#8764; sched &#8764; t) &#8743; 
                              (((the (domain s a)) &#8605; d) &#10230; (s &#8764; (the (domain s a)) &#8764; t)) &#10230; 
                              (&#8704; s&#39; t&#39;. (s,s&#39;) &#8712; step a &#8743; (t,t&#39;) &#8712; step a &#10230; (s&#39; &#8764;d&#8764; t&#39;))&quot;</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">definition</span><span class=""> </span><span class="">weak_step_consistent_e</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;e &#8658; bool&quot;</span><span class=""> </span><span class="keyword2">where</span><span class="">
</span><span class="">      </span><span class="string">&quot;weak_step_consistent_e a &#8801; &#8704;d s t. reachable0 s &#8743; reachable0 t &#8743; (s &#8764; d &#8764; t) &#8743; (s &#8764; sched &#8764; t) &#8743; 
                              ((the (domain s a)) &#8605; d) &#8743; (s &#8764; (the (domain s a)) &#8764; t) &#10230;
                              (&#8704; s&#39; t&#39;. (s,s&#39;) &#8712; step a &#8743; (t,t&#39;) &#8712; step a &#10230; (s&#39; &#8764;d&#8764; t&#39;))&quot;</span><span class="">
</span><span class="">
</span><span class="">    
</span><span class="">    </span><span class="keyword1">definition</span><span class=""> </span><span class="">local_respect</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;bool&quot;</span><span class=""> </span><span class="keyword2">where</span><span class="">
</span><span class="">      </span><span class="string">&quot;local_respect &#8801; &#8704; a d s s&#39;. reachable0 s &#8743; ((the (domain s a)) &#8726;&#8605; d) &#8743; (s,s&#39;)&#8712;step a &#10230; (s &#8764; d &#8764; s&#39;)&quot;</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">definition</span><span class=""> </span><span class="">local_respect_e</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;e &#8658; bool&quot;</span><span class=""> </span><span class="keyword2">where</span><span class="">
</span><span class="">      </span><span class="string">&quot;local_respect_e a &#8801; &#8704;d s s&#39;. reachable0 s &#8743; ((the (domain s a)) &#8726;&#8605; d) &#8743; (s,s&#39;)&#8712;step a &#10230; (s &#8764; d &#8764; s&#39;)&quot;</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">local_respect_all_evt</span><span class=""> </span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;local_respect = (&#8704;a. local_respect_e a)&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">local_respect_def</span><span class=""> </span><span class="">local_respect_e_def</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="">   </span><span class="keyword1">declare</span><span class=""> </span><span class="">step_consistent_def</span><span class=""> </span><span class="delimiter">[</span><span class="">cong</span><span class="delimiter">]</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">weak_step_consistent_def</span><span class="delimiter">[</span><span class="">cong</span><span class="delimiter">]</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">step_consistent_e_def</span><span class="delimiter">[</span><span class="">cong</span><span class="delimiter">]</span><span class=""> </span><span class="keyword2">and</span><span class="">
</span><span class="">        </span><span class="">weak_step_consistent_e_def</span><span class="delimiter">[</span><span class="">cong</span><span class="delimiter">]</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">local_respect_def</span><span class="delimiter">[</span><span class="">cong</span><span class="delimiter">]</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">local_respect_e_def</span><span class=""> </span><span class="delimiter">[</span><span class="">cong</span><span class="delimiter">]</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">step_consistent_all_evt</span><span class=""> </span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;step_consistent = (&#8704;a. step_consistent_e a)&quot;</span><span class="">
</span><span class="">     </span><span class="keyword1">by</span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">weak_step_consistent_all_evt</span><span class=""> </span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;weak_step_consistent = (&#8704;a. weak_step_consistent_e a)&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">by</span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">      
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">step_cons_impl_weak</span><span class=""> </span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;step_consistent &#10233; weak_step_consistent&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">step_consistent_def</span><span class=""> </span><span class="">weak_step_consistent_def</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">       
</span><span class="">      
</span><span class="">
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">weak_with_step_cons</span><span class="delimiter">:</span><span class="">
</span><span class="">      </span><span class="keyword2">assumes</span><span class=""> </span><span class="">p1</span><span class="delimiter">:</span><span class="">weak_step_consistent</span><span class="">
</span><span class="">        </span><span class="keyword2">and</span><span class="">   </span><span class="">p2</span><span class="delimiter">:</span><span class="">local_respect</span><span class="">
</span><span class="">      </span><span class="keyword2">shows</span><span class="">   </span><span class="">step_consistent</span><span class="">  
</span><span class="">      </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">      </span><span class="keyword1">{</span><span class="">
</span><span class="">        </span><span class="keyword3">fix</span><span class=""> </span><span class="">d</span><span class=""> </span><span class="">a</span><span class=""> </span><span class="">s</span><span class=""> </span><span class="">t</span><span class=""> </span><span class="">s&#39;</span><span class=""> </span><span class="">t&#39;</span><span class="">
</span><span class="">        </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;reachable0 s &#8743; reachable0 t &#10230; (s &#8764; d &#8764; t) &#8743; (s &#8764; sched &#8764; t) &#8743; 
              (((the (domain s a)) &#8605; d) &#10230; (s &#8764; (the (domain s a)) &#8764; t)) &#10230; (s,s&#39;)&#8712;step a &#8743; (t,t&#39;)&#8712;step a
              &#10230; (s&#39; &#8764; d &#8764; t&#39;)&quot;</span><span class=""> 
</span><span class="">           </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">           </span><span class="keyword1">{</span><span class="">
</span><span class="">             </span><span class="keyword3">assume</span><span class=""> </span><span class="">aa</span><span class="delimiter">:</span><span class="string">&quot;reachable0 s &#8743; reachable0 t&quot;</span><span class="">
</span><span class="">             </span><span class="keyword3">assume</span><span class=""> </span><span class="">a0</span><span class="delimiter">:</span><span class="string">&quot;s &#8764; d &#8764; t&quot;</span><span class="">
</span><span class="">             </span><span class="keyword3">assume</span><span class=""> </span><span class="">a1</span><span class="delimiter">:</span><span class="string">&quot;s &#8764; sched &#8764; t&quot;</span><span class="">
</span><span class="">             </span><span class="keyword3">assume</span><span class=""> </span><span class="">a2</span><span class="delimiter">:</span><span class="string">&quot;((the (domain s a)) &#8605; d) &#10230; (s &#8764; (the (domain s a)) &#8764; t)&quot;</span><span class="">
</span><span class="">             </span><span class="keyword3">assume</span><span class=""> </span><span class="">a3</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(s,s&#39;)&#8712;step a &#8743; (t,t&#39;)&#8712;step a&quot;</span><span class="">
</span><span class="">             </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;s&#39; &#8764; d &#8764; t&#39;&quot;</span><span class="">
</span><span class="">              </span><span class="keyword1">proof</span><span class="delimiter">(</span><span class="">cases</span><span class=""> </span><span class="string">&quot;(the (domain s a)) &#8605; d&quot;</span><span class="delimiter">)</span><span class="">
</span><span class="">                </span><span class="keyword3">assume</span><span class=""> </span><span class="">b0</span><span class="delimiter">:</span><span class="string">&quot;(the (domain s a)) &#8605; d&quot;</span><span class="">
</span><span class="">                </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">aa</span><span class=""> </span><span class="">a0</span><span class=""> </span><span class="">a1</span><span class=""> </span><span class="">a2</span><span class=""> </span><span class="">b0</span><span class=""> </span><span class="">p1</span><span class=""> </span><span class="">weak_step_consistent_def</span><span class=""> </span><span class="">a3</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">                </span><span class="keyword1">next</span><span class="">
</span><span class="">                </span><span class="keyword3">assume</span><span class=""> </span><span class="">b1</span><span class="delimiter">:</span><span class="string">&quot;&#172;((the (domain s a)) &#8605; d)&quot;</span><span class="">
</span><span class="">                </span><span class="keyword1">have</span><span class=""> </span><span class="">b2</span><span class="delimiter">:</span><span class="string">&quot;(domain s a) = (domain t a)&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">a1</span><span class=""> </span><span class="">sched_vpeq</span><span class="delimiter">)</span><span class="">
</span><span class="">                </span><span class="keyword1">with</span><span class=""> </span><span class="">b1</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">b3</span><span class="delimiter">:</span><span class="string">&quot;&#172;((the (domain t a)) &#8605; d)&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">                </span><span class="keyword1">then</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">b4</span><span class="delimiter">:</span><span class="string">&quot;s&#8764;d&#8764;s&#39;&quot;</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">aa</span><span class=""> </span><span class="">b1</span><span class="">  </span><span class="">p2</span><span class=""> </span><span class="">a3</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="">fastforce</span><span class=""> 
</span><span class="">                </span><span class="keyword1">then</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">b5</span><span class="delimiter">:</span><span class="string">&quot;t&#8764;d&#8764;t&#39;&quot;</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">aa</span><span class=""> </span><span class="">b3</span><span class=""> </span><span class="">p2</span><span class=""> </span><span class="">a3</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">fastforce</span><span class="">
</span><span class="">                </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">a0</span><span class=""> </span><span class="">b4</span><span class=""> </span><span class="">vpeq_symmetric_lemma</span><span class=""> </span><span class="">vpeq_transitive_lemma</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">              </span><span class="keyword1">qed</span><span class="">
</span><span class="">           </span><span class="keyword1">}</span><span class="">
</span><span class="">           </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">           </span><span class="keyword1">qed</span><span class="">
</span><span class="">      </span><span class="keyword1">}</span><span class="">
</span><span class="">      </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">step_consistent_def</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">      </span><span class="keyword1">qed</span><span class="">
</span><span class="">
</span><span class="keyword1">subsection</span><span class="verbatim">{* Lemmas for the inference framework *}</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">sched_equiv_preserved</span><span class="delimiter">:</span><span class="">
</span><span class="">      </span><span class="keyword2">assumes</span><span class=""> </span><span class="">1</span><span class="delimiter">:</span><span class="">step_consistent</span><span class="">
</span><span class="">      </span><span class="keyword2">and</span><span class="">     </span><span class="">2</span><span class="delimiter">:</span><span class="string">&quot;s &#8764;sched&#8764; t&quot;</span><span class="">
</span><span class="">      </span><span class="keyword2">and</span><span class="">     </span><span class="">3</span><span class="delimiter">:</span><span class="string">&quot;(s,s&#39;)&#8712;step a&quot;</span><span class="">
</span><span class="">      </span><span class="keyword2">and</span><span class="">     </span><span class="">4</span><span class="delimiter">:</span><span class="string">&quot;(t,t&#39;)&#8712;step a&quot;</span><span class="">
</span><span class="">      </span><span class="keyword2">and</span><span class="">     </span><span class="">5</span><span class="delimiter">:</span><span class="string">&quot;reachable0 s &#8743; reachable0 t&quot;</span><span class="">
</span><span class="">    </span><span class="keyword2">shows</span><span class=""> </span><span class="string">&quot;s&#39; &#8764;sched&#8764; t&#39;&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">case_tac</span><span class=""> </span><span class="string">&quot;the (domain s a) = sched&quot;</span><span class="delimiter">)</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="string">&quot;1&quot;</span><span class=""> </span><span class="string">&quot;2&quot;</span><span class=""> </span><span class="string">&quot;3&quot;</span><span class=""> </span><span class="string">&quot;4&quot;</span><span class=""> </span><span class="string">&quot;5&quot;</span><span class=""> </span><span class="">step_consistent_def</span><span class=""> </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="string">&quot;1&quot;</span><span class=""> </span><span class="string">&quot;2&quot;</span><span class=""> </span><span class="string">&quot;3&quot;</span><span class=""> </span><span class="string">&quot;4&quot;</span><span class=""> </span><span class="string">&quot;5&quot;</span><span class=""> </span><span class="">no_intf_sched</span><span class=""> </span><span class="">step_consistent_def</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">      
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">sched_equiv_preserved_left</span><span class="delimiter">:</span><span class="">
</span><span class="">      </span><span class="string">&quot;&#10214;local_respect; reachable0 s; (s &#8764;sched&#8764; t); the (domain s a) &#8800; sched; (s,s&#39;)&#8712; step a&#10215; 
        &#10233;  (s&#39; &#8764;sched&#8764; t)&quot;</span><span class="">
</span><span class="">        </span><span class="keyword1">using</span><span class=""> </span><span class="">local_respect_def</span><span class=""> </span><span class="">no_intf_sched</span><span class=""> </span><span class="">non_interference_def</span><span class=""> 
</span><span class="">          </span><span class="">vpeq_symmetric_lemma</span><span class=""> </span><span class="">vpeq_transitive_lemma</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">un_eq</span><span class="delimiter">:</span><span class="">
</span><span class="">      </span><span class="string">&quot;&#10214;S = S&#39;; T = T&#39;&#10215; &#10233; S &#8746; T = S&#39; &#8746; T&#39;&quot;</span><span class="">
</span><span class="">    </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">Un_eq</span><span class="delimiter">:</span><span class="">
</span><span class="">      </span><span class="string">&quot;&#10214;&#8896; x y. &#10214;x &#8712; xs; y &#8712; ys&#10215; &#10233; P x = Q y; &#8707; x. x &#8712; xs; &#8707; y. y &#8712; ys&#10215; &#10233; (&#8899;x&#8712;xs. P x) = (&#8899;y&#8712;ys. Q y)&quot;</span><span class="">
</span><span class="">    </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">declare</span><span class=""> </span><span class="">step_consistent_def</span><span class=""> </span><span class="delimiter">[</span><span class="">cong</span><span class=""> </span><span class="">del</span><span class="delimiter">]</span><span class="">                                                   
</span><span class="">
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">sources_eq0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;step_consistent &#8743; (s &#8764; sched &#8764; t) &#8743; reachable0 s &#8743; reachable0 t
                      &#10230; sources as s d = sources as t d&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">proof</span><span class=""> </span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">as</span><span class=""> </span><span class="">arbitrary</span><span class="delimiter">:</span><span class=""> </span><span class="">s</span><span class=""> </span><span class="">t</span><span class="delimiter">)</span><span class="">
</span><span class="">        </span><span class="keyword3">case</span><span class=""> </span><span class="">Nil</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?case</span><span class="">
</span><span class="">          </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">sources_Nil</span><span class="delimiter">)</span><span class="">
</span><span class="">      </span><span class="keyword1">next</span><span class="">
</span><span class="">        </span><span class="keyword3">case</span><span class=""> </span><span class="delimiter">(</span><span class="">Cons</span><span class=""> </span><span class="">a</span><span class=""> </span><span class="">as</span><span class="delimiter">)</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?case</span><span class="">                    
</span><span class="">          </span><span class="keyword1">using</span><span class=""> </span><span class="">sources_Cons</span><span class=""> </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">clarsimp</span><span class=""> </span><span class="">simp</span><span class="delimiter">:</span><span class=""> </span><span class="">sources_Cons</span><span class="delimiter">)</span><span class="">
</span><span class="">          </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">un_eq</span><span class="delimiter">)</span><span class="">
</span><span class="">          </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">only</span><span class="delimiter">:</span><span class=""> </span><span class="">Union_eq</span><span class="delimiter">,</span><span class=""> </span><span class="">simp</span><span class=""> </span><span class="">only</span><span class="delimiter">:</span><span class=""> </span><span class="">UNION_eq</span><span class="delimiter">[</span><span class="">symmetric</span><span class="delimiter">]</span><span class="delimiter">)</span><span class="">
</span><span class="">           </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">Un_eq</span><span class="delimiter">,</span><span class=""> </span><span class="">clarsimp</span><span class="delimiter">)</span><span class="">
</span><span class="">           </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">meson</span><span class=""> </span><span class="">Cons.hyps</span><span class=""> </span><span class="">reachable0_reach</span><span class=""> </span><span class="">reachableStep</span><span class=""> </span><span class="">reachable_s0</span><span class=""> </span><span class="">sched_equiv_preserved</span><span class="delimiter">)</span><span class="">             
</span><span class="">             </span><span class="keyword1">using</span><span class=""> </span><span class="">enabled</span><span class=""> </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">            </span><span class="keyword1">using</span><span class=""> </span><span class="">enabled</span><span class=""> </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">          </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">clarsimp</span><span class=""> </span><span class="">simp</span><span class="delimiter">:</span><span class=""> </span><span class="">sched_vpeq</span><span class="delimiter">)</span><span class="">
</span><span class="">          </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">Collect_cong</span><span class="delimiter">)</span><span class="">
</span><span class="">          </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">conj_cong</span><span class="delimiter">,</span><span class=""> </span><span class="">rule</span><span class=""> </span><span class="">refl</span><span class="delimiter">)</span><span class="">
</span><span class="">          </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">iff_exI</span><span class="delimiter">)</span><span class="">
</span><span class="">          </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="delimiter">(</span><span class="">no_types</span><span class="delimiter">,</span><span class=""> </span><span class="">hide_lams</span><span class="delimiter">)</span><span class=""> </span><span class="">Cons.hyps</span><span class=""> </span><span class="">enabled</span><span class=""> </span><span class="">reachableStep</span><span class=""> </span><span class="">sched_equiv_preserved</span><span class="delimiter">)</span><span class="">
</span><span class="">          </span><span class="keyword1"><span class="improper">done</span></span><span class="">                    
</span><span class="">      </span><span class="keyword1">qed</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">sources_eq</span><span class="delimiter">:</span><span class="">
</span><span class="">      </span><span class="string">&quot;&#10214;step_consistent; s &#8764; sched &#8764; t; reachable0 s; reachable0 t&#10215; &#10233; sources as s d = sources as t d&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">sources_eq0</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">same_sources_dom</span><span class="delimiter">:</span><span class="">
</span><span class="">      </span><span class="string">&quot;&#10214;s &#8776;(sources (a#as) s d)&#8776; t; (the (domain s a)) &#8605; x; x &#8712; sources as s&#39; d; 
        (s,s&#39;)&#8712;step a&#10215; &#10233; (s &#8764;(the (domain s a))&#8764; t)&quot;</span><span class="">
</span><span class="">       </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">       </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">erule</span><span class=""> </span><span class="">bspec</span><span class="delimiter">)</span><span class="">
</span><span class="">       </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">subst</span><span class=""> </span><span class="">sources_Cons</span><span class="delimiter">)</span><span class="">
</span><span class="">       </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="">UnI2</span><span class="delimiter">)</span><span class="">
</span><span class="">       </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">blast</span><span class="delimiter">)</span><span class="">
</span><span class="">       </span><span class="keyword1"><span class="improper">done</span></span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">sources_step</span><span class="delimiter">:</span><span class="">
</span><span class="">      </span><span class="string">&quot;&#10214;reachable0 s; (the (domain s a)) &#8726;&#8605; d&#10215; &#10233; sources [a] s d = {d}&quot;</span><span class=""> 
</span><span class="">      </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">auto</span><span class=""> </span><span class="">simp</span><span class="delimiter">:</span><span class=""> </span><span class="">sources_Cons</span><span class="">  </span><span class="">sources_Nil</span><span class=""> </span><span class="">enabled</span><span class=""> </span><span class="">dest</span><span class="delimiter">:</span><span class=""> </span><span class="">enabled</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="">    
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">sources_step2</span><span class="delimiter">:</span><span class="">
</span><span class="">      </span><span class="string">&quot;&#10214;reachable0 s; (the (domain s a)) &#8605; d&#10215; &#10233; sources [a] s d = {the (domain s a),d}&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">auto</span><span class=""> </span><span class="">simp</span><span class="delimiter">:</span><span class=""> </span><span class="">sources_Cons</span><span class=""> </span><span class="">sources_Nil</span><span class=""> </span><span class="">enabled</span><span class=""> </span><span class="">dest</span><span class="delimiter">:</span><span class=""> </span><span class="">enabled</span><span class="delimiter">)</span><span class="">
</span><span class="">      </span><span class="keyword1"><span class="improper">done</span></span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">sources_unwinding_step</span><span class="delimiter">:</span><span class="">
</span><span class="">      </span><span class="string">&quot;&#10214;s &#8776;(sources (a#as) s d)&#8776; t; (s&#8764;sched&#8764;t); step_consistent;
        (s,s&#39;)&#8712;step a; (t,t&#39;)&#8712;step a; reachable0 s; reachable0 t&#10215;  &#10233; (s&#39; &#8776;(sources as s&#39; d)&#8776; t&#39;)&quot;</span><span class="">
</span><span class="">       </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">clarsimp</span><span class=""> </span><span class="">simp</span><span class="delimiter">:</span><span class=""> </span><span class="">ivpeq_def</span><span class=""> </span><span class="">sources_Cons</span><span class="delimiter">)</span><span class="">        
</span><span class="">        </span><span class="keyword1">using</span><span class=""> </span><span class="">UnionI</span><span class=""> </span><span class="">step_consistent_def</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">       
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">sources_eq_step</span><span class="delimiter">:</span><span class="">
</span><span class="">      </span><span class="string">&quot;&#10214;local_respect; step_consistent;(s,s&#39;)&#8712;step a; 
        (the (domain s a)) &#8800; sched; reachable0 s&#10215; &#10233;
        (sources as s&#39; d) = (sources as s d)&quot;</span><span class="">
</span><span class="">        </span><span class="keyword1">using</span><span class=""> </span><span class="">reachableStep</span><span class=""> </span><span class="">sched_equiv_preserved_left</span><span class=""> </span><span class="">sources_eq0</span><span class=""> </span><span class="">vpeq_reflexive_lemma</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">sources_equiv_preserved_left</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#10214;local_respect; step_consistent; s&#8764;sched&#8764;t; 
          the (domain s a) &#8713; sources (a#as) s d; s &#8776;sources (a#as) s d&#8776; t; (s,s&#39;)&#8712;step a; 
          (the (domain s a)) &#8800; sched; reachable0 s; reachable0 t&#10215; &#10233; (s&#39; &#8776;sources as s&#39; d&#8776; t)&quot;</span><span class="">
</span><span class="">          </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">clarsimp</span><span class=""> </span><span class="">simp</span><span class="delimiter">:</span><span class=""> </span><span class="">ivpeq_def</span><span class=""> </span><span class="">cong</span><span class=""> </span><span class="">del</span><span class="delimiter">:</span><span class=""> </span><span class="">local_respect_def</span><span class="delimiter">)</span><span class="">
</span><span class="">          </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rename_tac</span><span class=""> </span><span class="">v</span><span class="delimiter">)</span><span class="">
</span><span class="">          </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">case_tac</span><span class=""> </span><span class="string">&quot;(the (domain s a)) &#8605; v&quot;</span><span class="delimiter">)</span><span class="">
</span><span class="">           </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">fastforce</span><span class=""> </span><span class="">simp</span><span class="delimiter">:</span><span class=""> </span><span class="">sources_Cons</span><span class=""> </span><span class="">cong</span><span class=""> </span><span class="">del</span><span class="delimiter">:</span><span class=""> </span><span class="">local_respect_def</span><span class="delimiter">)</span><span class="">
</span><span class="">          </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">            </span><span class="keyword3">fix</span><span class=""> </span><span class="">v</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="tfree">&#39;d</span><span class="">
</span><span class="">            </span><span class="keyword3">assume</span><span class=""> </span><span class="">a1</span><span class="delimiter">:</span><span class=""> </span><span class="">local_respect</span><span class="">
</span><span class="">            </span><span class="keyword3">assume</span><span class=""> </span><span class="">a2</span><span class="delimiter">:</span><span class=""> </span><span class="">step_consistent</span><span class="">
</span><span class="">            </span><span class="keyword3">assume</span><span class=""> </span><span class="">a3</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;s &#8764; sched &#8764; t&quot;</span><span class="">
</span><span class="">            </span><span class="keyword3">assume</span><span class=""> </span><span class="">a4</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8704;d&#8712;sources (a # as) s d. (s &#8764; d &#8764; t)&quot;</span><span class="">
</span><span class="">            </span><span class="keyword3">assume</span><span class=""> </span><span class="">a5</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(s, s&#39;) &#8712; step a&quot;</span><span class="">
</span><span class="">            </span><span class="keyword3">assume</span><span class=""> </span><span class="">a6</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;reachable0 s&quot;</span><span class="">
</span><span class="">            </span><span class="keyword3">assume</span><span class=""> </span><span class="">a7</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;reachable0 t&quot;</span><span class="">
</span><span class="">            </span><span class="keyword3">assume</span><span class=""> </span><span class="">a8</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;v &#8712; sources as s&#39; d&quot;</span><span class="">
</span><span class="">            </span><span class="keyword3">assume</span><span class=""> </span><span class="">a9</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#172; ((the (domain s a)) &#8605; v)&quot;</span><span class="">
</span><span class="">            </span><span class="keyword3">obtain</span><span class=""> </span><span class="">ss</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;s &#8658; &#39;e &#8658; &#39;s&quot;</span><span class=""> </span><span class="keyword2">where</span><span class="">
</span><span class="">              </span><span class="">f10</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8704;e. (t, ss t e) &#8712; step e&quot;</span><span class="">
</span><span class="">              </span><span class="keyword1">using</span><span class=""> </span><span class="">a7</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">meson</span><span class=""> </span><span class="">enabled</span><span class="delimiter">)</span><span class="">
</span><span class="">            </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;&#8704;e. domain s e = domain t e&quot;</span><span class="">
</span><span class="">              </span><span class="keyword1">using</span><span class=""> </span><span class="">a3</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">meson</span><span class=""> </span><span class="">sched_vpeq</span><span class="delimiter">)</span><span class="">
</span><span class="">            </span><span class="keyword1">then</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">f11</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8704;d sa e. (t, sa) &#8713; step e &#8744; (t &#8764; d &#8764; sa) &#8744; ((the (domain s e)) &#8605; d)&quot;</span><span class="">
</span><span class="">              </span><span class="keyword1">using</span><span class=""> </span><span class="">a7</span><span class=""> </span><span class="">a1</span><span class=""> </span><span class="">local_respect_def</span><span class=""> </span><span class="">non_interference_def</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">force</span><span class="">
</span><span class="">            </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;s&#39; &#8764; v &#8764; (ss t a)&quot;</span><span class="">
</span><span class="">              </span><span class="keyword1">using</span><span class=""> </span><span class="">f10</span><span class=""> </span><span class="">a8</span><span class=""> </span><span class="">a7</span><span class=""> </span><span class="">a6</span><span class=""> </span><span class="">a5</span><span class=""> </span><span class="">a4</span><span class=""> </span><span class="">a3</span><span class=""> </span><span class="">a2</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="delimiter">(</span><span class="">no_types</span><span class="delimiter">)</span><span class=""> </span><span class="">ivpeq_def</span><span class=""> </span><span class="">sources_unwinding_step</span><span class="delimiter">)</span><span class="">
</span><span class="">            </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="string">&quot;s&#39; &#8764; v &#8764; t&quot;</span><span class="">
</span><span class="">              </span><span class="keyword1">using</span><span class=""> </span><span class="">f11</span><span class=""> </span><span class="">f10</span><span class=""> </span><span class="">a9</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">meson</span><span class=""> </span><span class="">vpeq_symmetric_lemma</span><span class=""> </span><span class="">vpeq_transitive_lemma</span><span class="delimiter">)</span><span class="">
</span><span class="">          </span><span class="keyword1">qed</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">ipurge_eq&#39;_helper</span><span class="delimiter">:</span><span class="">
</span><span class="">      </span><span class="string">&quot;&#10214;s &#8712; ss; the (domain s a) &#8712; sources (a # as) s u; &#8704;s&#8712;ts. the (domain s a) &#8713; sources (a # as) s u;
       (&#8704;s t. s &#8712; ss &#8743; t &#8712; ts &#10230; (s &#8764;sched&#8764; t) &#8743; reachable0 s &#8743; reachable0 t);  t &#8712; ts; step_consistent&#10215; &#10233;
      False&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">cut_tac</span><span class=""> </span><span class="">s</span><span class="delimiter">=</span><span class="">s</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">t</span><span class="delimiter">=</span><span class="">t</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">as</span><span class="delimiter">=</span><span class="">as</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">d</span><span class="delimiter">=</span><span class="">u</span><span class=""> </span><span class="keyword2">in</span><span class=""> </span><span class="">sources_eq</span><span class="delimiter">,</span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">cong</span><span class=""> </span><span class="">del</span><span class="delimiter">:</span><span class=""> </span><span class="">step_consistent_def</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="delimiter">)</span><span class="">
</span><span class="">      </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">clarsimp</span><span class="">  </span><span class="">simp</span><span class="delimiter">:</span><span class=""> </span><span class="">sources_Cons</span><span class=""> </span><span class="delimiter">|</span><span class=""> </span><span class="">safe</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="">
</span><span class="">      </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rename_tac</span><span class=""> </span><span class="">s&#39;</span><span class="delimiter">)</span><span class="">
</span><span class="">       </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">drule_tac</span><span class=""> </span><span class="">x</span><span class="delimiter">=</span><span class="">t</span><span class=""> </span><span class="keyword2">in</span><span class=""> </span><span class="">bspec</span><span class="delimiter">,</span><span class=""> </span><span class="">simp</span><span class="delimiter">)</span><span class="">
</span><span class="">       </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">clarsimp</span><span class=""> </span><span class="">cong</span><span class=""> </span><span class="">del</span><span class="delimiter">:</span><span class=""> </span><span class="">step_consistent_def</span><span class="delimiter">)</span><span class="">
</span><span class="">       </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">cut_tac</span><span class=""> </span><span class="">s</span><span class="delimiter">=</span><span class="">t</span><span class=""> </span><span class="keyword2">in</span><span class=""> </span><span class="">enabled</span><span class="delimiter">,</span><span class=""> </span><span class="">simp</span><span class="delimiter">)</span><span class="">
</span><span class="">       </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">erule</span><span class=""> </span><span class="">exE</span><span class="delimiter">,</span><span class=""> </span><span class="">rename_tac</span><span class=""> </span><span class="">t&#39;</span><span class="delimiter">)</span><span class="">
</span><span class="">       </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">drule_tac</span><span class=""> </span><span class="">x</span><span class="delimiter">=</span><span class="string">&quot;sources as t&#39; u&quot;</span><span class=""> </span><span class="keyword2">in</span><span class=""> </span><span class="">spec</span><span class="delimiter">)</span><span class="">
</span><span class="">       </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">cut_tac</span><span class=""> </span><span class="">s</span><span class="delimiter">=</span><span class="">s&#39;</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">t</span><span class="delimiter">=</span><span class="">t&#39;</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">d</span><span class="delimiter">=</span><span class="">u</span><span class=""> </span><span class="keyword2">in</span><span class=""> </span><span class="">sources_eq</span><span class="delimiter">,</span><span class=""> </span><span class="">simp</span><span class="delimiter">+</span><span class="delimiter">)</span><span class="">
</span><span class="">          </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">fastforce</span><span class=""> </span><span class="">elim</span><span class="delimiter">:</span><span class=""> </span><span class="">sched_equiv_preserved</span><span class="delimiter">)</span><span class="">
</span><span class="">         </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">fastforce</span><span class=""> </span><span class="">intro</span><span class="delimiter">:</span><span class=""> </span><span class="">reachableStep</span><span class="delimiter">)</span><span class="">
</span><span class="">        </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">fastforce</span><span class=""> </span><span class="">intro</span><span class="delimiter">:</span><span class=""> </span><span class="">reachableStep</span><span class="delimiter">)</span><span class="">
</span><span class="">       </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">fastforce</span><span class=""> </span><span class="">simp</span><span class="delimiter">:</span><span class=""> </span><span class="">sched_vpeq</span><span class=""> </span><span class="delimiter">)</span><span class="">
</span><span class="">      </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">drule_tac</span><span class=""> </span><span class="">x</span><span class="delimiter">=</span><span class="">t</span><span class=""> </span><span class="keyword2">in</span><span class=""> </span><span class="">bspec</span><span class="delimiter">,</span><span class=""> </span><span class="">simp</span><span class="delimiter">)</span><span class="">
</span><span class="">      </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">clarsimp</span><span class=""> </span><span class="delimiter">)</span><span class="">
</span><span class="">      </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rename_tac</span><span class=""> </span><span class="">v</span><span class=""> </span><span class="">s&#39;</span><span class="delimiter">)</span><span class="">
</span><span class="">      </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">drule_tac</span><span class=""> </span><span class="">x</span><span class="delimiter">=</span><span class="">v</span><span class=""> </span><span class="keyword2">in</span><span class=""> </span><span class="">spec</span><span class="delimiter">,</span><span class=""> </span><span class="">erule</span><span class=""> </span><span class="">impE</span><span class="delimiter">,</span><span class=""> </span><span class="">fastforce</span><span class=""> </span><span class="">simp</span><span class="delimiter">:</span><span class=""> </span><span class="">sched_vpeq</span><span class="delimiter">)</span><span class="">
</span><span class="">      </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">cut_tac</span><span class=""> </span><span class="">s</span><span class="delimiter">=</span><span class="">t</span><span class=""> </span><span class="keyword2">in</span><span class=""> </span><span class="">enabled</span><span class="delimiter">[</span><span class="keyword2">where</span><span class=""> </span><span class="">a</span><span class="delimiter">=</span><span class="">a</span><span class="delimiter">]</span><span class="delimiter">,</span><span class=""> </span><span class="">simp</span><span class="delimiter">,</span><span class=""> </span><span class="">clarsimp</span><span class="delimiter">,</span><span class=""> </span><span class="">rename_tac</span><span class=""> </span><span class="">t&#39;</span><span class="delimiter">)</span><span class="">
</span><span class="">      </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">cut_tac</span><span class=""> </span><span class="">s</span><span class="delimiter">=</span><span class="">s&#39;</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">t</span><span class="delimiter">=</span><span class="">t&#39;</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">d</span><span class="delimiter">=</span><span class="">u</span><span class=""> </span><span class="keyword2">in</span><span class=""> </span><span class="">sources_eq</span><span class="delimiter">,</span><span class=""> </span><span class="">simp</span><span class="delimiter">+</span><span class="delimiter">)</span><span class="">
</span><span class="">         </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">fastforce</span><span class=""> </span><span class="">elim</span><span class="delimiter">:</span><span class=""> </span><span class="">sched_equiv_preserved</span><span class=""> </span><span class="delimiter">)</span><span class="">
</span><span class="">        </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">fastforce</span><span class=""> </span><span class="">intro</span><span class="delimiter">:</span><span class=""> </span><span class="">reachableStep</span><span class=""> </span><span class="delimiter">)</span><span class="">
</span><span class="">       </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">fastforce</span><span class=""> </span><span class="">intro</span><span class="delimiter">:</span><span class=""> </span><span class="">reachableStep</span><span class=""> </span><span class="delimiter">)</span><span class="">
</span><span class="">      </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">fastforce</span><span class=""> </span><span class="">simp</span><span class="delimiter">:</span><span class=""> </span><span class="">sched_vpeq</span><span class=""> </span><span class="delimiter">)</span><span class="">
</span><span class="">      </span><span class="keyword1"><span class="improper">done</span></span><span class="">
</span><span class=""> 
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">ipurge_eq&#39;</span><span class="delimiter">:</span><span class="">
</span><span class="">      </span><span class="string">&quot;(&#8704; s t. s&#8712;ss &#8743; t&#8712;ts &#10230; (s &#8764;sched&#8764; t) &#8743; reachable0 s &#8743; reachable0 t) &#8743; 
        (&#8707; s. s &#8712; ss) &#8743; (&#8707; t. t &#8712; ts) &#8743; step_consistent &#10230; ipurge as u ss = ipurge as u ts&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">proof</span><span class=""> </span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">as</span><span class=""> </span><span class="">arbitrary</span><span class="delimiter">:</span><span class=""> </span><span class="">ss</span><span class=""> </span><span class="">ts</span><span class="delimiter">)</span><span class="">
</span><span class="">      </span><span class="keyword3">case</span><span class=""> </span><span class="">Nil</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?case</span><span class="">
</span><span class="">       </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">       </span><span class="keyword1"><span class="improper">done</span></span><span class="">
</span><span class="">      </span><span class="keyword1">next</span><span class="">
</span><span class="">      </span><span class="keyword3">case</span><span class=""> </span><span class="delimiter">(</span><span class="">Cons</span><span class=""> </span><span class="">a</span><span class=""> </span><span class="">as</span><span class="delimiter">)</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?case</span><span class="">
</span><span class="">       </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">clarsimp</span><span class=""> </span><span class="">simp</span><span class="delimiter">:</span><span class=""> </span><span class="">sched_vpeq</span><span class=""> </span><span class="delimiter">)</span><span class="">
</span><span class="">       </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">intro</span><span class=""> </span><span class="">conjI</span><span class=""> </span><span class="">impI</span><span class="delimiter">)</span><span class="">
</span><span class="">          </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="string">&quot;Cons.hyps&quot;</span><span class="delimiter">[</span><span class="">rule_format</span><span class="delimiter">]</span><span class="delimiter">)</span><span class="">
</span><span class="">          </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">clarsimp</span><span class="delimiter">)</span><span class="">
</span><span class="">          </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">sched_equiv_preserved</span><span class=""> </span><span class="">reachableStep</span><span class=""> </span><span class="">enabled</span><span class="delimiter">)</span><span class="">
</span><span class="">         </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">clarsimp</span><span class="delimiter">)</span><span class="">
</span><span class="">         </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">drule</span><span class=""> </span><span class="">ipurge_eq&#39;_helper</span><span class="delimiter">,</span><span class=""> </span><span class="">simp</span><span class="delimiter">+</span><span class="delimiter">)</span><span class="delimiter">[</span><span class="">1</span><span class="delimiter">]</span><span class="">
</span><span class="">        </span><span class="keyword1"><span class="improper">apply</span></span><span class=""> </span><span class="delimiter">(</span><span class="">clarsimp</span><span class="delimiter">)</span><span class="">
</span><span class="">        </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">drule</span><span class=""> </span><span class="">ipurge_eq&#39;_helper</span><span class="delimiter">,</span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">vpeq_symmetric_lemma</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="delimiter">)</span><span class="delimiter">[</span><span class="">1</span><span class="delimiter">]</span><span class="">
</span><span class="">       </span><span class="keyword1"><span class="improper">apply</span></span><span class="delimiter">(</span><span class="">rule</span><span class=""> </span><span class="string">&quot;Cons.hyps&quot;</span><span class="delimiter">[</span><span class="">rule_format</span><span class="delimiter">]</span><span class="delimiter">,</span><span class=""> </span><span class="">auto</span><span class="delimiter">)</span><span class="">
</span><span class="">       </span><span class="keyword1"><span class="improper">done</span></span><span class="">  
</span><span class="">      </span><span class="keyword1">qed</span><span class="">
</span><span class=""> 
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">ipurge_eq</span><span class="delimiter">:</span><span class="string">&quot;&#10214;step_consistent; s &#8764; sched &#8764; t; reachable0 s &#8743; reachable0 t&#10215;
                      &#10233; ipurge as d {s} = ipurge as d {t}&quot;</span><span class=""> 
</span><span class="">      </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">ipurge_eq&#39;</span><span class="delimiter">)</span><span class="">
</span><span class="">      
</span><span class="keyword1">declare</span><span class=""> </span><span class="">step_consistent_def</span><span class=""> </span><span class="delimiter">[</span><span class="">cong</span><span class="delimiter">]</span><span class="">
</span><span class="keyword1">subsection</span><span class="verbatim">{* Inference framework of information flow security properties *}</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">theorem</span><span class=""> </span><span class="">nonintf_impl_weak</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;noninterference &#10233; weak_noninterference&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">noninterference_def</span><span class=""> </span><span class="">observ_equiv_sym</span><span class=""> </span><span class="">observ_equiv_trans</span><span class=""> </span><span class="">reachable_s0</span><span class=""> </span><span class="">weak_noninterference_def</span><span class="delimiter">)</span><span class="">       
</span><span class="">
</span><span class="">    </span><span class="keyword1">theorem</span><span class=""> </span><span class="">wk_nonintf_r_impl_wk_nonintf</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;weak_noninterference_r &#10233; weak_noninterference&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">reachable_s0</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">      
</span><span class="">    </span><span class="keyword1">theorem</span><span class=""> </span><span class="">nonintf_r_impl_noninterf</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;noninterference_r &#10233; noninterference&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">noninterference_def</span><span class=""> </span><span class="">noninterference_r_def</span><span class=""> </span><span class="">reachable_s0</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class=""> 
</span><span class="">
</span><span class="">    </span><span class="keyword1">theorem</span><span class=""> </span><span class="">nonintf_r_impl_wk_nonintf_r</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;noninterference_r &#10233; weak_noninterference_r&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">noninterference_r_def</span><span class=""> </span><span class="">observ_equiv_sym</span><span class=""> </span><span class="">observ_equiv_trans</span><span class=""> </span><span class="">weak_noninterference_r_def</span><span class="delimiter">)</span><span class="">
</span><span class="">      
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">noninf_impl_nonintf_r</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;noninfluence &#10233; noninterference_r&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">ivpeq_def</span><span class=""> </span><span class="">noninfluence_def</span><span class=""> </span><span class="">noninterference_r_def</span><span class=""> </span><span class="">vpeq_reflexive_lemma</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">      
</span><span class="">
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">noninf_impl_nonlk</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;noninfluence &#10233; nonleakage&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">noninterference_r_def</span><span class=""> </span><span class="">nonleakage_def</span><span class=""> </span><span class="">observ_equiv_sym</span><span class=""> 
</span><span class="">        </span><span class="">observ_equiv_trans</span><span class=""> </span><span class="">noninfluence_def</span><span class=""> </span><span class="">noninf_impl_nonintf_r</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">wk_noninfl_impl_nonlk</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;weak_noninfluence &#10233; nonleakage&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">weak_noninfluence_def</span><span class=""> </span><span class="">nonleakage_def</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">       
</span><span class="">    
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">wk_noninfl_impl_wk_nonintf_r</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;weak_noninfluence &#10233; weak_noninterference_r&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">ivpeq_def</span><span class=""> </span><span class="">weak_noninfluence_def</span><span class=""> </span><span class="">vpeq_reflexive_lemma</span><span class=""> </span><span class="">weak_noninterference_r_def</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">   
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">noninf_gen_impl_noninfl</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;noninfluence_gen &#10233; noninfluence&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">noninfluence_gen_def</span><span class=""> </span><span class="">noninfluence_def</span><span class="">
</span><span class="">      </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">empty_iff</span><span class=""> </span><span class="">insert_iff</span><span class="delimiter">)</span><span class=""> 
</span><span class="">      
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">nonlk_imp_sc</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;nonleakage &#10233; step_consistent&quot;</span><span class=""> 
</span><span class="">      </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">        </span><span class="keyword3">assume</span><span class=""> </span><span class="">p0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;nonleakage&quot;</span><span class="">
</span><span class="">        </span><span class="keyword1">then</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">p1</span><span class="delimiter">[</span><span class="">rule_format</span><span class="delimiter">]</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8704;as d s t. reachable0 s &#8743; reachable0 t &#10230; (s &#8764; sched &#8764; t) 
                         &#10230; (s &#8776; (sources as s d) &#8776; t) &#10230; (s &#8882; as &#8773; t &#8882; as @ d)&quot;</span><span class="">
</span><span class="">          </span><span class="keyword1">using</span><span class=""> </span><span class="">nonleakage_def</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">        
</span><span class="">        </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;&#8704;a d s t. reachable0 s &#8743; reachable0 t &#10230; (s &#8764; d &#8764; t) &#8743; (s &#8764; sched &#8764; t) &#8743; 
                          (((the (domain s a)) &#8605; d) &#10230; (s &#8764; (the (domain s a)) &#8764; t)) &#10230; 
                          (&#8704; s&#39; t&#39;. (s,s&#39;) &#8712; step a &#8743; (t,t&#39;) &#8712; step a &#10230; (s&#39; &#8764;d&#8764; t&#39;))&quot;</span><span class="">
</span><span class="">          </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">          </span><span class="keyword1">{</span><span class="">
</span><span class="">            </span><span class="keyword3">fix</span><span class=""> </span><span class="">a</span><span class=""> </span><span class="">d</span><span class=""> </span><span class="">s</span><span class=""> </span><span class="">t</span><span class="">
</span><span class="">            </span><span class="keyword3">assume</span><span class=""> </span><span class="">a0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;reachable0 s &#8743; reachable0 t&quot;</span><span class="">
</span><span class="">              </span><span class="keyword2">and</span><span class="">  </span><span class="">a1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(s &#8764; d &#8764; t) &#8743; (s &#8764; sched &#8764; t)&quot;</span><span class="">
</span><span class="">              </span><span class="keyword2">and</span><span class="">  </span><span class="">a2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;((the (domain s a)) &#8605; d) &#10230; (s &#8764; (the (domain s a)) &#8764; t)&quot;</span><span class="">
</span><span class="">            </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;&#8704; s&#39; t&#39;. (s,s&#39;) &#8712; step a &#8743; (t,t&#39;) &#8712; step a &#10230; (s&#39; &#8764;d&#8764; t&#39;)&quot;</span><span class="">
</span><span class="">              </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">              </span><span class="keyword1">{</span><span class="">
</span><span class="">                </span><span class="keyword3">fix</span><span class=""> </span><span class="">s&#39;</span><span class=""> </span><span class="">t&#39;</span><span class="">
</span><span class="">                </span><span class="keyword3">assume</span><span class=""> </span><span class="">b0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(s,s&#39;) &#8712; step a &#8743; (t,t&#39;) &#8712; step a&quot;</span><span class="">
</span><span class="">                </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;s&#39; &#8764;d&#8764; t&#39;&quot;</span><span class=""> 
</span><span class="">                  </span><span class="keyword1">proof</span><span class="delimiter">(</span><span class="">cases</span><span class=""> </span><span class="string">&quot;(the (domain s a)) &#8605; d&quot;</span><span class="delimiter">)</span><span class="">
</span><span class="">                    </span><span class="keyword3">assume</span><span class=""> </span><span class="">c0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(the (domain s a)) &#8605; d&quot;</span><span class="">
</span><span class="">                    </span><span class="keyword1">with</span><span class=""> </span><span class="">a2</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;s &#8764; (the (domain s a)) &#8764; t&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">                    </span><span class="keyword1">with</span><span class=""> </span><span class="">a0</span><span class=""> </span><span class="">a1</span><span class=""> </span><span class="">c0</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;s &#8776; (sources [a] s d) &#8776; t&quot;</span><span class=""> 
</span><span class="">                      </span><span class="keyword1">using</span><span class=""> </span><span class="">sources_step2</span><span class="delimiter">[</span><span class="">of</span><span class=""> </span><span class="">s</span><span class=""> </span><span class="">a</span><span class=""> </span><span class="">d</span><span class="delimiter">]</span><span class="">
</span><span class="">                        </span><span class="">insert_iff</span><span class=""> </span><span class="">singletonD</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class=""> 
</span><span class="">                    </span><span class="keyword1">then</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;s &#8882; [a] &#8773; t &#8882; [a] @ d&quot;</span><span class=""> 
</span><span class="">                      </span><span class="keyword1">using</span><span class=""> </span><span class="">p1</span><span class="delimiter">[</span><span class="">of</span><span class=""> </span><span class="">s</span><span class=""> </span><span class="">t</span><span class=""> </span><span class="string">&quot;[a]&quot;</span><span class=""> </span><span class="">d</span><span class="delimiter">]</span><span class=""> </span><span class="">a0</span><span class=""> </span><span class="">a1</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">                    </span><span class="keyword1">with</span><span class=""> </span><span class="">b0</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class="">
</span><span class="">                     </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">                  </span><span class="keyword1">next</span><span class="">
</span><span class="">                    </span><span class="keyword3">assume</span><span class=""> </span><span class="">c0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#172;((the (domain s a)) &#8605; d)&quot;</span><span class="">
</span><span class="">                    </span><span class="keyword1">with</span><span class=""> </span><span class="">a0</span><span class=""> </span><span class="">a1</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;s &#8776; (sources [a] s d) &#8776; t&quot;</span><span class=""> 
</span><span class="">                      </span><span class="keyword1">using</span><span class=""> </span><span class="">sources_step</span><span class="delimiter">[</span><span class="">of</span><span class=""> </span><span class="">s</span><span class=""> </span><span class="">a</span><span class=""> </span><span class="">d</span><span class="delimiter">]</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class=""> 
</span><span class="">                    </span><span class="keyword1">then</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;s &#8882; [a] &#8773; t &#8882; [a] @ d&quot;</span><span class=""> 
</span><span class="">                      </span><span class="keyword1">using</span><span class=""> </span><span class="">p1</span><span class="delimiter">[</span><span class="">of</span><span class=""> </span><span class="">s</span><span class=""> </span><span class="">t</span><span class=""> </span><span class="string">&quot;[a]&quot;</span><span class=""> </span><span class="">d</span><span class="delimiter">]</span><span class=""> </span><span class="">a0</span><span class=""> </span><span class="">a1</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">                    </span><span class="keyword1">with</span><span class=""> </span><span class="">b0</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class="">
</span><span class="">                      </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">                  </span><span class="keyword1">qed</span><span class="">
</span><span class="">              </span><span class="keyword1">}</span><span class="">
</span><span class="">              </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">              </span><span class="keyword1">qed</span><span class="">
</span><span class="">          </span><span class="keyword1">}</span><span class="">
</span><span class="">          </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">          </span><span class="keyword1">qed</span><span class="">
</span><span class="">        </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="string">&quot;step_consistent&quot;</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">step_consistent_def</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">      </span><span class="keyword1">qed</span><span class="">
</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">sc_imp_nonlk</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;step_consistent &#10233; nonleakage&quot;</span><span class=""> 
</span><span class="">      </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">        </span><span class="keyword3">assume</span><span class=""> </span><span class="">p0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;step_consistent&quot;</span><span class="">
</span><span class="">        </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;&#8704;d as s t. reachable0 s &#8743; reachable0 t &#10230; (s &#8764; sched &#8764; t) 
                         &#10230; (s &#8776; (sources as s d) &#8776; t) &#10230; (s &#8882; as &#8773; t &#8882; as @ d)&quot;</span><span class="">
</span><span class="">          </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">          </span><span class="keyword1">{</span><span class="">
</span><span class="">            </span><span class="keyword3">fix</span><span class=""> </span><span class="">as</span><span class="">
</span><span class="">            </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;&#8704;d s t. reachable0 s &#8743; reachable0 t &#10230; (s &#8764; sched &#8764; t) 
                         &#10230; (s &#8776; (sources as s d) &#8776; t) &#10230; (s &#8882; as &#8773; t &#8882; as @ d)&quot;</span><span class="">
</span><span class="">              </span><span class="keyword1">proof</span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">as</span><span class="delimiter">)</span><span class="">
</span><span class="">                </span><span class="keyword3">case</span><span class=""> </span><span class="">Nil</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?case</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">sources_refl</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class=""> 
</span><span class="">              </span><span class="keyword1">next</span><span class="">
</span><span class="">                </span><span class="keyword3">case</span><span class=""> </span><span class="delimiter">(</span><span class="">Cons</span><span class=""> </span><span class="">b</span><span class=""> </span><span class="">bs</span><span class="delimiter">)</span><span class="">
</span><span class="">                </span><span class="keyword3">assume</span><span class=""> </span><span class="">a0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8704;d s t. reachable0 s &#8743; reachable0 t &#10230; (s &#8764; sched &#8764; t) 
                                    &#10230; (s &#8776; sources bs s d &#8776; t) &#10230; (s &#8882; bs &#8773; t &#8882; bs @ d)&quot;</span><span class="">
</span><span class="">                </span><span class="keyword3">show</span><span class=""> </span><span class="var">?case</span><span class="">
</span><span class="">                  </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">                  </span><span class="keyword1">{</span><span class="">
</span><span class="">                    </span><span class="keyword3">fix</span><span class=""> </span><span class="">d</span><span class=""> </span><span class="">s</span><span class=""> </span><span class="">t</span><span class="">
</span><span class="">                    </span><span class="keyword3">assume</span><span class=""> </span><span class="">b0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;reachable0 s &#8743; reachable0 t&quot;</span><span class="">
</span><span class="">                      </span><span class="keyword2">and</span><span class="">  </span><span class="">b1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;s &#8764; sched &#8764; t&quot;</span><span class="">
</span><span class="">                      </span><span class="keyword2">and</span><span class="">  </span><span class="">b2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;s &#8776; sources (b # bs) s d &#8776; t&quot;</span><span class="">
</span><span class="">                    </span><span class="keyword1">then</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;s &#8882; b # bs &#8773; t &#8882; b # bs @ d&quot;</span><span class="">
</span><span class="">                      </span><span class="keyword1">using</span><span class=""> </span><span class="">exec_equiv_both</span><span class=""> </span><span class="">sources_unwinding_step</span><span class=""> </span><span class="">p0</span><span class=""> </span><span class="">a0</span><span class=""> 
</span><span class="">                        </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">meson</span><span class=""> </span><span class="">reachableStep</span><span class=""> </span><span class="">SM_axioms</span><span class=""> </span><span class="">sched_equiv_preserved</span><span class="delimiter">)</span><span class=""> 
</span><span class="">                  </span><span class="keyword1">}</span><span class="">
</span><span class="">                  </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">                  </span><span class="keyword1">qed</span><span class="">
</span><span class="">              </span><span class="keyword1">qed</span><span class="">
</span><span class="">          </span><span class="keyword1">}</span><span class="">
</span><span class="">          </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">        </span><span class="keyword1">qed</span><span class="">
</span><span class="">
</span><span class="">        </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="string">&quot;nonleakage&quot;</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">nonleakage_def</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">      </span><span class="keyword1">qed</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">theorem</span><span class=""> </span><span class="">sc_eq_nonlk</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;step_consistent = nonleakage&quot;</span><span class=""> 
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">nonlk_imp_sc</span><span class=""> </span><span class="">sc_imp_nonlk</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">noninf_imp_lr</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;noninfluence &#10233; local_respect&quot;</span><span class=""> 
</span><span class="">      </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">        </span><span class="keyword3">assume</span><span class=""> </span><span class="">p0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;noninfluence&quot;</span><span class="">
</span><span class="">        </span><span class="keyword1">then</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">p1</span><span class="delimiter">[</span><span class="">rule_format</span><span class="delimiter">]</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8704; d as s t . reachable0 s &#8743; reachable0 t &#10230; (s &#8776; (sources as s d) &#8776; t) 
                                &#10230; (s &#8764; sched &#8764; t) &#10230; (s &#8882; as &#8773; t &#8882; (ipurge as d {t}) @ d)&quot;</span><span class="">
</span><span class="">          </span><span class="keyword1">using</span><span class=""> </span><span class="">noninfluence_def</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">        
</span><span class="">        </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;&#8704; a d s s&#39;. reachable0 s &#10230; ((the (domain s a)) &#8726;&#8605; d) &#8743; (s,s&#39;)&#8712;step a &#10230; (s &#8764; d &#8764; s&#39;)&quot;</span><span class="">
</span><span class="">          </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">          </span><span class="keyword1">{</span><span class="">
</span><span class="">            </span><span class="keyword3">fix</span><span class=""> </span><span class="">a</span><span class=""> </span><span class="">d</span><span class=""> </span><span class="">s</span><span class=""> </span><span class="">s&#39;</span><span class="">
</span><span class="">            </span><span class="keyword3">assume</span><span class=""> </span><span class="">a0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;reachable0 s&quot;</span><span class="">
</span><span class="">              </span><span class="keyword2">and</span><span class="">  </span><span class="">a1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;((the (domain s a)) &#8726;&#8605; d) &#8743; (s,s&#39;)&#8712;step a&quot;</span><span class="">
</span><span class="">            </span><span class="keyword1">then</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">a2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;the (domain s a) &#8800; d&quot;</span><span class=""> </span><span class="keyword1">using</span><span class="">  </span><span class="">interf_reflexive</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">            </span><span class="keyword1">from</span><span class=""> </span><span class="">a0</span><span class=""> </span><span class="">a1</span><span class=""> </span><span class="">p1</span><span class="delimiter">[</span><span class="">of</span><span class=""> </span><span class="">s</span><span class=""> </span><span class="">s</span><span class=""> </span><span class="string">&quot;[a]&quot;</span><span class=""> </span><span class="">d</span><span class="delimiter">]</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">a3</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;s &#8882; [a] &#8773; s &#8882; (ipurge [a] d {s}) @ d&quot;</span><span class="">
</span><span class="">              </span><span class="keyword1">using</span><span class="">  </span><span class="">vpeq_reflexive_lemma</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">            </span><span class="keyword1">from</span><span class=""> </span><span class="">a0</span><span class=""> </span><span class="">a1</span><span class=""> </span><span class="">a2</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;ipurge [a] d {s} = []&quot;</span><span class=""> 
</span><span class="">              </span><span class="keyword1">using</span><span class=""> </span><span class="">sources_step</span><span class=""> </span><span class="">SM_enabled_axioms</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="">fastforce</span><span class="">
</span><span class="">            </span><span class="keyword1">with</span><span class=""> </span><span class="">a1</span><span class=""> </span><span class="">a3</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;s &#8764; d &#8764; s&#39;&quot;</span><span class="">
</span><span class="">              </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">IdI</span><span class=""> </span><span class="">R_O_Id</span><span class=""> </span><span class="">observ_equiv_sym</span><span class=""> </span><span class="">observ_equivalence_def</span><span class=""> </span><span class="">run_Cons</span><span class=""> </span><span class="">run_Nil</span><span class="delimiter">)</span><span class=""> 
</span><span class="">          </span><span class="keyword1">}</span><span class="">
</span><span class="">          </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">          </span><span class="keyword1">qed</span><span class="">
</span><span class="">        </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="string">&quot;local_respect&quot;</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">local_respect_def</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">      </span><span class="keyword1">qed</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">noninf_imp_sc</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;noninfluence &#10233; step_consistent&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">nonlk_imp_sc</span><span class=""> </span><span class="">noninf_impl_nonlk</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">  
</span><span class="">
</span><span class="">    </span><span class="keyword1">theorem</span><span class=""> </span><span class="">UnwindingTheorem</span><span class=""> </span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#10214;step_consistent; local_respect&#10215; &#10233; noninfluence_gen&quot;</span><span class="">
</span><span class="">    </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">      </span><span class="keyword3">assume</span><span class=""> </span><span class="">p1</span><span class="delimiter">:</span><span class="">step_consistent</span><span class="">
</span><span class="">      </span><span class="keyword3">assume</span><span class=""> </span><span class="">p2</span><span class="delimiter">:</span><span class="">local_respect</span><span class="">
</span><span class="">      </span><span class="keyword1">{</span><span class="">
</span><span class="">        </span><span class="keyword3">fix</span><span class=""> </span><span class="">as</span><span class=""> </span><span class="">d</span><span class="">
</span><span class="">        </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;&#8704;s ts. reachable0 s &#8743; (&#8704;t&#8712;ts. reachable0 t) 
                    &#10230; (&#8704;t&#8712;ts. (s &#8776; (sources as s d) &#8776; t)) 
                    &#10230; (&#8704;t&#8712;ts. (s &#8764; sched &#8764; t)) 
                    &#10230; (&#8704;t&#8712;ts. (s &#8882; as &#8773; t &#8882; (ipurge as d ts) @ d))&quot;</span><span class="">
</span><span class="">          </span><span class="keyword1">proof</span><span class="delimiter">(</span><span class="">induct</span><span class=""> </span><span class="">as</span><span class="delimiter">)</span><span class="">
</span><span class="">            </span><span class="keyword3">case</span><span class=""> </span><span class="">Nil</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?case</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">sources_refl</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">          </span><span class="keyword1">next</span><span class="">
</span><span class="">            </span><span class="keyword3">case</span><span class=""> </span><span class="delimiter">(</span><span class="">Cons</span><span class=""> </span><span class="">b</span><span class=""> </span><span class="">bs</span><span class="delimiter">)</span><span class="">
</span><span class="">            </span><span class="keyword3">assume</span><span class=""> </span><span class="">a0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8704;s ts. reachable0 s &#8743; (&#8704;t&#8712;ts. reachable0 t) 
                          &#10230; (&#8704;t&#8712;ts. (s &#8776; (sources bs s d) &#8776; t)) 
                          &#10230; (&#8704;t&#8712;ts. (s &#8764; sched &#8764; t)) 
                          &#10230; (&#8704;t&#8712;ts. (s &#8882; bs &#8773; t &#8882; (ipurge bs d ts) @ d))&quot;</span><span class="">
</span><span class="">            </span><span class="keyword3">show</span><span class=""> </span><span class="var">?case</span><span class=""> 
</span><span class="">              </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">              </span><span class="keyword1">{</span><span class="">
</span><span class="">                </span><span class="keyword3">fix</span><span class=""> </span><span class="">s</span><span class=""> </span><span class="">ts</span><span class="">
</span><span class="">                </span><span class="keyword3">assume</span><span class=""> </span><span class="">b0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;reachable0 s &#8743; (&#8704;t&#8712;ts. reachable0 t)&quot;</span><span class="">
</span><span class="">                  </span><span class="keyword2">and</span><span class="">  </span><span class="">b1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8704;t&#8712;ts. (s &#8776; (sources (b # bs) s d) &#8776; t)&quot;</span><span class="">
</span><span class="">                  </span><span class="keyword2">and</span><span class="">  </span><span class="">b2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8704;t&#8712;ts. (s &#8764; sched &#8764; t)&quot;</span><span class="">
</span><span class="">                </span><span class="keyword1">{</span><span class="">
</span><span class="">                  </span><span class="keyword3">fix</span><span class=""> </span><span class="">t</span><span class="">
</span><span class="">                  </span><span class="keyword3">assume</span><span class=""> </span><span class="">c0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;t&#8712;ts&quot;</span><span class="">
</span><span class="">                  </span><span class="keyword1">have</span><span class=""> </span><span class="">c1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;sources (b#bs) s d = sources (b#bs) t d&quot;</span><span class="">
</span><span class="">                    </span><span class="keyword1">using</span><span class=""> </span><span class="">b0</span><span class=""> </span><span class="">b2</span><span class=""> </span><span class="">c0</span><span class=""> </span><span class="">p1</span><span class=""> </span><span class="">sources_eq0</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">                  </span><span class="keyword1">have</span><span class=""> </span><span class="">c2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;domain s b = domain t b&quot;</span><span class="">
</span><span class="">                    </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">b2</span><span class=""> </span><span class="">c0</span><span class=""> </span><span class="">sched_vpeq</span><span class="delimiter">)</span><span class=""> 
</span><span class="">                  </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;s &#8882; b # bs &#8773; t &#8882; ipurge (b # bs) d ts @ d&quot;</span><span class="">
</span><span class="">                    </span><span class="keyword1">proof</span><span class="delimiter">(</span><span class="">cases</span><span class=""> </span><span class="string">&quot;the (domain s b) &#8712; sources (b#bs) s d&quot;</span><span class="delimiter">)</span><span class="">
</span><span class="">                      </span><span class="keyword3">assume</span><span class=""> </span><span class="">d0</span><span class="delimiter">:</span><span class="string">&quot;the (domain s b) &#8712; sources (b#bs) s d&quot;</span><span class="">
</span><span class="">                      </span><span class="keyword1">have</span><span class=""> </span><span class="">d1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;ipurge (b # bs) d ts = b # ipurge bs d (&#8899;s&#8712;ts. {s&#39;. (s,s&#39;) &#8712; step b})&quot;</span><span class="">
</span><span class="">                        </span><span class="keyword1">using</span><span class=""> </span><span class="">c0</span><span class=""> </span><span class="">c1</span><span class=""> </span><span class="">c2</span><span class=""> </span><span class="">d0</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">                      </span><span class="keyword1">let</span><span class=""> </span><span class="var">?ts&#39;</span><span class=""> </span><span class="delimiter">=</span><span class=""> </span><span class="string">&quot;&#8899;s&#8712;ts. {s&#39;. (s,s&#39;) &#8712; step b}&quot;</span><span class=""> 
</span><span class="">                      </span><span class="keyword1">let</span><span class=""> </span><span class="var">?bs&#39;</span><span class=""> </span><span class="delimiter">=</span><span class=""> </span><span class="string">&quot;ipurge bs d (&#8899;s&#8712;ts. {s&#39;. (s,s&#39;) &#8712; step b})&quot;</span><span class="">
</span><span class="">                      </span><span class="keyword1">{</span><span class="">
</span><span class="">                        </span><span class="keyword3">fix</span><span class=""> </span><span class="">s&#39;</span><span class=""> </span><span class="">t&#39;</span><span class="">
</span><span class="">                        </span><span class="keyword3">assume</span><span class=""> </span><span class="">e0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(s,s&#39;)&#8712; run (b#bs) &#8743; (t,t&#39;)&#8712; run (b # ?bs&#39;)&quot;</span><span class="">
</span><span class="">                        </span><span class="keyword1">then</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">e1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8707;s&#39;&#39; t&#39;&#39;. (s,s&#39;&#39;)&#8712;step b &#8743; (s&#39;&#39;,s&#39;)&#8712;run bs &#8743; (t,t&#39;&#39;)&#8712;step b &#8743; (t&#39;&#39;,t&#39;)&#8712;run ?bs&#39;&quot;</span><span class="">
</span><span class="">                          </span><span class="keyword1">using</span><span class=""> </span><span class="">relcompEpair</span><span class=""> </span><span class="">run_Cons</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">                        </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">obtain</span><span class=""> </span><span class="">s&#39;&#39;</span><span class=""> </span><span class="keyword2">and</span><span class=""> </span><span class="">t&#39;&#39;</span><span class=""> </span><span class="keyword2">where</span><span class=""> </span><span class="">e2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(s,s&#39;&#39;)&#8712;step b &#8743; (s&#39;&#39;,s&#39;)&#8712;run bs &#8743; (t,t&#39;&#39;)&#8712;step b &#8743; (t&#39;&#39;,t&#39;)&#8712;run ?bs&#39;&quot;</span><span class="">
</span><span class="">                          </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">                        </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;&#8704;t&#8712;?ts&#39;. reachable0 t&quot;</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">b0</span><span class=""> </span><span class="">reachableStep</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class=""> 
</span><span class="">                        </span><span class="keyword1">moreover</span><span class="">
</span><span class="">                        </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;&#8704;t&#8712;?ts&#39;. (s&#39;&#39; &#8776; (sources bs s&#39;&#39; d) &#8776; t)&quot;</span><span class="">
</span><span class="">                          </span><span class="keyword1">using</span><span class=""> </span><span class="">b0</span><span class=""> </span><span class="">b1</span><span class=""> </span><span class="">b2</span><span class=""> </span><span class="">e2</span><span class=""> </span><span class="">p1</span><span class=""> </span><span class="">sources_unwinding_step</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">                        </span><span class="keyword1">moreover</span><span class="">
</span><span class="">                        </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;&#8704;t&#8712;?ts&#39;. (s&#39;&#39; &#8764; sched &#8764; t)&quot;</span><span class="">
</span><span class="">                          </span><span class="keyword1">using</span><span class=""> </span><span class="">SM_enabled.sched_equiv_preserved</span><span class=""> </span><span class="">SM_enabled_axioms</span><span class=""> </span><span class="">b0</span><span class=""> </span><span class="">b2</span><span class=""> </span><span class="">e2</span><span class=""> </span><span class="">p1</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">fast</span><span class="">
</span><span class="">                        </span><span class="keyword1">ultimately</span><span class=""> 
</span><span class="">                        </span><span class="keyword1">have</span><span class=""> </span><span class="">e3</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8704;t&#8712;?ts&#39;. (s&#39;&#39; &#8882; bs &#8773; t &#8882; (ipurge bs d ?ts&#39;) @ d)&quot;</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">a0</span><span class="">
</span><span class="">                          </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">b0</span><span class=""> </span><span class="">e2</span><span class=""> </span><span class="">reachableStep</span><span class="delimiter">)</span><span class=""> 
</span><span class="">                        </span><span class="keyword1">then</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;s&#39; &#8764; d &#8764; t&#39;&quot;</span><span class="">
</span><span class="">                          </span><span class="keyword1">using</span><span class=""> </span><span class="">UN_iff</span><span class=""> </span><span class="">c0</span><span class=""> </span><span class="">e2</span><span class=""> </span><span class="">mem_Collect_eq</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class=""> 
</span><span class="">                      </span><span class="keyword1">}</span><span class="">
</span><span class="">                      </span><span class="keyword1">then</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;&#8704;s&#39; t&#39;. ((s,s&#39;)&#8712; run (b#bs) &#8743; (t,t&#39;)&#8712; run (b # ?bs&#39;)) &#10230;(s&#39; &#8764; d &#8764; t&#39;)&quot;</span><span class="">
</span><span class="">                        </span><span class="keyword1">by</span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">                      </span><span class="keyword1">with</span><span class=""> </span><span class="">d1</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">                    </span><span class="keyword1">next</span><span class="">
</span><span class="">                      </span><span class="keyword3">assume</span><span class=""> </span><span class="">d0</span><span class="delimiter">:</span><span class="string">&quot;&#172;(the (domain s b) &#8712; sources (b#bs) s d)&quot;</span><span class="">
</span><span class="">                      </span><span class="keyword1">have</span><span class=""> </span><span class="">d1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;ipurge (b # bs) d ts = ipurge bs d ts&quot;</span><span class="">
</span><span class="">                        </span><span class="keyword1">using</span><span class=""> </span><span class="">b0</span><span class=""> </span><span class="">b2</span><span class=""> </span><span class="">d0</span><span class=""> </span><span class="">p1</span><span class=""> </span><span class="">sched_vpeq</span><span class=""> </span><span class="">sources_eq</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">auto</span><span class=""> </span><span class="">cong</span><span class=""> </span><span class="">del</span><span class="delimiter">:</span><span class=""> </span><span class="">step_consistent_def</span><span class="delimiter">)</span><span class="">
</span><span class="">                      </span><span class="keyword1">let</span><span class=""> </span><span class="var">?bs&#39;</span><span class=""> </span><span class="delimiter">=</span><span class=""> </span><span class="string">&quot;ipurge bs d ts&quot;</span><span class="">
</span><span class="">                      </span><span class="keyword1">{</span><span class="">
</span><span class="">                        </span><span class="keyword3">fix</span><span class=""> </span><span class="">s&#39;</span><span class=""> </span><span class="">t&#39;</span><span class="">
</span><span class="">                        </span><span class="keyword3">assume</span><span class=""> </span><span class="">e0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(s,s&#39;)&#8712; run (b#bs) &#8743; (t,t&#39;)&#8712; run ?bs&#39;&quot;</span><span class="">
</span><span class="">                        </span><span class="keyword1">then</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">e1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8707;s&#39;&#39; t&#39;&#39;. (s,s&#39;&#39;)&#8712;step b &#8743; (s&#39;&#39;,s&#39;)&#8712;run bs&quot;</span><span class="">
</span><span class="">                          </span><span class="keyword1">using</span><span class=""> </span><span class="">relcompEpair</span><span class=""> </span><span class="">run_Cons</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">                        </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">obtain</span><span class=""> </span><span class="">s&#39;&#39;</span><span class=""> </span><span class="keyword2">where</span><span class=""> </span><span class="">e2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(s,s&#39;&#39;)&#8712;step b &#8743; (s&#39;&#39;,s&#39;)&#8712;run bs&quot;</span><span class="">
</span><span class="">                          </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">                        </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;&#8704;t&#8712;ts. (s&#39;&#39; &#8776; (sources bs s&#39;&#39; d) &#8776; t)&quot;</span><span class="">
</span><span class="">                          </span><span class="keyword1">using</span><span class=""> </span><span class="">b0</span><span class=""> </span><span class="">b1</span><span class=""> </span><span class="">b2</span><span class=""> </span><span class="">d0</span><span class=""> </span><span class="">e2</span><span class=""> </span><span class="">p1</span><span class=""> </span><span class="">p2</span><span class=""> </span><span class="">scheduler_in_sources_Cons</span><span class=""> 
</span><span class="">                          </span><span class="">sources_equiv_preserved_left</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">                        </span><span class="keyword1">moreover</span><span class="">
</span><span class="">                        </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;&#8704;t&#8712;ts. (s&#39;&#39; &#8764; sched &#8764; t)&quot;</span><span class="">
</span><span class="">                          </span><span class="keyword1">using</span><span class=""> </span><span class="">b0</span><span class=""> </span><span class="">b2</span><span class=""> </span><span class="">d0</span><span class=""> </span><span class="">e2</span><span class=""> </span><span class="">p2</span><span class=""> </span><span class="">sched_equiv_preserved_left</span><span class=""> 
</span><span class="">                            </span><span class="">scheduler_in_sources_Cons</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">                        </span><span class="keyword1">ultimately</span><span class=""> 
</span><span class="">                        </span><span class="keyword1">have</span><span class=""> </span><span class="">e3</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8704;t&#8712;ts. (s&#39;&#39; &#8882; bs &#8773; t &#8882; (ipurge bs d ts) @ d)&quot;</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">a0</span><span class="">
</span><span class="">                          </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">b0</span><span class=""> </span><span class="">e2</span><span class=""> </span><span class="">reachableStep</span><span class="delimiter">)</span><span class=""> 
</span><span class="">                        </span><span class="keyword1">then</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;s&#39; &#8764; d &#8764; t&#39;&quot;</span><span class="">
</span><span class="">                          </span><span class="keyword1">using</span><span class=""> </span><span class="">c0</span><span class=""> </span><span class="">e0</span><span class=""> </span><span class="">e2</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class=""> 
</span><span class="">                      </span><span class="keyword1">}</span><span class="">
</span><span class="">                      </span><span class="keyword1">then</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;&#8704;s&#39; t&#39;. ((s,s&#39;)&#8712; run (b#bs) &#8743; (t,t&#39;)&#8712; run ?bs&#39;) &#10230;(s&#39; &#8764; d &#8764; t&#39;)&quot;</span><span class="">
</span><span class="">                        </span><span class="keyword1">by</span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">                      </span><span class="keyword1">with</span><span class=""> </span><span class="">d1</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">                    </span><span class="keyword1">qed</span><span class="">
</span><span class="">                      
</span><span class="">                </span><span class="keyword1">}</span><span class="">
</span><span class="">                
</span><span class="">              </span><span class="keyword1">}</span><span class="">
</span><span class="">              </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">              </span><span class="keyword1">qed</span><span class="">
</span><span class="">          </span><span class="keyword1">qed</span><span class="">
</span><span class="">      </span><span class="keyword1">}</span><span class="">
</span><span class="">      </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">noninfluence_gen_def</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">    </span><span class="keyword1">qed</span><span class="">
</span><span class="">    
</span><span class="">    </span><span class="keyword1">theorem</span><span class=""> </span><span class="">UnwindingTheorem1</span><span class=""> </span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#10214;weak_step_consistent; local_respect&#10215; &#10233; noninfluence_gen&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">UnwindingTheorem</span><span class=""> </span><span class="">weak_with_step_cons</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">theorem</span><span class=""> </span><span class="">noninf_eq_noninf_gen</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;noninfluence = noninfluence_gen&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">UnwindingTheorem</span><span class=""> </span><span class="">noninf_imp_lr</span><span class=""> </span><span class="">noninf_imp_sc</span><span class=""> </span><span class="">noninf_gen_impl_noninfl</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">
</span><span class="">    </span><span class="keyword1">theorem</span><span class=""> </span><span class="">uc_eq_noninf</span><span class=""> </span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(step_consistent &#8743; local_respect) = noninfluence&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">UnwindingTheorem1</span><span class=""> </span><span class="">step_cons_impl_weak</span><span class=""> </span><span class="">noninf_eq_noninf_gen</span><span class=""> 
</span><span class="">        </span><span class="">noninf_imp_lr</span><span class=""> </span><span class="">noninf_imp_sc</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">      
</span><span class="">    </span><span class="keyword1">theorem</span><span class=""> </span><span class="">noninf_impl_weak</span><span class="delimiter">:</span><span class="string">&quot;noninfluence &#10233; weak_noninfluence&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">smt</span><span class=""> </span><span class="">observ_equiv_sym</span><span class=""> </span><span class="">observ_equiv_trans</span><span class=""> </span><span class="">ipurge_eq</span><span class=""> </span><span class="">weak_noninfluence_def</span><span class=""> 
</span><span class="">          </span><span class="">noninterference_r_def</span><span class=""> </span><span class="">noninf_imp_sc</span><span class=""> </span><span class="">noninfluence_def</span><span class=""> </span><span class="">noninf_impl_nonintf_r</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">wk_nonintf_r_and_nonlk_impl_noninfl</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#10214;weak_noninterference_r; nonleakage&#10215; &#10233; weak_noninfluence&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">        </span><span class="keyword3">assume</span><span class=""> </span><span class="">p0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;weak_noninterference_r&quot;</span><span class="">
</span><span class="">          </span><span class="keyword2">and</span><span class="">  </span><span class="">p1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;nonleakage&quot;</span><span class="">
</span><span class="">        </span><span class="keyword1">then</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">a0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8704;d as bs s. reachable0 s &#8743; ipurge as d {s} = ipurge bs d {s}
                                    &#10230; (s &#8882; as &#8773; s &#8882; bs @ d)&quot;</span><span class=""> 
</span><span class="">          </span><span class="keyword1">using</span><span class=""> </span><span class="">weak_noninterference_r_def</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">        </span><span class="keyword1">from</span><span class=""> </span><span class="">p1</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">a1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8704;d as s t. reachable0 s &#8743; reachable0 t &#8743; (s &#8764; sched &#8764; t) 
                                      &#8743; (s &#8776; (sources as s d) &#8776; t) &#10230; (s &#8882; as &#8773; t &#8882; as @ d)&quot;</span><span class="">
</span><span class="">          </span><span class="keyword1">using</span><span class=""> </span><span class="">nonleakage_def</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">        
</span><span class="">        </span><span class="keyword1">then</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;&#8704; d as bs s t . reachable0 s &#8743; reachable0 t &#8743; (s &#8776; (sources as s d) &#8776; t) 
                                     &#8743; (s &#8764; sched &#8764; t) &#8743; ipurge as d {s} = ipurge bs d {s} 
                                     &#10230; (s &#8882; as &#8773; t &#8882; bs @ d)&quot;</span><span class="">
</span><span class="">          </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">          </span><span class="keyword1">{</span><span class="">
</span><span class="">            </span><span class="keyword3">fix</span><span class=""> </span><span class="">d</span><span class=""> </span><span class="">as</span><span class=""> </span><span class="">bs</span><span class=""> </span><span class="">s</span><span class=""> </span><span class="">t</span><span class="">
</span><span class="">            </span><span class="keyword3">assume</span><span class=""> </span><span class="">b0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;reachable0 s &#8743; reachable0 t &#8743; (s &#8776; (sources as s d) &#8776; t) 
                        &#8743; (s &#8764; sched &#8764; t) &#8743; ipurge as d {s} = ipurge bs d {s}&quot;</span><span class="">
</span><span class="">            </span><span class="keyword1">with</span><span class=""> </span><span class="">a1</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">b1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;s &#8882; as &#8773; t &#8882; as @ d&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">            </span><span class="keyword1">from</span><span class=""> </span><span class="">b0</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">b2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;ipurge as d {s} = ipurge as d {t}&quot;</span><span class="">
</span><span class="">              </span><span class="keyword1">using</span><span class=""> </span><span class="">ipurge_eq</span><span class=""> </span><span class="">nonlk_imp_sc</span><span class=""> </span><span class="">p1</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">            </span><span class="keyword1">from</span><span class=""> </span><span class="">b0</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">b3</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;ipurge bs d {s} = ipurge bs d {t}&quot;</span><span class="">
</span><span class="">              </span><span class="keyword1">using</span><span class=""> </span><span class="">ipurge_eq</span><span class=""> </span><span class="">nonlk_imp_sc</span><span class=""> </span><span class="">p1</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">            </span><span class="keyword1">from</span><span class=""> </span><span class="">a0</span><span class=""> </span><span class="">b0</span><span class=""> </span><span class="">b2</span><span class=""> </span><span class="">b3</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">b4</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;s &#8882; as &#8773; s &#8882; bs @ d&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">            </span><span class="keyword1">from</span><span class=""> </span><span class="">a0</span><span class=""> </span><span class="">b0</span><span class=""> </span><span class="">b2</span><span class=""> </span><span class="">b3</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">b5</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;t &#8882; as &#8773; t &#8882; bs @ d&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">            </span><span class="keyword1">from</span><span class=""> </span><span class="">b1</span><span class=""> </span><span class="">b4</span><span class=""> </span><span class="">b5</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;s &#8882; as &#8773; t &#8882; bs @ d&quot;</span><span class="">
</span><span class="">              </span><span class="keyword1">using</span><span class=""> </span><span class="">b0</span><span class=""> </span><span class="">observ_equiv_trans</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">          </span><span class="keyword1">}</span><span class="">
</span><span class="">          </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">          </span><span class="keyword1">qed</span><span class="">
</span><span class="">        </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">weak_noninfluence_def</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">      </span><span class="keyword1">qed</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">nonintf_r_and_nonlk_impl_noninfl</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#10214;noninterference_r; nonleakage&#10215; &#10233; noninfluence&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">        </span><span class="keyword3">assume</span><span class=""> </span><span class="">p0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;noninterference_r&quot;</span><span class="">
</span><span class="">          </span><span class="keyword2">and</span><span class="">  </span><span class="">p1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;nonleakage&quot;</span><span class="">
</span><span class="">        </span><span class="keyword1">then</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">a0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8704;d as s. reachable0 s &#10230; (s &#8882; as &#8773; s &#8882; (ipurge as d {s}) @ d)&quot;</span><span class=""> 
</span><span class="">          </span><span class="keyword1">using</span><span class=""> </span><span class="">noninterference_r_def</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">        </span><span class="keyword1">from</span><span class=""> </span><span class="">p1</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">a1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8704;d as s t. reachable0 s &#8743; reachable0 t &#8743; (s &#8764; sched &#8764; t) 
                                      &#8743; (s &#8776; (sources as s d) &#8776; t) &#10230; (s &#8882; as &#8773; t &#8882; as @ d)&quot;</span><span class="">
</span><span class="">          </span><span class="keyword1">using</span><span class=""> </span><span class="">nonleakage_def</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">        
</span><span class="">        </span><span class="keyword1">then</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;&#8704; d as s t . reachable0 s &#8743; reachable0 t &#8743; (s &#8776; (sources as s d) &#8776; t) 
                                &#8743; (s &#8764; sched &#8764; t) &#10230; (s &#8882; as &#8773; t &#8882; (ipurge as d {t}) @ d)&quot;</span><span class="">
</span><span class="">          </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">          </span><span class="keyword1">{</span><span class="">
</span><span class="">            </span><span class="keyword3">fix</span><span class=""> </span><span class="">d</span><span class=""> </span><span class="">as</span><span class=""> </span><span class="">bs</span><span class=""> </span><span class="">s</span><span class=""> </span><span class="">t</span><span class="">
</span><span class="">            </span><span class="keyword3">assume</span><span class=""> </span><span class="">b0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;reachable0 s &#8743; reachable0 t &#8743; (s &#8776; (sources as s d) &#8776; t) 
                        &#8743; (s &#8764; sched &#8764; t)&quot;</span><span class="">
</span><span class="">            </span><span class="keyword1">with</span><span class=""> </span><span class="">a1</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">b1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;s &#8882; as &#8773; t &#8882; as @ d&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">            </span><span class="keyword1">from</span><span class=""> </span><span class="">b0</span><span class=""> </span><span class="">a0</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">b2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;s &#8882; as &#8773; s &#8882; (ipurge as d {s}) @ d&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">fast</span><span class="">
</span><span class="">            </span><span class="keyword1">from</span><span class=""> </span><span class="">b0</span><span class=""> </span><span class="">a0</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">b3</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;t &#8882; as &#8773; t &#8882; (ipurge as d {t}) @ d&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">fast</span><span class="">
</span><span class="">            
</span><span class="">            </span><span class="keyword1">from</span><span class=""> </span><span class="">b1</span><span class=""> </span><span class="">b2</span><span class=""> </span><span class="">b3</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;s &#8882; as &#8773; t &#8882; (ipurge as d {t}) @ d&quot;</span><span class="">
</span><span class="">              </span><span class="keyword1">using</span><span class=""> </span><span class="">b0</span><span class=""> </span><span class="">observ_equiv_trans</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">          </span><span class="keyword1">}</span><span class="">
</span><span class="">          </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">          </span><span class="keyword1">qed</span><span class="">
</span><span class="">        </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">noninfluence_def</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">      </span><span class="keyword1">qed</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">noninfl_impl_noninfl2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;weak_noninfluence &#10233; weak_noninfluence2&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">ipurge_eq</span><span class=""> </span><span class="">wk_noninfl_impl_nonlk</span><span class=""> </span><span class="">weak_noninfluence2_def</span><span class=""> 
</span><span class="">        </span><span class="">weak_noninfluence_def</span><span class=""> </span><span class="">nonlk_imp_sc</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">metis</span><span class=""> 
</span><span class="">
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">noninf2_imp_lr</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;weak_noninfluence2 &#10233; local_respect&quot;</span><span class=""> 
</span><span class="">      </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">        </span><span class="keyword3">assume</span><span class=""> </span><span class="">p0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;weak_noninfluence2&quot;</span><span class="">
</span><span class="">        </span><span class="keyword1">then</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">p1</span><span class="delimiter">[</span><span class="">rule_format</span><span class="delimiter">]</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8704; d as bs s t . reachable0 s &#8743; reachable0 t &#8743; (s &#8776; (sources as s d) &#8776; t) 
                                     &#8743; (s &#8764; sched &#8764; t) &#8743; ipurge as d {s} = ipurge bs d {t} 
                                     &#10230; (s &#8882; as &#8773; t &#8882; bs @ d)&quot;</span><span class="">
</span><span class="">          </span><span class="keyword1">using</span><span class=""> </span><span class="">weak_noninfluence2_def</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">        
</span><span class="">        </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;&#8704; a d s s&#39;. reachable0 s &#10230; ((the (domain s a)) &#8726;&#8605; d) &#8743; (s,s&#39;)&#8712;step a &#10230; (s &#8764; d &#8764; s&#39;)&quot;</span><span class="">
</span><span class="">          </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">          </span><span class="keyword1">{</span><span class="">
</span><span class="">            </span><span class="keyword3">fix</span><span class=""> </span><span class="">a</span><span class=""> </span><span class="">d</span><span class=""> </span><span class="">s</span><span class=""> </span><span class="">s&#39;</span><span class="">
</span><span class="">            </span><span class="keyword3">assume</span><span class=""> </span><span class="">a0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;reachable0 s&quot;</span><span class="">
</span><span class="">              </span><span class="keyword2">and</span><span class="">  </span><span class="">a1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;((the (domain s a)) &#8726;&#8605; d) &#8743; (s,s&#39;)&#8712;step a&quot;</span><span class="">
</span><span class="">            </span><span class="keyword1">then</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">a2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;the (domain s a) &#8800; d&quot;</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">non_interference_def</span><span class=""> </span><span class="">interf_reflexive</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">            </span><span class="keyword1">from</span><span class=""> </span><span class="">a0</span><span class=""> </span><span class="">a1</span><span class=""> </span><span class="">a2</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;ipurge [a] d {s} = ipurge [] d {s}&quot;</span><span class=""> 
</span><span class="">              </span><span class="keyword1">using</span><span class=""> </span><span class="">sources_step</span><span class=""> </span><span class="">SM_enabled_axioms</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="">fastforce</span><span class="">
</span><span class="">            </span><span class="keyword1">with</span><span class=""> </span><span class="">a0</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;s &#8882; [a] &#8773; s &#8882; [] @ d&quot;</span><span class=""> 
</span><span class="">              </span><span class="keyword1">using</span><span class=""> </span><span class="">p1</span><span class="delimiter">[</span><span class="">of</span><span class=""> </span><span class="">s</span><span class=""> </span><span class="">s</span><span class=""> </span><span class="string">&quot;[a]&quot;</span><span class=""> </span><span class="">d</span><span class=""> </span><span class="string">&quot;[]&quot;</span><span class="delimiter">]</span><span class=""> </span><span class="">ivpeq_def</span><span class=""> </span><span class="">vpeq_reflexive_lemma</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">            </span><span class="keyword1">with</span><span class=""> </span><span class="">a1</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;s &#8764; d &#8764; s&#39;&quot;</span><span class="">
</span><span class="">              </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">metis</span><span class=""> </span><span class="">IdI</span><span class=""> </span><span class="">R_O_Id</span><span class=""> </span><span class="">observ_equiv_sym</span><span class=""> </span><span class="">observ_equivalence_def</span><span class=""> </span><span class="">run_Cons</span><span class=""> </span><span class="">run_Nil</span><span class="delimiter">)</span><span class=""> 
</span><span class="">          </span><span class="keyword1">}</span><span class="">
</span><span class="">          </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">          </span><span class="keyword1">qed</span><span class="">
</span><span class="">        </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="string">&quot;local_respect&quot;</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">local_respect_def</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">      </span><span class="keyword1">qed</span><span class="">
</span><span class="">    
</span><span class="">    </span><span class="keyword1">lemma</span><span class=""> </span><span class="">noninf2_imp_sc</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;weak_noninfluence2 &#10233; step_consistent&quot;</span><span class=""> 
</span><span class="">      </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">        </span><span class="keyword3">assume</span><span class=""> </span><span class="">p0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;weak_noninfluence2&quot;</span><span class="">
</span><span class="">        </span><span class="keyword1">then</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">p1</span><span class="delimiter">[</span><span class="">rule_format</span><span class="delimiter">]</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#8704; d as bs s t . reachable0 s &#8743; reachable0 t &#8743; (s &#8776; (sources as s d) &#8776; t) 
                                     &#8743; (s &#8764; sched &#8764; t) &#8743; ipurge as d {s} = ipurge bs d {t} 
                                     &#10230; (s &#8882; as &#8773; t &#8882; bs @ d)&quot;</span><span class="">
</span><span class="">          </span><span class="keyword1">using</span><span class=""> </span><span class="">weak_noninfluence2_def</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">        
</span><span class="">        </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;&#8704;a d s t. reachable0 s &#8743; reachable0 t &#8743; (s &#8764; d &#8764; t) &#8743; (s &#8764; sched &#8764; t) &#8743; 
                              (((the (domain s a)) &#8605; d) &#10230; (s &#8764; (the (domain s a)) &#8764; t)) &#10230; 
                              (&#8704; s&#39; t&#39;. (s,s&#39;) &#8712; step a &#8743; (t,t&#39;) &#8712; step a &#10230; (s&#39; &#8764;d&#8764; t&#39;))&quot;</span><span class="">
</span><span class="">          </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">          </span><span class="keyword1">{</span><span class="">
</span><span class="">            </span><span class="keyword3">fix</span><span class=""> </span><span class="">a</span><span class=""> </span><span class="">d</span><span class=""> </span><span class="">s</span><span class=""> </span><span class="">t</span><span class="">
</span><span class="">            </span><span class="keyword3">assume</span><span class=""> </span><span class="">a0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;reachable0 s &#8743; reachable0 t&quot;</span><span class="">
</span><span class="">              </span><span class="keyword2">and</span><span class="">  </span><span class="">a1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(s &#8764; d &#8764; t) &#8743; (s &#8764; sched &#8764; t)&quot;</span><span class="">
</span><span class="">              </span><span class="keyword2">and</span><span class="">  </span><span class="">a2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;((the (domain s a)) &#8605; d) &#10230; (s &#8764; (the (domain s a)) &#8764; t)&quot;</span><span class="">
</span><span class="">            </span><span class="keyword1">then</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">a3</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;domain s a = domain t a&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="delimiter">(</span><span class="">simp</span><span class=""> </span><span class="">add</span><span class="delimiter">:</span><span class=""> </span><span class="">sched_vpeq</span><span class="delimiter">)</span><span class=""> 
</span><span class="">                    
</span><span class="">            </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;&#8704; s&#39; t&#39;. (s,s&#39;) &#8712; step a &#8743; (t,t&#39;) &#8712; step a &#10230; (s&#39; &#8764;d&#8764; t&#39;)&quot;</span><span class="">
</span><span class="">              </span><span class="keyword1">proof</span><span class=""> </span><span class="">-</span><span class="">
</span><span class="">              </span><span class="keyword1">{</span><span class="">
</span><span class="">                </span><span class="keyword3">fix</span><span class=""> </span><span class="">s&#39;</span><span class=""> </span><span class="">t&#39;</span><span class="">
</span><span class="">                </span><span class="keyword3">assume</span><span class=""> </span><span class="">b0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(s,s&#39;) &#8712; step a &#8743; (t,t&#39;) &#8712; step a&quot;</span><span class="">
</span><span class="">                </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;s&#39; &#8764;d&#8764; t&#39;&quot;</span><span class=""> 
</span><span class="">                  </span><span class="keyword1">proof</span><span class="delimiter">(</span><span class="">cases</span><span class=""> </span><span class="string">&quot;(the (domain s a)) &#8605; d&quot;</span><span class="delimiter">)</span><span class="">
</span><span class="">                    </span><span class="keyword3">assume</span><span class=""> </span><span class="">c0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(the (domain s a)) &#8605; d&quot;</span><span class="">
</span><span class="">                    </span><span class="keyword1">with</span><span class=""> </span><span class="">a2</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">c1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;s &#8764; (the (domain s a)) &#8764; t&quot;</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">simp</span><span class="">
</span><span class="">                    </span><span class="keyword1">with</span><span class=""> </span><span class="">a0</span><span class=""> </span><span class="">a1</span><span class=""> </span><span class="">c0</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">c2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;s &#8776; (sources [a] s d) &#8776; t&quot;</span><span class=""> 
</span><span class="">                      </span><span class="keyword1">using</span><span class=""> </span><span class="">sources_step2</span><span class="delimiter">[</span><span class="">of</span><span class=""> </span><span class="">s</span><span class=""> </span><span class="">a</span><span class=""> </span><span class="">d</span><span class="delimiter">]</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class=""> 
</span><span class="">                    </span><span class="keyword1">from</span><span class=""> </span><span class="">a0</span><span class=""> </span><span class="">c0</span><span class=""> </span><span class="">a3</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">c4</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;ipurge [a] d {s} = ipurge [a] d {t}&quot;</span><span class=""> 
</span><span class="">                      </span><span class="keyword1">using</span><span class=""> </span><span class="">sources_step2</span><span class="delimiter">[</span><span class="">of</span><span class=""> </span><span class="">s</span><span class=""> </span><span class="">a</span><span class=""> </span><span class="">d</span><span class="delimiter">]</span><span class=""> </span><span class="">sources_step2</span><span class="delimiter">[</span><span class="">of</span><span class=""> </span><span class="">t</span><span class=""> </span><span class="">a</span><span class=""> </span><span class="">d</span><span class="delimiter">]</span><span class=""> 
</span><span class="">                        </span><span class="">ipurge_Cons</span><span class="delimiter">[</span><span class="">of</span><span class=""> </span><span class="">a</span><span class=""> </span><span class="string">&quot;[]&quot;</span><span class=""> </span><span class="">d</span><span class=""> </span><span class="string">&quot;{s}&quot;</span><span class="delimiter">]</span><span class=""> </span><span class="">ipurge_Cons</span><span class="delimiter">[</span><span class="">of</span><span class=""> </span><span class="">a</span><span class=""> </span><span class="string">&quot;[]&quot;</span><span class=""> </span><span class="">d</span><span class=""> </span><span class="string">&quot;{t}&quot;</span><span class="delimiter">]</span><span class=""> 
</span><span class="">                        </span><span class="">ipurge_Nil</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">                    </span><span class="keyword1">then</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;s &#8882; [a] &#8773; t &#8882; [a] @ d&quot;</span><span class=""> 
</span><span class="">                      </span><span class="keyword1">using</span><span class=""> </span><span class="">p1</span><span class="delimiter">[</span><span class="">of</span><span class=""> </span><span class="">s</span><span class=""> </span><span class="">t</span><span class=""> </span><span class="string">&quot;[a]&quot;</span><span class=""> </span><span class="">d</span><span class="delimiter">]</span><span class=""> </span><span class="">a0</span><span class=""> </span><span class="">a1</span><span class=""> </span><span class="">c2</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">                    </span><span class="keyword1">with</span><span class=""> </span><span class="">b0</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class="">
</span><span class="">                      </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">                  </span><span class="keyword1">next</span><span class="">
</span><span class="">                    </span><span class="keyword3">assume</span><span class=""> </span><span class="">c0</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#172;((the (domain s a)) &#8605; d)&quot;</span><span class="">
</span><span class="">                    </span><span class="keyword1">then</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">c1</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;the (domain s a) &#8800; d&quot;</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">interf_reflexive</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">                    </span><span class="keyword1">from</span><span class=""> </span><span class="">c0</span><span class=""> </span><span class="">a0</span><span class=""> </span><span class="">a1</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">c2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;s &#8776; (sources [a] s d) &#8776; t&quot;</span><span class=""> 
</span><span class="">                      </span><span class="keyword1">using</span><span class=""> </span><span class="">sources_step</span><span class="delimiter">[</span><span class="">of</span><span class=""> </span><span class="">s</span><span class=""> </span><span class="">a</span><span class=""> </span><span class="">d</span><span class="delimiter">]</span><span class="">  </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class=""> 
</span><span class="">                    </span><span class="keyword1">from</span><span class=""> </span><span class="">a0</span><span class=""> </span><span class="">c0</span><span class=""> </span><span class="">c1</span><span class=""> </span><span class="">a3</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="">c4</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;ipurge [a] d {s} = ipurge [a] d {t}&quot;</span><span class=""> 
</span><span class="">                      </span><span class="keyword1">using</span><span class=""> </span><span class="">sources_step</span><span class="delimiter">[</span><span class="">of</span><span class=""> </span><span class="">s</span><span class=""> </span><span class="">a</span><span class=""> </span><span class="">d</span><span class="delimiter">]</span><span class=""> </span><span class="">sources_step</span><span class="delimiter">[</span><span class="">of</span><span class=""> </span><span class="">t</span><span class=""> </span><span class="">a</span><span class=""> </span><span class="">d</span><span class="delimiter">]</span><span class=""> 
</span><span class="">                        </span><span class="">ipurge_Cons</span><span class="delimiter">[</span><span class="">of</span><span class=""> </span><span class="">a</span><span class=""> </span><span class="string">&quot;[]&quot;</span><span class=""> </span><span class="">d</span><span class=""> </span><span class="string">&quot;{s}&quot;</span><span class="delimiter">]</span><span class=""> </span><span class="">ipurge_Cons</span><span class="delimiter">[</span><span class="">of</span><span class=""> </span><span class="">a</span><span class=""> </span><span class="string">&quot;[]&quot;</span><span class=""> </span><span class="">d</span><span class=""> </span><span class="string">&quot;{t}&quot;</span><span class="delimiter">]</span><span class=""> 
</span><span class="">                        </span><span class="">ipurge_Nil</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">                    </span><span class="keyword1">then</span><span class=""> </span><span class="keyword1">have</span><span class=""> </span><span class="string">&quot;s &#8882; [a] &#8773; t &#8882; [a] @ d&quot;</span><span class=""> 
</span><span class="">                      </span><span class="keyword1">using</span><span class=""> </span><span class="">p1</span><span class="delimiter">[</span><span class="">of</span><span class=""> </span><span class="">s</span><span class=""> </span><span class="">t</span><span class=""> </span><span class="string">&quot;[a]&quot;</span><span class=""> </span><span class="">d</span><span class="delimiter">]</span><span class=""> </span><span class="">a0</span><span class=""> </span><span class="">a1</span><span class=""> </span><span class="">c2</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">                    </span><span class="keyword1">with</span><span class=""> </span><span class="">b0</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class="">
</span><span class="">                      </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class=""> 
</span><span class="">                  </span><span class="keyword1">qed</span><span class="">
</span><span class="">              </span><span class="keyword1">}</span><span class="">
</span><span class="">              </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">              </span><span class="keyword1">qed</span><span class="">
</span><span class="">          </span><span class="keyword1">}</span><span class="">
</span><span class="">          </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="var">?thesis</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">          </span><span class="keyword1">qed</span><span class="">
</span><span class="">        </span><span class="keyword1">then</span><span class=""> </span><span class="keyword3">show</span><span class=""> </span><span class="string">&quot;step_consistent&quot;</span><span class=""> </span><span class="keyword1">using</span><span class=""> </span><span class="">step_consistent_def</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">      </span><span class="keyword1">qed</span><span class="">
</span><span class="">
</span><span class="">    </span><span class="keyword1">theorem</span><span class=""> </span><span class="">noninfl_eq_noninfl2</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;weak_noninfluence = weak_noninfluence2&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">noninf2_imp_lr</span><span class=""> </span><span class="">noninf2_imp_sc</span><span class=""> </span><span class="">noninf_impl_weak</span><span class=""> </span><span class="">noninfl_impl_noninfl2</span><span class=""> </span><span class="">uc_eq_noninf</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">      
</span><span class="">    </span><span class="keyword1">theorem</span><span class=""> </span><span class="">nonintf_r_and_nonlk_eq_strnoninfl</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(noninterference_r &#8743; nonleakage) = noninfluence&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">nonintf_r_and_nonlk_impl_noninfl</span><span class=""> </span><span class="">noninf_impl_nonintf_r</span><span class=""> </span><span class="">noninf_impl_nonlk</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class=""> 
</span><span class="">
</span><span class="">    </span><span class="keyword1">theorem</span><span class=""> </span><span class="">wk_nonintf_r_and_nonlk_eq_noninfl</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;(weak_noninterference_r &#8743; nonleakage) = weak_noninfluence&quot;</span><span class="">
</span><span class="">      </span><span class="keyword1">using</span><span class=""> </span><span class="">wk_noninfl_impl_nonlk</span><span class=""> </span><span class="">wk_noninfl_impl_wk_nonintf_r</span><span class=""> </span><span class="">wk_nonintf_r_and_nonlk_impl_noninfl</span><span class=""> </span><span class="keyword1">by</span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">      
</span><span class="">  </span><span class="keyword2">end</span><span class="">
</span><span class="keyword2">end</span><span class="">
</span></pre>

</div>
</body>
</html>
