<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Theory Linux_LSM_Model (Isabelle2019: June 2019)</title>
<link media="all" rel="stylesheet" type="text/css" href="isabelle.css"/>
</head>

<body>
<div class="head"><h1>Theory Linux_LSM_Model</h1>

<span class="command">theory</span> <span class="name">Linux_LSM_Model</span><br/>
<span class="keyword">imports</span> <a href="LSM_Cap.html"><span class="name">LSM_Cap</span></a> <a href="Linux_LSM_Hooks.html"><span class="name">Linux_LSM_Hooks</span></a><br/>

</div>
<div class="source">
<pre class="source"><span class="keyword1"><span class="command">section</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249; LSM Model &#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">theory</span></span><span> </span><span>Linux_LSM_Model</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">imports</span></span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;SOAC&quot;</span></span></span><span>  
</span><span>    </span><span>LSM_Cap</span><span>
</span><span>    </span><span>Linux_LSM_Hooks</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;../lib/Monad_WP/NonDetMonadVCG&quot;</span></span></span><span> 
</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span class="cartouche"><span class="delete"><span class="delete">&#8249;
  In this theory, we introduce LSM Model
&#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249; def security opts type &#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_init_mnt_opts &#8801; &#10631;mnt_opts = [],mnt_opts_flags = [],num_mnt_opts=0&#10632;&quot;</span></span></span><span>          
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span class="cartouche"><span class="delete"><span class="delete">&#8249; lsm model&#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>lsm</span><span> </span><span class="delimiter">=</span><span>  </span><span>lsm_hooks</span><span> </span><span>state</span><span>  </span><span class="delimiter">+</span><span> </span><span>SOModel</span><span> </span><span>subj_label</span><span> </span><span>obj_label</span><span> </span><span>access_rules</span><span> </span><span>Subj</span><span> </span><span>Obj</span><span> </span><span>request</span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">for</span></span><span>   </span><span>state</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>subj_label</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;Subj &#8658; subject_label&quot;</span></span></span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>obj_label</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s =&gt;Obj &#8658; object_label&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>access_rules</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot; Label &#8658; Label &#8658; access set&quot;</span></span></span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>Subj</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Subj set&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>Obj</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Obj set&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>request</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;Subj &#8658; Obj &#8658; Request&#8658; decision&quot;</span></span></span><span> 
</span><span>  </span><span class="delimiter">+</span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>k_task</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; process_id &#8640; Task&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>inodes</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; inum &#8640; inode&quot;</span></span></span><span>
</span><span>  
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*capable*)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_capget</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658; kct &#8658; kct &#8658;kct &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_capget s target effective inheritable permitted &#8801;  
         hook_capget s target effective inheritable permitted&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_capset</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Cred &#8658; Cred &#8658; kct &#8658; kct &#8658;kct &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_capset s new old effective inheritable permitted &#8801;  
         hook_capset s new old effective inheritable permitted&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_capable</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Cred &#8658; ns &#8658; cap &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_capable s c ns cap &#8801; hook_capable s c ns cap&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_capable_noaudit</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Cred &#8658; ns &#8658; cap &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_capable_noaudit s c ns cap &#8801; hook_capable_noaudit s c ns cap &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_quotactl</span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; int &#8658; int &#8658; int &#8658; super_block option &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_quotactl s cmds t id&#39; sb &#8801; hook_quotactl s cmds t id&#39; sb&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_quota_on</span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_quota_on s dentry &#8801; hook_quota_on s dentry&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_settime64</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; ts &#8658; tz option  &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_settime64 s ts tz &#8801; hook_settime64 s ts tz&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>vm_enough_memory</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; mm &#8658; pages &#8658; int &#8658; int&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;vm_enough_memory s mm&#39; p pages &#8801; 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_vm_enough_memory_mm</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; mm &#8658;  pages &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_vm_enough_memory_mm s mm&#39; pages &#8801; do 
          rc &#8592; hook_vm_enough_memory_mm s mm&#39; pages;
          cap_sys_admin &#8592; (if rc &#8804; 0 then return 0 
                            else return 1
                           );
          return(vm_enough_memory s mm&#39; pages cap_sys_admin)
        od&quot;</span></span></span><span>
</span><span>
</span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*binder *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_binder_set_context_mgr</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_binder_set_context_mgr s mgr &#8801; hook_binder_set_context_mgr s mgr&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_binder_transaction</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658; Task &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span class="string"><span class="delete"><span class="delete">&quot;security_binder_transaction s from to &#8801; hook_binder_transaction s from to&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_binder_transfer_binder</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658; Task &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span class="string"><span class="delete"><span class="delete">&quot;security_binder_transfer_binder s from to &#8801; hook_binder_transfer_binder s from to &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_binder_transfer_file</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658; Task &#8658;Files &#8658; (&#39;s, int) nondet_monad &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_binder_transfer_file s from to file &#8801; hook_binder_transfer_file s from to file&quot;</span></span></span><span>
</span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*ptrace*)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_ptrace_access_check</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658; nat &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_ptrace_access_check s child m &#8801; hook_ptrace_access_check s child m&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_ptrace_traceme</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>  
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_ptrace_traceme s parent&#39; &#8801; hook_ptrace_traceme s parent&#39;&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_syslog</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_syslog s type &#8801; hook_syslog s type&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;ima_bprm_check bprm = 0&quot;</span></span></span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*bprm*)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_bprm_set_creds</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;linux_binprm &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_bprm_set_creds s bprm &#8801; hook_bprm_set_creds s bprm&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_bprm_check</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;linux_binprm &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_bprm_check s bprm &#8801; do
         ret &#8592; hook_bprm_check s bprm;
         rc &#8592; (if ret &#8800; 0 then  return ret 
                else return (ima_bprm_check bprm));
         return rc
  od&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_bprm_committing_creds</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; linux_binprm &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_bprm_committing_creds s bprm &#8801; hook_bprm_committing_creds s bprm&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_bprm_committed_creds</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; linux_binprm &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_bprm_committed_creds s bprm &#8801; hook_bprm_committed_creds s bprm&quot;</span></span></span><span>
</span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* super_block *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sb_alloc</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; super_block &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sb_alloc s sb &#8801; hook_sb_alloc s sb &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sb_free</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; super_block &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sb_free s sb &#8801; hook_sb_free s sb&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sb_copy_data</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; string &#8658; string &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sb_copy_data s orig copy &#8801; hook_sb_copy_data s orig copy&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sb_remount</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;super_block &#8658; Void &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sb_remount s sb data &#8801; hook_sb_remount s sb data&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sb_kern_mount</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;super_block &#8658; int &#8658; string &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sb_kern_mount s sb flgs data &#8801; hook_sb_kern_mount s sb flgs data&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sb_show_options</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; seq_file &#8658; super_block &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sb_show_options s m sb &#8801; hook_sb_show_options s m sb&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sb_statfs</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sb_statfs s dentry &#8801; hook_sb_statfs s dentry&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sb_mount</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; string &#8658; path &#8658; string &#8658; int &#8658; Void &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sb_mount s dev_name path type flgs data &#8801; 
         hook_sb_mount s dev_name path type flgs data&quot;</span></span></span><span>    
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sb_umount</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;vfsmount &#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sb_umount s vmnt flgs &#8801; hook_sb_umount s vmnt flgs&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sb_pivotroot</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s&#8658;path &#8658;path &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sb_pivotroot s old_path new_path &#8801; hook_sb_pivotroot s old_path new_path&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sb_set_mnt_opts</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;super_block &#8658; opts &#8658; nat &#8658; nat &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sb_set_mnt_opts s sb opt kern_flags set_kern_flags &#8801; 
         hook_sb_set_mnt_opts s sb opt kern_flags set_kern_flags &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sb_clone_mnt_opts</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s&#8658;super_block &#8658; super_block&#8658; int &#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sb_clone_mnt_opts s oldsb newsb kern_flags set_kern_flags &#8801; 
         hook_sb_clone_mnt_opts s oldsb newsb kern_flags set_kern_flags&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sb_parse_opts_str</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s&#8658;string &#8658; opts &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sb_parse_opts_str s options opt &#8801; hook_sb_parse_opts_str s options opt &quot;</span></span></span><span>
</span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*inode *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>d_backing_inode</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658;  inode option&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;d_backing_inode s upper &#8801;((inodes s)(d_inode upper))&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>integrity_inode_free</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; inode &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;integrity_inode_free s inode &#8801; return()&quot;</span></span></span><span> 
</span><span>       
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_alloc</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;inode &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_alloc s inode &#8801; hook_inode_alloc s inode&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_free</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; inode &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_free s inode &#8801; do 
        integrity_inode_free s inode;
        hook_inode_free s inode
      od&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>evm_inode_init_security</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;inode &#8658; xattrs &#8658; xattrs&#8658;int&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;evm_inode_init_security inode xattr_array evm &#8801; 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>initxattrss</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;inode &#8658; xattrs list&#8658; string&#8658; int&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;initxattrss inode xattr_array fs_data &#8801; 1&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_init_security</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; inode &#8658; inode &#8658; string &#8658; initxattrs 
                                               &#8658; string &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_init_security s inode dir qstr initxattrs&#39; fsdata = do 
             new_xattrs &#8592; return(SOME x::xattrs list. True);
             lsm_xattr &#8592; return(SOME x::xattrs. True);
             evm_xattr &#8592; return(SOME x::xattrs. True);
             xattr &#8592; return(SOME x::xattr. True);
             rc &#8592; (if  unlikely (IS_PRIVATE inode) then return (0) 
                   else 
                        if initxattrs&#39; = 0 then 
                             (hook_inode_init_security s inode dir qstr &#39;&#39;&#39;&#39; &#39;&#39;&#39;&#39; 0)
                        else do
                               lsm_xattrs &#8592; return (new_xattrs);
                               lsm_xattr &#8592; return (lsm_xattrs ! 0);
                               ret &#8592; (hook_inode_init_security s inode dir qstr (xattr_name lsm_xattr) 
                                                (xattr_value lsm_xattr) (xattr_value_len lsm_xattr));
                                if ret &#8800; 0 then
                                      if ret = (-EOPNOTSUPP) then 
                                           return 0  
                                      else return ret
                                else do
                                       evm_xattr &#8592; return(lsm_xattrs ! 1);
                                       ret &#8592; return(evm_inode_init_security inode lsm_xattr evm_xattr);
                                       if ret &#8800; 0 then 
                                           if ret = (-EOPNOTSUPP) then 
                                                (return 0) 
                                           else return ret
                                        else
                                            do
                                              ret &#8592; return (initxattrss inode new_xattrs fsdata);
                                              if ret = (-EOPNOTSUPP) then (
                                                   return 0) 
                                              else return ret
                                            od  
                                     od
                             od
                      
                   );
             return rc
         od &quot;</span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_old_inode_init_security</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; inode &#8658; inode &#8658; qstr &#8658; string 
                                                   &#8658; string &#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_old_inode_init_security s inode dir qstr name value len&#39; &#8801; 
         hook_old_inode_init_security s inode dir qstr name value len&#39;&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_create</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; inode &#8658; dentry&#8658; mode &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_create s dir dentry m &#8801; 
         if unlikely (IS_PRIVATE dir) then 
             return 0
         else 
             hook_inode_create s dir dentry m&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_link</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; inode &#8658; dentry &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_link s old_dentry dir new_dentry &#8801;
         if unlikely (IS_PRIVATE (the(d_backing_inode s old_dentry))) then 
              return 0
         else 
             hook_inode_link s old_dentry dir new_dentry&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_unlink</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  inode &#8658; dentry &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_unlink s dir dentry &#8801;
        if unlikely (IS_PRIVATE (the(d_backing_inode s dentry))) then 
             return 0
        else 
             hook_inode_unlink s dir dentry&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_symlink</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  inode &#8658; dentry &#8658; string &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_symlink s dir dentry old_name &#8801; 
         if unlikely (IS_PRIVATE dir) then 
            return 0
         else 
            hook_inode_symlink s dir dentry old_name&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_mkdir</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; inode &#8658; dentry&#8658; mode &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_mkdir s dir dentry m &#8801; 
         if unlikely (IS_PRIVATE dir) then 
              return 0
         else 
              hook_inode_mkdir s dir dentry m&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_rmdir</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  inode &#8658; dentry&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_rmdir s dir dentry &#8801; 
         if unlikely (IS_PRIVATE (the(d_backing_inode s dentry))) then 
              return 0
         else 
              hook_inode_rmdir s dir dentry&quot;</span></span></span><span>
</span><span>   
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_mknod</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  inode &#8658; dentry &#8658; mode &#8658; dev_t&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_mknod s dir dentry m dev &#8801;  
         if unlikely (IS_PRIVATE dir) then 
              return 0
         else 
              hook_inode_mknod s dir dentry m dev&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_rename</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; inode &#8658; dentry &#8658; inode &#8658;dentry &#8658; flags 
                                        &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_rename s old_dir old_dentry new_dir new_dentry flgs &#8801; 
          if unlikely (IS_PRIVATE (the(d_backing_inode s old_dentry))) &#8744;
            ( (d_is_positive new_dentry) &#8743; IS_PRIVATE (the(d_backing_inode s old_dentry)) &#8800; 0)
          then return 0
          else if ((int flgs)  AND RENAME_EXCHANGE) &#8800; 0 then
              do
                 err &#8592; (hook_inode_rename s new_dir new_dentry old_dir old_dentry);
                 if err &#8800; 0 then 
                    return err 
                 else  (hook_inode_rename s  old_dir old_dentry new_dir new_dentry)
              od
              else
                (hook_inode_rename s  old_dir old_dentry new_dir new_dentry )&quot;</span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_readlink</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_readlink s dentry &#8801;
        if unlikely (IS_PRIVATE (the(d_backing_inode s dentry))) then 
             return 0
        else 
            hook_inode_readlink s dentry&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_follow_link</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; inode &#8658; bool &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_follow_link s dentry inode rcu&#39; &#8801; 
         if unlikely (IS_PRIVATE inode) then 
              return 0
         else 
              hook_inode_follow_link s dentry inode rcu&#39;&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_permission</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  inode &#8658; mask &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_permission s inode m &#8801; 
         if unlikely (IS_PRIVATE inode) then 
              return 0
         else 
              hook_inode_permission s inode m&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>evm_inode_setattr</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; iattr &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;evm_inode_setattr s dentry at &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_setattr</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; iattr &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_setattr s dentry attr&#39; &#8801; 
         if unlikely (IS_PRIVATE (the(d_backing_inode s dentry))) then
              return 0
         else do
                ret &#8592; hook_inode_setattr s dentry attr&#39;;
                if ret &#8800; 0 then 
                    return ret
                else  
                    evm_inode_setattr s dentry attr&#39;
              od&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_getattr</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; path &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_getattr s path &#8801;
         if unlikely (IS_PRIVATE (the(d_backing_inode s (p_dentry path)))) 
         then 
              return 0
         else 
              hook_inode_getattr s path&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>ima_inode_setxattr</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658;xattr &#8658;string &#8658;int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;ima_inode_setxattr s d x value flg &#8801; return 0 &quot;</span></span></span><span> 
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>evm_inode_setxattr</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658;xattr &#8658;string &#8658;int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;evm_inode_setxattr s d x value flg &#8801; return 0 &quot;</span></span></span><span> 
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_setxattr</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; xattr &#8658; string &#8658; int &#8658; flags 
                                          &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_setxattr s dentry name value size&#39; flgs &#8801; 
         if unlikely (IS_PRIVATE (the(d_backing_inode s dentry))) 
         then return 0
         else do
                ret &#8592; hook_inode_setxattr s dentry name value size&#39; flgs;
                if ret &#8800; 1 then  
                      cap_inode_setxattr s dentry name value size&#39; flgs
                else  if ret &#8800; 0 then 
                         return ret
                      else 
                         do
                            ret &#8592; ima_inode_setxattr s dentry name value size&#39;;
                            if ret &#8800; 0 then 
                               return ret 
                            else 
                               evm_inode_setxattr s dentry  name value size&#39;
                         od          
              od &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>evm_inode_post_setxattr</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658;xattr &#8658;string &#8658;int &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;evm_inode_post_setxattr s d x value flg &#8801; return () &quot;</span></span></span><span> 
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_post_setxattr</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; xattr &#8658; string &#8658; int &#8658; flags 
                                               &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_post_setxattr s dentry name value size&#39; flgs &#8801;
           if unlikely (IS_PRIVATE (the(d_backing_inode s dentry))) then 
              return ()
          else 
              do
              hook_inode_post_setxattr  s dentry name value size&#39; flgs; 
              evm_inode_post_setxattr  s dentry name value size&#39; 
              od&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_getxattr</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; xattr &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_getxattr s dentry name &#8801;
        if unlikely (IS_PRIVATE (the(d_backing_inode s dentry))) 
        then 
             return 0
        else 
             hook_inode_getxattr s dentry name &quot;</span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_listxattr</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry  &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_listxattr s dentry  &#8801;
        if unlikely (IS_PRIVATE (the(d_backing_inode s dentry))) 
        then 
             return 0
        else 
             hook_inode_listxattr s dentry  &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>current_user_ns</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; ns&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;current_user_ns s = user_ns (cred(the((k_task s) (current s))))&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span>  </span><span>privileged_wrt_inode_uidgid</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;ns &#8658; inode &#8658; bool&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot; privileged_wrt_inode_uidgid ns inode &#8801; 
         (kuid_has_mapping ns (i_uid inode))
         &#8743; (kgid_has_mapping ns (i_gid inode))&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>capable_wrt_inode_uidgid</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; inode &#8658; int&#8658;bool&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;capable_wrt_inode_uidgid s inode cap &#8801; 
          let  ns = current_user_ns s 
          in (ns_capable ns cap) &#8743;  privileged_wrt_inode_uidgid ns inode&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>cap_inode_removexattr</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658;xattr &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;cap_inode_removexattr s dentry name  &#8801; do
         ns &#8592; return (s_user_ns (d_sb dentry));
         rc &#8592; (if name = XATTR_SECURITY_PREFIX 
                then 
                    return 0 
                else
                     if name = XATTR_NAME_CAPS then 
                  do
                    inode &#8592; return ((d_backing_inode s dentry));
                    if inode = None then 
                        return(-EINVAL) 
                    else
                        if &#172;(capable_wrt_inode_uidgid s (the inode) CAP_SETFCAP) then 
                            return(-EPERM)
                        else 
                            return 0
                   od 
                else 
                if &#172;(ns_capable ns CAP_SYS_ADMIN) 
                then 
                    return (-EPERM)
                else
                return 0
             );
         return(rc)
        od&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>ima_inode_removexattr</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;dentry &#8658; xattr &#8658; int&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;ima_inode_removexattr dentry name &#8801; 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>evm_inode_removexattr</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;dentry &#8658; xattr &#8658; int&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;evm_inode_removexattr dentry name &#8801; 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_removexattr</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; xattr &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_removexattr s dentry name &#8801;  
             if unlikely (IS_PRIVATE (the(d_backing_inode s dentry))) then return 0
             else do 
                    ret &#8592; hook_inode_removexattr s dentry name;
                    rc &#8592;if ret = 1 then 
                              cap_inode_removexattr s dentry name 
                         else if ret &#8800; 0 then 
                                   return ret 
                              else do
                                      ret &#8592; return(ima_inode_removexattr  dentry name);
                                      if ret &#8800; 0 then 
                                          return ret 
                                      else 
                                          return(evm_inode_removexattr  dentry name)
                                   od ;
                    return rc
                  od &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_need_killpriv</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_need_killpriv s dentry &#8801; hook_inode_need_killpriv s dentry&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_killpriv</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_killpriv s dentry &#8801; hook_inode_killpriv s dentry&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_getsecurity</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  inode &#8658; xattr &#8658; Void &#8658; bool &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_getsecurity s inode name buffer alloc  &#8801; 
            if unlikely (IS_PRIVATE (inode)) then return (-EOPNOTSUPP)
            else do
                   rc &#8592; hook_inode_getsecurity s inode name buffer alloc;
                   if rc &#8800; (-EOPNOTSUPP) 
                   then 
                        return rc
                   else 
                        return(-EOPNOTSUPP)
                 od &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_setsecurity</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; inode &#8658; xattr &#8658; Void &#8658; nat&#8658; int 
                                             &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_setsecurity s inode name value size&#39; flgs &#8801; 
         if unlikely (IS_PRIVATE (inode)) 
         then 
            return (-EOPNOTSUPP)
        else do
               rc &#8592; hook_inode_setsecurity s inode name value size&#39; flgs ;
               if rc &#8800; (-EOPNOTSUPP) 
               then 
                    return rc
               else 
                    return(-EOPNOTSUPP)
             od &quot;</span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_listsecurity</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  inode &#8658; Void &#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_listsecurity s inode buffer bsize  &#8801;
        if unlikely (IS_PRIVATE (inode)) 
        then 
             return 0
        else 
            hook_inode_listsecurity s inode buffer bsize&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_getsecid</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; inode &#8658; u32 &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_getsecid  s inode secid&#39; &#8801; hook_inode_getsecid  s inode secid&#39;&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_copy_up</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; Cred option &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_copy_up  s src new &#8801; hook_inode_copy_up  s src new&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_copy_up_xattr</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; xattr &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_copy_up_xattr  s name &#8801; hook_inode_copy_up_xattr  s name&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_invalidate_secctx</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  inode &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_invalidate_secctx s inode &#8801; hook_inode_invalidate_secctx s inode&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_notifysecctx</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  inode &#8658; string &#8658; u32&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_notifysecctx s inode ctx ctxlen &#8801; hook_inode_notifysecctx s inode ctx ctxlen&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_setsecctx</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; string &#8658; u32&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_setsecctx s dentry ctx ctxlen &#8801; hook_inode_setsecctx s dentry ctx ctxlen &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_getsecctx</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; inode &#8658; string &#8658; u32&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_getsecctx s dentry ctx ctxlen &#8801; hook_inode_getsecctx s dentry ctx ctxlen &quot;</span></span></span><span>
</span><span>
</span><span>
</span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*task*)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_task_alloc</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658; nat &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_task_alloc s task clone_flags &#8801; hook_task_alloc s task clone_flags&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_task_free</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658;  (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_task_free s task &#8801; hook_task_free s task&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_cred_alloc_blank</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Cred &#8658; nat &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_cred_alloc_blank s cred&#39; gfp&#39; &#8801; hook_cred_alloc_blank s cred&#39; gfp&#39;&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_cred_free</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Cred &#8658;  (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_cred_free s cred&#39; &#8801; hook_cred_free s cred&#39;&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_prepare_creds</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Cred &#8658; Cred &#8658; nat &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_prepare_creds s new old gfp&#39; &#8801; hook_prepare_creds s new old gfp&#39;&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_transfer_creds</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Cred &#8658; Cred &#8658;  (&#39;s, unit) nondet_monad&quot;</span></span></span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_transfer_creds s new old &#8801; hook_transfer_creds s new old &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_cred_getsecid</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Cred &#8658; u32 &#8658;  (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_cred_getsecid s c secid&#39; &#8801; do 
         secid &#8592; return 0;
         hook_cred_getsecid s c secid
  od&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_task_fix_setuid</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Cred &#8658; Cred &#8658; int &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_task_fix_setuid s new old flgs &#8801; hook_task_fix_setuid s new old flgs&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_task_setpgid</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658; pid_t &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_task_setpgid s p pgid &#8801; hook_task_setpgid s p pgid&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_task_getpgid</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_task_getpgid s p &#8801; hook_task_getpgid s p&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_task_getsid</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_task_getsid s p &#8801; hook_task_getsid s p&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_task_getsecid</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658; u32 &#8658;  (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_task_getsecid s c secid&#39; &#8801; do 
         secid &#8592; return 0;
         hook_task_getsecid s c secid
  od&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_task_setnice</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658; int &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_task_setnice s p nice &#8801; hook_task_setnice s p nice&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_task_setioprio</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658; int &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_task_setioprio s p ioprio &#8801; hook_task_setioprio s p ioprio &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_task_getioprio</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_task_getioprio s p &#8801; hook_task_getioprio s p&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_task_prlimit</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Cred &#8658; Cred &#8658; nat &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_task_prlimit s cred&#39; tcred flgs &#8801; hook_task_prlimit s cred&#39; tcred flgs&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_task_setrlimit</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658; nat &#8658; rlimit &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_task_setrlimit s p res new_rlim &#8801; hook_task_setrlimit s p res new_rlim&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_task_setscheduler</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task  &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span class="string"><span class="delete"><span class="delete">&quot;security_task_setscheduler s p &#8801; hook_task_setscheduler s p&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_task_getscheduler</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task  &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_task_getscheduler s p &#8801; hook_task_getscheduler s p&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_task_movememory</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task  &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_task_movememory s p &#8801; hook_task_movememory s p&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_task_kill</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658; siginfo &#8658; int &#8658; Cred option &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_task_kill s t info sig c &#8801; hook_task_kill s t info sig c&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_task_prctl</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; int &#8658; nat &#8658; nat &#8658;nat &#8658; nat &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_task_prctl s opt arg2 arg3 arg4 arg5 &#8801; do
         rc &#8592; return(-ENOSYS);
         thisrc &#8592;hook_task_prctl s opt arg2 arg3 arg4 arg5;
         if thisrc &#8800; (-ENOSYS) 
         then 
              return thisrc
         else 
              return rc
  od&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_task_to_inode</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658;  inode  &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_task_to_inode s p inode &#8801; hook_task_to_inode s p inode&quot;</span></span></span><span>
</span><span>
</span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*ipc &amp;msg*)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_ipc_permission</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  kern_ipc_perm &#8658; nat &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_ipc_permission s ipcp flg &#8801; hook_ipc_permission s ipcp flg&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_ipc_getsecid</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; kern_ipc_perm &#8658; u32 &#8658;  (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_ipc_getsecid s ipcp secid&#39; &#8801; do
        secid &#8592; return 0;
        hook_ipc_getsecid s ipcp secid
  od&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_msg_msg_alloc</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  msg_msg &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_msg_msg_alloc s msg &#8801; hook_msg_msg_alloc s msg&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_msg_msg_free</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; msg_msg &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_msg_msg_free s msg &#8801; hook_msg_msg_free s msg&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_msg_queue_alloc</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; kern_ipc_perm &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_msg_queue_alloc s msq &#8801; hook_msg_queue_alloc s msq&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_msg_queue_free</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; kern_ipc_perm &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_msg_queue_free s msq &#8801; hook_msg_queue_free s msq&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_msg_queue_associate</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; kern_ipc_perm &#8658; int&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_msg_queue_associate s msq msqflg &#8801; hook_msg_queue_associate s msq msqflg&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_msg_queue_msgctl</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  kern_ipc_perm &#8658; IPC_CMD&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_msg_queue_msgctl s msq cmd &#8801; hook_msg_queue_msgctl s msq cmd&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_msg_queue_msgsnd</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; kern_ipc_perm &#8658;  msg_msg &#8658; int&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_msg_queue_msgsnd s msq msg msqflg &#8801; hook_msg_queue_msgsnd s msq msg msqflg&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_msg_queue_msgrcv</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; kern_ipc_perm &#8658; msg_msg&#8658; Task &#8658; int 
                                             &#8658; int&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_msg_queue_msgrcv s msq msg target type m &#8801; 
         hook_msg_queue_msgrcv s msq msg target type m&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_shm_alloc</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  kern_ipc_perm &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_shm_alloc s shp &#8801; hook_shm_alloc s shp&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_shm_free</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  kern_ipc_perm &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_shm_free s shp &#8801; hook_shm_free s shp&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_shm_associate</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; kern_ipc_perm &#8658; int&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_shm_associate s shp shmflg &#8801; hook_shm_associate s shp shmflg &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_shm_shmctl</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  kern_ipc_perm &#8658; IPC_CMD&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_shm_shmctl s shp cmd &#8801; hook_shm_shmctl s shp cmd &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_shm_shmat</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; kern_ipc_perm &#8658;string &#8658;int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_shm_shmat s shp shmaddr shmflg &#8801; hook_shm_shmat s shp shmaddr shmflg&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sem_alloc</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  kern_ipc_perm &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sem_alloc s sma &#8801; hook_sem_alloc s sma&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sem_free</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  kern_ipc_perm &#8658;  (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sem_free s sma &#8801; hook_sem_free s sma&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sem_associate</span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; kern_ipc_perm &#8658; int&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sem_associate s sma semflg &#8801; hook_sem_associate s sma semflg &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sem_semctl</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  kern_ipc_perm &#8658; IPC_CMD&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sem_semctl s sma cmd &#8801; hook_sem_semctl s sma cmd&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sem_semop</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; kern_ipc_perm &#8658;sembuf&#8658;nat &#8658; int&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sem_semop s sma sops nsops alter &#8801; hook_sem_semop s sma sops nsops alter&quot;</span></span></span><span>
</span><span>
</span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* file *)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>file_inode</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;Files &#8658;  inode&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;file_inode f &#8801; f_inode f&quot;</span></span></span><span> 
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*  simple call site for access decisions *)</span></span></span></span></span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*
definition  fsnotify_perm:: &quot;&#39;s &#8658; Files &#8658; mask &#8658;(&#39;s, int) nondet_monad&quot;
  where &quot;fsnotify_perm s file m &#8801; do 
          path &#8592; return(f_path file);
          inode &#8592; return(file_inode file);
          fsnotify_mask  &#8592; (return 0);
          rc &#8592; (if ((f_mode file AND  FMODE_NONOTIFY) &#8800; 0) &#8744; ((m AND (bitOR MAY_READ MAY_OPEN)) = 0) 
                then return 0 else 
          do 
           fsnotify_mask &#8592; (if (m AND MAY_OPEN) &#8800; 0then return FS_OPEN_PERM 
                             else if (m AND MAY_READ) &#8800; 0 then return FS_ACCESS_PERM else return fsnotify_mask);
           return 0
         od);
          return(rc)
        od &quot;
*)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span>  </span><span>fsnotify_perm</span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files &#8658; mask &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;fsnotify_perm s file m &#8801; do 
          path &#8592; return(f_path file);
          inode &#8592; return(file_inode file);        
          return(0)
        od &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_file_permission</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files&#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_file_permission s file mask&#39; &#8801;do
               ret &#8592; hook_file_permission s file mask&#39; ;
               if ret &#8800; 0 then  return ret 
               else fsnotify_perm s file mask&#39;
      od&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_file_alloc</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_file_alloc s file &#8801; hook_file_alloc s file&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_file_free</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_file_free s file &#8801; hook_file_free s file&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_file_ioctl</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files&#8658; IOC_DIR &#8658; nat &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_file_ioctl s file cmd arg &#8801; hook_file_ioctl s file cmd arg&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>mmap_capabilities</span><span> </span><span class="delimiter">::</span><span class="string"><span class="delete"><span class="delete">&quot;Files &#8658; nat&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;mmap_capabilities f &#8801; 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>mmap_prot_mmu</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;Files &#8658; nat&#8658; nat&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;mmap_prot_mmu f prot &#8801;
                        if CONFIG_MMU then
                               let 
                                  fop = f_op f;
                                  caps = mmap_capabilities f
                               in 
                                if fop = fop_mmap_capabilities then 
                                if &#172;((caps AND NOMMU_MAP_EXEC) &#8800; 0) 
                                then prot 
                                else 
                                    nat(bitOR (int prot) PROT_EXEC)
                                else 
                                    nat(bitOR (int prot) PROT_EXEC)
                        else 
                          nat(bitOR (int prot) PROT_EXEC) &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>mmap_prot</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files option &#8658; nat &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;mmap_prot s file&#39; prot &#8801; do
            flag1 &#8592; return(((int prot) AND (bitOR PROT_READ PROT_EXEC)) &#8800; PROT_READ );
            personality &#8592;  return(personality (the((k_task s)(current s))));
            flag2 &#8592; return((personality AND READ_IMPLIES_EXEC) = 0);
            rc &#8592; (if flag1 &#8744; flag2 then 
                       return (int prot) 
                  else if file&#39; &#8800; None 
                       then return(bitOR (int prot) PROT_EXEC)
                       else if &#172;(path_noexec (f_path (the file&#39;))) then
                            return(int (mmap_prot_mmu (the file&#39;) prot))
                       else 
                            return((int prot))
                  );
            return rc
        od&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>ima_file_mmap</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;Files &#8658; nat &#8658; int&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;ima_file_mmap file prot &#8801; 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_mmap_file</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files &#8658; nat &#8658; nat &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_mmap_file s file prot flgs &#8801; do 
              mprot &#8592; mmap_prot s (Some file) flgs;
              ret &#8592; hook_mmap_file s (Some file)  prot (nat mprot) flgs;
              if ret &#8800; 0 then 
                return ret
              else 
                return(ima_file_mmap file prot)
        od&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_mmap_addr</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; nat &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_mmap_addr s addr &#8801; hook_mmap_addr s addr&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_file_mprotect</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; vm_area_struct&#8658; nat &#8658; nat &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_file_mprotect s vma reqprot prot &#8801; hook_file_mprotect s vma reqprot prot&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_file_lock</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files&#8658; nat  &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_file_lock s file cmd &#8801; hook_file_lock s file cmd&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_file_fcntl</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files&#8658; nat &#8658; nat &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_file_fcntl s file cmd arg &#8801; hook_file_fcntl s file cmd arg&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_file_set_fowner</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files&#8658;  (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_file_set_fowner s file &#8801; hook_file_set_fowner s file&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_file_send_sigiotask</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task&#8658; fown_struct &#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_file_send_sigiotask s tsk&#39; fown sig &#8801; hook_file_send_sigiotask s tsk&#39; fown sig&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_file_receive</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files&#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_file_receive s file &#8801; hook_file_receive s file&quot;</span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_file_open</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files&#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_file_open s file &#8801; do
         ret &#8592; (hook_file_open s file);
         rc &#8592; (if ret &#8800; 0 then 
                  return ret 
                else (fsnotify_perm s file MAY_OPEN));
         return rc       
  od&quot;</span></span></span><span>
</span><span>
</span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*kernel*)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_kernel_act_as</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Cred &#8658; u32 &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_kernel_act_as s new secid&#39; &#8801; hook_kernel_act_as s new secid&#39;&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_kernel_create_files_as</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Cred &#8658;  inode &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_kernel_create_files_as s new inode &#8801; hook_kernel_create_files_as s new inode&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>integrity_kernel_module_request</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; string &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;integrity_kernel_module_request s name &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_kernel_module_request</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; string &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_kernel_module_request s name &#8801; do 
        ret &#8592; hook_kernel_module_request s name;
        if ret &#8800; 0 then 
           return ret
        else 
           integrity_kernel_module_request s name
   od&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>ima_load_data</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; kernel_load_data_id &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;ima_load_data s  kid &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_kernel_load_data</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; kernel_load_data_id &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_kernel_load_data s  kid &#8801; do 
        ret &#8592; hook_kernel_load_data s  kid;
        if ret &#8800; 0 then 
          return ret
        else 
          ima_load_data s  kid
   od&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>ima_read_file</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files &#8658;kernel_read_file_id  &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;ima_read_file s file kid &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_kernel_read_file</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files &#8658;kernel_read_file_id 
                                             &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_kernel_read_file s file kid &#8801; do 
        ret &#8592; hook_kernel_read_file s file kid;
        if ret &#8800; 0 then 
             return ret
        else 
             ima_read_file s file kid
   od&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>ima_post_read_file</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files &#8658; string &#8658; nat &#8658; kernel_read_file_id 
                                      &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;ima_post_read_file s file buf size&#39; kid &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_kernel_post_read_file</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files &#8658; string &#8658; nat &#8658; kernel_read_file_id 
                                                   &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_kernel_post_read_file s file buf size&#39; kid &#8801; do 
        ret &#8592; hook_kernel_post_read_file s file buf size&#39; kid;
        if ret &#8800; 0 then 
             return ret
        else 
             ima_post_read_file s file buf size&#39; kid
    od&quot;</span></span></span><span>
</span><span>
</span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*dentry*)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_dentry_init_security</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; mode &#8658; string &#8658; string &#8658; int 
                                                &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_dentry_init_security s dentry m name ctx xtxlen &#8801; 
         hook_dentry_init_security s dentry m name ctx xtxlen&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_dentry_create_files_as</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; mode &#8658; string &#8658; Cred &#8658; Cred 
                                                  &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_dentry_create_files_as s dentry m name old new &#8801; 
         hook_dentry_create_files_as s dentry m name old new&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_d_instantiate</span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; inode &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_d_instantiate s dentry inode &#8801; 
        if unlikely (IS_PRIVATE (inode)) then 
             return ()
        else 
             hook_d_instantiate s dentry (Some inode)&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_getprocattr</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658; string &#8658; string &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_getprocattr s p name value &#8801; hook_getprocattr s p name value&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_setprocattr</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; string &#8658; string &#8658; int&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_setprocattr s name value size&#39; &#8801; hook_setprocattr s name value size&#39;&quot;</span></span></span><span>
</span><span>
</span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* network *)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_netlink_send</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  sock &#8658; sk_buff&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_netlink_send s sk&#39; skb &#8801; hook_netlink_send s sk&#39; skb &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_ismaclabel</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; xattr&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_ismaclabel s name &#8801; hook_ismaclabel s name&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_secid_to_secctx</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; u32 &#8658;string  &#8658; u32 &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_secid_to_secctx s secid&#39; secdata seclen &#8801; 
         hook_secid_to_secctx s secid&#39; secdata seclen &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_secctx_to_secid</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; string &#8658; u32&#8658; u32&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_secctx_to_secid s secdata seclen secid&#39; &#8801; do
         secid &#8592; return 0;
         hook_secctx_to_secid s secdata seclen secid
    od&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_release_secctx</span><span> </span><span class="delimiter">::</span><span>   </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; string &#8658; u32&#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_release_secctx s secdata seclen &#8801; hook_release_secctx s secdata seclen&quot;</span></span></span><span>
</span><span> 
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_unix_stream_connect</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; sock &#8658; sock &#8658; sock &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_unix_stream_connect s sock other newsk &#8801; hook_unix_stream_connect  s sock other newsk&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_unix_may_send</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  socket &#8658;  socket &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_unix_may_send s sock other &#8801; hook_unix_may_send s sock other&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_socket_create</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Sk_Family &#8658; int &#8658; int &#8658;int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_create s family type pro kern &#8801; hook_socket_create s family type pro kern &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_socket_post_create</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; socket &#8658; Sk_Family &#8658; int &#8658; int &#8658; int 
                                               &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_post_create s sock family type pro kern &#8801; 
         hook_socket_post_create s sock family type pro kern&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_socket_socketpair</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; socket &#8658;  socket &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_socketpair s socka sockb &#8801; hook_socket_socketpair s socka sockb&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_socket_bind</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; socket &#8658; sockaddr &#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_bind s sock address addrlen &#8801; hook_socket_bind s sock address addrlen&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_socket_connect</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; socket &#8658; sockaddr &#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_connect s sock address addrlen &#8801; hook_socket_connect s sock address addrlen&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_socket_listen</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  socket  &#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_listen s sock backlog &#8801; hook_socket_listen s sock backlog&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_socket_accept</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  socket &#8658; socket  &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_accept s sock newsock &#8801; hook_socket_accept s sock newsock&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_socket_sendmsg</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  socket &#8658; msghdr &#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_sendmsg s sock msg size&#39; &#8801; hook_socket_sendmsg s sock msg size&#39;&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_socket_recvmsg</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  socket &#8658; msghdr &#8658; int &#8658; int&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_recvmsg s sock msg size&#39; flgs &#8801; hook_socket_recvmsg s sock msg size&#39; flgs&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_socket_getsockname</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; socket  &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_getsockname s sock &#8801; hook_socket_getsockname s sock&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_socket_getpeername</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  socket  &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_getpeername s sock &#8801; hook_socket_getpeername s sock&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_socket_getsockopt</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  socket  &#8658;int &#8658; int&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_getsockopt s sock level&#39; optname &#8801; 
         hook_socket_getsockopt s sock level&#39; optname &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_socket_setsockopt</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  socket &#8658;int &#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_setsockopt s sock level&#39; optname &#8801; 
         hook_socket_setsockopt s sock level&#39; optname&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_socket_shutdown</span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  socket &#8658;int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_shutdown s sock how &#8801; hook_socket_shutdown s sock how&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sock_rcv_skb</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  sock &#8658;sk_buff  &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sock_rcv_skb s sock skb &#8801; hook_sock_rcv_skb s sock skb&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_socket_getpeersec_stream</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; socket &#8658; string &#8658;int &#8658; nat 
                                                     &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_getpeersec_stream s sock optval optlen len&#39; &#8801; 
         hook_socket_getpeersec_stream s sock optval optlen len&#39; &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_socket_getpeersec_dgram</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; socket &#8658; sk_buff option&#8658; u32 
                                                    &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_getpeersec_dgram s sock skb secid&#39; &#8801; 
         hook_socket_getpeersec_dgram s sock skb secid&#39; &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sk_alloc</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; sock &#8658; int &#8658; gfp_t &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sk_alloc s sk&#39; family priority &#8801; hook_sk_alloc s sk&#39; family priority&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sk_free</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; sock &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sk_free s sock &#8801; hook_sk_free s sock&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sk_clone</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; sock &#8658; sock &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sk_clone s sk&#39; newsk &#8801; hook_sk_clone s sk&#39; newsk&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sk_classify_flow</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; sock &#8658; flowi &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sk_classify_flow s sock&#39; fl &#8801; hook_sk_classify_flow s sock&#39; fl&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_req_classify_flow</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; request_sock&#8658; flowi &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_req_classify_flow s req fl &#8801; hook_req_classify_flow s req fl&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sock_graft</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; sock &#8658; socket &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sock_graft s sk&#39; parent&#39; &#8801; hook_sock_graft s sk&#39; parent&#39;&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inet_conn_request</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; sock &#8658; sk_buff &#8658;request_sock 
                                              &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inet_conn_request s sk&#39; skb req &#8801; hook_inet_conn_request s sk&#39; skb req&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inet_csk_clone</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  sock &#8658; request_sock &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inet_csk_clone s newsk req &#8801; hook_inet_csk_clone s newsk req&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inet_conn_established</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; sock &#8658; sk_buff &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inet_conn_established s sk&#39; skb &#8801; hook_inet_conn_established s sk&#39; skb&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_secmark_relabel_packet</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; u32 &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_secmark_relabel_packet s secid&#39; &#8801; hook_secmark_relabel_packet s secid&#39;&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_secmark_refcount_inc</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_secmark_refcount_inc s &#8801; hook_secmark_refcount_inc s&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_secmark_refcount_dec</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span class="string"><span class="delete"><span class="delete">&quot;security_secmark_refcount_dec s &#8801; hook_secmark_refcount_dec s&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_tun_dev_alloc_security</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; &#39;h&#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_tun_dev_alloc_security s security &#8801; hook_tun_dev_alloc_security s security&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_tun_dev_free_security</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; &#39;h &#8658;(&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_tun_dev_free_security s security &#8801; hook_tun_dev_free_security s security&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_tun_dev_create</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span class="string"><span class="delete"><span class="delete">&quot;security_tun_dev_create s &#8801; hook_tun_dev_create s &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_tun_dev_attach_queue</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; &#39;h &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_tun_dev_attach_queue s security &#8801; hook_tun_dev_attach_queue s security&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_tun_dev_attach</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; sock&#8658; &#39;h &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_tun_dev_attach s sk&#39; security &#8801; hook_tun_dev_attach s sk&#39; security&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_tun_dev_open</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; &#39;h &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span class="string"><span class="delete"><span class="delete">&quot;security_tun_dev_open s security &#8801; hook_tun_dev_open s security&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sctp_assoc_request</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; sctp_endpoint &#8658; sk_buff &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sctp_assoc_request s ep skb &#8801; hook_sctp_assoc_request s ep skb&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sctp_bind_connect</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; sock &#8658; int &#8658; sockaddr &#8658;int &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sctp_bind_connect s sk&#39; optname address addrlen &#8801; 
         hook_sctp_bind_connect s sk&#39; optname address addrlen&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sctp_sk_clone</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; sctp_endpoint &#8658; sock &#8658;  sock &#8658;(&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sctp_sk_clone s ep sk&#39; newsk &#8801; hook_sctp_sk_clone s ep sk&#39; newsk&quot;</span></span></span><span>
</span><span>
</span><span>   </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* ib *)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_ib_pkey_access</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; &#39;i &#8658; nat &#8658; nat  &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_ib_pkey_access s sec subnet_prefix pkey &#8801; 
         hook_ib_pkey_access s sec subnet_prefix pkey&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_ib_endport_manage_subnet</span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; &#39;i &#8658; string &#8658; nat  &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_ib_endport_manage_subnet s sec dev_name port_num &#8801; 
         hook_ib_endport_manage_subnet s sec dev_name port_num&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_ib_alloc_security</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; &#39;i list &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_ib_alloc_security s sec &#8801; hook_ib_alloc_security s sec&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_ib_free_security</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; &#39;i list &#8658;  (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_ib_free_security s sec &#8801; hook_ib_free_security s sec&quot;</span></span></span><span>
</span><span>
</span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* lsm path *)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_path_unlink</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; path &#8658; dentry &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_path_unlink s dir dentry &#8801; 
           if unlikely (IS_PRIVATE (the(d_backing_inode s (p_dentry dir)))) 
           then 
              return 0
           else 
              hook_path_unlink s dir dentry&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_path_mkdir</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; path &#8658; dentry &#8658;nat &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_path_mkdir s dir dentry m &#8801;
           if unlikely (IS_PRIVATE (the(d_backing_inode s (p_dentry dir)))) 
           then 
                return 0
           else 
                hook_path_mkdir s dir dentry m
         &quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_path_rmdir</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; path &#8658; dentry &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_path_rmdir s dir dentry  &#8801;
           if unlikely (IS_PRIVATE (the(d_backing_inode s (p_dentry dir)))) 
           then 
                return 0
           else 
                hook_path_rmdir s dir dentry &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_path_mknod</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; path &#8658; dentry &#8658;nat &#8658; nat&#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_path_mknod s dir dentry m  dev&#8801;
           if unlikely (IS_PRIVATE (the(d_backing_inode s (p_dentry dir)))) 
           then return 0
           else hook_path_mknod s dir dentry m dev&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_path_truncate</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; path &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_path_truncate s dir   &#8801;
           if unlikely (IS_PRIVATE (the(d_backing_inode s (p_dentry dir)))) 
           then 
                return 0
           else 
                hook_path_truncate s dir &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_path_symlink</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; path &#8658; dentry &#8658; string &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_path_symlink s dir dentry old_name  &#8801;
           if unlikely (IS_PRIVATE (the(d_backing_inode s (p_dentry dir))))
           then 
                return 0
           else 
                hook_path_symlink s dir dentry old_name  &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_path_link</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; dentry &#8658;path &#8658; dentry &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_path_link s old_dentry new_dir new_dentry  &#8801;
           if unlikely (IS_PRIVATE (the(d_backing_inode s ( old_dentry)))) 
           then 
                return 0
           else 
                hook_path_link s old_dentry new_dir new_dentry  &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_path_rename</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; path &#8658; dentry &#8658; path &#8658; dentry &#8658; nat 
                                         &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_path_rename s old_dir old_dentry new_dir new_dentry flgs &#8801; 
          if unlikely (IS_PRIVATE (the(d_backing_inode s old_dentry))) &#8744;
            ( (d_is_positive new_dentry) &#8743; IS_PRIVATE (the(d_backing_inode s new_dentry)) &#8800; 0)
          then 
               return 0
          else if (((int flgs)  AND RENAME_EXCHANGE) &#8800; 0) then
              do
                 err &#8592; (hook_path_rename s new_dir new_dentry old_dir old_dentry);
                 if err &#8800; 0 then 
                       return err 
                 else  
                       (hook_path_rename s  old_dir old_dentry new_dir new_dentry)
              od
              else
                (hook_path_rename s  old_dir old_dentry new_dir new_dentry)&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_path_chmod</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; path &#8658; nat&#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_path_chmod s path m   &#8801;
           if unlikely (IS_PRIVATE (the(d_backing_inode s (p_dentry path)))) 
           then 
                return 0
           else 
                hook_path_chmod s path m &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_path_chown</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; path &#8658; kuid_t &#8658; kgid_t &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_path_chown s path uid&#39; gid&#39;   &#8801;
           if unlikely (IS_PRIVATE (the(d_backing_inode s (p_dentry path)))) 
           then return 0
           else hook_path_chown s path uid&#39; gid&#39; &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_path_chroot</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; path &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_path_chroot s path &#8801; hook_path_chroot s path&quot;</span></span></span><span>
</span><span>
</span><span>
</span><span>  </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* lsm keys *)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_key_alloc</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; key &#8658; Cred &#8658; nat &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_key_alloc s key&#39; c flgs &#8801;  hook_key_alloc s key&#39; c flgs&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_key_free</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; key &#8658;(&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_key_free s key&#39; &#8801; hook_key_free s key&#39;&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_key_permission</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; key_ref_t &#8658; Cred &#8658; nat &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_key_permission s key_ref c perm &#8801; hook_key_permission s key_ref c perm&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_key_getsecurity</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; key &#8658; string &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_key_getsecurity s key&#39; buffer &#8801; hook_key_getsecurity s key&#39; buffer&quot;</span></span></span><span>
</span><span>
</span><span>
</span><span>  </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* lsm audit_krule *)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_audit_rule_init</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; nat &#8658; enum_audit &#8658; string &#8658; string 
                                             &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_audit_rule_init s field op rulestr lsmrule &#8801;  
         hook_audit_rule_init s field op rulestr lsmrule &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_audit_rule_known</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; audit_krule &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_audit_rule_known s krule &#8801; hook_audit_rule_known s krule&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_audit_rule_match</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; nat &#8658; nat &#8658; enum_audit &#8658; string &#8658; audit_context 
                                              &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_audit_rule_match s secid&#39; field op lsmrule actx &#8801; 
         hook_audit_rule_match s secid&#39; field op lsmrule actx &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_audit_rule_free</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; string &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_audit_rule_free s lsmrule &#8801; hook_audit_rule_free s lsmrule&quot;</span></span></span><span>
</span><span>
</span><span>
</span><span>  </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* lsm network_xfrm *)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_xfrm_policy_alloc</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; xfrm_sec_ctx &#8658; xfrm_user_sec_ctx &#8658; gfp_t 
                                             &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_xfrm_policy_alloc s ctxp sec_ctx gfp&#39; &#8801; hook_xfrm_policy_alloc s ctxp sec_ctx gfp&#39;&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_xfrm_policy_clone</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; xfrm_sec_ctx &#8658; xfrm_user_sec_ctx 
                                             &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_xfrm_policy_clone s old_ctx new_ctxp &#8801; hook_xfrm_policy_clone s old_ctx new_ctxp &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_xfrm_policy_free</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; xfrm_sec_ctx &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_xfrm_policy_free s ctx &#8801; hook_xfrm_policy_free s ctx&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_xfrm_policy_delete</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; xfrm_sec_ctx &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_xfrm_policy_delete s ctx &#8801; hook_xfrm_policy_delete s ctx&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_xfrm_state_alloc</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; xfrm_state &#8658; xfrm_sec_ctx &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_xfrm_state_alloc s x sec_ctx &#8801; hook_xfrm_state_alloc s x sec_ctx&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_xfrm_state_alloc_acquire</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; xfrm_state &#8658; xfrm_sec_ctx &#8658; u32 
                                                    &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_xfrm_state_alloc_acquire s x plosec secid&#39; &#8801; 
         hook_xfrm_state_alloc_acquire s x plosec secid&#39; &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_xfrm_state_delete</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; xfrm_state  &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_xfrm_state_delete s x &#8801; hook_xfrm_state_delete s x&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_xfrm_state_free</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; xfrm_state  &#8658;(&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_xfrm_state_free s x &#8801; hook_xfrm_state_free s x&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_xfrm_policy_lookup</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; xfrm_sec_ctx &#8658; u32 &#8658; u8 &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_xfrm_policy_lookup s ctx fl_secid dir &#8801; hook_xfrm_policy_lookup s ctx fl_secid dir&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_xfrm_state_pol_flow_match</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; xfrm_state &#8658; xfrm_policy &#8658; flowi 
                                                     &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_xfrm_state_pol_flow_match s x xp fl&#8801; return 1&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_xfrm_decode_session</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; sk_buff &#8658; u32 &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_xfrm_decode_session s skb secid&#39; &#8801; hook_xfrm_decode_session s skb 1&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_skb_classify_flow</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; sk_buff &#8658; flowi &#8658;(&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_skb_classify_flow s skb fl &#8801; hook_skb_classify_flow s skb fl&quot;</span></span></span><span>
</span><span>
</span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* lsm bpf *)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_bpf</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; int &#8658; bpf_attr &#8658; nat  &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_bpf s cmd attr&#39; size&#39; &#8801; hook_bpf s cmd attr&#39; size&#39;  &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_bpf_map</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; bpf_map &#8658; mode  &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_bpf_map s bmap fmode &#8801; hook_bpf_map s bmap fmode&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_bpf_prog</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; bpf_prog &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_bpf_prog s prog &#8801; hook_bpf_prog s prog&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_bpf_map_alloc</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; bpf_map  &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_bpf_map_alloc s bmap &#8801; hook_bpf_map_alloc s bmap &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_bpf_map_free</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; bpf_map  &#8658;(&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_bpf_map_free s bmap &#8801; hook_bpf_map_free s bmap &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_bpf_prog_alloc</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; bpf_prog_aux  &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_bpf_prog_alloc s aux&#39; &#8801; hook_bpf_prog_alloc s aux&#39;&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_bpf_prog_free</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; bpf_prog_aux  &#8658;(&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_bpf_prog_free s aux&#39; &#8801; hook_bpf_prog_free s aux&#39; &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249; func lemma &#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249; binder state lemma &#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_binder_set_context_mgr_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628; security_binder_set_context_mgr sa mgr &#10627;&#955;r s. s = sa&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>security_binder_set_context_mgr_def</span><span> </span><span>stb_binder_set_context_mgr</span><span> 
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_binder_transaction_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628; security_binder_transaction sa from to &#10627;&#955;r s. s = sa&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>security_binder_transaction_def</span><span> </span><span>stb_binder_transaction</span><span> 
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_binder_transfer_binder_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628; security_binder_transfer_binder s from to  &#10627;&#955;r s. s = sa&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>security_binder_transfer_binder_def</span><span> </span><span>stb_binder_transfer_binder</span><span> 
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_binder_transfer_file_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628; security_binder_transfer_file s from to file &#10627;&#955;r s. s = sa&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>security_binder_transfer_file_def</span><span> </span><span>stb_binder_transfer_file</span><span> 
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;ptrace state lemma &#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_ptrace_access_check_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628; security_ptrace_access_check s child m &#10627;&#955;r s. s = sa&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>security_ptrace_access_check_def</span><span> </span><span>stb_ptrace_access_check</span><span> 
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_ptrace_traceme_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628; security_ptrace_traceme s parent&#39; &#10627;&#955;r s. s = sa&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>security_ptrace_traceme_def</span><span> </span><span>stb_ptrace_traceme</span><span> 
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249; file state lemma &#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_file_permission_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628; security_file_permission sa file mask&#39; &#10627;&#955;r s. s = sa&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>security_file_permission_def</span><span>   </span><span>fsnotify_perm_def</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>bind_def</span><span> </span><span>return_def</span><span> </span><span>split_def</span><span> </span><span>valid_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>wpsimp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>stb_file_permission</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span>  </span><span>valid_def</span><span> </span><span>split_def</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_file_ioctl_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa file. &#10627;&#955;s . s = sa&#10628; security_file_ioctl sa file cmd arg &#10627;&#955;r s. s = sa&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>security_file_ioctl_def</span><span>   
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>stb_file_ioctl</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>auto</span><span class="delimiter">[</span><span>1</span><span class="delimiter">]</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_mmap_addr_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628; security_mmap_addr sa addr &#10627;&#955;r s. s = sa&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>security_mmap_addr_def</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>stb_mmap_addr</span><span> 
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_mmap_file_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628; security_mmap_file sa file prot flgs &#10627;&#955;r s. s = sa&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>security_mmap_file_def</span><span>  </span><span>bind_def</span><span>  </span><span>ima_file_mmap_def</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>wpsimp</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>valid_def</span><span> </span><span>mmap_prot_def</span><span> </span><span>return_def</span><span> </span><span>bind_def</span><span class="delimiter">)</span><span> 
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>PROT_READ_def</span><span> </span><span>PROT_EXEC_def</span><span> </span><span>return_def</span><span> </span><span>READ_IMPLIES_EXEC_def</span><span class="delimiter">)</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>stb_mmap_file</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span>  </span><span>valid_def</span><span> </span><span>split_def</span><span> </span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>auto</span><span class="delimiter">[</span><span>1</span><span class="delimiter">]</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>return_def</span><span class="delimiter">)</span><span> </span><span class="delimiter">+</span><span>
</span><span>   
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_file_mprotect_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628; security_file_mprotect sa vma reqprot prot &#10627;&#955;r s. s = sa&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>security_file_mprotect_def</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>stb_file_mprotect</span><span> 
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_file_lock_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628; security_file_lock sa file cmd &#10627;&#955;r s. s = sa&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>security_file_lock_def</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>stb_file_lock</span><span> 
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_file_fcntl_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628; security_file_fcntl sa file cmd arg&#10627;&#955;r s. s = sa&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>security_file_fcntl_def</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>stb_file_fcntl</span><span> 
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_file_send_sigiotask_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628; security_file_send_sigiotask sa tsk&#39; fown sig&#10627;&#955;r s. s = sa&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>security_file_send_sigiotask_def</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>stb_file_send_sigiotask</span><span> 
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_file_receive_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628; security_file_receive sa file &#10627;&#955;r s. s = sa&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>security_file_receive_def</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>stb_file_receive</span><span> 
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_file_open_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628; security_file_open sa file &#10627;&#955;r s. s = sa&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>security_file_open_def</span><span> </span><span>return_def</span><span> </span><span>bind_def</span><span> </span><span>valid_def</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>auto</span><span> 
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>stb_file_open</span><span> 
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span>  </span><span>valid_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>fsnotify_perm_def</span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>smt</span><span> </span><span>case_prodD</span><span> </span><span>fst_conv</span><span> </span><span>return_def</span><span> </span><span>singleton_iff</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>do_ioctl_state</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;
  &#8896;sa . &#10627;&#955;s . s = sa&#10628; security_file_ioctl sa file cmd arg &#10627;&#955;r s. s = sa&#10628; &#8743;
        det (security_file_ioctl sa file cmd arg)&#10230;
  snd (the_run_state  (security_file_ioctl sa file cmd arg) sa )= sa&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>valid_def</span><span class="delimiter">)</span><span> 
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>auto</span><span class="delimiter">[</span><span>1</span><span class="delimiter">]</span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>all_not_in_conv</span><span> </span><span>det_def</span><span> </span><span>fst_conv</span><span> </span><span>insert_not_empty</span><span>  
</span><span>       </span><span>the_run_state_def</span><span> </span><span>the_run_state_det</span><span> </span><span>prod.case_eq_if</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>smt</span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249; cap state lemma &#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_capget_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628;security_capget s target effective inheritable permitted &#10627;&#955;r s. s = sa&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>security_capget_def</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>stb_capget</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_capset_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628;security_capset s new old effective inheritable permitted  
          &#10627;&#955;r s. s = sa&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>security_capset_def</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>stb_capset</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_capable_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628; security_capable s c ns cap  
          &#10627;&#955;r s. s = sa&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>security_capable_def</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>stb_capable</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_capable_noaudit_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628; security_capable_noaudit s c ns cap  
          &#10627;&#955;r s. s = sa&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>security_capable_noaudit_def</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>stb_capable_noaudit</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_quotactl_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628; security_quotactl s cmds t id&#39; sb  
          &#10627;&#955;r s. s = sa&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>security_quotactl_def</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>stb_quotactl</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_quota_on_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628; security_quota_on s dentry  
          &#10627;&#955;r s. s = sa&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>security_quota_on_def</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>stb_quota_on</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_settime64_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628; security_settime64 s ts tz
          &#10627;&#955;r s. s = sa&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>security_settime64_def</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>stb_settime64</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_vm_enough_memory_mm_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628; security_vm_enough_memory_mm s mm&#39; pages
          &#10627;&#955;r s. s = sa&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>security_vm_enough_memory_mm_def</span><span>  </span><span>bind_def</span><span> 
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>auto</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>stb_vm_enough_memory_mm</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span>  </span><span>valid_def</span><span> </span><span>return_def</span><span> </span><span>split_def</span><span class="delimiter">)</span><span> 
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_syslog_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628; security_syslog s type
          &#10627;&#955;r s. s = sa&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>security_syslog_def</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>stb_syslog</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_bprm_set_creds_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628; security_bprm_set_creds s bprm
          &#10627;&#955;r s. s = sa&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>security_bprm_set_creds_def</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>stb_bprm_set_creds</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_bprm_check_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628; security_bprm_check s bprm
          &#10627;&#955;r s. s = sa&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>security_bprm_check_def</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>stb_bprm_check</span><span>
</span><span> </span><span class="keyword1"><span class="command">by</span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span>  </span><span>valid_def</span><span> </span><span>return_def</span><span> </span><span>bind_def</span><span> </span><span>split_def</span><span class="delimiter">)</span><span> 
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_bprm_committing_creds_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628; security_bprm_committing_creds s bprm
          &#10627;&#955;r s. True&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>security_bprm_committing_creds_def</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>stb_bprm_committing_creds</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_bprm_committed_creds_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628; security_bprm_committed_creds s bprm
          &#10627;&#955;r s. True&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>security_bprm_committed_creds_def</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>stb_bprm_committed_creds</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249; sb state lemma &#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_sb_alloc_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628;security_sb_alloc s sb
          &#10627;&#955;r s. r = 0 &#8744; r = -ENOMEM&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>security_sb_alloc_def</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>stb_sb_alloc_hook</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_sb_free_r</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628;security_sb_free s sb
          &#10627;&#955;r s. r = unit&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>security_sb_free_def</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>stb_sb_free</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_sb_copy_data_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628; security_sb_copy_data s orig copy
          &#10627;&#955;r s. s = sa&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>security_sb_copy_data_def</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>stb_sb_copy_data</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span>  </span><span>valid_def</span><span> </span><span>return_def</span><span> </span><span>bind_def</span><span> </span><span>split_def</span><span class="delimiter">)</span><span> 
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_sb_remount_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628; security_sb_remount s sb data
          &#10627;&#955;r s. s = sa&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>security_sb_remount_def</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>stb_sb_remount</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span>  </span><span>valid_def</span><span class="delimiter">)</span><span> 
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_sb_kern_mount_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628; security_sb_kern_mount s sb flgs data
          &#10627;&#955;r s. s = sa&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>security_sb_kern_mount_def</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>stb_sb_kern_mount</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span>  </span><span>valid_def</span><span class="delimiter">)</span><span> 
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_sb_show_options_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628;security_sb_show_options s m sb
          &#10627;&#955;r s. s = sa&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>security_sb_show_options_def</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>stb_sb_show_options</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span>  </span><span>valid_def</span><span> </span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_sb_statfs_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628;security_sb_statfs s dentry
          &#10627;&#955;r s. s = sa&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>security_sb_statfs_def</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>stb_sb_statfs</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span>  </span><span>valid_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_sb_mount_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628; security_sb_mount s dev_name path type flgs data
          &#10627;&#955;r s. s = sa&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>security_sb_mount_def</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>stb_sb_mount</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span> 
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_sb_umount_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628; security_sb_umount s vmnt flgs
          &#10627;&#955;r s. s = sa&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>security_sb_umount_def</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>stb_sb_umount</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span> 
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_sb_pivotroot_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628; security_sb_pivotroot s old_path new_path
          &#10627;&#955;r s. s = sa&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>security_sb_pivotroot_def</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>stb_sb_pivotroot</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span> 
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_sb_set_mnt_opts_notchgstate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa . &#10627;&#955;s . s = sa&#10628;security_sb_set_mnt_opts s sb opt kern_flags set_kern_flags
          &#10627;&#955;r s. s = sa&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>security_sb_set_mnt_opts_def</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>stb_sb_set_mnt_opts</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span> 
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249; init lsm hooks func&#8250;</span></span></span><span>
</span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* binder security *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span>  </span><span>security_binder_set_context_mgr&#39;</span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_binder_set_context_mgr&#39; s mgr &#8801; do 
          r &#8592; (return 0);
          return(r)
        od &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>binder_set_context_mgr&#39;</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;&#10627;&#955;s. True&#10628; security_binder_set_context_mgr&#39; s t &#10627;&#955;r s. r = 0 &#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span> </span><span class="delimiter">:</span><span>security_binder_set_context_mgr&#39;_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>wpsimp</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span>  </span><span>security_binder_transaction&#39;</span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658; Task &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_binder_transaction&#39; s from to &#8801; do 
          r &#8592; (return 0);
          return(r)
        od &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span>  </span><span>security_binder_transfer_binder&#39;</span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658; Task &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_binder_transfer_binder&#39; s from to &#8801; do 
          r &#8592; (return 0);
          return(r)
        od &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span>  </span><span>security_binder_transfer_file&#39;</span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658; Task&#8658; Files &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_binder_transfer_file&#39; s from to file &#8801; do 
          r &#8592; (return 0);
          return(r)
        od &quot;</span></span></span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* capget*)</span></span></span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span>  </span><span>security_syslog&#39;</span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; int  &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_syslog&#39; s type&#39; &#8801; do 
          r &#8592; (return 0);
          return(r)
        od &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span>  </span><span>security_bprm_check&#39;</span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; linux_binprm &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_bprm_check&#39; s bprm &#8801; do 
          r &#8592; (return 0);
          return(r)
        od &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span>  </span><span>security_bprm_committing_creds&#39;</span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; linux_binprm &#8658;(&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_bprm_committing_creds&#39; s bprm &#8801;  return() &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span>  </span><span>security_bprm_committed_creds&#39;</span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; linux_binprm &#8658;(&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_bprm_committed_creds&#39; s bprm &#8801; do 
          r &#8592; (return bprm);
          return()
        od &quot;</span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span>  </span><span>security_sb_alloc&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; super_block &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sb_alloc&#39; s sb &#8801; do 
          r &#8592; (return 0);
          return(r)
        od &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span>  </span><span>security_sb_free&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; super_block &#8658;(&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sb_free&#39; s sb &#8801; return()&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span>  </span><span>security_sb_copy_data&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; string &#8658; string &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sb_copy_data&#39; s orig copy &#8801; do 
          r &#8592; (return 0);
          return(r)
        od &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span>  </span><span>security_sb_remount&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; super_block &#8658; Void &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sb_remount&#39; s sb data &#8801; do 
          r &#8592; (return 0);
          return(r)
        od &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span>  </span><span>security_sb_kern_mount&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; super_block &#8658; int &#8658; Void&#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sb_kern_mount&#39; s sb flag data &#8801; do 
          r &#8592; (return 0);
          return(r)
        od &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span>  </span><span>security_sb_show_options&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658;seq_file &#8658;super_block &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sb_show_options&#39; s m sb &#8801; do 
          r &#8592; (return 0);
          return(r)
        od &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span>  </span><span>security_sb_statfs&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sb_statfs&#39; s dentry &#8801; do 
          r &#8592; (return 0);
          return(r)
        od &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span>  </span><span>security_sb_mount&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; string &#8658; path &#8658;string &#8658;int &#8658; Void &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sb_mount&#39; s devname path type flag data &#8801; do 
          r &#8592; (return 0);
          return(r)
        od &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span>  </span><span>security_sb_umount&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; vfsmount &#8658; int &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sb_umount&#39; s mnt&#39; flag &#8801; do 
          r &#8592; (return 0);
          return(r)
        od &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span>  </span><span>security_sb_pivotroot&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; path &#8658; path  &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sb_pivotroot&#39; s old new &#8801; do 
          r &#8592; (return 0);
          return(r)
        od &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sb_set_mnt_opts&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s&#8658;super_block &#8658; opts &#8658; int &#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sb_set_mnt_opts&#39; s sb opts&#39; kflags set_kflags  &#8801; do 
          r &#8592; (return 0);
          return(r)
        od &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sb_clone_mnt_opts&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s&#8658;super_block &#8658; super_block &#8658; int &#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sb_clone_mnt_opts&#39; s oldsb newsb kflags set_kflags  &#8801; do 
          r &#8592; (return 0);
          return(r)
        od &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sb_parse_opts_str&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s&#8658;string &#8658; opts &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sb_parse_opts_str&#39; s options opt  &#8801; do 
          r &#8592; (return 0);
          return(r)
        od &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_task_alloc&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s&#8658;Task &#8658;nat&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_task_alloc&#39; s p f &#8801; do
          r &#8592; (return 0);
          return(r)
          od &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_task_free&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s&#8658;Task&#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_task_free&#39; s p &#8801; return()&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_task_fix_setuid&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s&#8658;Cred &#8658;Cred &#8658;int&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_task_fix_setuid&#39; s new old f&#8801; do
          r &#8592; (return 0);
          return(r)
          od &quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_task_prlimit&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s&#8658;Cred &#8658;Cred &#8658;int&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_task_prlimit&#39; s c tc f&#8801; do
          r &#8592; (return 0);
          return(r)
          od &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_task_setrlimit&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s&#8658;Task &#8658;nat &#8658;rlimit&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_task_setrlimit&#39; s p r f&#8801; do
          r &#8592; (return 0);
          return(r)
          od &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_task_prctl&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s&#8658;int &#8658;nat &#8658;nat &#8658;nat &#8658;nat&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_task_prctl&#39; s op arg2 arg3 arg4 arg5&#8801; do
          r &#8592; (return 0);
          return(r)
          od &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>l_security_sb_alloc</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;&#10627;&#955;s. True&#10628; security_sb_alloc&#39; s sb &#10627;&#955;r s. r = 0 &#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span> </span><span class="delimiter">:</span><span>security_sb_alloc&#39;_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>wpsimp</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>l_security_sb_copy_data</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;&#10627;&#955;s. True&#10628; security_sb_copy_data&#39; s orig copy &#10627;&#955;r s. r = 0 &#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span> </span><span class="delimiter">:</span><span>security_sb_copy_data&#39;_def</span><span class="delimiter">)</span><span> 
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>wpsimp</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>l_security_sb_set_mnt_opts</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;&#10627;&#955;s. True&#10628; security_sb_set_mnt_opts&#39; s sb opts&#39; kflags set_kflags &#10627;&#955;r s. r = 0 &#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span> </span><span class="delimiter">:</span><span>security_sb_set_mnt_opts&#39;_def</span><span class="delimiter">)</span><span> 
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>wpsimp</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_capget&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658; kct &#8658; kct &#8658;kct &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_capget&#39; s target  effective inheritable permitted&#8801; return 0   &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_capset&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Cred &#8658; Cred &#8658; kct &#8658; kct &#8658;kct &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_capset&#39; s new old effective inheritable permitted &#8801;  return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_capable&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Cred &#8658; ns &#8658; cap &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_capable&#39; s c ns cap &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_capable_noaudit&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Cred &#8658; ns &#8658; cap &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_capable_noaudit&#39; s c ns cap &#8801; return 0 &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_quotactl&#39;</span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; int &#8658; int &#8658; int &#8658; super_block option&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_quotactl&#39; s cmds t id&#39; sb &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_quota_on&#39;</span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_quota_on&#39; s dentry &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_settime64&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; ts &#8658; tz option &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_settime64&#39; s ts tz &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_vm_enough_memory_mm&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; mm &#8658;  pages &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_vm_enough_memory_mm&#39; s mm&#39; pages &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_bprm_set_creds&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;linux_binprm &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_bprm_set_creds&#39; s bprm &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*dentry*)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_dentry_init_security&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;dentry &#8658; mode &#8658; string &#8658; string&#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_dentry_init_security&#39; s dentry m name ctx xtxlen &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_dentry_create_files_as&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;dentry &#8658; mode &#8658; string &#8658; Cred &#8658; Cred &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_dentry_create_files_as&#39; s dentry m name old new &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_d_instantiate&#39;</span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; inode &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_d_instantiate&#39; s dentry inode &#8801; return ()&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_getprocattr&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658; string &#8658; string &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_getprocattr&#39; s p name value &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_setprocattr&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; string &#8658; string &#8658; int&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_setprocattr&#39; s name value size&#39; &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_alloc&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;inode &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_alloc&#39; s inode &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_free&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; inode &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_free&#39; s inode &#8801; return()&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_init_security&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s&#8658;inode &#8658;  inode &#8658; string &#8658; string  &#8658; string &#8658;int &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_init_security&#39; s inode dir qstr name value len&#39; = return 0 &quot;</span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_old_inode_init_security&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; inode &#8658; inode &#8658; qstr &#8658; string &#8658; string &#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_old_inode_init_security&#39; s inode dir qstr name value len&#39; &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_create&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; inode &#8658; dentry&#8658; mode &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_create&#39; s dir dentry m &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_link&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; inode &#8658; dentry &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_link&#39; s old_dentry dir new_dentry &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_unlink&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  inode &#8658; dentry &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_unlink&#39; s dir dentry &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_symlink&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  inode &#8658; dentry &#8658; string &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_symlink&#39; s dir dentry old_name &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_mkdir&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; inode &#8658; dentry&#8658; mode &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_mkdir&#39; s dir dentry m &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_rmdir&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  inode &#8658; dentry&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_rmdir&#39; s dir dentry &#8801;  return 0&quot;</span></span></span><span>
</span><span>   
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_mknod&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  inode &#8658; dentry &#8658; mode &#8658; dev_t&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_mknod&#39; s dir dentry m dev &#8801;  return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_rename&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  inode &#8658; dentry &#8658;  inode &#8658;dentry  &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_rename&#39; s old_dir old_dentry new_dir new_dentry &#8801;  return 0&quot;</span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_readlink&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_readlink&#39; s dentry &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_follow_link&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658;  inode &#8658; bool &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_follow_link&#39; s dentry inode rcu&#39; &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_permission&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  inode &#8658; mask &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_permission&#39; s inode m &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_setattr&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; iattr &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_setattr&#39; s dentry attr&#39; &#8801; return 0
        &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_getattr&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; path &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_getattr&#39; s path &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_setxattr&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; xattr &#8658; string &#8658; int &#8658; flags &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_setxattr&#39; s dentry name value size&#39; flgs &#8801; return 0
        &quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>evm_inode_post_setxattr&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658;xattr &#8658;string &#8658;int &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;evm_inode_post_setxattr&#39; s d x value flg &#8801; return () &quot;</span></span></span><span> 
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_post_setxattr&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; xattr &#8658; string &#8658; int &#8658; flags &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_post_setxattr&#39; s dentry name value size&#39; flgs &#8801; return ()
  &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_getxattr&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; xattr &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_getxattr&#39; s dentry name &#8801; return 0
  &quot;</span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_listxattr&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry  &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_listxattr&#39; s dentry  &#8801; return 0
  &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_removexattr&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; xattr &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_removexattr&#39; s dentry name &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_need_killpriv&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_need_killpriv&#39; s dentry &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_killpriv&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_killpriv&#39; s dentry &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_getsecurity&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  inode &#8658; xattr &#8658; Void &#8658; bool &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_getsecurity&#39; s inode name buffer alloc  &#8801; return (-EOPNOTSUPP)&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_setsecurity&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; inode &#8658; xattr &#8658; Void &#8658; nat&#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_setsecurity&#39; s inode name value size&#39; flgs &#8801; return (-EOPNOTSUPP)&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_listsecurity&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  inode &#8658; Void &#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_listsecurity&#39; s inode buffer bsize  &#8801;
        return 0
  &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_getsecid&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; inode &#8658; u32 &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_getsecid&#39;  s inode secid&#39; &#8801; return()&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_copy_up&#39;</span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; Cred option &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_copy_up&#39;  s src new &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_copy_up_xattr&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; string &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_copy_up_xattr&#39;  s name &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_invalidate_secctx&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  inode &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_invalidate_secctx&#39; s inode &#8801;return ()&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_notifysecctx&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  inode &#8658; string &#8658; u32&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_notifysecctx&#39; s inode ctx ctxlen &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_setsecctx&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; string &#8658; u32&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_setsecctx&#39; s dentry ctx ctxlen &#8801; return 0 &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inode_getsecctx&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; inode &#8658; string &#8658; u32&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_getsecctx&#39; s dentry ctx ctxlen &#8801; return 0 &quot;</span></span></span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* file *)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_file_permission&#39;</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files&#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_file_permission&#39; s file mask&#39; &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_file_alloc&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_file_alloc&#39; s file &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_file_free&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_file_free&#39; s file &#8801; return ()&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_file_ioctl&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files&#8658; IOC_DIR &#8658; nat &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_file_ioctl&#39; s file cmd arg &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_mmap_file&#39;</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files option&#8658; nat &#8658; nat &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_mmap_file&#39; s file prot flgs &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_mmap_addr&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; nat &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_mmap_addr&#39; s addr &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_file_mprotect&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; vm_area_struct&#8658; nat &#8658; nat &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_file_mprotect&#39; s vma reqprot prot &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_file_lock&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files&#8658; nat  &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_file_lock&#39; s file cmd &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_file_fcntl&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files&#8658; nat &#8658; nat &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_file_fcntl&#39; s file cmd arg &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_file_set_fowner&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files&#8658;  (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_file_set_fowner&#39; s file &#8801; return ()&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_file_send_sigiotask&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task&#8658; fown_struct &#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_file_send_sigiotask&#39; s tsk&#39; fown sig &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_file_receive&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files&#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_file_receive&#39; s file &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_file_open&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files&#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_file_open&#39; s file &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span>
</span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*kernel*)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_kernel_act_as&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Cred &#8658; u32 &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_kernel_act_as&#39; s new secid&#39; &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_kernel_create_files_as&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Cred &#8658;  inode &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_kernel_create_files_as&#39; s new inode &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_kernel_module_request&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; string &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_kernel_module_request&#39; s name &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_kernel_load_data&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; kernel_load_data_id &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_kernel_load_data&#39; s  kid &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_kernel_read_file&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files &#8658;kernel_read_file_id &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_kernel_read_file&#39; s file kid &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_kernel_post_read_file&#39;</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files &#8658; string &#8658; nat &#8658;kernel_read_file_id &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_kernel_post_read_file&#39; s file buf size&#39; kid &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*ipc &amp;msg*)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_ipc_permission&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  kern_ipc_perm &#8658; nat &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_ipc_permission&#39; s ipcp flg &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_ipc_getsecid&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; kern_ipc_perm &#8658; u32 &#8658;  (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_ipc_getsecid&#39; s ipcp secid&#39; &#8801; return () &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_msg_msg_alloc&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  msg_msg &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_msg_msg_alloc&#39; s msg &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_msg_msg_free&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; msg_msg &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_msg_msg_free&#39; s msg &#8801; return ()&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_msg_queue_alloc&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  kern_ipc_perm &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_msg_queue_alloc&#39; s msq &#8801;  return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_msg_queue_free&#39;</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  kern_ipc_perm &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_msg_queue_free&#39; s msq &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_msg_queue_associate&#39;</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; kern_ipc_perm &#8658; int&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_msg_queue_associate&#39; s msq msqflg &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_msg_queue_msgctl&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  kern_ipc_perm &#8658; IPC_CMD&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_msg_queue_msgctl&#39; s msq cmd &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_msg_queue_msgsnd&#39;</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; kern_ipc_perm &#8658;  msg_msg &#8658; int&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_msg_queue_msgsnd&#39; s msq msg msqflg &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_msg_queue_msgrcv&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; kern_ipc_perm &#8658; msg_msg&#8658; Task &#8658; int &#8658; int&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_msg_queue_msgrcv&#39; s msq msg target type m &#8801; return 0 &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_shm_alloc&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  kern_ipc_perm &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_shm_alloc&#39; s shp &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_shm_free&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  kern_ipc_perm &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_shm_free&#39; s shp &#8801; return ()&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_shm_associate&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; kern_ipc_perm &#8658; int&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_shm_associate&#39; s shp shmflg &#8801; return 0 &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_shm_shmctl&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  kern_ipc_perm &#8658; IPC_CMD&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_shm_shmctl&#39; s shp cmd &#8801; return 0 &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_shm_shmat&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; kern_ipc_perm &#8658;string &#8658;int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_shm_shmat&#39; s shp shmaddr shmflg &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sem_alloc&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  kern_ipc_perm &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sem_alloc&#39; s sma &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sem_free&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  kern_ipc_perm &#8658;  (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sem_free&#39; s sma &#8801; return ()&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sem_associate&#39;</span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; kern_ipc_perm &#8658; int&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sem_associate&#39; s sma semflg &#8801; return 0 &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sem_semctl&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  kern_ipc_perm &#8658; IPC_CMD&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sem_semctl&#39; s sma cmd &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sem_semop&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; kern_ipc_perm &#8658;sembuf&#8658;nat &#8658; int&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sem_semop&#39; s sma sops nsops alter &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* network *)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_netlink_send&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  sock &#8658; sk_buff&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_netlink_send&#39; s sk&#39; skb &#8801; return 0 &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_ismaclabel&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; xattr&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_ismaclabel&#39; s name &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_secid_to_secctx&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; u32 &#8658;string  &#8658; u32 &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_secid_to_secctx&#39; s secid&#39; secdata seclen &#8801; return 0 &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_secctx_to_secid&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; string &#8658; u32&#8658; u32&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_secctx_to_secid&#39; s secdata seclen secid&#39; &#8801;return 0
    &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_release_secctx&#39;</span><span> </span><span class="delimiter">::</span><span>   </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; string &#8658; u32&#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_release_secctx&#39; s secdata seclen &#8801; return ()&quot;</span></span></span><span>
</span><span> 
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_unix_stream_connect&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  sock &#8658; sock &#8658;  sock &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span class="string"><span class="delete"><span class="delete">&quot;security_unix_stream_connect&#39; s sock other newsk &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_unix_may_send&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  socket &#8658;  socket &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_unix_may_send&#39; s sock other &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_socket_create&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Sk_Family &#8658; int &#8658; int &#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_create&#39; s family type pro kern &#8801; return 0 &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_socket_post_create&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; socket &#8658; Sk_Family &#8658; int &#8658; int &#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_post_create&#39; s sock family type pro kern &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_socket_socketpair&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; socket &#8658;  socket &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_socketpair&#39; s socka sockb &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_socket_bind&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; socket &#8658; sockaddr &#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_bind&#39; s sock address addrlen &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_socket_connect&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; socket &#8658; sockaddr &#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_connect&#39; s sock address addrlen &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_socket_listen&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  socket  &#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_listen&#39; s sock backlog &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_socket_accept&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  socket &#8658; socket  &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_accept&#39; s sock newsock &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_socket_sendmsg&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  socket &#8658; msghdr &#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_sendmsg&#39; s sock msg size&#39; &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_socket_recvmsg&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  socket &#8658; msghdr &#8658; int &#8658; int&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_recvmsg&#39; s sock msg size&#39; flgs &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_socket_getsockname&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; socket  &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_getsockname&#39; s sock &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_socket_getpeername&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  socket  &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_getpeername&#39; s sock &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_socket_getsockopt&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  socket  &#8658;int &#8658; int&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_getsockopt&#39; s sock level&#39; optname &#8801; return 0 &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_socket_setsockopt&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  socket &#8658;int &#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_setsockopt&#39; s sock level&#39; optname &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_socket_shutdown&#39;</span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  socket &#8658;int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_shutdown&#39; s sock how &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sock_rcv_skb&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  sock &#8658;sk_buff  &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sock_rcv_skb&#39; s sock skb &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_socket_getpeersec_stream&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; socket &#8658;string &#8658;int &#8658;nat 
                                                      &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_getpeersec_stream&#39; s sock optval optlen len&#39; &#8801; return 0 &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_socket_getpeersec_dgram&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; socket &#8658;sk_buff option &#8658; u32 
                                                     &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_getpeersec_dgram&#39; s sock skb secid&#39; &#8801; return 0 &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sk_alloc&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; sock&#8658;int &#8658; gfp_t &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sk_alloc&#39; s sk&#39; family priority &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sk_free&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; sock&#8658;(&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sk_free&#39; s sock &#8801; return ()&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sk_clone&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  sock&#8658; sock &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sk_clone&#39; s sk&#39; newsk &#8801; return()&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sk_classify_flow&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  sock&#8658; flowi &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sk_classify_flow&#39; s sock&#39; fl &#8801; return ()&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_req_classify_flow&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; request_sock&#8658; flowi &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_req_classify_flow&#39; s req fl &#8801; return ()&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sock_graft&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; sock&#8658;  socket &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sock_graft&#39; s sk&#39; parent&#39; &#8801; return ()&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inet_conn_request&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; sock&#8658; sk_buff &#8658;request_sock 
                                               &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inet_conn_request&#39; s sk&#39; skb req &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inet_csk_clone&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  sock &#8658;request_sock &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inet_csk_clone&#39; s newsk req &#8801; return ()&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_inet_conn_established&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  sock&#8658; sk_buff &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_inet_conn_established&#39; s sk&#39; skb &#8801; return()&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_secmark_relabel_packet&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; u32 &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_secmark_relabel_packet&#39; s secid&#39; &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_secmark_refcount_inc</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_secmark_refcount_inc s &#8801; return ()&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_secmark_refcount_dec&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span class="string"><span class="delete"><span class="delete">&quot;security_secmark_refcount_dec&#39; s &#8801; return ()&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_tun_dev_alloc_security&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; &#39;b&#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_tun_dev_alloc_security&#39; s security &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_tun_dev_free_security&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; &#39;b &#8658;(&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_tun_dev_free_security&#39; s security &#8801; return ()&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_tun_dev_create</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span class="string"><span class="delete"><span class="delete">&quot;security_tun_dev_create s &#8801; return 0 &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_tun_dev_attach_queue&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; &#39;b &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_tun_dev_attach_queue&#39; s security &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_tun_dev_attach&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658;  sock&#8658; &#39;b &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_tun_dev_attach&#39; s sk&#39; security &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_tun_dev_open&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; &#39;b &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span class="string"><span class="delete"><span class="delete">&quot;security_tun_dev_open&#39; s security &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sctp_assoc_request&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; sctp_endpoint &#8658; sk_buff &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sctp_assoc_request&#39; s ep skb &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sctp_bind_connect&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658;  sock &#8658; int &#8658; sockaddr &#8658;int &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sctp_bind_connect&#39; s sk&#39; optname address addrlen &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_sctp_sk_clone&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; sctp_endpoint &#8658; sock &#8658;  sock &#8658;(&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_sctp_sk_clone&#39; s ep sk&#39; newsk &#8801; return ()&quot;</span></span></span><span>
</span><span>
</span><span>  </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* ib *)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_ib_pkey_access&#39;</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; &#39;i &#8658; nat &#8658; nat  &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_ib_pkey_access&#39; s sec subnet_prefix pkey &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_ib_endport_manage_subnet&#39;</span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; &#39;i &#8658; string &#8658; nat  &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_ib_endport_manage_subnet&#39; s sec dev_name port_num &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_ib_alloc_security&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; &#39;i list &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_ib_alloc_security&#39; s sec &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_ib_free_security&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; &#39;i list &#8658;  (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_ib_free_security&#39; s sec &#8801; return ()&quot;</span></span></span><span>
</span><span>
</span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* lsm network_xfrm *)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_xfrm_policy_alloc&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; xfrm_sec_ctx &#8658; xfrm_user_sec_ctx &#8658; gfp_t 
                                              &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_xfrm_policy_alloc&#39; s ctxp sec_ctx gfp&#39; &#8801; return 0 &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_xfrm_policy_clone&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; xfrm_sec_ctx &#8658; xfrm_user_sec_ctx 
                                              &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_xfrm_policy_clone&#39; s old_ctx new_ctxp &#8801; return 0 &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_xfrm_policy_free&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; xfrm_sec_ctx  &#8658;(&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_xfrm_policy_free&#39; s ctx &#8801; return ()&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_xfrm_policy_delete&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; xfrm_sec_ctx  &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_xfrm_policy_delete&#39; s ctx &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_xfrm_state_alloc&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; xfrm_state &#8658; xfrm_sec_ctx  &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_xfrm_state_alloc&#39; s x sec_ctx &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_xfrm_state_alloc_acquire&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; xfrm_state &#8658; xfrm_sec_ctx &#8658; u32 
                                                     &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_xfrm_state_alloc_acquire&#39; s x plosec secid&#39; &#8801; return 0 &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_xfrm_state_delete&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; xfrm_state  &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_xfrm_state_delete&#39; s x &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_xfrm_state_free&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; xfrm_state  &#8658;(&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_xfrm_state_free&#39; s x &#8801; return ()&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_xfrm_policy_lookup&#39;</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; xfrm_sec_ctx &#8658; u32 &#8658; u8 &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_xfrm_policy_lookup&#39; s ctx fl_secid dir &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_xfrm_state_pol_flow_match&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; xfrm_state &#8658; xfrm_policy &#8658; flowi 
                                                      &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_xfrm_state_pol_flow_match&#39; s x xp fl&#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_xfrm_decode_session&#39;</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; sk_buff &#8658; u32 &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_xfrm_decode_session&#39; s skb secid&#39; &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_skb_classify_flow&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; sk_buff &#8658; flowi &#8658;(&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_skb_classify_flow&#39; s skb fl &#8801; return ()&quot;</span></span></span><span>
</span><span>
</span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* lsm path *)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_path_unlink&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; path &#8658; dentry &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_path_unlink&#39; s dir dentry &#8801; return 0
        &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_path_mkdir&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; path &#8658; dentry &#8658;nat &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_path_mkdir&#39; s dir dentry m &#8801; return 0
         &quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_path_rmdir&#39;</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; path &#8658; dentry &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_path_rmdir&#39; s dir dentry  &#8801; return 0 &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_path_mknod&#39;</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; path &#8658; dentry &#8658;nat &#8658; nat&#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_path_mknod&#39; s dir dentry m  dev&#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_path_truncate&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; path &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_path_truncate&#39; s dir  &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_path_symlink&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; path &#8658; dentry &#8658; string &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_path_symlink&#39; s dir dentry old_name  &#8801; return 0  &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_path_link&#39;</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; dentry &#8658;path &#8658; dentry &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_path_link&#39; s old_dentry new_dir new_dentry  &#8801; return 0  &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_path_rename&#39;</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; path &#8658; dentry &#8658; path &#8658; dentry &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_path_rename&#39; s old_dir old_dentry new_dir new_dentry  &#8801; 
          return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_path_chmod&#39;</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; path &#8658; nat&#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_path_chmod&#39; s path m   &#8801; return 0 &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_path_chown&#39;</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; path &#8658; kuid_t &#8658; kgid_t  &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_path_chown&#39; s path uid&#39; gid&#39;  &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_path_chroot&#39;</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; path &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_path_chroot&#39; s path &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* lsm bpf *)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_bpf&#39;</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; int &#8658; bpf_attr &#8658; nat  &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_bpf&#39; s cmd attr&#39; size&#39; &#8801; return 0 &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_bpf_map&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; bpf_map &#8658; mode  &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_bpf_map&#39; s bmap fmode &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_bpf_prog&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; bpf_prog &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_bpf_prog&#39; s prog &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_bpf_map_alloc&#39;</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; bpf_map  &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_bpf_map_alloc&#39; s bmap &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_bpf_map_free&#39;</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; bpf_map  &#8658;(&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_bpf_map_free&#39; s bmap &#8801; return () &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_bpf_prog_alloc&#39;</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; bpf_prog_aux  &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_bpf_prog_alloc&#39; s aux&#39; &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_bpf_prog_free&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; bpf_prog_aux  &#8658;(&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_bpf_prog_free&#39; s aux&#39; &#8801; return () &quot;</span></span></span><span>
</span><span>
</span><span>  </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* lsm keys *)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_key_alloc&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; key &#8658; Cred &#8658; nat &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_key_alloc&#39; s key&#39; c flgs &#8801;  return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_key_free&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; key &#8658;(&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_key_free&#39; s key&#39; &#8801; return ()&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_key_permission&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; key_ref_t &#8658; Cred &#8658; nat &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_key_permission&#39; s key_ref c perm &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_key_getsecurity&#39;</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; key &#8658; string &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_key_getsecurity&#39; s key&#39; buffer &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span>  </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* lsm audit_krule *)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_audit_rule_init&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; nat &#8658; enum_audit &#8658; string &#8658; string 
                                             &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_audit_rule_init&#39; s field op rulestr lsmrule &#8801; return 0 &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_audit_rule_known&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; audit_krule &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_audit_rule_known&#39; s krule &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_audit_rule_match&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; nat &#8658; nat &#8658; enum_audit &#8658; string &#8658; audit_context 
                                               &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_audit_rule_match&#39; s secid&#39; field op lsmrule actx &#8801; return 0&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>security_audit_rule_free&#39;</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; string &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_audit_rule_free&#39; s lsmrule &#8801; return ()&quot;</span></span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span></pre>

</div>
</body>
</html>
