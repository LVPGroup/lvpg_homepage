<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Theory LSM_Smack (Isabelle2019: June 2019)</title>
<link media="all" rel="stylesheet" type="text/css" href="isabelle.css"/>
</head>

<body>
<div class="head"><h1>Theory LSM_Smack</h1>

<span class="command">theory</span> <span class="name">LSM_Smack</span><br/> 
<span class="keyword">imports</span> <a href="kernelA.html"><span class="name">kernelS</span></a> <a href="SmackLemma.html"><span class="name">SmackLemma</span></a><br/>

</div>
<div class="source">
<pre class="source"><span class="keyword1"><span class="command">section</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;Instantiate SMACK And Proof Information flow security of linux LSM  manage hooks specification&#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">theory</span></span><span> </span><span>LSM_Smack</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">imports</span></span><span>  
</span><span>   </span><span>kernelA</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;../Smack/TDS/SmackLemma&quot;</span></span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span class="cartouche"><span class="delete"><span class="delete">&#8249;config and definition&#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">consts</span></span><span> </span><span>optinit</span><span> </span><span class="delimiter">::</span><span> </span><span>opts</span><span>
</span><span class="keyword1"><span class="command">consts</span></span><span> </span><span>currenttask</span><span> </span><span class="delimiter">::</span><span> </span><span>Task</span><span>
</span><span class="keyword1"><span class="command">consts</span></span><span> </span><span>tl</span><span> </span><span class="delimiter">::</span><span> </span><span>list_head</span><span> 
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;inittasklabel &#8801; new_task_smack smack_known_floor smack_known_floor 1&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">datatype</span></span><span> </span><span>Value</span><span> </span><span class="delimiter">=</span><span> </span><span>SbValue</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;superblock_smack option&quot;</span></span></span><span> </span><span class="delimiter">|</span><span> </span><span>FileValue</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smack_known option&quot;</span></span></span><span> </span><span class="delimiter">|</span><span> </span><span>MsgValue</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smack_known option&quot;</span></span></span><span>
</span><span>  </span><span class="delimiter">|</span><span> </span><span>IpcValue</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smack_known option&quot;</span></span></span><span> </span><span class="delimiter">|</span><span> </span><span>KeyValue</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smack_known option&quot;</span></span></span><span> </span><span class="delimiter">|</span><span> </span><span>SockValue</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;socket_smack option&quot;</span></span></span><span>
</span><span>  </span><span class="delimiter">|</span><span> </span><span>InodeValue</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;inode_smack option&quot;</span></span></span><span> </span><span class="delimiter">|</span><span> </span><span>TskValue</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;task_smack option&quot;</span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>contents</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;State&#39; &#8658; Obj &#8658; Value&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;contents s obj &#8801; (case obj of Sb sb &#8658; SbValue (sb_security s sb) |
                                       File f &#8658; FileValue(f_security s f) |
                                       Msg msg &#8658; MsgValue (msg_security s msg)|
                                       IPC ipcs &#8658; IpcValue(ipc_security s ipcs )|
                                       ObjKey k &#8658; KeyValue(key_security s  k) |
                                       ObjSock sock &#8658; SockValue(sk_security s sock)|
                                       ObjInode i &#8658; InodeValue(i_security s i) | 
                                       Process p &#8658; TskValue(t_security s (real_cred(the(tasks s p)))))&quot;</span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>system_init</span><span> </span><span class="delimiter">::</span><span> </span><span>State&#39;</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span class="string"><span class="delete"><span class="delete">&quot;system_init &#8801; &#10631; current = 0,
                        tasks =[0 &#8614;currenttask],
                        k_superblock = (&#955;s. None),
                        inodes = (&#955;i. None),
                        sdentry = (&#955;x . None),
                        files = (&#955;x . None),
                        msg_msgs =(&#955;x. None),
                        msg_queues =(&#955;x. None),
                        keys =(&#955;x. None),
                        sockets =(&#955;x. None),
                        opts = optinit,
                        t_security = ([(cred currenttask) &#8614; (the inittasklabel)]),
                        sb_security = (&#955;s . None), 
                        msg_security = (&#955;s . None),
                        ipc_security = (&#955;s . None), 
                        i_security = (&#955;s . None), 
                        f_security = (&#955;s . None),
                        sk_security = (&#955;s . None),
                        key_security = (&#955;s . None),
                        subj_l = (&#955;s. Star), 
                        obj_l =  (&#955;obj. Star),
                        Subjs= {},
                        Objs = {},
                        pol_tab = (&#955;subj .(&#955;(subj,obj) . {}))
                     
&#10632;&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>objset</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;State&#39; &#8658; Obj set&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;objset s &#8801; {obj. &#8707;f. f_security s f &#8800; None &#8743; obj = File f } &#8746; 
                    {obj. &#8707;ipc. ipc_security s ipc &#8800; None &#8743; obj = IPC ipc } &#8746; 
                    {obj. &#8707;i. i_security s i &#8800; None &#8743; obj = ObjInode i } &#8746; 
                    {obj. &#8707;msg. msg_security s msg &#8800; None &#8743; obj = Msg msg } &#8746;
                    {obj. &#8707;p. t_security s (cred(the(tasks s p))) &#8800; None &#8743; obj = Process p } &#8746; 
                    {obj. &#8707;i. sk_security s i &#8800; None &#8743; obj = ObjSock i } &#8746; 
                    {obj. &#8707;i. sb_security s i &#8800; None &#8743; obj = Sb i } &#8746; 
                    {obj. &#8707;key. key_security s key &#8800; None &#8743; obj = ObjKey key } &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">consts</span></span><span> </span><span>s0</span><span class="delimiter">::</span><span> </span><span>State&#39;</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>ReferenceMonitor</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;State&#39;&#8658;Subj &#8658; Obj &#8658; Request &#8658; decision&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;ReferenceMonitor s subj obj r &#8801; 
         if (access_rl r) &#8712; (smk_access_rules ) (smk_of_subjlabel s subj) (smk_of_objectlabel s obj)
           then allow 
        else deny&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>access</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;State&#39;&#8658;Subj &#8658; Obj &#8658; access &#8658; bool&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;access s subj obj r &#8801; 
         if r &#8712; (smk_access_rules ) (smk_of_subjlabel s subj) (smk_of_objectlabel s obj)
           then True 
        else False&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">print_locale</span></span><span> </span><span>Kernel</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249; fsp lemma &#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_file_permission_correctness</span><span class="delimiter">:</span><span>
</span><span class="string"><span class="delete"><span class="delete">&quot;&#10627;&#955;s. True&#10628; security_file_permission&#39; s file mask&#39; &#10627;&#955;r s. r = 0&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>unfold</span><span> </span><span>security_file_permission&#39;_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>wpsimp</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>cap_mmap_addr_correctness</span><span class="delimiter">:</span><span>
</span><span class="string"><span class="delete"><span class="delete">&quot;&#10627;&#955;s. True&#10628; cap_mmap_addr  s addr &#10627;&#955;r s. r = 0 &#8744; r &#8800; 0&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>unfold</span><span> </span><span>cap_mmap_addr_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>wpsimp</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_file_mprotect_correctness</span><span class="delimiter">:</span><span>
</span><span class="string"><span class="delete"><span class="delete">&quot;&#10627;&#955;s. True&#10628; security_file_mprotect&#39; s vma reqprot prot &#10627;&#955;r s. r = 0 &#8744; r &#8800; 0&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>unfold</span><span> </span><span>security_file_mprotect&#39;_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>wpsimp</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_audit_rule_free_correctness</span><span class="delimiter">:</span><span>
</span><span class="string"><span class="delete"><span class="delete">&quot;&#10627;&#955;s. True&#10628; security_audit_rule_free&#39; s lsmrule &#10627;&#955;r s. r = unit&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>unfold</span><span> </span><span>security_audit_rule_free&#39;_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>wpsimp</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_task_alloc_correctness</span><span class="delimiter">:</span><span>
</span><span class="string"><span class="delete"><span class="delete">&quot;&#10627;&#955;s. True&#10628; security_task_alloc&#39; s p f &#10627;&#955;r s. r = 0&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>unfold</span><span> </span><span>security_task_alloc&#39;_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>wpsimp</span><span>             
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_task_free_correctness</span><span class="delimiter">:</span><span>
</span><span class="string"><span class="delete"><span class="delete">&quot;&#10627;&#955;s. True&#10628; security_task_free&#39; s p &#10627;&#955;r s. r = unit&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>unfold</span><span> </span><span>security_task_free&#39;_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>wpsimp</span><span>             
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_task_prctl_correctness</span><span class="delimiter">:</span><span>
</span><span class="string"><span class="delete"><span class="delete">&quot;&#10627;&#955;s. True&#10628; security_task_prctl&#39; s op arg2 arg3 arg4 arg5 &#10627;&#955;r s. r = 0&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>unfold</span><span> </span><span>security_task_prctl&#39;_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>wpsimp</span><span>             
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_dentry_init_security_correctness</span><span class="delimiter">:</span><span>
</span><span class="string"><span class="delete"><span class="delete">&quot;&#10627;&#955;s. True&#10628; security_dentry_init_security&#39; s dentry m name ctx xtxlen &#10627;&#955;r s. r = 0&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>unfold</span><span> </span><span>security_dentry_init_security&#39;_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>wpsimp</span><span>             
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* kernel *)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_kernel_act_as_correctness</span><span class="delimiter">:</span><span>
</span><span class="string"><span class="delete"><span class="delete">&quot;&#10627;&#955;s. True&#10628; security_kernel_act_as&#39; s new secid&#39;  &#10627;&#955;r s. r = 0&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>unfold</span><span> </span><span>security_kernel_act_as&#39;_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>wpsimp</span><span>             
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_kernel_create_files_as_correctness</span><span class="delimiter">:</span><span>
</span><span class="string"><span class="delete"><span class="delete">&quot;&#10627;&#955;s. True&#10628; security_kernel_create_files_as&#39; s new inode &#10627;&#955;r s. r = 0&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>unfold</span><span> </span><span>security_kernel_create_files_as&#39;_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>wpsimp</span><span>             
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_kernel_module_request_correctness</span><span class="delimiter">:</span><span>
</span><span class="string"><span class="delete"><span class="delete">&quot;&#10627;&#955;s. True&#10628; security_kernel_module_request&#39; s name  &#10627;&#955;r s. r = 0&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>unfold</span><span> </span><span>security_kernel_module_request&#39;_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>wpsimp</span><span>             
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_kernel_load_data_correctness</span><span class="delimiter">:</span><span>
</span><span class="string"><span class="delete"><span class="delete">&quot;&#10627;&#955;s. True&#10628; security_kernel_load_data&#39; s  kid &#10627;&#955;r s. r = 0&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>unfold</span><span> </span><span>security_kernel_load_data&#39;_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>wpsimp</span><span>             
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_kernel_read_file_correctness</span><span class="delimiter">:</span><span>
</span><span class="string"><span class="delete"><span class="delete">&quot;&#10627;&#955;s. True&#10628; security_kernel_read_file&#39; s file kid  &#10627;&#955;r s. r = 0&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>unfold</span><span> </span><span>security_kernel_read_file&#39;_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>wpsimp</span><span>             
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_kernel_post_read_file_correctness</span><span class="delimiter">:</span><span>
</span><span class="string"><span class="delete"><span class="delete">&quot;&#10627;&#955;s. True&#10628; security_kernel_post_read_file&#39; s file buf size&#39; kid &#10627;&#955;r s. r = 0&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>unfold</span><span> </span><span>security_kernel_post_read_file&#39;_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>wpsimp</span><span>             
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_binder_set_context_mgr_correctness</span><span class="delimiter">:</span><span>
</span><span class="string"><span class="delete"><span class="delete">&quot;&#10627;&#955;s. True&#10628; security_binder_set_context_mgr&#39; s m &#10627;&#955;r s. r = 0&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>unfold</span><span> </span><span>security_binder_set_context_mgr&#39;_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>wpsimp</span><span>             
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_binder_transaction_correctness</span><span class="delimiter">:</span><span>
</span><span class="string"><span class="delete"><span class="delete">&quot;&#10627;&#955;s. True&#10628; security_binder_transaction&#39; s from to &#10627;&#955;r s. r = 0&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>unfold</span><span> </span><span>security_binder_transaction&#39;_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>wpsimp</span><span>             
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_binder_transfer_binder_correctness</span><span class="delimiter">:</span><span>
</span><span class="string"><span class="delete"><span class="delete">&quot;&#10627;&#955;s. True&#10628; security_binder_transfer_binder&#39; s from to &#10627;&#955;r s. r = 0&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>unfold</span><span> </span><span>security_binder_transfer_binder&#39;_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>wpsimp</span><span>             
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>security_binder_transfer_file_correctness</span><span class="delimiter">:</span><span>
</span><span class="string"><span class="delete"><span class="delete">&quot;&#10627;&#955;s. True&#10628; security_binder_transfer_file&#39; s from to file  &#10627;&#955;r s. r = 0&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>unfold</span><span> </span><span>security_binder_transfer_file&#39;_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>wpsimp</span><span>             
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">thm</span></span><span> </span><span>Kernel.intro</span><span>
</span><span class="keyword1"><span class="command">thm</span></span><span> </span><span>lsm.intro</span><span>
</span><span class="keyword1"><span class="command">thm</span></span><span> </span><span>lsm_ipc_hooks.intro</span><span>
</span><span class="keyword1"><span class="command">thm</span></span><span> </span><span>Kernel_def</span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;interpretation kernel and Dynamic model&#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">interpretation</span></span><span> </span><span>Kernel</span><span>  
</span><span>  </span><span>smack_sb_alloc_security</span><span>
</span><span>  </span><span>smack_sb_free_security</span><span> 
</span><span>  </span><span>smack_sb_copy_data</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_sb_remount&#39;&quot;</span></span></span><span>
</span><span>  </span><span>smack_sb_kern_mount</span><span>
</span><span>  </span><span>security_sb_show_options&#39;</span><span> 
</span><span>  </span><span>smack_sb_statfs</span><span> </span><span>security_sb_mount&#39;</span><span>
</span><span>  </span><span>security_sb_umount&#39;</span><span> 
</span><span>  </span><span>security_sb_pivotroot&#39;</span><span>
</span><span>  </span><span>smack_set_mnt_opts</span><span>
</span><span>  </span><span>security_sb_clone_mnt_opts&#39;</span><span>
</span><span>  </span><span>smack_parse_opts_str</span><span> 
</span><span>  </span><span>security_task_alloc&#39;</span><span>
</span><span>  </span><span>security_task_free&#39;</span><span>
</span><span>  </span><span>smack_cred_alloc_blank</span><span>
</span><span>  </span><span>smack_cred_free</span><span>
</span><span>  </span><span>smack_cred_prepare</span><span>
</span><span>  </span><span>smack_cred_transfer</span><span>
</span><span>  </span><span>smack_cred_getsecid</span><span>
</span><span>  </span><span>security_task_fix_setuid&#39;</span><span>
</span><span>  </span><span>smack_task_setpgid</span><span> </span><span>smack_task_getpgid</span><span>
</span><span>  </span><span>smack_task_getsid</span><span> </span><span>smack_task_getsecid</span><span> 
</span><span>  </span><span>smack_task_setnice</span><span>
</span><span>  </span><span>smack_task_setioprio</span><span>
</span><span>  </span><span>smack_task_getioprio</span><span> 
</span><span>  </span><span>security_task_prlimit&#39;</span><span>
</span><span>  </span><span>security_task_setrlimit&#39;</span><span>
</span><span>  </span><span>smack_task_setscheduler</span><span>
</span><span>  </span><span>smack_task_getscheduler</span><span>
</span><span>  </span><span>smack_task_movememory</span><span> 
</span><span>  </span><span>smack_task_kill</span><span>
</span><span>  </span><span>security_task_prctl&#39;</span><span> 
</span><span>  </span><span>smack_task_to_inode</span><span> 
</span><span>  </span><span>security_binder_set_context_mgr&#39;</span><span>
</span><span>  </span><span>security_binder_transaction&#39;</span><span>
</span><span>  </span><span>security_binder_transfer_binder&#39;</span><span> 
</span><span>  </span><span>security_binder_transfer_file&#39;</span><span>
</span><span>  </span><span>smack_ptrace_access_check</span><span>
</span><span>  </span><span>smack_ptrace_traceme</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_capget&#39;&quot;</span></span></span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_capset&#39;&quot;</span></span></span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_capable&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_capable_noaudit&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_quotactl&#39;&quot;</span></span></span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_quota_on&#39;&quot;</span></span></span><span> 
</span><span>   </span><span>smack_syslog</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_settime64&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_vm_enough_memory_mm&#39;&quot;</span></span></span><span>
</span><span>  </span><span>smack_bprm_set_creds</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_bprm_check&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_bprm_committing_creds&#39;&quot;</span></span></span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_bprm_committed_creds&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_dentry_init_security&#39;&quot;</span></span></span><span>
</span><span>  </span><span>smack_dentry_create_files_as</span><span>
</span><span>  </span><span>smack_inode_alloc_security</span><span>
</span><span>  </span><span>smack_inode_free_security</span><span>
</span><span>  </span><span>smack_inode_init_security</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_old_inode_init_security&#39;&quot;</span></span></span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_create&#39;&quot;</span></span></span><span> 
</span><span>  </span><span>smack_inode_link</span><span>
</span><span>  </span><span>smack_inode_unlink</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_symlink&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_mkdir&#39;&quot;</span></span></span><span>
</span><span>  </span><span>smack_inode_rmdir</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_mknod&#39;&quot;</span></span></span><span> 
</span><span>  </span><span>smack_inode_rename</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_readlink&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_follow_link&#39;&quot;</span></span></span><span> 
</span><span>  </span><span>smack_inode_permission</span><span>
</span><span>  </span><span>smack_inode_setattr</span><span>
</span><span>  </span><span>smack_inode_getattr</span><span>
</span><span>  </span><span>smack_inode_setxattr</span><span>
</span><span>  </span><span>smack_inode_post_setxattr</span><span>
</span><span>  </span><span>smack_inode_getxattr</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_listxattr&#39;&quot;</span></span></span><span>
</span><span>  </span><span>smack_inode_removexattr</span><span>
</span><span>  </span><span>security_inode_killpriv&#39;</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_need_killpriv&#39;&quot;</span></span></span><span>
</span><span>  </span><span>smack_inode_getsecurity</span><span>
</span><span>  </span><span>smack_inode_setsecurity</span><span>
</span><span>  </span><span>smack_inode_listsecurity</span><span>
</span><span>  </span><span>smack_inode_getsecid</span><span>
</span><span>  </span><span>smack_inode_copy_up</span><span>
</span><span>  </span><span>smack_inode_copy_up_xattr</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_inode_invalidate_secctx&#39;&quot;</span></span></span><span> 
</span><span>  </span><span>smack_inode_notifysecctx</span><span>
</span><span>  </span><span>smack_inode_setsecctx</span><span>
</span><span>  </span><span>smack_inode_getsecctx</span><span>
</span><span>  </span><span>access</span><span>
</span><span>  </span><span>current</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_file_permission&#39;&quot;</span></span></span><span>
</span><span>   </span><span>smack_file_alloc_security</span><span>
</span><span>   </span><span>smack_file_free_security</span><span>
</span><span>   </span><span>smack_file_ioctl</span><span>
</span><span>   </span><span>smack_mmap_file</span><span>
</span><span>   </span><span>cap_mmap_addr</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_file_mprotect&#39;&quot;</span></span></span><span>
</span><span>   </span><span>smack_file_lock</span><span>
</span><span>   </span><span>smack_file_fcntl</span><span>
</span><span>   </span><span>smack_file_set_fowner</span><span>
</span><span>   </span><span>smack_file_send_sigiotask</span><span>
</span><span>   </span><span>smack_file_receive</span><span>
</span><span>   </span><span>smack_file_open</span><span>
</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_kernel_act_as&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_kernel_create_files_as&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_kernel_module_request&#39;&quot;</span></span></span><span> 
</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_kernel_load_data&#39;&quot;</span></span></span><span> 
</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_kernel_read_file&#39;&quot;</span></span></span><span> 
</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_kernel_post_read_file&#39;&quot;</span></span></span><span> 
</span><span>  
</span><span>  </span><span>smack_ipc_permission</span><span>
</span><span>  </span><span>smack_ipc_getsecid</span><span>
</span><span>  </span><span>smack_msg_msg_alloc_security</span><span>
</span><span>  </span><span>smack_msg_msg_free_security</span><span> 
</span><span>  </span><span>smack_ipc_alloc_security</span><span>
</span><span>  </span><span>smack_ipc_free_security</span><span>
</span><span>  </span><span>smack_msg_queue_associate</span><span>
</span><span>  </span><span>smack_msg_queue_msgctl</span><span>
</span><span>  </span><span>smack_msg_queue_msgsnd</span><span>
</span><span>  </span><span>smack_msg_queue_msgrcv</span><span>
</span><span>  </span><span>smack_ipc_alloc_security</span><span>
</span><span>  </span><span>smack_ipc_free_security</span><span>
</span><span>  </span><span>smack_shm_associate</span><span>
</span><span>  </span><span>smack_shm_shmctl</span><span>
</span><span>  </span><span>smack_shm_shmat</span><span>
</span><span>  </span><span>smack_ipc_alloc_security</span><span>
</span><span>  </span><span>smack_ipc_free_security</span><span>
</span><span>  </span><span>smack_sem_associate</span><span>
</span><span>  </span><span>smack_sem_semctl</span><span>
</span><span>  </span><span>smack_sem_semop</span><span>
</span><span>
</span><span>  </span><span>smack_d_instantiate</span><span>
</span><span>
</span><span>  </span><span>smack_getprocattr</span><span>
</span><span>  </span><span>smack_setprocattr</span><span>
</span><span>  
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_netlink_send&#39;&quot;</span></span></span><span>
</span><span>  </span><span>smack_ismaclabel</span><span>
</span><span>  </span><span>smack_secid_to_secctx</span><span>
</span><span>  </span><span>smack_secctx_to_secid</span><span>
</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;security_release_secctx&#39;&quot;</span></span></span><span>
</span><span>
</span><span>  </span><span>smack_unix_stream_connect</span><span>
</span><span>  </span><span>smack_unix_may_send</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_create&#39;&quot;</span></span></span><span>
</span><span>  </span><span>smack_socket_post_create</span><span>
</span><span>  </span><span>smack_socket_socketpair</span><span> 
</span><span>  </span><span>smack_socket_bind</span><span>
</span><span>  </span><span>smack_socket_connect</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_listen&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_accept&#39;&quot;</span></span></span><span> 
</span><span>  </span><span>smack_socket_sendmsg</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_recvmsg&#39;&quot;</span></span></span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_getsockname&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_getpeername&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_getsockopt&#39;&quot;</span></span></span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_setsockopt&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_socket_shutdown&#39;&quot;</span></span></span><span> 
</span><span>  </span><span>smack_socket_sock_rcv_skb</span><span>
</span><span>  </span><span>smack_socket_getpeersec_stream</span><span>
</span><span>  </span><span>smack_socket_getpeersec_dgram</span><span>
</span><span>  </span><span>smack_sk_alloc_security</span><span>
</span><span>  </span><span>smack_sk_free_security</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_sk_clone&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_sk_classify_flow&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_req_classify_flow&#39;&quot;</span></span></span><span> 
</span><span>  </span><span>smack_sock_graft</span><span>
</span><span>  </span><span>smack_inet_conn_request</span><span>
</span><span>  </span><span>smack_inet_csk_clone</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_inet_conn_established&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_secmark_relabel_packet&#39;&quot;</span></span></span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_secmark_refcount_inc&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_secmark_refcount_dec&#39;&quot;</span></span></span><span>
</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_tun_dev_alloc_security&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_tun_dev_free_security&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_tun_dev_create&quot;</span></span></span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_tun_dev_attach_queue&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_tun_dev_attach&#39;&quot;</span></span></span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_tun_dev_open&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_sctp_assoc_request&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_sctp_bind_connect&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_sctp_sk_clone&#39;&quot;</span></span></span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_ib_pkey_access&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_ib_endport_manage_subnet&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_ib_alloc_security&#39;&quot;</span></span></span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_ib_free_security&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_xfrm_policy_alloc&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_xfrm_policy_clone&#39;&quot;</span></span></span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_xfrm_policy_free&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_xfrm_policy_delete&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_xfrm_state_alloc&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_xfrm_state_alloc_acquire&#39;&quot;</span></span></span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_xfrm_state_delete&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_xfrm_state_free&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_xfrm_policy_lookup&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_xfrm_state_pol_flow_match&#39;&quot;</span></span></span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_xfrm_decode_session&#39;&quot;</span></span></span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_skb_classify_flow&#39;&quot;</span></span></span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_path_unlink&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_path_mkdir&#39;&quot;</span></span></span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_path_rmdir&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_path_mknod&#39;&quot;</span></span></span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_path_truncate&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_path_symlink&#39;&quot;</span></span></span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_path_link&#39;&quot;</span></span></span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_path_rename&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_path_chmod&#39;&quot;</span></span></span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_path_chown&#39;&quot;</span></span></span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_path_chroot&#39;&quot;</span></span></span><span>
</span><span>
</span><span>  </span><span>smack_key_alloc</span><span>
</span><span>  </span><span>smack_key_free</span><span>
</span><span>  </span><span>smack_key_permission</span><span>
</span><span>  </span><span>smack_key_getsecurity</span><span>
</span><span>
</span><span>  </span><span>smack_audit_rule_init</span><span>
</span><span>  </span><span>smack_audit_rule_known</span><span>
</span><span>  </span><span>smack_audit_rule_match</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_audit_rule_free&#39;&quot;</span></span></span><span> 
</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_bpf&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_bpf_map&#39;&quot;</span></span></span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_bpf_prog&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_bpf_map_alloc&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_bpf_map_free&#39;&quot;</span></span></span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_bpf_prog_alloc&#39;&quot;</span></span></span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;security_bpf_prog_free&#39;&quot;</span></span></span><span>
</span><span>  </span><span>s0</span><span> </span><span>s0</span><span>
</span><span>  </span><span>smk_of_subjlabel</span><span>
</span><span>  </span><span>smk_of_objectlabel</span><span>
</span><span>  </span><span>smk_access_rules</span><span>
</span><span>  </span><span>Subjs</span><span>
</span><span>  </span><span>objset</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;ReferenceMonitor&quot;</span></span></span><span> 
</span><span>
</span><span>  </span><span>tasks</span><span> 
</span><span>  </span><span>inodes</span><span>  
</span><span>  </span><span>k_superblock</span><span>  
</span><span>  </span><span>sdentry</span><span> 
</span><span>  </span><span>sockets</span><span> 
</span><span>  </span><span>keys</span><span>  
</span><span>  </span><span>files</span><span> 
</span><span>  </span><span>msg_msgs</span><span>
</span><span>  </span><span>msg_queues</span><span>
</span><span>  </span><span>contents</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span> </span><span class="delimiter">:</span><span> </span><span>Kernel_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>lsm_def</span><span> </span><span>lsm_hooks_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>auto</span><span class="delimiter">[</span><span>1</span><span class="delimiter">]</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">defer</span></span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>security_task_alloc_correctness</span><span>
</span><span>    </span><span>security_task_free_correctness</span><span>
</span><span>    </span><span>smack_cred_alloc_blank_correctness</span><span>
</span><span>    </span><span>smack_cred_free_correctness</span><span>
</span><span>    </span><span>smack_cred_prepare_correctness</span><span>
</span><span>    </span><span>smack_cred_transfer_correctness</span><span>
</span><span>    </span><span>smack_task_setpgid_correctness</span><span>
</span><span>    </span><span>smack_task_getpgid_correctness</span><span>
</span><span>    </span><span>smack_task_getsid_correctness</span><span>
</span><span>    </span><span>smack_task_getsecid_correctness</span><span>
</span><span>    </span><span>smack_task_setnice_correctness</span><span>
</span><span>    </span><span>smack_task_setioprio_correctness</span><span>
</span><span>    </span><span>smack_task_getioprio_correctness</span><span>
</span><span>    </span><span>smack_task_setscheduler_correctness</span><span>
</span><span>    </span><span>smack_task_getscheduler_correctness</span><span>
</span><span>    </span><span>smack_task_movememory_correctness</span><span>
</span><span>    </span><span>smack_task_kill_correctness</span><span>
</span><span>    </span><span>security_task_prctl_correctness</span><span>
</span><span>    </span><span>smack_task_to_inode_correctness</span><span>
</span><span>        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>lsm_task_hooks_def</span><span> </span><span>hoare_post_taut</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>security_binder_set_context_mgr_correctness</span><span>
</span><span>    </span><span>security_binder_transaction_correctness</span><span>
</span><span>    </span><span>security_binder_transfer_binder_correctness</span><span>
</span><span>    </span><span>security_binder_transfer_file_correctness</span><span>
</span><span>           </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span> </span><span class="delimiter">:</span><span> </span><span>lsm_binder_hooks_def</span><span> </span><span>hoare_post_taut</span><span class="delimiter">)</span><span>
</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>smack_ptrace_access_check_correctness</span><span>
</span><span>  </span><span>smack_ptrace_traceme_correctness</span><span>
</span><span>          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>lsm_ptrace_hooks.intro</span><span class="delimiter">)</span><span>
</span><span>   </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span> </span><span class="delimiter">:</span><span> </span><span>lsm_bprm_hooks_def</span><span> </span><span>hoare_post_taut</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>security_dentry_init_security_correctness</span><span> 
</span><span>    </span><span>smack_dentry_create_files_as_correctness</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>hoare_vcg_prop</span><span> </span><span>lsm_dentry_hooks.intro</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>security_file_permission_correctness</span><span>
</span><span>  </span><span>smack_file_alloc_security_correctness</span><span>
</span><span>  </span><span>smack_file_free_security_correctness</span><span>
</span><span>  </span><span>smack_file_ioctl_correctness</span><span>
</span><span>  </span><span>smack_mmap_file_correctness</span><span>
</span><span>  </span><span>cap_mmap_addr_correctness</span><span>
</span><span>  </span><span>security_file_mprotect_correctness</span><span>
</span><span>  </span><span>smack_file_lock_correctness</span><span>
</span><span>  </span><span>smack_file_fcntl_correctness</span><span>
</span><span>  </span><span>smack_file_set_fowner_correctness</span><span>
</span><span>  </span><span>smack_file_send_sigiotask_correctness</span><span>
</span><span>  </span><span>smack_file_receive_correctness</span><span>
</span><span>  </span><span>smack_file_open_correctness</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>lsm_file_hooks.intro</span><span> </span><span>hoare_post_taut</span><span class="delimiter">)</span><span> 
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>security_kernel_act_as_correctness</span><span> 
</span><span>    </span><span>security_kernel_create_files_as_correctness</span><span>
</span><span>    </span><span>security_kernel_load_data_correctness</span><span> 
</span><span>    </span><span>security_kernel_module_request_correctness</span><span>
</span><span>    </span><span>security_kernel_read_file_correctness</span><span> 
</span><span>    </span><span>security_kernel_post_read_file_correctness</span><span>
</span><span>      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>lsm_kernel_hooks.intro</span><span> </span><span>hoare_post_taut</span><span class="delimiter">)</span><span>
</span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>smack_ipc_permission_correctness</span><span>
</span><span>  </span><span>smack_ipc_getsecid_correctness</span><span>
</span><span>  </span><span>smack_ipc_alloc_security_correctness</span><span>
</span><span>  </span><span>smack_ipc_free_security_correctness</span><span>
</span><span>  </span><span>smack_shm_associate_correctness</span><span>
</span><span>  </span><span>smack_shm_shmctl_correctness</span><span>
</span><span>  </span><span>smack_shm_shmat_correctness</span><span>
</span><span>  </span><span>smk_curacc_sem_correctness</span><span>
</span><span>  </span><span>smack_sem_associate_correctness</span><span>
</span><span>  </span><span>smack_sem_semctl_correctness</span><span>
</span><span>  </span><span>smack_sem_semop_correctness</span><span>
</span><span>  </span><span>smk_curacc_msq_correctness</span><span>
</span><span>  </span><span>smack_msg_associate_correctness</span><span>
</span><span>  </span><span>smack_msg_queue_msgctl_correctness</span><span>
</span><span>  </span><span>smack_msg_queue_msgsnd_correctness</span><span>
</span><span>  </span><span>smack_msg_queue_msgrcv_correctness</span><span>
</span><span>  </span><span>smack_msg_msg_alloc_security_correctness</span><span>
</span><span>  </span><span>smack_msg_msg_free_security_correctness</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>lsm_ipc_hooks.intro</span><span> </span><span>hoare_post_taut</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>smack_key_alloc_correctness</span><span>
</span><span>  </span><span>smack_key_free_correctness</span><span>
</span><span>  </span><span>smack_key_permission_correctness</span><span>
</span><span>  </span><span>smack_key_getsecurity_correctness</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>hoare_post_taut</span><span> </span><span>lsm_key_hooks.intro</span><span> </span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>smack_audit_rule_init_correctness</span><span>
</span><span>  </span><span>smack_audit_rule_known_correctness</span><span>
</span><span>  </span><span>smack_audit_rule_match_correctness</span><span>
</span><span>  </span><span>security_audit_rule_free_correctness</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>hoare_post_taut</span><span> </span><span>lsm_audit_hooks_def</span><span> </span><span class="delimiter">)</span><span> 
</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>smack_sb_alloc_security_correctness</span><span>
</span><span>    </span><span>smack_sb_free_security_correctness</span><span> 
</span><span>    </span><span>smack_sb_copy_data_correctness</span><span>
</span><span>    </span><span>smack_set_mnt_opts_correctness</span><span>
</span><span>    </span><span>smack_sb_kern_mount_correctness</span><span>
</span><span>    </span><span>smack_sb_statfs_correctness</span><span> 
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>lsm_superblock_hooks_def</span><span> </span><span>hoare_post_taut</span><span> </span><span>ENOMEM_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>obs</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;State&#39; &#8658; process_id &#8658; bool&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;obs s p &#8801; True&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>sched</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;State&#39; &#8658; Event_manage_hooks&#8658; bool&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;sched s e&#8801; (the(getpid_from_manage_hooks e)) = current s&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">axiomatization</span></span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>sched&#39;</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;s e. sched s e = True&quot;</span></span></span><span>
</span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>process_label_not_star</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s (current s) &#8800; Star&quot;</span></span></span><span>
</span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>process_label_not_undefined</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s (current s) &#8800; UNDEFINED&quot;</span></span></span><span>
</span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>current_alter</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;exec_manage_event s e = t&#10230; drma3s = True&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>subj_web</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj s d . &#8707;subj. smk_of_subjlabel s subj = Web &#8743; d &#8800; subj &#10230; interference subj s d &quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">interpretation</span></span><span> </span><span>LSM_Security_model</span><span> </span><span>s0</span><span> </span><span>exec_manage_event</span><span> </span><span>getpid_from_manage_hooks</span><span> </span><span>kvpeq</span><span> </span><span>interference</span><span> </span><span>observe</span><span> </span><span>alter</span><span> </span><span>contents</span><span> 
</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>kvpeq_transitive_lemma</span><span> </span><span>kvpeq_symmetric_lemma</span><span> </span><span>kvpeq_reflexive_lemma</span><span> </span><span>ac_interferes&#39;</span><span>
</span><span>       </span><span>nintf_reflx</span><span> </span><span>policy_respect1</span><span> </span><span>reachable_top</span><span>  </span><span>contents_consistent&#39;</span><span> </span><span>observed_consistent&#39;</span><span>
</span><span>       </span><span>SM.intro</span><span class="delimiter">[</span><span>of</span><span> </span><span>kvpeq</span><span> </span><span>interference</span><span class="delimiter">]</span><span>
</span><span>       </span><span>SM_enabled_axioms.intro</span><span class="delimiter">[</span><span>of</span><span> </span><span>s0</span><span> </span><span>exec_manage_event</span><span> </span><span>kvpeq</span><span> </span><span>interference</span><span> </span><span class="delimiter">]</span><span>
</span><span>       </span><span>SM_enabled.intro</span><span class="delimiter">[</span><span>of</span><span>  </span><span>kvpeq</span><span> </span><span>interference</span><span> </span><span class="delimiter">]</span><span> 
</span><span>       </span><span>LSM_Security_model.intro</span><span class="delimiter">[</span><span>of</span><span> </span><span>s0</span><span> </span><span>exec_manage_event</span><span> </span><span>kvpeq</span><span> </span><span>interference</span><span> </span><span class="delimiter">]</span><span>
</span><span>       </span><span>LSM_Security_model_axioms.intro</span><span class="delimiter">[</span><span>of</span><span> </span><span>kvpeq</span><span> </span><span>observe</span><span>  </span><span>contents</span><span> </span><span>alter</span><span> </span><span>interference</span><span class="delimiter">]</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fast</span><span>
</span><span>
</span><span class="keyword1"><span class="command">notation</span></span><span> </span><span>kvpeq</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">&quot;(_ &#8764; _ &#8764; _)&quot;</span></span></span><span class="delimiter">)</span><span> 
</span><span class="keyword1"><span class="command">notation</span></span><span> </span><span>interference</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">&quot;(_ @ _&#8605; _)&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">declare</span></span><span>   </span><span>kvpeq_reflexive_lemma</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;Correctness for specification &#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">subsubsection</span></span><span class="cartouche"><span class="delete"><span class="delete">&#8249; Correctness lemmas&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>create_new_superblock_cor</span><span> </span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>p1</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;r = k_create_new_superblock s pid t &quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>p2</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;sb = getsb_by_id s t&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>p3</span><span> </span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;(result s (smack_sb_alloc_security s sb) ) = False&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(snd r) = None &quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p1</span><span> </span><span>p2</span><span>  </span><span>p3</span><span>  </span><span>k_create_new_superblock_def</span><span> </span><span>security_sb_alloc_def</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>create_new_superblock_cor2</span><span> </span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>p1</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;r = k_create_new_superblock s pid t &quot;</span></span></span><span>
</span><span>     </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>p2</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;sb = getsb_by_id s t&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>p5</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot; result s (smack_sb_alloc_security s sb) = True&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;(snd r) &#8800; None &quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>smt</span><span> </span><span>is_none_code</span><span class="delimiter">(</span><span>2</span><span class="delimiter">)</span><span> </span><span>is_none_simps</span><span class="delimiter">(</span><span>1</span><span class="delimiter">)</span><span> </span><span>k_create_new_superblock_def</span><span> </span><span>p1</span><span> </span><span>p2</span><span>  </span><span>p5</span><span> </span><span>snd_eqD</span><span> </span><span>security_sb_alloc_def</span><span class="delimiter">)</span><span>
</span><span>  
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>sb_free_cor</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>p1</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;r = k_sb_free s pid t&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>p2</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;snd r = ()&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>p3</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;sb = the((k_superblock s) t)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>p4</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = snd(the_run_state(smack_sb_free_security s sb) s) &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(fst r) = s&#39; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p1</span><span> </span><span>p2</span><span> </span><span>p3</span><span> </span><span>p4</span><span>  </span><span>k_sb_free_def</span><span> </span><span>security_sb_free_def</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>getsb_by_id_def</span><span> </span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>sb_free_cor2</span><span class="delimiter">:</span><span>
</span><span> </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>p1</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;r = k_sb_free s pid t&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>p2</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;sb = the((k_superblock s) t)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>p3</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = snd(the_run_state(smack_sb_free_security s sb) s) &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot; s&#39;=s&#10631;sb_security := (sb_security s)(sb := None ) &#10632;&quot;</span></span></span><span> 
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p1</span><span> </span><span>p3</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>smack_sb_free_security_def</span><span> </span><span>the_run_state_def</span><span> </span><span>return_def</span><span> </span><span>getsb_by_id_def</span><span>
</span><span>          </span><span>modify_def</span><span> </span><span>put_def</span><span> </span><span>get_def</span><span> </span><span>bind_def</span><span>  </span><span>split_def</span><span> </span><span>k_sb_free_def</span><span> </span><span>p2</span><span class="delimiter">)</span><span> 
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>sb_copy_data_cor</span><span> </span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>p1</span><span> </span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;r = k_sb_copy_data s pid&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>p2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;copy = (SOME x::string. True) &#8743; orig = []&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>p3</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;result s (smack_sb_copy_data s orig copy) = False&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;snd(r) = 0&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p1</span><span> </span><span>p2</span><span> </span><span>p3</span><span> 
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#172; LSM_Smack.result s (smack_sb_copy_data s [] (SOME x. True))&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p2</span><span> </span><span>p3</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;k_sb_copy_data s pid= (s, 0)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>k_sb_copy_data_def</span><span> </span><span>security_sb_copy_data_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>presburger</span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>p1</span><span> </span><span>sndI</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>sb_copy_data_cor&#39;</span><span> </span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>p1</span><span> </span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;r = k_sb_copy_data s pid&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>p2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;copy = (SOME x::string. True) &#8743; orig = []&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>p3</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;result s (smack_sb_copy_data s orig copy) = True&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>p4</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;v = resultValue s (smack_sb_copy_data s orig copy)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;snd(r) = v&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p1</span><span> </span><span>p2</span><span> </span><span>p3</span><span> </span><span>p4</span><span> </span><span>result_def</span><span> </span><span>resultValue_def</span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;resultValue s (smack_sb_copy_data s [] (SOME x. True)) = 0&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span class="delimiter">(</span><span>no_types</span><span class="delimiter">)</span><span> </span><span>LSM_Smack.result_def</span><span> </span><span>p2</span><span> </span><span>p3</span><span> </span><span>resultValue_def</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;r = (s, 0)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>k_sb_copy_data_def</span><span> </span><span>p1</span><span> </span><span>security_sb_copy_data_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>presburger</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span class="delimiter">(</span><span>no_types</span><span class="delimiter">)</span><span> </span><span>LSM_Smack.result_def</span><span> </span><span>p3</span><span> </span><span>p4</span><span> </span><span>resultValue_def</span><span> </span><span>sndI</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>do_remount_cor</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>p1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;r = do_remount s p data&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>p2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;result s (security_sb_remount&#39; s  (mnt_sb (p_mnt p)) data) = True&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>p3</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;retval =  resultValue s (security_sb_remount&#39;  s  (mnt_sb (p_mnt p)) data) &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span class="string"><span class="delete"><span class="delete">&quot;snd r = retval&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>do_remount_def</span><span> </span><span>security_sb_remount_def</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>p1</span><span> </span><span>p2</span><span> </span><span>p3</span><span> </span><span>snd_conv</span><span class="delimiter">)</span><span>
</span><span>  
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>show_sb_opts_cor</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>p1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;r = show_sb_opts s pid m t&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>p2</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;retval = resultValue s (security_sb_show_options&#39; s m (getsb_by_id s t))&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;snd r = retval&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(s, retval) = r&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>show_sb_opts_def</span><span> </span><span>security_sb_show_options_def</span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>p1</span><span> </span><span>p2</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>snd_conv</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">thm</span></span><span> </span><span>statfs_by_dentry_def</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>statfs_by_dentry_cor</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>p1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;r = statfs_by_dentry s pid d&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>p2</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;retval = resultValue s (smack_sb_statfs s d)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;snd r = retval&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(s, retval) = r&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>statfs_by_dentry_def</span><span> </span><span>security_sb_statfs_def</span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>p1</span><span> </span><span>p2</span><span> </span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>snd_conv</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span> 
</span><span>  </span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;Some lemmas of security proofs&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>get_subj_policy_from_id</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;State&#39; &#8658; process_id &#8658;  nat &#215; Obj &#8658; access set&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;get_subj_policy_from_id s p &#8801;  (pol_tab s) p&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">type_synonym</span></span><span> </span><span>objaccess</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;Label &#8658; access set&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>get_subj_access_from_id</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;State&#39; &#8658; process_id &#8658; objaccess&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;get_subj_access_from_id s p &#8801;  (smk_access_rules ) (smk_of_subjlabel s p)&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span class="cartouche"><span class="delete"><span class="delete">&#8249; Concrete unwinding condition of &quot;local respect&quot;&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span class="cartouche"><span class="delete"><span class="delete">&#8249; smack superblock hooks local respect proof&#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">subsubsection</span></span><span class="cartouche"><span class="delete"><span class="delete">&#8249;proving &quot;create new superblock&quot; satisfying the &quot;local respect&quot; property&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>subjlabelnotchg</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#10214;t_security s = t_security t;&#8704;d. tasks s d = tasks t d &#10215; &#10233;
                     &#8704;d .smk_of_subjlabel s d = smk_of_subjlabel t d&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>    </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;t_security s = t_security t&quot;</span></span></span><span>
</span><span>    </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a1</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;d. tasks s d = tasks t d&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a2</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot; (smk_known (smk_task (task_security s (the (tasks s d))))) =
                (smk_known (smk_task (task_security t (the (tasks t d)))))&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a0</span><span> </span><span>a1</span><span> 
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>task_security_def</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a3</span><span> </span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;d .smk_of_subjlabel s d = smk_of_subjlabel t d&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a2</span><span> </span><span>smk_of_subjlabel_def</span><span> </span><span>smk_of_task_def</span><span> 
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>a0</span><span> </span><span>a1</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span> 
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">
</span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete"></span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span class="cartouche"><span class="delete"><span class="delete">&#8249; smack file hooks local respect proof&#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">subsubsection</span></span><span class="cartouche"><span class="delete"><span class="delete">&#8249;proving &quot;alloc_file&quot; satisfying the &quot;local respect&quot; property&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>alloc_file_pre</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;resultValue s ( security_file_alloc s file ) = 0 
   &#10230; f_security s file = None&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>resultValue_def</span><span> </span><span>security_file_alloc_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>the_run_state_def</span><span> </span><span>smack_file_alloc_security_def</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>EEXIST_def</span><span> </span><span>return_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span> 
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>alloc_file_notchg_subjlabel</span><span class="delimiter">:</span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>p0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 s&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#172;(interference (current s) s d)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = fst(alloc_file s pid file c)&quot;</span></span></span><span>    
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot; smk_of_subjlabel s d = smk_of_subjlabel s&#39; d&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;resultValue s ( security_file_alloc s file ) &#8800; 0&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>True</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s = s&#39;&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p2</span><span> </span><span>alloc_file_def</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>True</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>False</span><span>
</span><span>  </span><span class="keyword1"><span class="command">let</span></span><span> </span><span class="var">?fsec</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_current s &quot;</span></span></span><span>  
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a1</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = snd (the_run_state (security_file_alloc s file) s)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>alloc_file_def</span><span> </span><span>p2</span><span> </span><span>False</span><span> </span><span>funcState_def</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a2</span><span> </span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;resultValue s ( security_file_alloc s file ) = 0&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>False</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a3</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;f_security s file = None&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a2</span><span> </span><span>alloc_file_pre</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>a1</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a4</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = s&#10631;f_security := (f_security s)(file := Some ?fsec )&#10632;&quot;</span></span></span><span> 
</span><span>    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>funcState_def</span><span> </span><span>security_file_alloc_def</span><span> </span><span>the_run_state_def</span><span> </span><span>return_def</span><span> 
</span><span>          </span><span>smack_file_alloc_security_def</span><span> </span><span>modify_def</span><span> </span><span>put_def</span><span> </span><span>get_def</span><span> </span><span>bind_def</span><span>  </span><span>EEXIST_def</span><span> </span><span class="delimiter">)</span><span> 
</span><span>    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>auto</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>False</span><span> 
</span><span>   </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a3</span><span> </span><span>not_None_eq</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b3</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;t_security s = t_security s&#39; &quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a4</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b4</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;d &#8800; current s&quot;</span></span></span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p2</span><span> </span><span>non_interference_def</span><span> </span><span>p1</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>nintf_reflx</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b5</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;d .tasks s d = tasks s&#39; d&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a4</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b6</span><span> </span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;d. smk_of_subjlabel s d = smk_of_subjlabel s&#39; d&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>b3</span><span> </span><span>b5</span><span> </span><span>subjlabelnotchg</span><span>   
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b7</span><span> </span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot; smk_of_subjlabel s d = smk_of_subjlabel s&#39; d&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>b6</span><span>    
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>alloc_file_notchg_obs</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>p0</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 s&quot;</span></span></span><span> 
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>p1</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;&#172;(interference (current s) s d)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>p2</span><span class="delimiter">:</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = fst(alloc_file s pid file c)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>p3</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;e =  Event_alloc_file  pid file c &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;observe s d = observe s&#39; d&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;resultValue s ( security_file_alloc s file ) &#8800; 0&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>True</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s = s&#39;&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p2</span><span> </span><span>alloc_file_def</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>True</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>False</span><span>
</span><span>  </span><span class="keyword1"><span class="command">let</span></span><span> </span><span class="var">?fsec</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_current s &quot;</span></span></span><span>  
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a1</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = snd (the_run_state (security_file_alloc s file) s)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>alloc_file_def</span><span> </span><span>p2</span><span>  </span><span>False</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>funcState_def</span><span class="delimiter">)</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a2</span><span> </span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;resultValue s ( security_file_alloc s file ) = 0&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>False</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a3</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;f_security s file = None&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a2</span><span> </span><span>alloc_file_pre</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>a1</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = s&#10631;f_security := (f_security s)(file := Some ?fsec )&#10632;&quot;</span></span></span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span class="delimiter">(</span><span> </span><span>auto</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>security_file_alloc_def</span><span> </span><span>the_run_state_def</span><span> </span><span>return_def</span><span> 
</span><span>          </span><span>smack_file_alloc_security_def</span><span> </span><span>modify_def</span><span> </span><span>put_def</span><span> </span><span>get_def</span><span> </span><span>bind_def</span><span> </span><span>EEXIST_def</span><span> </span><span>a3</span><span class="delimiter">)</span><span> 
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b3</span><span> </span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s d = smk_of_subjlabel s&#39; d&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>p0</span><span> </span><span>p1</span><span> </span><span>p2</span><span> </span><span>alloc_file_notchg_subjlabel</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span> 
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a4</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;contents s&#39; (File file) &#8800; contents s (File file)&quot;</span></span></span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>contents_def</span><span> </span><span>b2</span><span> </span><span>a3</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a5</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = exec_manage_event s e&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>exec_manage_event_def</span><span> </span><span>p2</span><span> </span><span>p3</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a6</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(the (getpid_from_manage_hooks e)) = current s&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p1</span><span> </span><span>getpid_from_manage_hooks_def</span><span>  </span><span>sched&#39;</span><span> </span><span>sched_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a7</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;contents (exec_manage_event s e) (File file) &#8800;  contents s (File file)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a4</span><span> </span><span>a5</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>   
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a8</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(File file) &#8712; alter s (the (getpid_from_manage_hooks e)) &quot;</span></span></span><span> 
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>drma3_def</span><span> </span><span>a7</span><span>  </span><span>current_alter</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>    
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b4</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;alter s (current s)  &#8745; observe s d = {}&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p1</span><span> </span><span>interference_def</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>metis</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b5</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_filelabel s file = UNDEFINED&quot;</span></span></span><span>  
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>smk_of_filelabel_def</span><span> </span><span>a3</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b6</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(File file) &#8713; observe s d&quot;</span></span></span><span> 
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>b4</span><span>  </span><span>a6</span><span> </span><span>a8</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b7</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;current s = current s&#39;&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>b2</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b8</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s&#39; (current s) = smk_of_objectlabel s&#39; (File file)&quot;</span></span></span><span> 
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>b2</span><span>  </span><span>smk_of_subjlabel_def</span><span> </span><span>smk_of_objectlabel_def</span><span> 
</span><span>      </span><span>smk_of_current_def</span><span>  </span><span>task_cred_def</span><span>
</span><span>     </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>auto</span><span> 
</span><span>     </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>meson</span><span> </span><span>process_label_not_undefined</span><span class="delimiter">)</span><span>
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span>  </span><span>task_security_def</span><span> </span><span>current_task_def</span><span> </span><span>SmackHooks.task_cred_def</span><span> </span><span>smk_of_filelabel_def</span><span class="delimiter">)</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a9</span><span> </span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;smk_access_rules (smk_of_subjlabel s&#39; (current s)) (smk_of_filelabel s&#39; file) = {READ,EXECUTE,WRITE,APPEND,T, LOCK }&quot;</span></span></span><span>
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>b8</span><span> </span><span>smk_access_rules_def</span><span> 
</span><span>     </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>auto</span><span> 
</span><span>     </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>b7</span><span> </span><span>process_label_not_star</span><span class="delimiter">)</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>b7</span><span> </span><span>process_label_not_undefined</span><span class="delimiter">)</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b7&#39;</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(File file) &#8712; alter s&#39; (current s&#39;) &quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a9</span><span> </span><span>alter_def</span><span> </span><span>b7</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>meson</span><span> </span><span>current_alter</span><span class="delimiter">)</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a10</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s (current s) &#8800; UNDEFINED&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>process_label_not_undefined</span><span class="delimiter">)</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a11</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;d .tasks s d = tasks s&#39; d&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>b2</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a12</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;t_security s = t_security s&#39; &quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>b2</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a13</span><span> </span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;v. smk_of_subjlabel s v = smk_of_subjlabel s&#39; v&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>a11</span><span> </span><span>a12</span><span> </span><span>subjlabelnotchg</span><span>   
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b10</span><span> </span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;v .get_subj_access_from_id s v = get_subj_access_from_id s&#39; v&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span>  </span><span>get_subj_access_from_id_def</span><span>  </span><span>smk_access_rules_def</span><span class="delimiter">)</span><span>
</span><span>     </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>auto</span><span class="delimiter">[</span><span>1</span><span class="delimiter">]</span><span>
</span><span>     </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>smk_access_rules_def</span><span>
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a13</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>presburger</span><span>
</span><span>  </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* have b11: &quot;&#8704;subj. smk_of_subjlabel s subj &#8800; Web&quot; 
     using non_interference_def p1 interference_def
     by meson
   have b12 : &quot;&#8704;obs. smk_of_objectlabel s obs &#8800; Web&quot; 
      using non_interference_def p1 interference_def 
      by meson
   have b13 : &quot;&#8704;obs. smk_of_objectlabel s obs &#8800; Star&quot; 
     using non_interference_def p1 interference_def 
     by meson
   have b14 : &quot;(smk_of_subjlabel s (current s)) &#8800; Star&quot; using process_label_not_star 
     by simp*)</span></span></span></span></span><span>
</span><span>   </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*have b15: &quot;(smk_of_subjlabel s&#39; d) &#8800; (smk_of_filelabel s&#39; file)&quot;  
     using a13 b8 b9 by auto
   have b16: &quot;smk_of_subjlabel s (current s) &#8800; Floor&quot; 
     using non_interference_def p1 interference_def 
     by meson*)</span></span></span></span></span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a14</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;current s = current s&#39;&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>b2</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a15</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s (current s) = smk_of_subjlabel s&#39; (current s&#39;)&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a13</span><span> </span><span>a14</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>   </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*have b17 : &quot;smk_of_subjlabel s&#39; (current s&#39;) &#8800; Floor&quot; using b16 a15 
     by simp
   have b18 : &quot;(smk_of_filelabel s&#39; file) &#8800; Floor&quot; using b17 a15 b8 
     using a14 by auto
 
   have b20 : &quot;smk_of_subjlabel s d &#8800; Hat &#8743; smk_of_subjlabel s&#39; d &#8800; Hat &quot;   
     using non_interference_def p1 interference_def b3
     by metis*)</span></span></span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b21</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_objectlabel s&#39; (File file) &#8800; Star &quot;</span></span></span><span>   
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>a13</span><span> </span><span>b8</span><span> </span><span>process_label_not_star</span><span class="delimiter">)</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a16</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_objectlabel s&#39; (File file) &#8800; UNDEFINED&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a10</span><span> </span><span>a13</span><span> </span><span>b8</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a17</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_access_rules (smk_of_subjlabel s&#39; d) (smk_of_filelabel s&#39; file) = {}&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>smk_access_rules_def</span><span> </span><span>a16</span><span>   </span><span>b21</span><span> </span><span>a13</span><span>  </span><span>b8</span><span> </span><span class="delimiter">)</span><span>
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>current_alter</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>    
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a20</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;observe s d = observe s&#39; d&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>observe_def</span><span>  
</span><span>     </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span>observe_def</span><span> </span><span>objset_def</span><span class="delimiter">)</span><span>
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>a8</span><span> </span><span>alter_def</span><span> </span><span>b5</span><span> </span><span>smk_access_rules_def</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span> </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>alloc_file_notchg_policy</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>p0</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 s&quot;</span></span></span><span> 
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>p1</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;&#172;(interference (current s) s d)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>p2</span><span class="delimiter">:</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = fst(alloc_file s pid file c)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>p3</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;e =  (Event_alloc_file  pid file c) &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#8704;v .interference v s d = interference v s&#39; d)&quot;</span></span></span><span> 
</span><span class="keyword1"><span class="command">proof</span></span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;resultValue s ( security_file_alloc s file ) &#8800; 0&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>True</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s = s&#39;&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p2</span><span> </span><span>alloc_file_def</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>True</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>interference_def</span><span> </span><span>a1</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>False</span><span>
</span><span>  </span><span class="keyword1"><span class="command">let</span></span><span> </span><span class="var">?fsec</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_current s &quot;</span></span></span><span>  
</span><span>  </span><span class="keyword1"><span class="command">let</span></span><span> </span><span class="var">?pid</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;current s&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a1</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = snd (the_run_state (security_file_alloc s file) s)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>alloc_file_def</span><span> </span><span>p2</span><span> </span><span>False</span><span> </span><span>funcState_def</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a2</span><span> </span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;resultValue s ( security_file_alloc s file ) = 0&quot;</span></span></span><span> 
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>False</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a3</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;f_security s file = None&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a2</span><span> </span><span>alloc_file_pre</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>a1</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a4</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = s&#10631;f_security := (f_security s)(file := Some ?fsec )&#10632;&quot;</span></span></span><span> 
</span><span>    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>funcState_def</span><span> </span><span>security_file_alloc_def</span><span> </span><span>the_run_state_def</span><span> </span><span>return_def</span><span> 
</span><span>          </span><span>smack_file_alloc_security_def</span><span> </span><span>modify_def</span><span> </span><span>put_def</span><span> </span><span>get_def</span><span> </span><span>bind_def</span><span>  </span><span>EEXIST_def</span><span> </span><span class="delimiter">)</span><span> 
</span><span>    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>auto</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>False</span><span>  </span><span>a3</span><span> </span><span>not_None_eq</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a5</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;the (f_security s&#39; file) = ?fsec&quot;</span></span></span><span> 
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a4</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a6</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;t_security s = t_security s&#39; &quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a4</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a7</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;d &#8800; ?pid&quot;</span></span></span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p2</span><span> </span><span>non_interference_def</span><span> </span><span>p1</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>nintf_reflx</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span> 
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a8</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;v. tasks s v = tasks s&#39; v&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a4</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a9</span><span> </span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s d = smk_of_subjlabel s&#39; d&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>a6</span><span> </span><span>a8</span><span> </span><span>subjlabelnotchg</span><span>  
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>   
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a10</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot; ?pid = current s&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>sched&#39;</span><span> </span><span>sched_def</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a11</span><span> </span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s ?pid = smk_of_subjlabel s&#39; ?pid&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>a6</span><span> </span><span>a8</span><span> </span><span>subjlabelnotchg</span><span>  
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span> 
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a12</span><span> </span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;v. smk_of_subjlabel s v = smk_of_subjlabel s&#39; v&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>a6</span><span> </span><span>a8</span><span> </span><span>subjlabelnotchg</span><span>  
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>   
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a13</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;current s = current s&#39;&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a4</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a14</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s (current s) = smk_of_subjlabel s&#39; (current s&#39;)&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a11</span><span> </span><span>a13</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e1</span><span> </span><span class="delimiter">:</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj . sb_security s obj = sb_security s&#39; obj&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a4</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>   </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>e1</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e2</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj. smk_of_superblocklabel s obj = smk_of_superblocklabel s&#39; obj&quot;</span></span></span><span>
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>smk_of_superblocklabel_def</span><span> </span><span>a4</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e3</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj. t_security s obj  = t_security s&#39; obj&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a4</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>   </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>e3</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e4</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj. smk_of_subjlabel_real s obj = smk_of_subjlabel_real s&#39; obj&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>smk_of_subjlabel_real_def</span><span> </span><span>a4</span><span> </span><span>task_real_cred_def</span><span> </span><span>smk_of_task_def</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e5</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj. ipc_security s obj  = ipc_security s&#39; obj&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a4</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>   </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>e5</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e6</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj. smk_of_ipclabel s obj = smk_of_ipclabel s&#39; obj&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>smk_of_ipclabel_def</span><span> </span><span>a4</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e7</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj&#8800; file. f_security s obj  = f_security s&#39; obj&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a4</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>   </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>e7</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e8</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj&#8800; file. smk_of_filelabel s obj = smk_of_filelabel s&#39; obj&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>smk_of_filelabel_def</span><span> </span><span>a4</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e9</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj. msg_security s obj  = msg_security s&#39; obj&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a4</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>   </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>e9</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e10</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj. smk_of_msglabel s obj = smk_of_msglabel s&#39; obj&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>smk_of_msglabel_def</span><span> </span><span>a4</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e11</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj. i_security s obj  = i_security s&#39; obj&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a4</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>   </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>e11</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e12</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj. smk_of_inodelabel s obj = smk_of_inodelabel s&#39; obj&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>smk_of_inodelabel_def</span><span> </span><span>a4</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e13</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj. sk_security s obj  = sk_security s&#39; obj&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a4</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>   </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>e13</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e14</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj. smk_of_sklabel s obj = smk_of_sklabel s&#39; obj&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>smk_of_sklabel_def</span><span> </span><span>a4</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e15</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj. key_security s obj  = key_security s&#39; obj&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a4</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>   </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>e7</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e16</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj. smk_of_keylabel s obj = smk_of_keylabel s&#39; obj&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>smk_of_keylabel_def</span><span> </span><span>a4</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a15</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj&#8800;(File file). smk_of_objectlabel s&#39; obj = smk_of_objectlabel s obj&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>e2</span><span> </span><span>e4</span><span> </span><span>e6</span><span> </span><span>e8</span><span> </span><span>e10</span><span> </span><span>e12</span><span> </span><span>e14</span><span> </span><span>e16</span><span>
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>Obj.exhaust</span><span> </span><span>smk_of_objectlabel.simps</span><span class="delimiter">)</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a16</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_objectlabel s (File file) = UNDEFINED&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>a3</span><span> </span><span>smk_of_filelabel_def</span><span class="delimiter">)</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b1</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;alter s ?pid  &#8745; observe s d = {}&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p1</span><span> </span><span>interference_def</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>metis</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b2</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;contents s&#39; (File file) &#8800; contents s (File file)&quot;</span></span></span><span> 
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>contents_def</span><span> </span><span>a3</span><span> </span><span>a4</span><span class="delimiter">)</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b3</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = exec_manage_event s e&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>exec_manage_event_def</span><span> </span><span>p2</span><span> </span><span>p3</span><span> 
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b4</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(the (getpid_from_manage_hooks e)) = current s&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p1</span><span> </span><span>domain_of_event_def</span><span> </span><span>getpid_from_file_event_def</span><span> 
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>sched&#39;</span><span> </span><span>sched_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b5</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;contents (exec_manage_event s e) (File file) &#8800;  contents s (File file)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>b2</span><span> </span><span>b3</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>         
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a18</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(File file) &#8712; alter s (the (getpid_from_manage_hooks e)) &quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>drma3_def</span><span> </span><span>a7</span><span> </span><span>current_alter</span><span> 
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b6</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;observe s d = observe s&#39; d&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p0</span><span> </span><span>p1</span><span> </span><span>p2</span><span> </span><span>alloc_file_notchg_obs</span><span> </span><span>p3</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b7</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s d = smk_of_subjlabel s&#39; d&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p0</span><span> </span><span>p1</span><span> </span><span>p2</span><span> </span><span>alloc_file_notchg_subjlabel</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b8</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s&#39; (current s) = smk_of_objectlabel s&#39; (File file)&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a4</span><span> </span><span>a10</span><span> </span><span>smk_of_subjlabel_def</span><span> </span><span>smk_of_objectlabel_def</span><span> </span><span>smk_of_current_def</span><span>  </span><span>task_cred_def</span><span>
</span><span>     </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>auto</span><span> 
</span><span>     </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>meson</span><span> </span><span>process_label_not_undefined</span><span class="delimiter">)</span><span>
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span>  </span><span>task_security_def</span><span> </span><span>current_task_def</span><span> </span><span>SmackHooks.task_cred_def</span><span> </span><span>smk_of_filelabel_def</span><span class="delimiter">)</span><span> 
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b9</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s&#39; d &#8800; (smk_of_objectlabel s&#39; (File file))&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>b7</span><span> </span><span>b8</span><span> </span><span>a14</span><span> </span><span>smk_of_filelabel_def</span><span>   </span><span>current_alter</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b10</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot; smk_of_subjlabel s&#39; ?pid &#8800; smk_of_subjlabel s&#39; d &quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>b9</span><span> </span><span>b8</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">let</span></span><span> </span><span class="var">?obs</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(alter s ?pid) &quot;</span></span></span><span>
</span><span>   </span><span class="keyword1"><span class="command">let</span></span><span> </span><span class="var">?obs&#39;</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(alter s&#39; ?pid) &quot;</span></span></span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b11</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_filelabel s file = UNDEFINED&quot;</span></span></span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>smk_of_filelabel_def</span><span> </span><span>a3</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b12</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_access_rules (smk_of_subjlabel s ?pid) (smk_of_filelabel s file) = {}&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>b11</span><span> </span><span>smk_access_rules_def</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b13</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(smk_of_subjlabel s ?pid) &#8800; Star&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>process_label_not_star</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b14</span><span> </span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;smk_access_rules (smk_of_subjlabel s&#39; ?pid) (smk_of_filelabel s&#39; file) = {READ,EXECUTE,WRITE,APPEND,T, LOCK }&quot;</span></span></span><span>
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>current_alter</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b15</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;File file &#8713; ?obs&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>alter_def</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>b11</span><span> </span><span>smk_access_rules_def</span><span class="delimiter">)</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b16</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;File file &#8713; observe s d&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>b11</span><span> </span><span>observe_def</span><span> </span><span>smk_access_rules_def</span><span class="delimiter">)</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>c1</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_filelabel s file = UNDEFINED&quot;</span></span></span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>smk_of_filelabel_def</span><span> </span><span>a3</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>c2</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_access_rules (smk_of_subjlabel s d) (smk_of_filelabel s file) = {}&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>c1</span><span> </span><span>smk_access_rules_def</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>c3</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot; READ &#8713; smk_access_rules (smk_of_subjlabel s d) (smk_of_objectlabel s (File file))&quot;</span></span></span><span>
</span><span>     </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>smk_of_objectlabel_def</span><span class="delimiter">)</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>c2</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>  
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>c4</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;current s = current s&#39;&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a4</span><span>
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>c5</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s (current s) = smk_of_subjlabel s&#39; (current s&#39;)&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>a14</span><span class="delimiter">)</span><span> 
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>c6</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_objectlabel s&#39; (File file) &#8800; Star &quot;</span></span></span><span>  
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a11</span><span> </span><span>b13</span><span> </span><span>b8</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>c7</span><span> </span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;smk_access_rules (smk_of_subjlabel s&#39; d) (smk_of_filelabel s&#39; file) = {}&quot;</span></span></span><span>
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a18</span><span> </span><span>b15</span><span> </span><span>b4</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span> 
</span><span>   </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>sskey</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;key &#8658; smack_known&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span>    </span><span>f3</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;x. (&#8707;v. key_security s&#39; x = Some v) = (key_security s&#39; x = Some (sskey x))&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>moura</span><span>
</span><span>  </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>sssb</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;super_block &#8658;superblock_smack&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span>    </span><span>f4</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;x. (&#8707;v. sb_security s&#39; x = Some v) = (sb_security s&#39; x = Some (sssb x))&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>moura</span><span>
</span><span>  </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>sssk</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;sock &#8658; socket_smack&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span>    </span><span>f5</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;x0. (&#8707;v1. sk_security s&#39; x0 = Some v1) = (sk_security s&#39; x0 = Some (sssk x0))&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>moura</span><span>
</span><span>  </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>tt</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;nat &#8658; task_smack&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span>    </span><span>f6</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;x0. (&#8707;v1. t_security s&#39; (cred (the (tasks s&#39; x0))) = Some v1) = (t_security s&#39; (cred (the (tasks s&#39; x0))) = Some (tt x0))&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>moura</span><span>
</span><span>  </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>ssmsg</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;msg_msg &#8658; smack_known&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span>    </span><span>f7</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;x0. (&#8707;v1. msg_security s&#39; x0 = Some v1) = (msg_security s&#39; x0 = Some (ssmsg x0))&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>moura</span><span>
</span><span>  </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>ii</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;inode &#8658; inode_smack&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span>    </span><span>f8</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;x0. (&#8707;v1. i_security s&#39; x0 = Some v1) = (i_security s&#39; x0 = Some (ii x0))&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>moura</span><span>
</span><span>  </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>ssipc</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;kern_ipc_perm &#8658; smack_h.smack_known&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span>    </span><span>f9</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;x0. (&#8707;v1. ipc_security s&#39; x0 = Some v1) = (ipc_security s&#39; x0 = Some (ssipc x0))&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>moura</span><span>
</span><span>  </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>ssf</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;Files &#8658; smack_h.smack_known&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;x0. (&#8707;v1. f_security s&#39; x0 = Some v1) = (f_security s&#39; x0 = Some (ssf x0))&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>moura</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b17</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;?obs&#39; - {File file} = ?obs&quot;</span></span></span><span> 
</span><span>    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>alter_def</span><span class="delimiter">)</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a18</span><span> </span><span>b15</span><span> </span><span>b4</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>    
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b18</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;{File file} &#8745; observe s d = {}&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p1</span><span> </span><span>interference_def</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a3</span><span> </span><span>objset_def</span><span> </span><span>c3</span><span> </span><span>observe_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>c8</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;{File file} &#8745; observe s&#39; d = {}&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>b18</span><span> </span><span>b7</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>b6</span><span class="delimiter">)</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>c9</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;?obs&#39; &#8745; observe s&#39; d = {} &quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>auto</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a18</span><span> </span><span>b15</span><span> </span><span>b4</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>  
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>c10</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;observe s d = {} &quot;</span></span></span><span>
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a18</span><span> </span><span>b15</span><span> </span><span>b4</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>c11</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#172;(interference (current s&#39;) s&#39; d)&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a7</span><span> </span><span>c4</span><span> </span><span>c9</span><span> </span><span>interference_def</span><span> </span><span>is_process_privileged_def</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a18</span><span> </span><span>b15</span><span> </span><span>b4</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span> 
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>c12</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(File file) &#8713; objset s&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a3</span><span> </span><span>objset_def</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>c13</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj&#8800; (File file). smk_of_objectlabel s obj = smk_of_objectlabel s obj&quot;</span></span></span><span>
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>smk_of_objectlabel_def</span><span class="delimiter">)</span><span> 
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>c14</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;v. v&#8800;?pid  &#10230; interference v s d &#10231; interference v s&#39; d&quot;</span></span></span><span> 
</span><span>   </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>     </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>       </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>v</span><span>
</span><span>       </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>d0</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;v &#8800; ?pid&quot;</span></span></span><span>
</span><span>       </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;interference v s d &#10231; interference v s&#39; d&quot;</span></span></span><span>
</span><span>       </span><span class="keyword1"><span class="command">proof</span></span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s v  = smk_of_subjlabel s ?pid&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>         </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>True</span><span>
</span><span>         </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f0</span><span> </span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;alter s v = alter s ?pid&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>True</span><span> </span><span>alter_def</span><span> 
</span><span>         </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>       </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f1</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;alter s&#39; v = alter s&#39; ?pid&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>True</span><span> </span><span>alter_def</span><span> 
</span><span>         </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>a12</span><span class="delimiter">)</span><span>
</span><span>       </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f2</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;alter s ?pid &#8745; observe s d = {}&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>interference_def</span><span> </span><span>p1</span><span> 
</span><span>         </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>metis</span><span>
</span><span>       </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f3</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;alter s v &#8745; observe s d = {}&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>f0</span><span> </span><span>f2</span><span> 
</span><span>         </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>       </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f4</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s v &#8800; smk_of_subjlabel s d&quot;</span></span></span><span> 
</span><span>         </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>True</span><span> </span><span>a12</span><span> </span><span>b10</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>       </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f5</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#172;(interference v s d)&quot;</span></span></span><span>   
</span><span>         </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span class="delimiter">(</span><span>full_types</span><span class="delimiter">)</span><span> </span><span>True</span><span>  </span><span>b7</span><span> </span><span>b8</span><span> </span><span>b9</span><span>  </span><span>c4</span><span> </span><span>c5</span><span> </span><span>f3</span><span> </span><span>interference_def</span><span> </span><span>is_process_privileged_def</span><span> </span><span class="delimiter">)</span><span>
</span><span>
</span><span>       </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f6</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s&#39; v &#8800; smk_of_subjlabel s&#39; d&quot;</span></span></span><span> 
</span><span>         </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a12</span><span> </span><span>f4</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>       </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f7</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#172;(interference v s&#39; d)&quot;</span></span></span><span>  
</span><span>         </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>b6</span><span> </span><span>c10</span><span> </span><span>f5</span><span> </span><span>interference_def</span><span> </span><span>is_process_privileged_def</span><span> 
</span><span>         </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>a12</span><span> </span><span>c11</span><span> </span><span>c4</span><span>  </span><span>f1</span><span> </span><span>f6</span><span> </span><span class="delimiter">)</span><span>
</span><span>       </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f8</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(interference v s d) = (interference v s&#39; d)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>f5</span><span> </span><span>f7</span><span> 
</span><span>         </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>     </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>f8</span><span>  
</span><span>       </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>   </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>     </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>False</span><span>
</span><span>     </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f9</span><span> </span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s v  &#8800; smk_of_subjlabel s ?pid&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>False</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>     </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f10</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s v = smk_of_subjlabel s&#39; v&quot;</span></span></span><span> 
</span><span>       </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>a12</span><span class="delimiter">)</span><span>
</span><span>     </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f11</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj&#8800;(File file). smk_access_rules (smk_of_subjlabel s v) (smk_of_objectlabel s obj)
                =  smk_access_rules (smk_of_subjlabel s&#39; v) (smk_of_objectlabel s&#39; obj)&quot;</span></span></span><span>
</span><span>       </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>a12</span><span> </span><span>a15</span><span class="delimiter">)</span><span>
</span><span>     </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f12</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj&#8800;(File file). smk_access_rules (smk_of_subjlabel s d) (smk_of_objectlabel s obj)
                =  smk_access_rules (smk_of_subjlabel s&#39; d) (smk_of_objectlabel s&#39; obj)&quot;</span></span></span><span>
</span><span>       </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>a12</span><span> </span><span>a15</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f8</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(interference v s d) = (interference v s&#39; d)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">proof</span></span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s v  = smk_of_subjlabel s d&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>True</span><span>
</span><span>         </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>           </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a8</span><span> </span><span>f10</span><span> </span><span>b6</span><span> </span><span>c10</span><span> </span><span>interference_def</span><span> </span><span>is_process_privileged_def</span><span> 
</span><span>           </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a18</span><span> </span><span>b15</span><span> </span><span>b4</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>    </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>      </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>False</span><span>
</span><span>      </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f13</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s v  &#8800; smk_of_subjlabel s d&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>False</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f14</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s&#39; v  &#8800; smk_of_subjlabel s&#39; d&quot;</span></span></span><span> 
</span><span>        </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>b7</span><span> </span><span>f10</span><span> </span><span>f13</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>      </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f15</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj&#8800;(File file). (interference v s d) = (interference v s&#39; d)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">proof</span></span><span>-</span><span>
</span><span>        </span><span class="keyword1"><span class="command">{</span></span><span> </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>obj</span><span>
</span><span>          </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>f16</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;obj&#8800;(File file)&quot;</span></span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot; (interference v s d) = (interference v s&#39; d)&quot;</span></span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">proof</span></span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;v = d&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>            </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>True</span><span>
</span><span>                </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>   
</span><span>                  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>f14</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>              </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>                </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>False</span><span>
</span><span>                </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f17</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;v &#8800; d&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>False</span><span> 
</span><span>                  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>                </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>                  </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>False</span><span>  </span><span>f10</span><span> </span><span>a15</span><span>  </span><span>a18</span><span> </span><span>c10</span><span> </span><span>c13</span><span> </span><span>f13</span><span> </span><span>f14</span><span> 
</span><span>                  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>auto</span><span>
</span><span>                  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>interference_def</span><span> </span><span>is_process_privileged_def</span><span> 
</span><span>                  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>simp</span><span> 
</span><span>                  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>b15</span><span> </span><span>b4</span><span class="delimiter">)</span><span> 
</span><span>
</span><span>
</span><span>              </span><span class="keyword1"><span class="command">qed</span></span><span>      
</span><span>            </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>      </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>f13</span><span> 
</span><span>        </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>    </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>     </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> 
</span><span>       </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>   </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span> </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b21</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;v. v= current s &#10230; interference v s d = interference v s&#39; d&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>c11</span><span> </span><span>p1</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>c4</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b22</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#8704;v .interference v s d = interference v s&#39; d)&quot;</span></span></span><span>
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>c14</span><span> </span><span>b21</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>alloc_file_notchg_contents</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>p0</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 s&quot;</span></span></span><span> 
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>p1</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;&#172;(interference (current s) s d)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>p2</span><span class="delimiter">:</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = fst(alloc_file s pid file c)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;(&#8704;n. n &#8712;(observe s d)  &#10230; (contents s n) = (contents s&#39; n) )&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;resultValue s ( security_file_alloc s file ) &#8800; 0&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>True</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s = s&#39;&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p2</span><span> </span><span>alloc_file_def</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>True</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>alloc_file_def</span><span> </span><span>p2</span><span> </span><span>a1</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>False</span><span>
</span><span>  </span><span class="keyword1"><span class="command">let</span></span><span> </span><span class="var">?fsec</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_current s &quot;</span></span></span><span>  
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a1</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = snd (the_run_state (security_file_alloc s file) s)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>alloc_file_def</span><span> </span><span>p2</span><span> </span><span>False</span><span> </span><span>funcState_def</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a2</span><span> </span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;resultValue s ( security_file_alloc s file ) = 0&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>False</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a3</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;f_security s file = None&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a2</span><span> </span><span>alloc_file_pre</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>a1</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a4</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = s&#10631;f_security := (f_security s)(file := Some ?fsec )&#10632;&quot;</span></span></span><span> 
</span><span>    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>funcState_def</span><span> </span><span>security_file_alloc_def</span><span> </span><span>the_run_state_def</span><span> </span><span>return_def</span><span> 
</span><span>          </span><span>smack_file_alloc_security_def</span><span> </span><span>modify_def</span><span> </span><span>put_def</span><span> </span><span>get_def</span><span> </span><span>bind_def</span><span>  </span><span>EEXIST_def</span><span> </span><span class="delimiter">)</span><span> 
</span><span>    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>auto</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>False</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a3</span><span> </span><span>not_None_eq</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b1</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_filelabel s file = UNDEFINED&quot;</span></span></span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>smk_of_filelabel_def</span><span> </span><span>a3</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b2</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_access_rules (smk_of_subjlabel s (current s)) (smk_of_filelabel s file) = {}&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>b1</span><span> </span><span>smk_access_rules_def</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b3</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;File file &#8713; observe s d&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>observe_def</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>b1</span><span> </span><span>smk_access_rules_def</span><span class="delimiter">)</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b4</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;observe s d = observe s&#39; d&quot;</span></span></span><span>   </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>alloc_file_notchg_obs</span><span> </span><span>p0</span><span> </span><span>p1</span><span> </span><span>p2</span><span>  
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b5</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;File file &#8713; observe s&#39; d&quot;</span></span></span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>b3</span><span> </span><span>b4</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a5</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#8704;n. n &#8712;(observe s d)  &#10230; (contents s n) = (contents s&#39; n) )&quot;</span></span></span><span> 
</span><span>    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>allI</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>induct_tac</span><span> </span><span>n</span><span class="delimiter">)</span><span>
</span><span>           </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span>contents_def</span><span> </span><span>a4</span><span class="delimiter">)</span><span> </span><span class="delimiter">+</span><span>
</span><span>         </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">defer</span></span></span></span><span>
</span><span>         </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span>contents_def</span><span> </span><span>a4</span><span class="delimiter">)</span><span> </span><span class="delimiter">+</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>b3</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>alloc_file_local_rsp</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>p0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 s&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#172;(interference (current s) s d)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = fst(alloc_file s pid file c)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span>   </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8764; d &#8764; s&#39;&quot;</span></span></span><span> 
</span><span class="keyword1"><span class="command">proof</span></span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">{</span></span><span> 
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s d = smk_of_subjlabel s&#39; d&quot;</span></span></span><span> 
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p0</span><span> </span><span>p1</span><span> </span><span>p2</span><span>  </span><span>alloc_file_notchg_subjlabel</span><span> 
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a2</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;observe s d = observe s&#39; d&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p0</span><span> </span><span>p1</span><span> </span><span>p2</span><span> </span><span>alloc_file_notchg_obs</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a3</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#8704;n. n &#8712;(observe s d)  &#10230; (contents s n) = (contents s&#39; n) )&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p0</span><span> </span><span>p1</span><span> </span><span>p2</span><span>   </span><span>alloc_file_notchg_contents</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a4</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#8704;v. interference v s d &#10231; interference v s&#39; d)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p0</span><span> </span><span>p1</span><span> </span><span>p2</span><span> </span><span>alloc_file_notchg_policy</span><span> 
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a6</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8764; d &#8764; s&#39;&quot;</span></span></span><span> 
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a1</span><span> </span><span>a2</span><span> </span><span>a3</span><span> </span><span>a4</span><span> 
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>kvpeq_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>alloc_file_local_rsp_e</span><span class="delimiter">:</span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>p0</span><span> </span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 s &quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>p1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;e =  (Event_alloc_file  pid file c) &quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>p2</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;non_interference (the(getpid_from_manage_hooks e)) s d&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>p3</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = exec_manage_event s e&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span>   </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8764; d &#8764; s&#39;&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(the (getpid_from_manage_hooks e)) = pid&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p1</span><span>  </span><span>getpid_from_manage_hooks_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = fst(alloc_file s pid file c)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p1</span><span> </span><span>p3</span><span> </span><span>exec_manage_event_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#172;(interference pid s d)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p2</span><span> </span><span>a0</span><span> </span><span>non_interference_def</span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a3</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot; pid = current s&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>sched&#39;</span><span> </span><span>sched_def</span><span> 
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a0</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a4</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8764; d &#8764; s&#39;&quot;</span></span></span><span> 
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a1</span><span> </span><span>a2</span><span> </span><span>a3</span><span> </span><span>p0</span><span> </span><span>alloc_file_local_rsp</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fast</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>alloc_file_dlocal_rsp_e</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;dynamic_local_respect_e ((Event_alloc_file  pid file c))&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>alloc_file_local_rsp_e</span><span> </span><span>dynamic_local_respect_e_def</span><span>  </span><span>non_interference_def</span><span> 
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span>
</span><span> 
</span><span class="keyword1"><span class="command">subsubsection</span></span><span class="cartouche"><span class="delete"><span class="delete">&#8249;proving &quot;file_free&quot; satisfying the &quot;local respect&quot; property&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>file_free_subjlabel</span><span class="delimiter">:</span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>p0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 s&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#172;(interference (current s) s d)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = fst(file_free s pid file )&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot; smk_of_subjlabel s d = smk_of_subjlabel s&#39; d&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;f_security s file = None&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>True</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s = s&#39;&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p2</span><span> </span><span>True</span><span> </span><span>file_free_def</span><span>  </span><span>security_file_free_def</span><span> </span><span>smack_file_free_security_def</span><span> 
</span><span>    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>auto</span><span class="delimiter">[</span><span>1</span><span class="delimiter">]</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>funcState_def</span><span> </span><span>the_run_state_def</span><span> </span><span>return_def</span><span> </span><span class="delimiter">)</span><span> 
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>False</span><span>
</span><span>  </span><span class="keyword1"><span class="command">let</span></span><span> </span><span class="var">?fsec</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_current s &quot;</span></span></span><span>  
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a1</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = snd (the_run_state (security_file_free s file) s)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>file_free_def</span><span> </span><span>p2</span><span> </span><span>False</span><span> </span><span>funcState_def</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>a1</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = s&#10631;f_security := (f_security s)(file := None )&#10632;&quot;</span></span></span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span class="delimiter">(</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>funcState_def</span><span> </span><span>security_file_free_def</span><span> </span><span>the_run_state_def</span><span> </span><span>return_def</span><span> 
</span><span>          </span><span>smack_file_free_security_def</span><span> </span><span>modify_def</span><span> </span><span>put_def</span><span> </span><span>get_def</span><span> </span><span>bind_def</span><span>  </span><span>False</span><span> </span><span class="delimiter">)</span><span> 
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a3</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;t_security s = t_security s&#39; &quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a2</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a4</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;d &#8800; (current s)&quot;</span></span></span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p2</span><span> </span><span>non_interference_def</span><span> </span><span>p1</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>nintf_reflx</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a5</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;d .tasks s d = tasks s&#39; d&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a2</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a6</span><span> </span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;d. smk_of_subjlabel s d = smk_of_subjlabel s&#39; d&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>a3</span><span> </span><span>a5</span><span> </span><span>subjlabelnotchg</span><span>   
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a7</span><span> </span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot; smk_of_subjlabel s d = smk_of_subjlabel s&#39; d&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>a6</span><span>    
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>file_free_notchg_observe</span><span class="delimiter">:</span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>p0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 s&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#172;(interference (current s) s d)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = fst(file_free s pid file )&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>p3</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;e =  (Event_file_free  pid file) &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot; observe s d = observe s&#39; d&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;f_security s file = None&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>True</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s = s&#39;&quot;</span></span></span><span> 
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p2</span><span> </span><span>True</span><span> </span><span>file_free_def</span><span>  </span><span>security_file_free_def</span><span> </span><span>smack_file_free_security_def</span><span> 
</span><span>    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>auto</span><span class="delimiter">[</span><span>1</span><span class="delimiter">]</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>funcState_def</span><span> </span><span>the_run_state_def</span><span> </span><span>return_def</span><span> </span><span class="delimiter">)</span><span> 
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>False</span><span>
</span><span>  </span><span class="keyword1"><span class="command">let</span></span><span> </span><span class="var">?fsec</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_current s &quot;</span></span></span><span>  
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a1</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = snd (the_run_state (security_file_free s file) s)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>file_free_def</span><span> </span><span>p2</span><span> </span><span>False</span><span> </span><span>funcState_def</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>a1</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = s&#10631;f_security := (f_security s)(file := None )&#10632;&quot;</span></span></span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span class="delimiter">(</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>funcState_def</span><span> </span><span>security_file_free_def</span><span> </span><span>the_run_state_def</span><span> </span><span>return_def</span><span> 
</span><span>          </span><span>smack_file_free_security_def</span><span> </span><span>modify_def</span><span> </span><span>put_def</span><span> </span><span>get_def</span><span> </span><span>bind_def</span><span>  </span><span>False</span><span> </span><span class="delimiter">)</span><span> 
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a3</span><span> </span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s d = smk_of_subjlabel s&#39; d&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>p0</span><span> </span><span>p1</span><span> </span><span>p2</span><span> </span><span>file_free_subjlabel</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span> 
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a4</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;contents s&#39; (File file) &#8800; contents s (File file)&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a2</span><span> </span><span>a3</span><span> </span><span>False</span><span>  </span><span>contents_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a5</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = exec_manage_event s e&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>exec_manage_event_def</span><span> </span><span>p2</span><span> </span><span>p3</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a6</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(the (getpid_from_manage_hooks e)) = current s&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p1</span><span> </span><span>getpid_from_manage_hooks_def</span><span>  </span><span>sched&#39;</span><span> </span><span>sched_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a7</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;contents (exec_manage_event s e) (File file) &#8800;  contents s (File file)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a4</span><span> </span><span>a5</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a9</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(File file) &#8712; alter s (the (getpid_from_manage_hooks e)) &quot;</span></span></span><span> 
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>drma3_def</span><span> </span><span>a7</span><span>  </span><span>current_alter</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>   
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a10</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;alter s (current s)  &#8745; observe s d = {}&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p1</span><span> </span><span>interference_def</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>metis</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a11</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(File file) &#8713; observe s d&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>current_alter</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a12</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;current s = current s&#39;&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a2</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a13</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(File file) &#8712; alter s&#39; (current s&#39;) &quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>current_alter</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a14</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s (current s) &#8800; UNDEFINED&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>process_label_not_undefined</span><span class="delimiter">)</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a15</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;d .tasks s d = tasks s&#39; d&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a2</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a16</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;t_security s = t_security s&#39; &quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a2</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a17</span><span> </span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;v. smk_of_subjlabel s v = smk_of_subjlabel s&#39; v&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>a15</span><span> </span><span>a16</span><span>  </span><span>subjlabelnotchg</span><span>   
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a18</span><span> </span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;v .get_subj_access_from_id s v = get_subj_access_from_id s&#39; v&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span>  </span><span>get_subj_access_from_id_def</span><span>  </span><span>smk_access_rules_def</span><span class="delimiter">)</span><span>
</span><span>     </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>auto</span><span class="delimiter">[</span><span>1</span><span class="delimiter">]</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>a17</span><span class="delimiter">)</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a19</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s (current s) = smk_of_subjlabel s&#39; (current s&#39;)&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>a12</span><span> </span><span>a17</span><span class="delimiter">)</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a20</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;observe s d = observe s&#39; d&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>observe_def</span><span>  
</span><span>     </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span>observe_def</span><span> </span><span>objset_def</span><span class="delimiter">)</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>meson</span><span>  </span><span>current_alter</span><span> </span><span>p1</span><span class="delimiter">)</span><span>
</span><span>   </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span> </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>file_free_notchg_policy</span><span class="delimiter">:</span><span>
</span><span> </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>p0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 s&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#172;(interference (current s) s d)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = fst(file_free s pid file )&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>p3</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;e =  (Event_file_free pid file) &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#8704;v .interference v s d = interference v s&#39; d)&quot;</span></span></span><span> 
</span><span class="keyword1"><span class="command">proof</span></span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;f_security s file = None&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>True</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s = s&#39;&quot;</span></span></span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>funcState_def</span><span> </span><span>the_run_state_def</span><span> </span><span>return_def</span><span> </span><span>modify_def</span><span> </span><span>bind_def</span><span> </span><span>p2</span><span> 
</span><span>        </span><span>True</span><span> </span><span>file_free_def</span><span> </span><span>security_file_free_def</span><span> </span><span>smack_file_free_security_def</span><span> </span><span class="delimiter">)</span><span> 
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>False</span><span>
</span><span>  </span><span class="keyword1"><span class="command">let</span></span><span> </span><span class="var">?fsec</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_current s &quot;</span></span></span><span> 
</span><span>  </span><span class="keyword1"><span class="command">let</span></span><span> </span><span class="var">?pid</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;current s&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a1</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = snd (the_run_state (security_file_free s file) s)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>file_free_def</span><span> </span><span>p2</span><span> </span><span>False</span><span> </span><span>funcState_def</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>a1</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = s&#10631;f_security := (f_security s)(file := None )&#10632;&quot;</span></span></span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span class="delimiter">(</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>funcState_def</span><span> </span><span>security_file_free_def</span><span> </span><span>the_run_state_def</span><span> </span><span>return_def</span><span> 
</span><span>          </span><span>smack_file_free_security_def</span><span> </span><span>modify_def</span><span> </span><span>put_def</span><span> </span><span>get_def</span><span> </span><span>bind_def</span><span>  </span><span>False</span><span> </span><span class="delimiter">)</span><span> 
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a3</span><span> </span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s d = smk_of_subjlabel s&#39; d&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>p0</span><span> </span><span>p1</span><span> </span><span>p2</span><span> </span><span>file_free_subjlabel</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span> 
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a4</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;f_security s file &#8800;  None&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>False</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a5</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot; (f_security s&#39; file) = None&quot;</span></span></span><span> 
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a2</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a6</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;t_security s = t_security s&#39; &quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a2</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a7</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;d &#8800; ?pid&quot;</span></span></span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p2</span><span> </span><span>non_interference_def</span><span> </span><span>p1</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>nintf_reflx</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span> 
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a8</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;v. tasks s v = tasks s&#39; v&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a2</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a9</span><span> </span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s d = smk_of_subjlabel s&#39; d&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>a6</span><span> </span><span>a8</span><span> </span><span>subjlabelnotchg</span><span>  
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>   
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a10</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot; ?pid = current s&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>sched&#39;</span><span> </span><span>sched_def</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a11</span><span> </span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s ?pid = smk_of_subjlabel s&#39; ?pid&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>a6</span><span> </span><span>a8</span><span> </span><span>subjlabelnotchg</span><span>  
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span> 
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a12</span><span> </span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;v. smk_of_subjlabel s v = smk_of_subjlabel s&#39; v&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>a6</span><span> </span><span>a8</span><span> </span><span>subjlabelnotchg</span><span>  
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>   
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a13</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;current s = current s&#39;&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a2</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a14</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s (current s) = smk_of_subjlabel s&#39; (current s&#39;)&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a11</span><span> </span><span>a13</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e1</span><span> </span><span class="delimiter">:</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj . sb_security s obj = sb_security s&#39; obj&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a2</span><span>
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>   </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>e1</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e2</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj. smk_of_superblocklabel s obj = smk_of_superblocklabel s&#39; obj&quot;</span></span></span><span>
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>smk_of_superblocklabel_def</span><span> </span><span>a4</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e3</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj. t_security s obj  = t_security s&#39; obj&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a2</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>   </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>e3</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e4</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj. smk_of_subjlabel_real s obj = smk_of_subjlabel_real s&#39; obj&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>smk_of_subjlabel_real_def</span><span> </span><span>a2</span><span> </span><span>task_real_cred_def</span><span> </span><span>smk_of_task_def</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e5</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj. ipc_security s obj  = ipc_security s&#39; obj&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a2</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>   </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>e5</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e6</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj. smk_of_ipclabel s obj = smk_of_ipclabel s&#39; obj&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>smk_of_ipclabel_def</span><span> </span><span>a4</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e7</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj&#8800; file. f_security s obj  = f_security s&#39; obj&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a2</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>   </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>e7</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e8</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj&#8800; file. smk_of_filelabel s obj = smk_of_filelabel s&#39; obj&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>smk_of_filelabel_def</span><span> </span><span>a4</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e9</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj. msg_security s obj  = msg_security s&#39; obj&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a2</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>   </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>e9</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e10</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj. smk_of_msglabel s obj = smk_of_msglabel s&#39; obj&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>smk_of_msglabel_def</span><span> </span><span>a4</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e11</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj. i_security s obj  = i_security s&#39; obj&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a2</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>   </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>e11</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e12</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj. smk_of_inodelabel s obj = smk_of_inodelabel s&#39; obj&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>smk_of_inodelabel_def</span><span> </span><span>a4</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e13</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj. sk_security s obj  = sk_security s&#39; obj&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a2</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>   </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>e13</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e14</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj. smk_of_sklabel s obj = smk_of_sklabel s&#39; obj&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>smk_of_sklabel_def</span><span> </span><span>a4</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e15</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj. key_security s obj  = key_security s&#39; obj&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a2</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>   </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>e7</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e16</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj. smk_of_keylabel s obj = smk_of_keylabel s&#39; obj&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>smk_of_keylabel_def</span><span> </span><span>a2</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a15</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj&#8800;(File file). smk_of_objectlabel s&#39; obj = smk_of_objectlabel s obj&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>e2</span><span> </span><span>e4</span><span> </span><span>e6</span><span> </span><span>e8</span><span> </span><span>e10</span><span> </span><span>e12</span><span> </span><span>e14</span><span> </span><span>e16</span><span>
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>Obj.exhaust</span><span> </span><span>smk_of_objectlabel.simps</span><span class="delimiter">)</span><span>
</span><span>   
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b1</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;alter s ?pid  &#8745; observe s d = {}&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p1</span><span> </span><span>interference_def</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>metis</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b2</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;contents s&#39; (File file) &#8800; contents s (File file)&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>contents_def</span><span> </span><span>a2</span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a4</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b3</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = exec_manage_event s e&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>exec_manage_event_def</span><span> </span><span>p2</span><span> </span><span>p3</span><span> 
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b4</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(the (getpid_from_manage_hooks e)) = current s&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p1</span><span> </span><span>domain_of_event_def</span><span> </span><span>getpid_from_file_event_def</span><span> 
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>sched&#39;</span><span> </span><span>sched_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b5</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;contents (exec_manage_event s e) (File file) &#8800;  contents s (File file)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>b2</span><span> </span><span>b3</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>         
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a18</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(File file) &#8712; alter s (the (getpid_from_manage_hooks e)) &quot;</span></span></span><span> 
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>drma3_def</span><span> </span><span>a7</span><span>  </span><span>current_alter</span><span> 
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b6</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;observe s d = observe s&#39; d&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p0</span><span> </span><span>p1</span><span> </span><span>p2</span><span> </span><span>file_free_notchg_observe</span><span> </span><span>p3</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>                         
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b7</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s d = smk_of_subjlabel s&#39; d&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p0</span><span> </span><span>p1</span><span> </span><span>p2</span><span> </span><span>file_free_subjlabel</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>  
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b9</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s&#39; d &#8800; (smk_of_objectlabel s&#39; (File file))&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>current_alter</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b10</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot; smk_of_subjlabel s&#39; ?pid &#8800; smk_of_subjlabel s&#39; d &quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>current_alter</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">let</span></span><span> </span><span class="var">?obs</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(alter s ?pid) &quot;</span></span></span><span>
</span><span>   </span><span class="keyword1"><span class="command">let</span></span><span> </span><span class="var">?obs&#39;</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(alter s&#39; ?pid) &quot;</span></span></span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b13</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(smk_of_subjlabel s ?pid) &#8800; Star&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>process_label_not_star</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>  
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>c4</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;current s = current s&#39;&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a2</span><span>
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>c5</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s (current s) = smk_of_subjlabel s&#39; (current s&#39;)&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>a14</span><span class="delimiter">)</span><span> 
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>c6</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_objectlabel s&#39; (File file) &#8800; Star &quot;</span></span></span><span>  
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>a5</span><span> </span><span>smk_of_filelabel_def</span><span class="delimiter">)</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>c7</span><span> </span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;smk_access_rules (smk_of_subjlabel s&#39; d) (smk_of_filelabel s&#39; file) = {}&quot;</span></span></span><span>
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>current_alter</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>sskey</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;key &#8658; smack_known&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span>    </span><span>f3</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;x. (&#8707;v. key_security s&#39; x = Some v) = (key_security s&#39; x = Some (sskey x))&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>moura</span><span>
</span><span>  </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>sssb</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;super_block &#8658;superblock_smack&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span>    </span><span>f4</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;x. (&#8707;v. sb_security s&#39; x = Some v) = (sb_security s&#39; x = Some (sssb x))&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>moura</span><span>
</span><span>  </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>sssk</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;sock &#8658; socket_smack&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span>    </span><span>f5</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;x0. (&#8707;v1. sk_security s&#39; x0 = Some v1) = (sk_security s&#39; x0 = Some (sssk x0))&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>moura</span><span>
</span><span>  </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>tt</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;nat &#8658; task_smack&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span>    </span><span>f6</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;x0. (&#8707;v1. t_security s&#39; (cred (the (tasks s&#39; x0))) = Some v1) = (t_security s&#39; (cred (the (tasks s&#39; x0))) = Some (tt x0))&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>moura</span><span>
</span><span>  </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>ssmsg</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;msg_msg &#8658; smack_known&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span>    </span><span>f7</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;x0. (&#8707;v1. msg_security s&#39; x0 = Some v1) = (msg_security s&#39; x0 = Some (ssmsg x0))&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>moura</span><span>
</span><span>  </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>ii</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;inode &#8658; inode_smack&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span>    </span><span>f8</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;x0. (&#8707;v1. i_security s&#39; x0 = Some v1) = (i_security s&#39; x0 = Some (ii x0))&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>moura</span><span>
</span><span>  </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>ssipc</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;kern_ipc_perm &#8658; smack_h.smack_known&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span>    </span><span>f9</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;x0. (&#8707;v1. ipc_security s&#39; x0 = Some v1) = (ipc_security s&#39; x0 = Some (ssipc x0))&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>moura</span><span>
</span><span>  </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>ssf</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;Files &#8658; smack_h.smack_known&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;x0. (&#8707;v1. f_security s&#39; x0 = Some v1) = (f_security s&#39; x0 = Some (ssf x0))&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>moura</span><span>
</span><span>   
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b18</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;{File file} &#8745; observe s d = {}&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p1</span><span> </span><span>interference_def</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a3</span><span> </span><span>objset_def</span><span>  </span><span>observe_def</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span class="delimiter">(</span><span>no_types</span><span class="delimiter">,</span><span> </span><span>lifting</span><span class="delimiter">)</span><span> </span><span>Int_empty_right</span><span> </span><span>a18</span><span> </span><span>b4</span><span> </span><span>disjoint_insert</span><span class="delimiter">(</span><span>1</span><span class="delimiter">)</span><span> </span><span>inf_sup_aci</span><span class="delimiter">(</span><span>1</span><span class="delimiter">)</span><span> </span><span>orthD2</span><span class="delimiter">)</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>c8</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;{File file} &#8745; observe s&#39; d = {}&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>b18</span><span> </span><span>b7</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>b6</span><span class="delimiter">)</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>c11</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#172;(interference (current s&#39;) s&#39; d)&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a7</span><span> </span><span>c4</span><span> </span><span>interference_def</span><span> </span><span>is_process_privileged_def</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>current_alter</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>c12</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(File file) &#8713; objset s&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a3</span><span> </span><span>objset_def</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>current_alter</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>c13</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj&#8800; (File file). smk_of_objectlabel s obj = smk_of_objectlabel s obj&quot;</span></span></span><span>
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>c14</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;v. v&#8800;?pid  &#10230; interference v s d &#10231; interference v s&#39; d&quot;</span></span></span><span> 
</span><span>   </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>     </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>       </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>v</span><span>
</span><span>       </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>d0</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;v &#8800; ?pid&quot;</span></span></span><span>
</span><span>       </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;interference v s d &#10231; interference v s&#39; d&quot;</span></span></span><span>
</span><span>       </span><span class="keyword1"><span class="command">proof</span></span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s v  = smk_of_subjlabel s ?pid&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>         </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>True</span><span>
</span><span>         </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f0</span><span> </span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;alter s v = alter s ?pid&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>True</span><span> </span><span>alter_def</span><span> 
</span><span>         </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>       </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f1</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;alter s&#39; v = alter s&#39; ?pid&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>True</span><span> </span><span>alter_def</span><span> 
</span><span>         </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>a12</span><span class="delimiter">)</span><span>
</span><span>       </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f2</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;alter s ?pid &#8745; observe s d = {}&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>interference_def</span><span> </span><span>p1</span><span> 
</span><span>         </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>metis</span><span>
</span><span>       </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f3</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;alter s v &#8745; observe s d = {}&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>f0</span><span> </span><span>f2</span><span> 
</span><span>         </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>       </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f4</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s v &#8800; smk_of_subjlabel s d&quot;</span></span></span><span> 
</span><span>         </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>True</span><span> </span><span>a12</span><span> </span><span>b10</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>       </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f5</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#172;(interference v s d)&quot;</span></span></span><span>  
</span><span>         </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span>   </span><span>f3</span><span>  </span><span>interference_def</span><span> </span><span>is_process_privileged_def</span><span class="delimiter">)</span><span>
</span><span>       </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f6</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s&#39; v &#8800; smk_of_subjlabel s&#39; d&quot;</span></span></span><span> 
</span><span>         </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a12</span><span> </span><span>f4</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>       </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f7</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#172;(interference v s&#39; d)&quot;</span></span></span><span>  
</span><span>         </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>b6</span><span>  </span><span>f5</span><span> </span><span>interference_def</span><span> </span><span>is_process_privileged_def</span><span> 
</span><span>          </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>current_alter</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>       </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f8</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(interference v s d) = (interference v s&#39; d)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>f5</span><span> </span><span>f7</span><span> 
</span><span>         </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>     </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>f8</span><span>  
</span><span>       </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>   </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>     </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>False</span><span>
</span><span>     </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f9</span><span> </span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s v  &#8800; smk_of_subjlabel s ?pid&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>False</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>     </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f10</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s v = smk_of_subjlabel s&#39; v&quot;</span></span></span><span> 
</span><span>       </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>a12</span><span class="delimiter">)</span><span>
</span><span>     </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f11</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj&#8800;(File file). smk_access_rules (smk_of_subjlabel s v) (smk_of_objectlabel s obj)
                =  smk_access_rules (smk_of_subjlabel s&#39; v) (smk_of_objectlabel s&#39; obj)&quot;</span></span></span><span>
</span><span>       </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>a12</span><span> </span><span>a15</span><span class="delimiter">)</span><span>
</span><span>     </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f12</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj&#8800;(File file). smk_access_rules (smk_of_subjlabel s d) (smk_of_objectlabel s obj)
                =  smk_access_rules (smk_of_subjlabel s&#39; d) (smk_of_objectlabel s&#39; obj)&quot;</span></span></span><span>
</span><span>       </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>a12</span><span> </span><span>a15</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f8</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(interference v s d) = (interference v s&#39; d)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">proof</span></span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s v  = smk_of_subjlabel s d&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>True</span><span>
</span><span>         </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>           </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a8</span><span> </span><span>f10</span><span> </span><span>b6</span><span>  </span><span>interference_def</span><span> </span><span>is_process_privileged_def</span><span> 
</span><span>           </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>current_alter</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>    </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>      </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>False</span><span>
</span><span>      </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f13</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s v  &#8800; smk_of_subjlabel s d&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>False</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f14</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s&#39; v  &#8800; smk_of_subjlabel s&#39; d&quot;</span></span></span><span> 
</span><span>        </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>b7</span><span> </span><span>f10</span><span> </span><span>f13</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>      </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f15</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;obj&#8800;(File file). (interference v s d) = (interference v s&#39; d)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">proof</span></span><span>-</span><span>
</span><span>        </span><span class="keyword1"><span class="command">{</span></span><span> </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>obj</span><span>
</span><span>          </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>f16</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;obj&#8800;(File file)&quot;</span></span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot; (interference v s d) = (interference v s&#39; d)&quot;</span></span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">proof</span></span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;v = d&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>            </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>True</span><span>
</span><span>                </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>   
</span><span>                  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>f14</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>              </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>                </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>False</span><span>
</span><span>                </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f17</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;v &#8800; d&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>False</span><span> 
</span><span>                  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>                </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>                  </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>False</span><span>  </span><span>f10</span><span> </span><span>a15</span><span>  </span><span>a18</span><span>  </span><span>c13</span><span> </span><span>f13</span><span> </span><span>f14</span><span>  
</span><span>                    </span><span>interference_def</span><span> </span><span>is_process_privileged_def</span><span> </span><span>b6</span><span> 
</span><span>                  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>meson</span><span>  </span><span>current_alter</span><span class="delimiter">)</span><span> 
</span><span>              </span><span class="keyword1"><span class="command">qed</span></span><span>      
</span><span>            </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>      </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>f13</span><span> 
</span><span>        </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>    </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>     </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> 
</span><span>       </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>   </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span> </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b21</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#8704;v .interference v s d = interference v s&#39; d)&quot;</span></span></span><span>
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>c14</span><span> </span><span>c11</span><span> </span><span>p1</span><span>  
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>current_alter</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>file_free_notchg_contents</span><span class="delimiter">:</span><span>
</span><span> </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>p0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 s&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#172;(interference (current s) s d)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = fst(file_free s pid file )&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p3</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;e = ( Event_file_free pid file) &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;(&#8704;n. n &#8712;(observe s d)  &#10230; (contents s n) = (contents s&#39; n) )&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;f_security s file = None&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>True</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s = s&#39;&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p2</span><span> </span><span>True</span><span> </span><span>file_free_def</span><span>  </span><span>security_file_free_def</span><span> </span><span>smack_file_free_security_def</span><span> 
</span><span>    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>auto</span><span class="delimiter">[</span><span>1</span><span class="delimiter">]</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>funcState_def</span><span> </span><span>the_run_state_def</span><span> </span><span>return_def</span><span> </span><span class="delimiter">)</span><span> 
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>False</span><span>
</span><span>  </span><span class="keyword1"><span class="command">let</span></span><span> </span><span class="var">?fsec</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_current s &quot;</span></span></span><span>  
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a1</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = snd (the_run_state (security_file_free s file) s)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>file_free_def</span><span> </span><span>p2</span><span> </span><span>False</span><span> </span><span>funcState_def</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>a1</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = s&#10631;f_security := (f_security s)(file := None )&#10632;&quot;</span></span></span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span class="delimiter">(</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>funcState_def</span><span> </span><span>security_file_free_def</span><span> </span><span>the_run_state_def</span><span> </span><span>return_def</span><span> 
</span><span>          </span><span>smack_file_free_security_def</span><span> </span><span>modify_def</span><span> </span><span>put_def</span><span> </span><span>get_def</span><span> </span><span>bind_def</span><span>  </span><span>False</span><span> </span><span class="delimiter">)</span><span> 
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a3</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = exec_manage_event s e&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>exec_manage_event_def</span><span> </span><span>p2</span><span> </span><span>p3</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a4</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(the (getpid_from_manage_hooks e)) = current s&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p1</span><span> </span><span>getpid_from_manage_hooks_def</span><span>  </span><span>sched&#39;</span><span> </span><span>sched_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a6</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(File file) &#8712; alter s (the (getpid_from_manage_hooks e)) &quot;</span></span></span><span> 
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>drma3_def</span><span> </span><span>current_alter</span><span> 
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a7</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;File file &#8713; observe s d&quot;</span></span></span><span> 
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>observe_def</span><span>  </span><span>current_alter</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>    
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a8</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;observe s d = observe s&#39; d&quot;</span></span></span><span> 
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>file_free_notchg_observe</span><span> </span><span>p0</span><span> </span><span>p1</span><span> </span><span>p2</span><span> </span><span>p3</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a5</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#8704;n. n &#8712;(observe s d)  &#10230; (contents s n) = (contents s&#39; n) )&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>auto</span><span class="delimiter">[</span><span>1</span><span class="delimiter">]</span><span>
</span><span>     </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>induct_tac</span><span> </span><span>n</span><span class="delimiter">)</span><span>
</span><span>            </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span>contents_def</span><span> </span><span>a2</span><span class="delimiter">)</span><span> </span><span class="delimiter">+</span><span>
</span><span>     </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">defer</span></span></span></span><span> 
</span><span>          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span>contents_def</span><span> </span><span>a2</span><span class="delimiter">)</span><span> </span><span class="delimiter">+</span><span>
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a7</span><span> </span><span>False</span><span>  </span><span>current_alter</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>file_free_local_rsp</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>p0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 s&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#172;(interference (current s) s d)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = fst(file_free s pid file )&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span>   </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8764; d &#8764; s&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p2</span><span> </span><span>file_free_def</span><span> </span><span>security_file_free_def</span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">{</span></span><span> 
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;smk_of_subjlabel s d = smk_of_subjlabel s&#39; d&quot;</span></span></span><span> 
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p0</span><span> </span><span>p1</span><span> </span><span>p2</span><span>  </span><span>file_free_subjlabel</span><span> 
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a2</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;observe s d = observe s&#39; d&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p0</span><span> </span><span>p1</span><span> </span><span>p2</span><span> </span><span>file_free_notchg_observe</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a3</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#8704;n. n &#8712;(observe s d)  &#10230; (contents s n) = (contents s&#39; n) )&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p0</span><span> </span><span>p1</span><span> </span><span>p2</span><span>   </span><span>file_free_notchg_contents</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a4</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#8704;v. interference v s d &#10231; interference v s&#39; d)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p0</span><span> </span><span>p1</span><span> </span><span>p2</span><span> </span><span>file_free_notchg_policy</span><span> 
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a6</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8764; d &#8764; s&#39;&quot;</span></span></span><span> 
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a1</span><span> </span><span>a2</span><span> </span><span>a3</span><span> </span><span>a4</span><span>  </span><span>kvpeq_def</span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>   
</span><span>  </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>file_free_local_rsp_e</span><span class="delimiter">:</span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>p0</span><span> </span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 s &quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>p1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;e = ( Event_file_free pid file)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>p2</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;non_interference (the(getpid_from_manage_hooks e)) s d&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>p3</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = exec_manage_event s e&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span>   </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8764; d &#8764; s&#39;&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(the (getpid_from_manage_hooks e)) = pid&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p1</span><span> </span><span>getpid_from_manage_hooks_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = fst(file_free s pid file )&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p1</span><span> </span><span>p3</span><span> </span><span>exec_manage_event_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#172;(interference pid s d)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p2</span><span> </span><span>a0</span><span> </span><span>non_interference_def</span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a3</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot; pid = current s&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>sched&#39;</span><span> </span><span>sched_def</span><span> 
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a0</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a4</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8764; d &#8764; s&#39;&quot;</span></span></span><span> 
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a1</span><span> </span><span>a2</span><span> </span><span>a3</span><span> </span><span>p0</span><span> </span><span>file_free_local_rsp</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fast</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>file_free_dlocal_rsp_e</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;dynamic_local_respect_e (( Event_file_free pid file))&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>file_free_local_rsp_e</span><span> </span><span>dynamic_local_respect_e_def</span><span>  </span><span>non_interference_def</span><span> 
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsubsection</span></span><span class="cartouche"><span class="delete"><span class="delete">&#8249;proving the &quot;dynamic local respect&quot; property&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>dynamic_local_respect_m</span><span class="delimiter">:</span><span>dynamic_local_respect</span><span>
</span><span>   </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>      </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>        </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>e</span><span>
</span><span>        </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;dynamic_local_respect_e e&quot;</span></span></span><span> 
</span><span>          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>induct</span><span> </span><span>e</span><span class="delimiter">)</span><span>
</span><span>          </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>alloc_file_dlocal_rsp_e</span><span> </span><span>file_free_dlocal_rsp_e</span><span> 
</span><span>          </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span class="delimiter">+</span><span>
</span><span>      </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> 
</span><span>        </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>dynamic_local_respect_all_evt</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>    </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249; Concrete unwinding condition of &quot;weakly step consistent&quot; &#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span class="cartouche"><span class="delete"><span class="delete">&#8249; smack file hooks weakly step consistent&#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">subsubsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;proving &quot;alloc_file&quot; satisfying the &quot;weakly step consistent&quot; property&#8250;</span></span></span><span> 
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>alloc_file_wsc</span><span class="delimiter">:</span><span>
</span><span> </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>p0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 s&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 t&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8764; d &#8764; t&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p3</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;pid @ s&#8605; d&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p4</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8764; pid &#8764; t &quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p5</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = fst(alloc_file s pid file c)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p6</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;t&#39; = fst(alloc_file t pid file c)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span>   </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; &#8764; d &#8764; t&#39;&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; &#8764; d &#8764; t&#39;&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>p2</span><span>  
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>current_alter</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>alloc_file_wsc_e</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>p0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 s&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 t&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;e =  (Event_alloc_file  pid file c)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p3</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8764; d &#8764; t&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p4</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(the (getpid_from_manage_hooks e)) @ s&#8605; d&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p5</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8764; (the (getpid_from_manage_hooks e)) &#8764; t &quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p6</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = exec_manage_event s e&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p7</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;t&#39; = exec_manage_event t e&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span>   </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; &#8764; d &#8764; t&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>    </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a0</span><span> </span><span class="delimiter">:</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;(the (getpid_from_manage_hooks e)) = pid&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p2</span><span> </span><span>getpid_from_manage_hooks_def</span><span> 
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>force</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = fst(alloc_file s pid file c)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p2</span><span> </span><span>p6</span><span> </span><span>exec_manage_event_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;t&#39; = fst(alloc_file t pid file c) &quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p2</span><span> </span><span>p7</span><span> </span><span>exec_manage_event_def</span><span> 
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a3</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;pid @ s&#8605;d&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p4</span><span> </span><span>a0</span><span> 
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a4</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8764; pid &#8764; t&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p5</span><span> </span><span>a0</span><span> 
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a5</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; &#8764; d &#8764; t&#39;&quot;</span></span></span><span>
</span><span>       </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a1</span><span> </span><span>a2</span><span> </span><span>a3</span><span> </span><span>a4</span><span> </span><span>p0</span><span> </span><span>p1</span><span> </span><span>p3</span><span> </span><span>p5</span><span> </span><span>p4</span><span> </span><span>alloc_file_wsc</span><span> 
</span><span>       </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>   
</span><span>     </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>alloc_file_dwsc_e</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;dynamic_weakly_step_consistent_e ( (Event_alloc_file  pid file c)) &quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>dynamic_weakly_step_consistent_e_def</span><span> </span><span>alloc_file_wsc_e</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsubsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;proving &quot;file_free&quot; satisfying the &quot;weakly step consistent&quot; property&#8250;</span></span></span><span> 
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>file_free_wsc</span><span class="delimiter">:</span><span>
</span><span> </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>p0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 s&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 t&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8764; d &#8764; t&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p3</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;pid @ s&#8605; d&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p4</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8764; pid &#8764; t &quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p5</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = fst(file_free s pid file )&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p6</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;t&#39; = fst(file_free t pid file )&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span>   </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; &#8764; d &#8764; t&#39;&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>   
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; &#8764; d &#8764; t&#39;&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p2</span><span> 
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>current_alter</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>file_free_wsc_e</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>p0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 s&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 t&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;e = ( Event_file_free pid file)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p3</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8764; d &#8764; t&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p4</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(the (getpid_from_manage_hooks e)) @ s&#8605; d&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p5</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8764; (the (getpid_from_manage_hooks e)) &#8764; t &quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p6</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = exec_manage_event s e&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p7</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;t&#39; = exec_manage_event t e&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span>   </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; &#8764; d &#8764; t&#39;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>    </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a0</span><span> </span><span class="delimiter">:</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;(the (getpid_from_manage_hooks e)) = pid&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p2</span><span> </span><span>getpid_from_manage_hooks_def</span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>force</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; = fst(file_free s pid file )&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p2</span><span> </span><span>p6</span><span> </span><span>exec_manage_event_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;t&#39; = fst(file_free t pid file ) &quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p2</span><span> </span><span>p7</span><span> </span><span>exec_manage_event_def</span><span> 
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a3</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;pid @ s&#8605;d&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p4</span><span> </span><span>a0</span><span> 
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a4</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8764; pid &#8764; t&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p5</span><span> </span><span>a0</span><span> 
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a5</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; &#8764; d &#8764; t&#39;&quot;</span></span></span><span>
</span><span>       </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a1</span><span> </span><span>a2</span><span> </span><span>a3</span><span> </span><span>a4</span><span> </span><span>p0</span><span> </span><span>p1</span><span> </span><span>p3</span><span> </span><span>p5</span><span> </span><span>p4</span><span> </span><span>file_free_wsc</span><span> 
</span><span>       </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>   
</span><span>     </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>file_free_dwsc_e</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;dynamic_weakly_step_consistent_e (( Event_file_free pid file)) &quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>dynamic_weakly_step_consistent_e_def</span><span> </span><span>file_free_wsc_e</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*
subsection&#8249; smack key hooks weakly step consistent&#8250;
subsubsection &#8249;proving &quot;key_alloc&quot; satisfying the &quot;weakly step consistent&quot; property&#8250; 
lemma key_alloc_wsc:
 assumes p0: &quot;reachable0 s&quot;
    and   p1: &quot;reachable0 t&quot;
    and   p2: &quot;s &#8764; d &#8764; t&quot;
    and   p3: &quot;pid @ s&#8605; d&quot;
    and   p4: &quot;s &#8764; pid &#8764; t &quot;
    and   p5: &quot;s&#39; = fst(key_alloc s pid ktype desc uid&#39; gid&#39; cred&#39; flags&#39;)&quot;
    and   p6: &quot;t&#39; = fst(key_alloc t pid ktype desc uid&#39; gid&#39; cred&#39; flags&#39;)&quot;
  shows   &quot;s&#39; &#8764; d &#8764; t&#39;&quot;
   proof -
  {
    have a0 : &quot;s = s&#39;&quot;
      using p5 key_alloc_def
      by (smt fstI)
    have a1 : &quot;t = t&#39;&quot;
      using p6 key_alloc_def 
      by (smt fst_conv)
    have a2: &quot;s&#39; &#8764; d &#8764; t&#39;&quot;
      using a0 a1 p2 
      by blast
  }
  then show ?thesis by auto
qed

lemma key_alloc_wsc_e:
  assumes p0: &quot;reachable0 s&quot;
    and   p1: &quot;reachable0 t&quot;
    and   p2: &quot;e = KeyEvt( Event_key_alloc pid ktype desc uid&#39; gid&#39; cred&#39; flags&#39;)&quot;
    and   p3: &quot;s &#8764; d &#8764; t&quot;
    and   p4: &quot;(the (domain_of_event e)) @ s&#8605; d&quot;
    and   p5: &quot;s &#8764; (the (domain_of_event e)) &#8764; t &quot;
    and   p6: &quot;s&#39; = exec_event s e&quot;
    and   p7: &quot;t&#39; = exec_event t e&quot;
  shows   &quot;s&#39; &#8764; d &#8764; t&#39;&quot;
  proof -
    {
    have a0 :  &quot;(the (domain_of_event e)) = pid&quot;
      using p2 domain_of_event_def getpid_from_key_evevt_def 
      by force
    have a1: &quot;s&#39; = fst(key_alloc s pid ktype desc uid&#39; gid&#39; cred&#39; flags&#39;)&quot;
      using p2 p6 exec_event_def by auto
    have a2: &quot;t&#39; = fst(key_alloc t pid ktype desc uid&#39; gid&#39; cred&#39; flags&#39;) &quot;
      using p2 p7 exec_event_def 
      by auto
    have a3: &quot;pid @ s&#8605;d&quot;
      using p4 a0 
      by blast
    have a4 : &quot;s &#8764; pid &#8764; t&quot; using p5 a0 
      by blast
    have a5: &quot;s&#39; &#8764; d &#8764; t&#39;&quot;
       using a1 a2 a3 a4 p0 p1 p3 p5 p4 key_alloc_wsc 
       by blast   
     }
  then show ?thesis by auto
qed

lemma key_alloc_dwsc_e: &quot;dynamic_weakly_step_consistent_e (KeyEvt( Event_key_alloc pid ktype desc uid&#39; gid&#39; cred&#39; flags&#39;)) &quot;
  using dynamic_weakly_step_consistent_e_def key_alloc_wsc_e
  by blast

subsubsection &#8249;proving &quot;key_free&quot; satisfying the &quot;weakly step consistent&quot; property&#8250; 
lemma key_free_wsc:
 assumes p0: &quot;reachable0 s&quot;
    and   p1: &quot;reachable0 t&quot;
    and   p2: &quot;s &#8764; d &#8764; t&quot;
    and   p3: &quot;pid @ s&#8605; d&quot;
    and   p4: &quot;s &#8764; pid &#8764; t &quot;
    and   p5: &quot;s&#39; = fst(key_free s pid key&#39;)&quot;
    and   p6: &quot;t&#39; = fst(key_free t pid key&#39;)&quot;
  shows   &quot;s&#39; &#8764; d &#8764; t&#39;&quot;
   proof -
  {
    have a0 : &quot;s = s&#39;&quot;
      using p5 key_free_def
      by (smt fstI)
    have a1 : &quot;t = t&#39;&quot;
      using p6 key_free_def 
      by (smt fst_conv)
    have a2: &quot;s&#39; &#8764; d &#8764; t&#39;&quot;
      using a0 a1 p2 
      by blast
  }
  then show ?thesis by auto
qed

lemma key_free_wsc_e:
  assumes p0: &quot;reachable0 s&quot;
    and   p1: &quot;reachable0 t&quot;
    and   p2: &quot;e = KeyEvt( Event_key_free pid key&#39; )&quot;
    and   p3: &quot;s &#8764; d &#8764; t&quot;
    and   p4: &quot;(the (domain_of_event e)) @ s&#8605; d&quot;
    and   p5: &quot;s &#8764; (the (domain_of_event e)) &#8764; t &quot;
    and   p6: &quot;s&#39; = exec_event s e&quot;
    and   p7: &quot;t&#39; = exec_event t e&quot;
  shows   &quot;s&#39; &#8764; d &#8764; t&#39;&quot;
  proof -
    {
    have a0 :  &quot;(the (domain_of_event e)) = pid&quot;
      using p2 domain_of_event_def getpid_from_key_evevt_def 
      by force
    have a1: &quot;s&#39; = fst(key_free s pid key&#39;)&quot;
      using p2 p6 exec_event_def by auto
    have a2: &quot;t&#39; = fst(key_free t pid key&#39;) &quot;
      using p2 p7 exec_event_def 
      by auto
    have a3: &quot;pid @ s&#8605;d&quot;
      using p4 a0 
      by blast
    have a4 : &quot;s &#8764; pid &#8764; t&quot; using p5 a0 
      by blast
    have a5: &quot;s&#39; &#8764; d &#8764; t&#39;&quot;
       using a1 a2 a3 a4 p0 p1 p3 p5 p4 key_free_wsc 
       by blast  
     }
  then show ?thesis by auto
qed

lemma key_free_dwsc_e: &quot;dynamic_weakly_step_consistent_e (KeyEvt( Event_key_free pid key&#39; )) &quot;
  using dynamic_weakly_step_consistent_e_def key_free_wsc_e
  by blast
*)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsubsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;proving the &quot;dynamic step consistent&quot; property&#8250;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>dynamic_weakly_step_consistent_m</span><span class="delimiter">:</span><span>dynamic_weakly_step_consistent</span><span>
</span><span>    </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>      </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>        </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>e</span><span>
</span><span>        </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;dynamic_weakly_step_consistent_e e&quot;</span></span></span><span> 
</span><span>          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>induct</span><span> </span><span>e</span><span class="delimiter">)</span><span>
</span><span>          </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>alloc_file_dwsc_e</span><span> </span><span>file_free_dwsc_e</span><span> 
</span><span>          </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span class="delimiter">+</span><span>
</span><span>              
</span><span>      </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>            </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>dynamic_weakly_step_consistent_all_evt</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>        </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span> </span><span class="keyword1"><span class="command">subsection</span></span><span class="cartouche"><span class="delete"><span class="delete">&#8249; Information flow security of linux LSM specification &#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>noninfluence_sat_m</span><span class="delimiter">:</span><span> </span><span>noninfluence</span><span>
</span><span>   </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>dynamic_local_respect_m</span><span> </span><span>uc_eq_noninf</span><span> </span><span>dynamic_weakly_step_consistent_m</span><span> 
</span><span>     </span><span>weak_with_step_cons</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>weak_noninfluence_sat_m</span><span class="delimiter">:</span><span> </span><span>weak_noninfluence</span><span> 
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>noninf_impl_weak</span><span> </span><span>noninfluence_sat_m</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span>  </span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>nonleakage_sat_m</span><span class="delimiter">:</span><span> </span><span>nonleakage</span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>noninf_impl_nonlk</span><span> </span><span>noninfluence_sat_m</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span>  </span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>noninterference_r_sat_m</span><span class="delimiter">:</span><span> </span><span>noninterference_r</span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>noninf_impl_nonintf_r</span><span> </span><span>noninfluence_sat_m</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>    
</span><span>  </span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>noninterference_sat_m</span><span class="delimiter">:</span><span> </span><span>noninterference</span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>noninterference_r_sat_m</span><span> </span><span>nonintf_r_impl_noninterf</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>    
</span><span>  </span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>weak_noninterference_r_sat_m</span><span class="delimiter">:</span><span> </span><span>weak_noninterference_r</span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>noninterference_r_sat_m</span><span> </span><span>nonintf_r_impl_wk_nonintf_r</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>    
</span><span>  </span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>weak_noninterference_sat_m</span><span class="delimiter">:</span><span> </span><span>weak_noninterference</span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>noninterference_sat_m</span><span> </span><span>nonintf_impl_weak</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span></pre>

</div>
</body>
</html>
