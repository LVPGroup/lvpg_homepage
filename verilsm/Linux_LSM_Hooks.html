<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Theory Linux_LSM_Hooks (Isabelle2019: June 2019)</title>
<link media="all" rel="stylesheet" type="text/css" href="isabelle.css"/>
</head>

<body>
<div class="head"><h1>Theory Linux_LSM_Hooks</h1>

<span class="command">theory</span> <span class="name">Linux_LSM_Hooks</span><br/>
<span class="keyword">imports</span> <a href="NonDetMonadVCG.html"><span class="name">NonDetMonadVCG</span></a> <a href="SOAC.html"><span class="name">SOAC</span></a><br/>

</div>
<div class="source">
<pre class="source"><span class="keyword1"><span class="command">section</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249; lsm hooks [lsm_hooks]&#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">theory</span></span><span> </span><span>Linux_LSM_Hooks</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">imports</span></span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;Element&quot;</span></span></span><span>  
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;../lib/Monad_WP/NonDetMonadVCG&quot;</span></span></span><span> 
</span><span>  </span><span>SOAC</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span class="cartouche"><span class="delete"><span class="delete">&#8249;
  In this theory, we introduce LSM hooks
&#8250;</span></span></span><span>         
</span><span class="keyword1"><span class="command">subsection</span></span><span class="cartouche"><span class="delete"><span class="delete">&#8249; lsm hook&#8250;</span></span></span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*super_block*)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>lsm_superblock_hooks</span><span> </span><span class="delimiter">=</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>s0</span><span> </span><span class="delimiter">::</span><span> </span><span class="tfree">&#39;s</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>state</span><span> </span><span class="delimiter">::</span><span> </span><span class="tfree">&#39;s</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>sb_security</span><span> </span><span class="delimiter">::</span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;super_block &#8658;&#39;sbsec option&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_sb_alloc</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; super_block &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_sb_free</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; super_block &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_sb_copy_data</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; string &#8658; string &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_sb_remount</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; super_block &#8658; Void &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_sb_kern_mount</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; super_block &#8658; int &#8658; string &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_sb_show_options</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; seq_file &#8658; super_block &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_sb_statfs</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_sb_mount</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; string &#8658; path &#8658; string &#8658; int &#8658; Void &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_sb_umount</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; vfsmount &#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_sb_pivotroot</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; path &#8658; path &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_sb_set_mnt_opts</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; super_block &#8658; opts &#8658; nat &#8658; nat &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_sb_clone_mnt_opts</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; super_block &#8658; super_block &#8658; int &#8658; int 
                                      &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_sb_parse_opts_str</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s&#8658;string &#8658; opts &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_sb_alloc_hook</span><span> </span><span class="delimiter">:</span><span>
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_sb_alloc s sb  &#10627;&#955;r s. r = 0 &#8744; r = -ENOMEM&#10628;&quot;</span></span></span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_sb_free</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_sb_free s sb &#10627;&#955;r s. r = unit &#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_sb_copy_data</span><span> </span><span class="delimiter">:</span><span>
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#10627;&#955;s. True&#10628; hook_sb_copy_data s orig smackopts &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r = (uminus 12))&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_sb_remount</span><span> </span><span class="delimiter">:</span><span>
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot; &#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_sb_remount s sb data&#39; &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_sb_kern_mount</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot; &#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_sb_kern_mount s sb flag data &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_sb_show_options</span><span> </span><span class="delimiter">:</span><span>
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot; &#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_sb_show_options s sq sb &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_sb_statfs</span><span> </span><span class="delimiter">:</span><span>
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_sb_statfs s  d &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_sb_mount</span><span> </span><span class="delimiter">:</span><span>
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot; &#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_sb_mount s  devname path type flag data&#39; 
            &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span> 
</span><span> </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_sb_umount</span><span class="delimiter">:</span><span>
</span><span>     </span><span class="string"><span class="delete"><span class="delete">&quot; &#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_sb_umount s  mnt&#39; flag &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span> </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_sb_pivotroot</span><span class="delimiter">:</span><span>
</span><span>     </span><span class="string"><span class="delete"><span class="delete">&quot; &#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_sb_pivotroot s  old_path new_path 
             &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_sb_set_mnt_opts</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot; &#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_sb_set_mnt_opts s sb opt kflag sflag 
            &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_sb_clone_mnt_opts</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot; &#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_sb_clone_mnt_opts s oldsb newsb kflag sflag 
            &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_parse_opts_str</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_sb_parse_opts_str s str opt  &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>lsm_task_hooks</span><span> </span><span class="delimiter">=</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>s0</span><span> </span><span class="delimiter">::</span><span> </span><span class="tfree">&#39;s</span><span>
</span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*task*)</span></span></span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>t_security</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Cred &#8658; &#39;tsec option&quot;</span></span></span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_task_alloc</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658; nat &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_task_free</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658;  (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_cred_alloc_blank</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Cred &#8658; nat &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_cred_free</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Cred &#8658;  (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_prepare_creds</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Cred &#8658; Cred &#8658; nat &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_transfer_creds</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Cred &#8658; Cred &#8658;  (&#39;s, unit) nondet_monad&quot;</span></span></span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_cred_getsecid</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Cred &#8658; u32 &#8658;  (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_task_fix_setuid</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Cred &#8658; Cred &#8658; int &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_task_setpgid</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658; pid_t &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_task_getpgid</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_task_getsid</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_task_getsecid</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658; u32 &#8658;  (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_task_setnice</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658; int &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_task_setioprio</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658; int &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_task_getioprio</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_task_prlimit</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Cred &#8658; Cred &#8658; nat &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_task_setrlimit</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658; nat &#8658; rlimit &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_task_setscheduler</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task  &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_task_getscheduler</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task  &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_task_movememory</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task  &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_task_kill</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658; siginfo &#8658; int &#8658; Cred option &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_task_prctl</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; int &#8658; nat &#8658; nat &#8658;nat &#8658; nat &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_task_to_inode</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658;  inode  &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*task*)</span></span></span></span></span><span>
</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_task_alloc</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_task_alloc s task  cflag &#10627;&#955;r s. r = 0 &#8744; r &#8800; 0&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_task_free</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_task_free s task &#10627;&#955;r s. r = unit &#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_cred_alloc_blank</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_cred_alloc_blank s cred&#39; gfp&#39;  &#10627;&#955;r s. r = 0 &#8744; r &#8800; 0&#10628;&quot;</span></span></span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_cred_free</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_cred_free s c &#10627;&#955;r s. r = unit &#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_prepare_creds</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_prepare_creds s new&#39; old gfp&#39; &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_transfer_creds</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_transfer_creds s new&#39; old &#10627;&#955;r s. r = unit&#10628;&quot;</span></span></span><span>  
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_task_setpgid</span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_task_setpgid s t pid &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_task_getpgid</span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_task_getpgid s t  &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>  
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_task_getsid</span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_task_getsid s t  &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_task_getsecid</span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot; &#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_task_getsecid s t secid&#39; &#10627;&#955;r s. r = unit&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_task_setnice</span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot; &#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_task_setnice s t nice &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_task_setioprio</span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot; &#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_task_setioprio s t ioprio &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_task_getioprio</span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_task_getioprio s t  &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_task_setrlimit</span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot; &#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_task_setrlimit s t resource new &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_task_setscheduler</span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot; &#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_task_setscheduler s t  &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_task_getscheduler</span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot; &#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_task_getscheduler s t  &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_task_movememory</span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot; &#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_task_movememory s t  &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_task_kill</span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot; &#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_task_kill s t info sig c&#39; &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_task_prctl</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; 
           hook_task_prctl s opt&#39; arg2 arg3 arg4 arg5  
          &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_task_to_inode</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_task_to_inode s t inode &#10627;&#955;r s. r = unit &#10628;&quot;</span></span></span><span>
</span><span>
</span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*binder *)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>lsm_binder_hooks</span><span> </span><span class="delimiter">=</span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>s0</span><span> </span><span class="delimiter">::</span><span> </span><span class="tfree">&#39;s</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_binder_set_context_mgr</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_binder_transaction</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658; Task &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_binder_transfer_binder</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658; Task &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_binder_transfer_file</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658; Task &#8658;Files &#8658; (&#39;s, int) nondet_monad &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_binder_set_context_mgr</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_binder_set_context_mgr s mgr  &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_binder_transaction</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_binder_transaction s from to  &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_binder_transfer_binder</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_binder_transfer_binder s from to  &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_binder_transfer_file</span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_binder_transfer_file s from to file  &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*ptrace*)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>lsm_ptrace_hooks</span><span> </span><span class="delimiter">=</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>s0</span><span> </span><span class="delimiter">::</span><span> </span><span class="tfree">&#39;s</span><span>
</span><span>  </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* sbuj &#8658; current task |  obj &#8658;child::Task *)</span></span></span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_ptrace_access_check</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658;  nat &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span> 
</span><span>  </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* sbuj &#8658; current task |  obj &#8658;parent::Task *)</span></span></span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_ptrace_traceme</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>  
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_ptrace_access_check</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_ptrace_access_check s child m &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_ptrace_traceme</span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_ptrace_traceme s parent&#39; &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>
</span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*capable*)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>lsm_capable_hooks</span><span> </span><span class="delimiter">=</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>s0</span><span> </span><span class="delimiter">::</span><span> </span><span class="tfree">&#39;s</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_capget</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658; kct &#8658; kct &#8658;kct &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_capset</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Cred &#8658; Cred &#8658; kct &#8658; kct &#8658;kct &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_capable</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Cred &#8658; ns &#8658; cap &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_capable_noaudit</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Cred &#8658; ns &#8658; cap &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_quotactl</span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; int &#8658; int &#8658; int &#8658; super_block option&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_quota_on</span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_syslog</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_settime64</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; ts &#8658; tz option &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_vm_enough_memory_mm</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; mm &#8658;  pages &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_capget</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_capget s target effective inheritable permitted 
          &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_capset</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_capset s new old effective inheritable permitted  
          &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_capable</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_capable s c ns cap  &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_capable_noaudit</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_capable_noaudit s c ns cap  &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_quotactl</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_quotactl s cmds t id&#39; sb &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_quota_on</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_quota_on s dentry  &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_syslog</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_syslog s type  &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_settime64</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_settime64 s ts tz &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_vm_enough_memory_mm</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_vm_enough_memory_mm s mm&#39; pages &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span> 
</span><span>
</span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*bprm*)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>lsm_bprm_hooks</span><span> </span><span class="delimiter">=</span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>s0</span><span> </span><span class="delimiter">::</span><span> </span><span class="tfree">&#39;s</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_bprm_set_creds</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;linux_binprm &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_bprm_check</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;linux_binprm &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_bprm_committing_creds</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s&#8658;linux_binprm &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_bprm_committed_creds</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s&#8658;linux_binprm &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  
</span><span>   </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_bprm_set_creds</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_bprm_set_creds s bprm  &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_bprm_check</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_bprm_check s bprm &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_bprm_committing_creds</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_bprm_committing_creds s bprm &#10627;&#955;r s. r = unit&#10628; &quot;</span></span></span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_bprm_committed_creds</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_bprm_committed_creds s bprm &#10627;&#955;r s. r = unit&#10628; &quot;</span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>lsm_file_hooks</span><span> </span><span class="delimiter">=</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>s0</span><span> </span><span class="delimiter">::</span><span> </span><span class="tfree">&#39;s</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>access</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s&#8658; Subj &#8658; Obj &#8658; access&#8658; bool&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>current</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; process_id&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>f_security</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot; &#39;s &#8658;Files &#8658; &#39;fsec option&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_file_permission</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files&#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_file_alloc</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_file_free</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_file_ioctl</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files&#8658; IOC_DIR &#8658; nat &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_mmap_file</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files option&#8658; nat &#8658; nat &#8658;nat&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_mmap_addr</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; nat &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_file_mprotect</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; vm_area_struct&#8658; nat &#8658; nat &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_file_lock</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files&#8658; nat  &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_file_fcntl</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files&#8658; nat &#8658; nat &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_file_set_fowner</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files&#8658;  (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_file_send_sigiotask</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task&#8658; fown_struct &#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_file_receive</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files&#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_file_open</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files&#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_file_permission</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa file mask&#39;. &#10627;&#955;s . s = sa &#10628; 
                      hook_file_permission sa file mask&#39; 
                      &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0) &#10628;&quot;</span></span></span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_file_alloc_security</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa file. &#10627;&#955;s . s = sa &#8743; f_security s file = None &#10628;
                hook_file_alloc sa file 
                &#10627;&#955;r s. (r = 0 &#8743; f_security s file &#8800; None &#8743; s &#8800; sa) &#8744; (r &#8800; 0 &#8743; s = sa) &#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_file_free_security</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa file. &#10627;&#955;s . s = sa&#10628; hook_file_free sa file &#10627;&#955;r s. r = unit &#8743; f_security s file = None &#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_file_ioctl</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s. s = sa&#10628; hook_file_ioctl sa file cmd arg &#10627;&#955;r s. s = sa &#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>file_ioctl_ac</span><span> </span><span class="delimiter">:</span><span>
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;(&#8707;p. access s (current s) (File file) p = True &#10230; 
         &#10627;&#955;s. True&#10628; hook_file_ioctl sa file cmd arg &#10627;&#955;r s. r = 0 &#10628;) &#8744;
     (&#8707;p. access s (current s) (File file) p = False &#10230; 
         &#10627;&#955;s. True&#10628; hook_file_ioctl sa file cmd arg &#10627;&#955;r s. r &#8800; 0 &#10628;)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_mmap_addr</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s. s = sa &#10628; hook_mmap_addr sa addr&#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_mmap_file</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s. s = sa &#10628; hook_mmap_file sa file&#39; prot mprot flgs &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_file_mprotect</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s. s = sa &#10628; hook_file_mprotect sa vma reqprot prot &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_file_lock</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s. s = sa &#10628; hook_file_lock sa file fcmd &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_file_fcntl</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s. s = sa &#10628; hook_file_fcntl sa file fcmd arg &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_file_set_fowner</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa file.  &#10627;&#955;s . s = sa &#10628; hook_file_set_fowner sa file &#10627;&#955;r s. r = unit&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_file_send_sigiotask</span><span> </span><span class="delimiter">:</span><span>
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s. s = sa &#10628; hook_file_send_sigiotask sa tsk&#39; fown sig &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_file_receive</span><span> </span><span class="delimiter">:</span><span>
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s. s = sa &#10628; hook_file_receive sa file &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_file_open</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s. s = sa &#10628; hook_file_open sa file &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>lsm_dentry_hooks</span><span> </span><span class="delimiter">=</span><span>
</span><span>  </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*dentry*)</span></span></span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>s0</span><span> </span><span class="delimiter">::</span><span> </span><span class="tfree">&#39;s</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_dentry_init_security</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;dentry &#8658; mode &#8658; string &#8658; string &#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_dentry_create_files_as</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;dentry &#8658; mode &#8658; string &#8658; Cred &#8658; Cred &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_dentry_init_security</span><span> </span><span class="delimiter">:</span><span>
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; 
           hook_dentry_init_security s dentry m name ctx xtxlen 
          &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_dentry_create_files_as</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; 
           hook_dentry_create_files_as s dentry m name old new 
           &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>
</span><span>  </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*inode *)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>lsm_inode_hooks</span><span> </span><span class="delimiter">=</span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>s0</span><span> </span><span class="delimiter">::</span><span> </span><span class="tfree">&#39;s</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>i_security</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; inode &#8658; &#39;isec option&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inode_alloc</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;inode &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inode_free</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; inode &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inode_init_security</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s&#8658;inode &#8658;  inode &#8658; string &#8658; string  &#8658; string &#8658;int  &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_old_inode_init_security</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; inode &#8658;  inode &#8658; qstr &#8658; string &#8658; string &#8658;int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inode_create</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; inode &#8658; dentry&#8658; mode &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inode_link</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; inode &#8658; dentry &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inode_unlink</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  inode &#8658; dentry &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inode_symlink</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  inode &#8658; dentry &#8658; string &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inode_mkdir</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; inode &#8658; dentry&#8658; mode &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inode_rmdir</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  inode &#8658; dentry&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inode_mknod</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  inode &#8658; dentry&#8658; mode &#8658; dev_t =&gt;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inode_rename</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  inode &#8658; dentry &#8658;  inode &#8658;dentry &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inode_readlink</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inode_follow_link</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658;  inode &#8658; bool &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inode_permission</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  inode &#8658; mask &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inode_setattr</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; iattr &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inode_getattr</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; path &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inode_setxattr</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; xattr &#8658; string &#8658; int &#8658; flags &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inode_post_setxattr</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; xattr &#8658; string &#8658; int &#8658; flags &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inode_getxattr</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; xattr &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inode_listxattr</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry  &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inode_removexattr</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; xattr &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inode_need_killpriv</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inode_killpriv</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inode_getsecurity</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  inode &#8658; xattr &#8658; Void &#8658; bool &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inode_setsecurity</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; inode &#8658; xattr &#8658; Void &#8658; nat&#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inode_listsecurity</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  inode &#8658; Void &#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inode_getsecid</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; inode &#8658; u32 &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inode_copy_up</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; Cred option &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inode_copy_up_xattr</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; xattr &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inode_invalidate_secctx</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  inode &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inode_notifysecctx</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  inode &#8658; string &#8658; u32&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inode_setsecctx</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; string &#8658; u32&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inode_getsecctx</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; inode &#8658; string&#8658; u32&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_inode_alloc</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_inode_alloc s inode &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_inode_free</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_inode_free s inode &#10627;&#955;r s.  r = unit&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_inode_init_security</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_inode_init_security s inode dir qstr  name value len&#39; 
           &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_old_inode_init_security</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot; &#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_old_inode_init_security s inode dir qstr name value len&#39; 
            &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_inode_create</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot; &#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_inode_create s dir dentry m &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_inode_link</span><span> </span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot; &#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_inode_link s old_dentry dir new_dentry &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_inode_unlink</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot; &#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_inode_unlink s dir dentry &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_inode_symlink</span><span> </span><span class="delimiter">:</span><span>
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628;   hook_inode_symlink s dir dentry old_name &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span> </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_inode_mkdir</span><span> </span><span class="delimiter">:</span><span> 
</span><span>   </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_inode_mkdir s dir dentry m &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span> </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_inode_rmdir</span><span> </span><span class="delimiter">:</span><span> 
</span><span>   </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_inode_rmdir s dir dentry &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>    
</span><span> </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_inode_mknod</span><span> </span><span class="delimiter">:</span><span> 
</span><span>   </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_inode_mknod s dir dentry m dev &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span> </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_inode_rename</span><span> </span><span class="delimiter">:</span><span> 
</span><span>   </span><span class="string"><span class="delete"><span class="delete">&quot; &#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_inode_rename s new_dir new_dentry old_dir old_dentry 
          &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span> </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_inode_readlink</span><span> </span><span class="delimiter">:</span><span>
</span><span>   </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_inode_readlink s  dentry &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span> </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_inode_follow_link</span><span> </span><span class="delimiter">:</span><span>
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_inode_follow_link s dentry inode rcu&#39; 
           &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span> </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_inode_permission</span><span> </span><span class="delimiter">:</span><span> 
</span><span>   </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_inode_permission s inode m &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span> </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_inode_setattr</span><span> </span><span class="delimiter">:</span><span>
</span><span>   </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_inode_setattr s dentry attr&#39; &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span> </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_inode_getattr</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_inode_getattr s path &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span> </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_inode_setxattr</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_inode_setxattr s dentry name&#39; value size&#39; flgs 
        &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_inode_post_setxattr</span><span> </span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot; &#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_inode_post_setxattr  s dentry name&#39; value size&#39; flgs &#10627;&#955;r s.  r = unit&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_inode_getxattr</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot; &#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_inode_getxattr s dentry name&#39; &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_inode_listxattr</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot; &#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_inode_listxattr s dentry &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_inode_removexattr</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot; &#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_inode_removexattr s dentry name&#39; &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_inode_need_killpriv</span><span> </span><span class="delimiter">:</span><span>
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_inode_need_killpriv s dentry &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_inode_killpriv</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628;   hook_inode_killpriv s dentry &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_inode_getsecurity</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_inode_getsecurity s inode name&#39; buffer alloc &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_inode_setsecurity</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot; &#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_inode_setsecurity s inode name&#39; va size&#39; flgs &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_inode_listsecurity</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot; &#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_inode_listsecurity s inode buffer bsize &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_inode_getsecid</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_inode_getsecid  s inode secid&#39; &#10627;&#955;r s. r = unit&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_inode_copy_up</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_inode_copy_up  s src new &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_inode_copy_up_xattr</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_inode_copy_up_xattr  s name&#39; &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_inode_invalidate_secctx</span><span> </span><span class="delimiter">:</span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_inode_invalidate_secctx s inode &#10627;&#955;r s.  r = unit&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_inode_notifysecctx</span><span> </span><span class="delimiter">:</span><span>  
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_inode_notifysecctx s inode ctx ctxlen &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_inode_setsecctx</span><span> </span><span class="delimiter">:</span><span>  
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot; &#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_inode_setsecctx s dentry ctx ctxlen &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_inode_getsecctx</span><span> </span><span class="delimiter">:</span><span>  
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628;  hook_inode_getsecctx s inode ctx ctxlen &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>
</span><span>  </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*kernel*)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>lsm_kernel_hooks</span><span> </span><span class="delimiter">=</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>s0</span><span> </span><span class="delimiter">::</span><span> </span><span class="tfree">&#39;s</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_kernel_act_as</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Cred &#8658; u32 &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_kernel_create_files_as</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Cred &#8658;  inode &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_kernel_module_request</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; string &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_kernel_load_data</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; kernel_load_data_id &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_kernel_read_file</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files &#8658;kernel_read_file_id  &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_kernel_post_read_file</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Files &#8658; string &#8658; nat &#8658;kernel_read_file_id 
                                            &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_kernel_act_as</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_kernel_act_as s new secid&#39; &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_kernel_create_files_as</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_kernel_create_files_as s c inode &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_kernel_module_request</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_kernel_module_request s name &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_kernel_load_data</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_kernel_load_data s ldataid &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span> </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_kernel_read_file</span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_kernel_read_file s f rfid &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_hook_kernel_post_read_file</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; 
           hook_kernel_post_read_file  s file buf size&#39; kid &#10627;&#955;r s.  s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  
</span><span>
</span><span>  
</span><span>   </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*ipc &amp;msg*)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>lsm_ipc_hooks</span><span> </span><span class="delimiter">=</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>s0</span><span> </span><span class="delimiter">::</span><span> </span><span class="tfree">&#39;s</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>ipc_security</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;kern_ipc_perm &#8658; &#39;ipcsec option&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>msg_security</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot; &#39;s &#8658;msg_msg &#8658; &#39;msgsec option&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_ipc_permission</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  kern_ipc_perm &#8658; int &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_ipc_getsecid</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; kern_ipc_perm &#8658; u32 &#8658;  (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_msg_msg_alloc</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  msg_msg &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_msg_msg_free</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; msg_msg &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_msg_queue_alloc</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  kern_ipc_perm &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_msg_queue_free</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  kern_ipc_perm &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_msg_queue_associate</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; kern_ipc_perm &#8658; int&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_msg_queue_msgctl</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  kern_ipc_perm &#8658; IPC_CMD&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_msg_queue_msgsnd</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; kern_ipc_perm &#8658;  msg_msg &#8658; int&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_msg_queue_msgrcv</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; kern_ipc_perm &#8658; msg_msg&#8658; Task &#8658; int &#8658; int
                                      &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_shm_alloc</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  kern_ipc_perm &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_shm_free</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  kern_ipc_perm &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_shm_associate</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; kern_ipc_perm &#8658; int&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_shm_shmctl</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  kern_ipc_perm &#8658; IPC_CMD&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_shm_shmat</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; kern_ipc_perm &#8658;string &#8658;int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_sem_alloc</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  kern_ipc_perm &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_sem_free</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  kern_ipc_perm &#8658;  (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_sem_associate</span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; kern_ipc_perm &#8658; int&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_sem_semctl</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  kern_ipc_perm &#8658; IPC_CMD&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_sem_semop</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; kern_ipc_perm &#8658;sembuf&#8658;nat &#8658; int&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_ipc_permission</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_ipc_permission s ipcp flg &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_ipc_getsecid</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_ipc_getsecid s ipcp secid&#39; &#10627;&#955;r s. r = unit&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_msg_msg_alloc</span><span> </span><span class="delimiter">:</span><span>
</span><span>     </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_msg_msg_alloc s msg &#10627;&#955;r s. r = 0 &#8744; r &#8800; 0&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_msg_msg_free</span><span> </span><span class="delimiter">:</span><span>
</span><span>     </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_msg_msg_free s msg&#10627;&#955;r s. r = unit&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_msg_queue_alloc</span><span class="delimiter">:</span><span>
</span><span>     </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_msg_queue_alloc s msq &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_msg_queue_free</span><span>  </span><span class="delimiter">:</span><span>
</span><span>     </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_msg_queue_free s msq&#10627;&#955;r s. r = unit&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_msg_queue_associate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_msg_queue_associate s msq msqflg &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_msg_queue_msgctl</span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_msg_queue_msgctl s msq cmd &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;  &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_msg_queue_msgsnd</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_msg_queue_msgsnd s msq msg msqflg &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_msg_queue_msgrcv</span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_msg_queue_msgrcv s msq msg target type m 
          &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;  &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_shm_alloc</span><span class="delimiter">:</span><span>
</span><span>     </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_shm_alloc s shp &#10627;&#955;r s. r = 0 &#8744; r &#8800; 0&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_shm_free</span><span>  </span><span class="delimiter">:</span><span>
</span><span>     </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_shm_free s shp&#10627;&#955;r s. r = unit&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_shm_associate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_shm_associate s shp shmflg &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;  &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_shm_shmctl</span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_shm_shmctl s shp cmd &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;  &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_shm_shmat</span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_shm_shmat s shp shmaddr shmflg &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;  &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_sem_alloc</span><span class="delimiter">:</span><span>
</span><span>     </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_sem_alloc s sma &#10627;&#955;r s. r = 0 &#8744; r &#8800; 0&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_sem_free</span><span>  </span><span class="delimiter">:</span><span>
</span><span>     </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_sem_free s sma&#10627;&#955;r s. r = unit&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_sem_associate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_sem_associate s sma semflg &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;  &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_sem_shmctl</span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_sem_semctl s sma cmd &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;  &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_sem_shmat</span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_sem_semop s sma sops nsops alter &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;  &quot;</span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>lsm_other_hooks</span><span> </span><span class="delimiter">=</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>s0</span><span> </span><span class="delimiter">::</span><span> </span><span class="tfree">&#39;s</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_d_instantiate</span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658; inode option&#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_getprocattr</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Task &#8658; string &#8658; string &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_setprocattr</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; string &#8658; string &#8658; int&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_netlink_send</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  sock &#8658; sk_buff&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_ismaclabel</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; xattr&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_secid_to_secctx</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; u32 &#8658;string  &#8658; u32 &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_secctx_to_secid</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; string &#8658; u32&#8658; u32&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_release_secctx</span><span> </span><span class="delimiter">::</span><span>   </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; string &#8658; u32&#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_d_instantiate</span><span>  </span><span class="delimiter">:</span><span>
</span><span>     </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_d_instantiate sa dentry inode &#10627;&#955;r s. r = unit&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_getprocattr</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_getprocattr sa p name value &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_setprocattr</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_setprocattr sa  name value size&#39; &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_netlink_send</span><span>  </span><span class="delimiter">:</span><span>
</span><span>     </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_netlink_send s sk&#39; skb &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_ismaclabel</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s. s = sa &#10628; hook_ismaclabel s name&#39; &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_secid_to_secctx</span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s. s = sa &#10628; hook_secid_to_secctx s secid&#39; secdata seclen &#10627;&#955;r s. s = sa &#8743;(r = 0 &#8744;r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>   </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_secctx_to_secid</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s. s = sa &#10628; hook_secctx_to_secid s secdata seclen secid&#39; &#10627;&#955;r s. s = sa &#8743;(r = 0 &#8744;r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_release_secctx</span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s. s = sa &#10628; hook_release_secctx s secdata seclen &#10627;&#955;r s. r = unit&#10628;&quot;</span></span></span><span>
</span><span>  
</span><span>  
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>lsm_network_hooks</span><span> </span><span class="delimiter">=</span><span>
</span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* network *)</span></span></span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>s0</span><span> </span><span class="delimiter">::</span><span> </span><span class="tfree">&#39;s</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>sk_security</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;sock &#8658; &#39;ssec option&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_unix_stream_connect</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  sock &#8658; sock &#8658;  sock &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_unix_may_send</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  socket &#8658;  socket &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_socket_create</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; Sk_Family &#8658; int &#8658; int &#8658;int&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_socket_post_create</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; socket &#8658;  Sk_Family &#8658; int &#8658; int &#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_socket_socketpair</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; socket &#8658;  socket &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_socket_bind</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; socket &#8658; sockaddr &#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_socket_connect</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; socket &#8658; sockaddr &#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_socket_listen</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  socket  &#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_socket_accept</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  socket &#8658; socket  &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_socket_sendmsg</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  socket &#8658; msghdr &#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_socket_recvmsg</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  socket &#8658; msghdr &#8658; int &#8658; int&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_socket_getsockname</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; socket  &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_socket_getpeername</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  socket  &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_socket_getsockopt</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  socket  &#8658;int &#8658; int&#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_socket_setsockopt</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  socket &#8658;int &#8658; int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_socket_shutdown</span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  socket &#8658;int &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_sock_rcv_skb</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  sock &#8658;sk_buff  &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_socket_getpeersec_stream</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  socket &#8658;string &#8658;int &#8658;nat &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_socket_getpeersec_dgram</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; socket &#8658;sk_buff option &#8658; u32 &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_sk_alloc</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; sock&#8658;int &#8658; gfp_t &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_sk_free</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; sock&#8658;(&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_sk_clone</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  sock&#8658; sock &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_sk_classify_flow</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  sock&#8658; flowi &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_req_classify_flow</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; request_sock&#8658; flowi &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_sock_graft</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; sock&#8658;  socket &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inet_conn_request</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  sock&#8658; sk_buff &#8658;request_sock &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inet_csk_clone</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  sock &#8658;request_sock &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_inet_conn_established</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;  sock&#8658; sk_buff &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_secmark_relabel_packet</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; u32 &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_secmark_refcount_inc</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_secmark_refcount_dec</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_tun_dev_alloc_security</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; &#39;security &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_tun_dev_free_security</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; &#39;security &#8658;(&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_tun_dev_create</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_tun_dev_attach_queue</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; &#39;security &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_tun_dev_attach</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658;  sock&#8658; &#39;security&#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_tun_dev_open</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; &#39;security &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_sctp_assoc_request</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; sctp_endpoint &#8658; sk_buff &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_sctp_bind_connect</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658;  sock &#8658; int &#8658; sockaddr &#8658;int &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_sctp_sk_clone</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; sctp_endpoint &#8658; sock &#8658;  sock &#8658;(&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_unix_stream_connect</span><span> </span><span class="delimiter">:</span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; 
         hook_unix_stream_connect  s sock other newsk 
         &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_unix_may_send</span><span> </span><span class="delimiter">:</span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_unix_may_send s sock&#39; other&#39; &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_socket_create</span><span> </span><span class="delimiter">:</span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_socket_create s family type pro kern &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_socket_post_create</span><span> </span><span class="delimiter">:</span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_socket_post_create s sock&#39; family type pro kern 
           &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_socket_socketpair</span><span> </span><span class="delimiter">:</span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_socket_socketpair s socka sockb &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_socket_bind</span><span> </span><span class="delimiter">:</span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_socket_bind s sock&#39; address addrlen &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_socket_connect</span><span> </span><span class="delimiter">:</span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_socket_connect s sock&#39; address addrlen 
          &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_socket_listen</span><span> </span><span class="delimiter">:</span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_socket_listen s sock&#39; backlog &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_socket_accept</span><span> </span><span class="delimiter">:</span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_socket_accept s sock&#39; newsock &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_socket_sendmsg</span><span> </span><span class="delimiter">:</span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_socket_sendmsg s sock&#39; msg size&#39; &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_socket_recvmsg</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_socket_recvmsg s sock&#39; msg size&#39; flgs &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_socket_getsockname</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_socket_getsockname s sock&#39; &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_socket_getpeername</span><span> </span><span class="delimiter">:</span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_socket_getpeername s sock&#39; &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_socket_getsockopt</span><span> </span><span class="delimiter">:</span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; 
           hook_socket_getsockopt s sock&#39; level&#39; optname 
           &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_socket_setsockopt</span><span> </span><span class="delimiter">:</span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_socket_setsockopt s sock&#39; level&#39; optname 
           &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_socket_shutdown</span><span class="delimiter">:</span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_socket_shutdown s sock&#39; how &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_sock_rcv_skb</span><span> </span><span class="delimiter">:</span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_sock_rcv_skb s sock skb &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_socket_getpeersec_stream</span><span> </span><span class="delimiter">:</span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_socket_getpeersec_stream s sock&#39; optval optlen len&#39; 
          &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_socket_getpeersec_dgram</span><span> </span><span class="delimiter">:</span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; 
           hook_socket_getpeersec_dgram s sock&#39; skb&#39; secid&#39; 
           &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_sk_alloc</span><span> </span><span class="delimiter">:</span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_sk_alloc s sk&#39; family&#39; priority &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_sk_free</span><span> </span><span class="delimiter">:</span><span>  
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_sk_free s sock &#10627;&#955;r s. r = unit&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_sk_clone</span><span> </span><span class="delimiter">:</span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_sk_clone s sk&#39; newsk &#10627;&#955;r s. r = unit&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_sk_classify_flow</span><span> </span><span class="delimiter">:</span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_sk_classify_flow s sock fl &#10627;&#955;r s. r = unit&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_req_classify_flow</span><span> </span><span class="delimiter">:</span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_req_classify_flow s req fl &#10627;&#955;r s. r = unit&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_sock_graft</span><span> </span><span class="delimiter">:</span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_sock_graft s sk&#39; parent&#39; &#10627;&#955;r s. r = unit&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_inet_conn_request</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_inet_conn_request s sk&#39; skb req &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_inet_csk_clone</span><span> </span><span class="delimiter">:</span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_inet_csk_clone s newsk req &#10627;&#955;r s. r = unit&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_inet_conn_established</span><span> </span><span class="delimiter">:</span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_inet_conn_established s sk&#39; skb &#10627;&#955;r s. r = unit&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_secmark_relabel_packet</span><span> </span><span class="delimiter">:</span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_secmark_relabel_packet s secid&#39; &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_secmark_refcount_inc</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_secmark_refcount_inc s &#10627;&#955;r s. r = unit&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_secmark_refcount_dec</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_secmark_refcount_dec s &#10627;&#955;r s. r = unit&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_tun_dev_alloc_security</span><span> </span><span class="delimiter">:</span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_tun_dev_alloc_security s security &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_tun_dev_free_security</span><span> </span><span class="delimiter">:</span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_tun_dev_free_security s security &#10627;&#955;r s. r = unit&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_tun_dev_create</span><span> </span><span class="delimiter">:</span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_tun_dev_create s &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_tun_dev_attach_queue</span><span> </span><span class="delimiter">:</span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_tun_dev_attach_queue s security &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_tun_dev_attach</span><span> </span><span class="delimiter">:</span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_tun_dev_attach s sk&#39; security &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_tun_dev_open</span><span> </span><span class="delimiter">:</span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_tun_dev_open s security &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_sctp_assoc_request</span><span> </span><span class="delimiter">:</span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_sctp_assoc_request s ep skb &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_sctp_bind_connect</span><span> </span><span class="delimiter">:</span><span>  
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_sctp_bind_connect s sk&#39; optname address addrlen 
         &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>  
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>security_sctp_sk_clone</span><span> </span><span class="delimiter">:</span><span>  
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_sctp_sk_clone s ep sk&#39; newsk &#10627;&#955;r s. r = unit&#10628;&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>lsm_infiniband_hooks</span><span> </span><span class="delimiter">=</span><span>
</span><span>   </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* ib *)</span></span></span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>s0</span><span> </span><span class="delimiter">::</span><span> </span><span class="tfree">&#39;s</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_ib_pkey_access</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; &#39;v &#8658; nat &#8658; nat  &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_ib_endport_manage_subnet</span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; &#39;v &#8658; string &#8658; nat  &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_ib_alloc_security</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; &#39;v list &#8658;  (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_ib_free_security</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; &#39;v list &#8658;  (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_ib_pkey_access</span><span>  </span><span class="delimiter">:</span><span>
</span><span>     </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_ib_pkey_access sa sec prefix&#39; pkey  &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_ib_endport_manage_subnet</span><span>  </span><span class="delimiter">:</span><span>
</span><span>     </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_ib_endport_manage_subnet sa sec dev_name prot_num &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_ib_alloc_security</span><span>  </span><span class="delimiter">:</span><span>
</span><span>     </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_ib_alloc_security sa sec&#39; &#10627;&#955;r s. r =  0 &#8744; r &#8800; 0&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_ib_free_security</span><span>  </span><span class="delimiter">:</span><span>
</span><span>     </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_ib_free_security sa sec&#39; &#10627;&#955;r s. r = unit&#10628; &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>lsm_network_xfrm_hooks</span><span> </span><span class="delimiter">=</span><span> 
</span><span>  </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* lsm network_xfrm *)</span></span></span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>s0</span><span> </span><span class="delimiter">::</span><span> </span><span class="tfree">&#39;s</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_xfrm_policy_alloc</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;xfrm_sec_ctx &#8658; xfrm_user_sec_ctx &#8658; gfp_t &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_xfrm_policy_clone</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;xfrm_sec_ctx &#8658; xfrm_user_sec_ctx  &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_xfrm_policy_free</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;xfrm_sec_ctx  &#8658;(&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_xfrm_policy_delete</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;xfrm_sec_ctx  &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_xfrm_state_alloc</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;xfrm_state &#8658; xfrm_sec_ctx  &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_xfrm_state_alloc_acquire</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;xfrm_state &#8658; xfrm_sec_ctx =&gt; u32 &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_xfrm_state_delete</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;xfrm_state  &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_xfrm_state_free</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;xfrm_state  &#8658;(&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_xfrm_policy_lookup</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;xfrm_sec_ctx &#8658; u32 &#8658; u8 &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_xfrm_state_pol_flow_match</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;xfrm_state &#8658;xfrm_policy &#8658; flowi  &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_xfrm_decode_session</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;sk_buff &#8658; u32 &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_skb_classify_flow</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;sk_buff &#8658; flowi &#8658;(&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_xfrm_policy_alloc</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_xfrm_policy_alloc sa ctxp sec_ctx gfp&#39; &#10627;&#955;r s. r = 0 &#8744; r &#8800; 0&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_xfrm_policy_clone</span><span> </span><span class="delimiter">:</span><span>
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_xfrm_policy_clone sa old_ctx new_ctxp &#10627;&#955;r s. r = 0 &#8744; r &#8800; 0&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_xfrm_policy_free</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_xfrm_policy_free sa ctx &#10627;&#955;r s. r = unit&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_xfrm_policy_delete</span><span> </span><span class="delimiter">:</span><span>
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_xfrm_policy_delete sa ctx &#10627;&#955;r s. r = 0 &#8744; r &#8800; 0&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_xfrm_state_alloc</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_xfrm_state_alloc sa x sec_ctx&#39; &#10627;&#955;r s. r = 0 &#8744; r &#8800; 0&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_xfrm_state_alloc_acquire</span><span> </span><span class="delimiter">:</span><span>
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_xfrm_state_alloc_acquire sa x plosec secid&#39; &#10627;&#955;r s. r = 0 &#8744; r &#8800; 0&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_xfrm_state_delete</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_xfrm_state_delete sa x &#10627;&#955;r s. r = 0 &#8744; r &#8800; 0&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_xfrm_state_free</span><span> </span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_xfrm_state_free sa x &#10627;&#955;r s. r = unit&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_xfrm_policy_lookup</span><span>  </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_xfrm_policy_lookup sa ctx fl_secid dir &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_xfrm_state_pol_flow_match</span><span> </span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_xfrm_state_pol_flow_match sa x xp fl &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_xfrm_decode_session</span><span>  </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_xfrm_decode_session sa skb secid&#39; &#10627;&#955;r s. r = 0 &#8744; r &#8800; 0&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_skb_classify_flow</span><span> </span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_skb_classify_flow sa skb fl &#10627;&#955;r s. r = unit&#10628;&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>lsm_path_hooks</span><span> </span><span class="delimiter">=</span><span>
</span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* lsm path *)</span></span></span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>s0</span><span> </span><span class="delimiter">::</span><span> </span><span class="tfree">&#39;s</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_path_unlink</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; path &#8658; dentry &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_path_mkdir</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; path &#8658; dentry &#8658;nat &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_path_rmdir</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; path &#8658; dentry &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_path_mknod</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; path &#8658; dentry &#8658; nat &#8658; nat &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_path_truncate</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; path &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_path_symlink</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; path &#8658; dentry &#8658; string &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_path_link</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; dentry &#8658;path &#8658; dentry &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_path_rename</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; path &#8658; dentry &#8658; path &#8658; dentry &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_path_chmod</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; path &#8658; nat&#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_path_chown</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; path &#8658; kuid_t &#8658; kgid_t &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_path_chroot</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; path &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_path_unlink</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_path_unlink s dir dentry &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_path_mkdir</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_path_mkdir s dir dentry m &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_path_rmdir</span><span>  </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_path_rmdir s dir dentry &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_path_mknod</span><span>  </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_path_mknod s dir dentry m dev &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_path_truncate</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_path_truncate s dir &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_path_symlink</span><span> </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_path_symlink s dir dentry old_name &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_path_link</span><span>  </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_path_link s old_dentry new_dir new_dentry 
           &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_path_rename</span><span>  </span><span class="delimiter">:</span><span>
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_path_rename s  old_dir old_dentry new_dir new_dentry 
          &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_path_chmod</span><span>  </span><span class="delimiter">:</span><span>
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_path_chmod s path m &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_path_chown</span><span>  </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_path_chown s path uid&#39; gid&#39; &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_path_chroot</span><span>  </span><span class="delimiter">:</span><span> 
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_path_chroot s path &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628;&quot;</span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>lsm_key_hooks</span><span> </span><span class="delimiter">=</span><span>
</span><span>  </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* lsm keys *)</span></span></span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>s0</span><span> </span><span class="delimiter">::</span><span> </span><span class="tfree">&#39;s</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>key_security</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658;key &#8658; &#39;ksec option&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_key_alloc</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658;  key &#8658; Cred &#8658; nat &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_key_free</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658;  key &#8658;(&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_key_permission</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; key_ref_t &#8658; Cred &#8658; nat &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_key_getsecurity</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; key &#8658; string &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_key_alloc</span><span class="delimiter">:</span><span>
</span><span>     </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_key_alloc sa k cred&#39; flag &#10627;&#955;r s. r = 0 &#8744; r &#8800; 0&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_key_free</span><span> </span><span class="delimiter">:</span><span>
</span><span>     </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_key_free sa k &#10627;&#955;r s. r = unit &#8743; key_security s k = None &#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_key_permission</span><span class="delimiter">:</span><span>
</span><span>     </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_key_permission sa key_ref c perm &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_key_getsecurity</span><span class="delimiter">:</span><span>
</span><span>     </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_key_getsecurity sa key&#39; buffer &#10627;&#955;r s. s = sa &#8743; (r = 0 &#8744; r &#8800; 0)&#10628; &quot;</span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>lsm_audit_hooks</span><span> </span><span class="delimiter">=</span><span> 
</span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* lsm audit_krule *)</span></span></span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>s0</span><span> </span><span class="delimiter">::</span><span> </span><span class="tfree">&#39;s</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_audit_rule_init</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; nat &#8658; enum_audit &#8658; string &#8658; string 
                                     &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_audit_rule_known</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; audit_krule &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_audit_rule_match</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; nat &#8658; nat &#8658; enum_audit &#8658; string &#8658; audit_context 
                                      &#8658; (&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_audit_rule_free</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; string &#8658; (&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_audit_rule_init</span><span class="delimiter">:</span><span>
</span><span>     </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_audit_rule_init s field op rulestr vrule &#10627;&#955;r s. r = 0 &#8744; r &#8800; 0&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_audit_rule_known</span><span> </span><span class="delimiter">:</span><span>
</span><span>     </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_audit_rule_known s krule &#10627;&#955;r s. r = 0 &#8744; r &#8800; 0&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_audit_rule_match</span><span class="delimiter">:</span><span>
</span><span>     </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_audit_rule_match s secid&#39; field op vrule actx&#10627;&#955;r s. r = 0 &#8744; r &#8800; 0&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_key_audit_rule_free</span><span class="delimiter">:</span><span>
</span><span>     </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_audit_rule_free s lsmrule &#10627;&#955;r s. r = unit&#10628; &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>lsm_bpf_hooks</span><span> </span><span class="delimiter">=</span><span>
</span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* lsm bpf *)</span></span></span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>s0</span><span> </span><span class="delimiter">::</span><span> </span><span class="tfree">&#39;s</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_bpf</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; int &#8658; bpf_attr &#8658; nat  &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_bpf_map</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; bpf_map &#8658; mode  &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_bpf_prog</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; bpf_prog &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_bpf_map_alloc</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; bpf_map  &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_bpf_map_free</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; bpf_map  &#8658;(&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_bpf_prog_alloc</span><span>  </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; bpf_prog_aux  &#8658;(&#39;s, int) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>hook_bpf_prog_free</span><span> </span><span class="delimiter">::</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s  &#8658; bpf_prog_aux  &#8658;(&#39;s, unit) nondet_monad&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_bpf</span><span> </span><span class="delimiter">:</span><span>
</span><span>     </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_bpf sa cmd attr&#39; size&#39; &#10627;&#955;r s. r = 0 &#8744; r &#8800; 0&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_bpf_map</span><span> </span><span class="delimiter">:</span><span>
</span><span>     </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_bpf_map sa bmap fmode &#10627;&#955;r s. r = 0 &#8744; r &#8800; 0&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_bpf_prog</span><span class="delimiter">:</span><span>
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_bpf_prog sa prog &#10627;&#955;r s. r = 0 &#8744; r &#8800; 0&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_bpf_map_alloc</span><span class="delimiter">:</span><span>
</span><span>     </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_bpf_map_alloc sa bmap &#10627;&#955;r s. r = 0 &#8744; r &#8800; 0&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_bpf_map_free</span><span class="delimiter">:</span><span>
</span><span>     </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_bpf_map_free sa bmap &#10627;&#955;r s. r = unit&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_bpf_prog_alloc</span><span class="delimiter">:</span><span>
</span><span>     </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_bpf_prog_alloc sa proga&#10627;&#955;r s. r = 0 &#8744; r &#8800; 0&#10628; &quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>stb_bpf_prog_free</span><span class="delimiter">:</span><span>
</span><span>     </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;sa. &#10627;&#955;s . s = sa &#10628; hook_bpf_prog_free sa proga &#10627;&#955;r s. r = unit&#10628; &quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>lsm_hooks</span><span> </span><span class="delimiter">=</span><span> 
</span><span>  </span><span>lsm_superblock_hooks</span><span> </span><span>s0</span><span> </span><span class="delimiter">+</span><span> 
</span><span>  </span><span>lsm_task_hooks</span><span> </span><span>s0</span><span> </span><span class="delimiter">+</span><span> 
</span><span>  </span><span>lsm_binder_hooks</span><span> </span><span>s0</span><span> </span><span class="delimiter">+</span><span> 
</span><span>  </span><span>lsm_ptrace_hooks</span><span> </span><span>s0</span><span> </span><span class="delimiter">+</span><span>
</span><span>  </span><span>lsm_capable_hooks</span><span> </span><span>s0</span><span> </span><span class="delimiter">+</span><span> 
</span><span>  </span><span>lsm_bprm_hooks</span><span> </span><span>s0</span><span> </span><span class="delimiter">+</span><span> 
</span><span>  </span><span>lsm_dentry_hooks</span><span> </span><span>s0</span><span> </span><span class="delimiter">+</span><span> 
</span><span>  </span><span>lsm_inode_hooks</span><span> </span><span>s0</span><span> </span><span class="delimiter">+</span><span> 
</span><span>  </span><span>lsm_file_hooks</span><span> </span><span>s0</span><span class="delimiter">+</span><span>
</span><span>  </span><span>lsm_kernel_hooks</span><span> </span><span>s0</span><span> </span><span class="delimiter">+</span><span> 
</span><span>  </span><span>lsm_ipc_hooks</span><span> </span><span>s0</span><span> </span><span class="delimiter">+</span><span> 
</span><span>  </span><span>lsm_other_hooks</span><span> </span><span>s0</span><span> </span><span class="delimiter">+</span><span> 
</span><span>  </span><span>lsm_network_hooks</span><span> </span><span>s0</span><span> </span><span class="delimiter">+</span><span> 
</span><span>  </span><span>lsm_infiniband_hooks</span><span> </span><span>s0</span><span> </span><span class="delimiter">+</span><span>
</span><span>  </span><span>lsm_network_xfrm_hooks</span><span> </span><span>s0</span><span> </span><span class="delimiter">+</span><span> 
</span><span>  </span><span>lsm_path_hooks</span><span> </span><span>s0</span><span> </span><span class="delimiter">+</span><span> 
</span><span>  </span><span>lsm_key_hooks</span><span> </span><span>s0</span><span> </span><span class="delimiter">+</span><span> 
</span><span>  </span><span>lsm_audit_hooks</span><span> </span><span>s0</span><span> </span><span class="delimiter">+</span><span> 
</span><span>  </span><span>lsm_bpf_hooks</span><span> </span><span>s0</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">for</span></span><span> </span><span>s0</span><span> </span><span class="delimiter">::</span><span> </span><span class="tfree">&#39;s</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span><span class="keyword2"><span class="keyword">end</span></span></pre>

</div>
</body>
</html>
