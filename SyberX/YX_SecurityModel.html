<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Theory YX_SecurityModel (Isabelle2019: June 2019)</title>
<link media="all" rel="stylesheet" type="text/css" href="isabelle.css"/>
</head>

<body>
<div class="head"><h1>Theory YX_SecurityModel</h1>

<span class="command">theory</span> <span class="name">YX_SecurityModel</span><br/>
<span class="keyword">imports</span> <a href="../../HOL/HOL/Main.html"><span class="name">Main</span></a><br/>

</div>
<div class="source">
<pre class="source"><span>
</span><span class="keyword1"><span class="command">section</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;Security Model of Separation Kernels&#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">theory</span></span><span> </span><span>YX_SecurityModel</span><span>
</span><span class="keyword2"><span class="keyword">imports</span></span><span> </span><span>Main</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249; Security State Machine &#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>SM</span><span> </span><span class="delimiter">=</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>s0</span><span> </span><span class="delimiter">::</span><span> </span><span class="tfree">&#39;s</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>step</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;e &#8658; (&#39;s &#215; &#39;s) set&quot;</span></span></span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*the state-transition function*)</span></span></span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>domain</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; &#39;e &#8658; (&#39;d option)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>sched</span><span> </span><span class="delimiter">::</span><span> </span><span class="tfree">&#39;d</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>vpeq</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; &#39;d &#8658; &#39;s &#8658; bool&quot;</span></span></span><span>  </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">&quot;(_ &#8764; _ &#8764; _)&quot;</span></span></span><span class="delimiter">)</span><span> </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*State equivalence*)</span></span></span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>interference</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;d &#8658; &#39;d &#8658; bool&quot;</span></span></span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">&quot;(_ &#8605; _)&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>audit_policy</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot; &#39;e &#8658; bool&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>access_control</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;d &#8658; &#39;obj &#8658; &#39;p &#8658; bool&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>issysPartition</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;d &#8658; bool&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>issysEvent</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;e &#8658; bool&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>audit_info</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; &#39;e &#8658; &#39;a&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> 
</span><span>    </span><span>vpeq_transitive_lemma</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704; s t r d. (s &#8764; d &#8764; t) &#8743; (t &#8764; d &#8764; r) &#10230; (s &#8764; d &#8764; r)&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span>
</span><span>    </span><span>vpeq_symmetric_lemma</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704; s t d. (s &#8764; d &#8764; t) &#10230; (t &#8764; d &#8764; s)&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span>
</span><span>    </span><span>vpeq_reflexive_lemma</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704; s d. (s &#8764; d &#8764; s)&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span>
</span><span>    </span><span>sched_vpeq</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;s t a. (s &#8764; sched &#8764; t) &#10230; (domain s a) = (domain t a)&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span>
</span><span>    </span><span>sched_intf_all</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;d. (sched &#8605; d)&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span>
</span><span>    </span><span>no_intf_sched</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;d. (d &#8605; sched) &#10230; d = sched&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span>
</span><span>    </span><span>interf_reflexive</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;d. (d &#8605; d)&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span>
</span><span>    </span><span>api_protection</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;e s . (issysEvent e) &#10230; issysPartition (the (domain s e)) &quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span>
</span><span>    </span><span>audit_stable</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;e s t. audit_policy e &#8743; (s,t) &#8712; step e&#10230; (&#8707;a. a = audit_info t e)&quot;</span></span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>non_interference</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;d &#8658; &#39;d &#8658; bool&quot;</span></span></span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">&quot;(_ &#8726;&#8605; _)&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(u &#8726;&#8605;  v) &#8801; &#172; (u &#8605; v)&quot;</span></span></span><span>
</span><span>   
</span><span>    </span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>ivpeq</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; &#39;d set &#8658; &#39;s &#8658; bool&quot;</span></span></span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">&quot;(_ &#8776; _ &#8776; _)&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;ivpeq s D t &#8801; &#8704; d &#8712; D. (s &#8764; d &#8764; t)&quot;</span></span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">primrec</span></span><span> </span><span>run</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;e list &#8658; (&#39;s &#215; &#39;s) set&quot;</span></span></span><span> 
</span><span>      </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>run_Nil</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;run [] = Id&quot;</span></span></span><span> </span><span class="delimiter">|</span><span>
</span><span>            </span><span>run_Cons</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;run (a#as) = step a O run as&quot;</span></span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>next_states</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; &#39;e &#8658; &#39;s set&quot;</span></span></span><span>
</span><span>      </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;next_states s a &#8801; {Q. (s,Q)&#8712;step a}&quot;</span></span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">term</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot; (run as)&quot;</span></span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>execute</span><span>  </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;e list &#8658; &#39;s &#8658; &#39;s set&quot;</span></span></span><span> 
</span><span>      </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;execute as s = Image (run as) {s} &quot;</span></span></span><span> 
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>reachable</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; &#39;s &#8658; bool&quot;</span></span></span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">&quot;(_ &#8618; _)&quot;</span></span></span><span> </span><span class="delimiter">[</span><span>70</span><span class="delimiter">,</span><span>71</span><span class="delimiter">]</span><span> </span><span>60</span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span>      </span><span class="string"><span class="delete"><span class="delete">&quot;reachable s1 s2 &#8801;  (&#8707;as. (s1,s2) &#8712; run as)&quot;</span></span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>reachable0</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; bool&quot;</span></span></span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span>      </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 s &#8801; reachable s0 s&quot;</span></span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>reachable_s0</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 s0&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>SM.reachable_def</span><span> </span><span>SM_axioms</span><span> </span><span>pair_in_Id_conv</span><span> </span><span>reachable0_def</span><span> </span><span>run.simps</span><span class="delimiter">(</span><span>1</span><span class="delimiter">)</span><span class="delimiter">)</span><span> 
</span><span>    
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>reachable_self</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable s s&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>reachable_def</span><span> </span><span>run.simps</span><span class="delimiter">(</span><span>1</span><span class="delimiter">)</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>reachable_step</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(s,s&#39;)&#8712;step a &#10233; reachable s s&#39;&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">proof</span></span><span>-</span><span>
</span><span>        </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(s,s&#39;)&#8712;step a&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(s,s&#39;)&#8712;run [a]&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>          
</span><span>        </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>reachable_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span> 
</span><span>      </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>run_trans</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;C T V as bs. (C,T)&#8712;run as &#8743; (T,V)&#8712;run bs &#10230; (C,V)&#8712;run (as@bs)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>      </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>        </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>T</span><span> </span><span>V</span><span> </span><span>as</span><span> </span><span>bs</span><span>
</span><span>        </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;C. (C,T)&#8712;run as &#8743; (T,V)&#8712;run bs &#10230; (C,V)&#8712;run (as@bs)&quot;</span></span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">proof</span></span><span class="delimiter">(</span><span>induct</span><span> </span><span>as</span><span class="delimiter">)</span><span>
</span><span>            </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>Nil</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?case</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>          </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>            </span><span class="keyword3"><span class="command">case</span></span><span> </span><span class="delimiter">(</span><span>Cons</span><span> </span><span>c</span><span> </span><span>cs</span><span class="delimiter">)</span><span>
</span><span>            </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;C. (C, T) &#8712; run cs &#8743; (T, V) &#8712; run bs &#10230; (C, V) &#8712; run (cs @ bs)&quot;</span></span></span><span>
</span><span>            </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?case</span><span>
</span><span>              </span><span class="keyword1"><span class="command">proof</span></span><span>-</span><span>
</span><span>              </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>                </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>C</span><span>
</span><span>                </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(C, T) &#8712; run (c # cs) &#8743; (T, V) &#8712; run bs &#10230; (C, V) &#8712; run ((c # cs) @ bs) &quot;</span></span></span><span>
</span><span>                  </span><span class="keyword1"><span class="command">proof</span></span><span>
</span><span>                    </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>b0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(C, T) &#8712; run (c # cs) &#8743; (T, V) &#8712; run bs&quot;</span></span></span><span>
</span><span>                    </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>b0</span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>C&#39;</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>b2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(C,C&#39;)&#8712;step c &#8743; (C&#39;,T)&#8712;run cs&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>                    </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>a0</span><span> </span><span>b0</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(C&#39;,V)&#8712;run (cs@bs)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>                    </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>b2</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(C, V) &#8712; run ((c # cs) @ bs)&quot;</span></span></span><span>
</span><span>                      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>append_Cons</span><span> </span><span>relcomp.relcompI</span><span> </span><span>run_Cons</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span> 
</span><span>                  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>              </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>      </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>reachable_trans</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#10214;reachable C T; reachable T V&#10215; &#10233; reachable C V&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">proof</span></span><span>-</span><span>
</span><span>        </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable C T&quot;</span></span></span><span>
</span><span>        </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable T V&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>a0</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;C = T &#8744; (&#8707;as. (C,T)&#8712;run as)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>reachable_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>        </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>          </span><span class="keyword1"><span class="command">proof</span></span><span>
</span><span>            </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>b0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;C = T&quot;</span></span></span><span>
</span><span>            </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> 
</span><span>              </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>                </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>a1</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;T = V &#8744; (&#8707;as. (T,V)&#8712;run as)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>reachable_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>                </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>                  </span><span class="keyword1"><span class="command">proof</span></span><span>
</span><span>                    </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>c0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;T=V&quot;</span></span></span><span>
</span><span>                    </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>a0</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>                  </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>                    </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>c0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#8707;as. (T,V)&#8712;run as)&quot;</span></span></span><span>
</span><span>                    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>a1</span><span> </span><span>b0</span><span class="delimiter">)</span><span> 
</span><span>                  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>            </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>b0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8707;as. (C,T)&#8712;run as&quot;</span></span></span><span>
</span><span>            </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>              </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>                </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>a1</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;T = V &#8744; (&#8707;as. (T,V)&#8712;run as)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>reachable_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>                </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>                  </span><span class="keyword1"><span class="command">proof</span></span><span>
</span><span>                    </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>c0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;T=V&quot;</span></span></span><span>
</span><span>                    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a0</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span> 
</span><span>                  </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>                    </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>c0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#8707;as. (T,V)&#8712;run as)&quot;</span></span></span><span>
</span><span>                    </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>b0</span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>as</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>d0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(C,T)&#8712;run as&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>                    </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>c0</span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>bs</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>d1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(T,V)&#8712;run bs&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>                    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>d0</span><span> </span><span>reachable_def</span><span> </span><span>run_trans</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span> 
</span><span>                  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>reachableStep</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#10214;reachable0 C; (C,C&#39;)&#8712;step a&#10215; &#10233; reachable0 C&#39;&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>        </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 C&quot;</span></span></span><span>
</span><span>        </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(C,C&#39;)&#8712;step a&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>a0</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(C = s0) &#8744; (&#8707;as. (s0,C) &#8712; run as)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>reachable0_def</span><span> </span><span>reachable_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>        </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 C&#39;&quot;</span></span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">proof</span></span><span>
</span><span>            </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>b0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;C = s0&quot;</span></span></span><span>
</span><span>            </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 C&#39;&quot;</span></span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a1</span><span> </span><span>b0</span><span> </span><span>reachable0_def</span><span> </span><span>reachable_step</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span> 
</span><span>          </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>            </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>b0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8707;as. (s0,C) &#8712; run as&quot;</span></span></span><span>
</span><span>            </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 C&#39;&quot;</span></span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a0</span><span> </span><span>a1</span><span> </span><span>reachable0_def</span><span> </span><span>reachable_step</span><span> </span><span>reachable_trans</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span> 
</span><span>          </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>    
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>reachable0_reach</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#10214;reachable0 C; reachable C C&#39;&#10215; &#10233; reachable0 C&#39;&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>reachable0_def</span><span> </span><span>reachable_trans</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span class="cartouche"><span class="delete"><span class="delete">&#8249; Information flow security properties &#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>SM_enabled</span><span> </span><span class="delimiter">=</span><span> </span><span>SM</span><span> </span><span>s0</span><span> </span><span>step</span><span> </span><span>domain</span><span> </span><span>sched</span><span> </span><span>vpeq</span><span> </span><span>interference</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">for</span></span><span> </span><span>s0</span><span> </span><span class="delimiter">::</span><span> </span><span class="tfree">&#39;s</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span>
</span><span>       </span><span>step</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;e &#8658; (&#39;s &#215; &#39;s) set&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span>
</span><span>       </span><span>domain</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; &#39;e &#8658; (&#39;d option)&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span>
</span><span>       </span><span>sched</span><span> </span><span class="delimiter">::</span><span> </span><span class="tfree">&#39;d</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span>
</span><span>       </span><span>vpeq</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; &#39;d &#8658; &#39;s &#8658; bool&quot;</span></span></span><span>  </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">&quot;(_ &#8764; _ &#8764; _)&quot;</span></span></span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span>
</span><span>       </span><span>interference</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;d &#8658; &#39;d &#8658; bool&quot;</span></span></span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">&quot;(_ &#8605; _)&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>  </span><span class="delimiter">+</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>enabled0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;s a. reachable0 s &#10230; (&#8707; s&#39;. (s,s&#39;) &#8712; step a)&quot;</span></span></span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>enabled</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 s &#10233; (&#8707; s&#39;. (s,s&#39;) &#8712; step a)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>enabled0</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>enabled_ex</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;s es. reachable0 s &#10230; (&#8707; s&#39;. s&#39; &#8712; execute es s)&quot;</span></span></span><span> 
</span><span>      </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>      </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>        </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>es</span><span>
</span><span>        </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;s. reachable0 s &#10230; (&#8707; s&#39;. s&#39; &#8712; execute es s)&quot;</span></span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">proof</span></span><span class="delimiter">(</span><span>induct</span><span> </span><span>es</span><span class="delimiter">)</span><span>
</span><span>            </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>Nil</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?case</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>execute_def</span><span class="delimiter">)</span><span> 
</span><span>          </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>            </span><span class="keyword3"><span class="command">case</span></span><span> </span><span class="delimiter">(</span><span>Cons</span><span> </span><span>a</span><span> </span><span>as</span><span class="delimiter">)</span><span>
</span><span>            </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;s. reachable0 s &#10230; (&#8707;s&#39;. s&#39; &#8712; execute as s)&quot;</span></span></span><span>
</span><span>            </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?case</span><span> 
</span><span>              </span><span class="keyword1"><span class="command">proof</span></span><span>-</span><span>
</span><span>              </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>                </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>s</span><span>
</span><span>                </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>b0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 s&quot;</span></span></span><span>
</span><span>                </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8707;s1. (s,s1)&#8712;step a&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>enabled</span><span> </span><span>b0</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span>next_states_def</span><span class="delimiter">)</span><span>
</span><span>                </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>s1</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>b2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(s,s1)&#8712;step a&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>                </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>a0</span><span> </span><span>b0</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b3</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8707;s&#39;. s&#39; &#8712; execute as s1&quot;</span></span></span><span>
</span><span>                  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>reachableStep</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span> 
</span><span>                </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>s2</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>b4</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s2&#8712;execute as s1&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>                </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s2 &#8712; execute (a # as) s&quot;</span></span></span><span>
</span><span>                  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>Image_singleton_iff</span><span> </span><span>SM.execute_def</span><span> </span><span>SM_axioms</span><span> </span><span>b2</span><span> </span><span>relcomp.simps</span><span> </span><span>run_Cons</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span> 
</span><span>                </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8707;s&#39;. s&#39; &#8712; execute (a # as) s&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>              </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>              </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>      </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>            
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>enabled_ex2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 s &#10233; (&#8707; s&#39;. s&#39; &#8712; execute es s)&quot;</span></span></span><span> 
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>enabled_ex</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">primrec</span></span><span> </span><span>sources</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;e list &#8658; &#39;s &#8658; &#39;d &#8658; &#39;d set&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span>      </span><span>sources_Nil</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;sources [] s d = {d}&quot;</span></span></span><span> </span><span class="delimiter">|</span><span>
</span><span>      </span><span>sources_Cons</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;sources (a # as) s d = (&#8899;{sources as s&#39; d| s&#39;. (s,s&#39;) &#8712; step a}) &#8746; 
                              {w . w = the (domain s a) &#8743; (&#8707;v s&#39;. (w &#8605; v) &#8743; 
                                   (s,s&#39;)&#8712;step a &#8743; v&#8712;sources as s&#39; d)}&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">declare</span></span><span> </span><span>sources_Nil</span><span> </span><span class="delimiter">[</span><span>simp</span><span> </span><span>del</span><span class="delimiter">]</span><span>     
</span><span>    </span><span class="keyword1"><span class="command">declare</span></span><span> </span><span>sources_Cons</span><span> </span><span class="delimiter">[</span><span>simp</span><span> </span><span>del</span><span class="delimiter">]</span><span>
</span><span>    
</span><span>    </span><span class="keyword1"><span class="command">primrec</span></span><span> </span><span>ipurge</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;e list &#8658; &#39;d &#8658; &#39;s set &#8658; &#39;e list&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span>      </span><span>ipurge_Nil</span><span class="delimiter">:</span><span>   </span><span class="string"><span class="delete"><span class="delete">&quot;ipurge [] u ss = []&quot;</span></span></span><span> </span><span class="delimiter">|</span><span>
</span><span>      </span><span>ipurge_Cons</span><span class="delimiter">:</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;ipurge (a#as) u ss = (if &#8707;s&#8712;ss. the (domain s a) &#8712; (sources (a#as) s u) then
                                              a # ipurge as u (&#8899;s&#8712;ss. {s&#39;. (s,s&#39;) &#8712; step a})
                                           else
                                              ipurge as u ss
                                          )&quot;</span></span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>observ_equivalence</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; &#39;e list &#8658; &#39;s &#8658; 
          &#39;e list &#8658; &#39;d &#8658; bool&quot;</span></span></span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">&quot;(_ &#8882; _ &#8773; _ &#8882; _ @ _)&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;observ_equivalence s as t bs d &#8801; 
                &#8704;s&#39; t&#39;. ((s,s&#39;)&#8712; run as &#8743; (t,t&#39;)&#8712; run bs) &#10230;(s&#39; &#8764; d &#8764; t&#39;)&quot;</span></span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>observ_equiv_sym</span><span class="delimiter">:</span><span>
</span><span>      </span><span class="string"><span class="delete"><span class="delete">&quot;(s &#8882; as &#8773; t &#8882; bs @ d) &#10233; (t &#8882; bs &#8773; s &#8882; as @ d)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>observ_equivalence_def</span><span> </span><span>vpeq_symmetric_lemma</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>    
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>observ_equiv_trans</span><span class="delimiter">:</span><span>
</span><span>      </span><span class="string"><span class="delete"><span class="delete">&quot;&#10214;reachable0 t; (s &#8882; as &#8773; t &#8882; bs @ d); (t &#8882; bs &#8773; x &#8882; cs @ d)&#10215; &#10233; (s &#8882; as &#8773; x &#8882; cs @ d)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>clarsimp</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>observ_equivalence_def</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>cut_tac</span><span> </span><span>s</span><span class="delimiter">=</span><span>t</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>es</span><span class="delimiter">=</span><span>bs</span><span> </span><span class="keyword2"><span class="keyword">in</span></span><span> </span><span>enabled_ex2</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>simp</span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span class="delimiter">(</span><span>no_types</span><span class="delimiter">,</span><span> </span><span>hide_lams</span><span class="delimiter">)</span><span> </span><span>Image_singleton_iff</span><span> </span><span>execute_def</span><span> </span><span>vpeq_transitive_lemma</span><span class="delimiter">)</span><span> 
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>exec_equiv_leftI</span><span class="delimiter">:</span><span>
</span><span>   </span><span class="string"><span class="delete"><span class="delete">&quot;&#10214;reachable0 C; &#8704; C&#39;. (C,C&#39;)&#8712;step a &#10230; (C&#39; &#8882; as &#8773; D &#8882; bs @ d)&#10215; &#10233; (C &#8882; (a # as) &#8773; D &#8882; bs @ d)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>        </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 C&quot;</span></span></span><span>
</span><span>        </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704; C&#39;. (C,C&#39;)&#8712;step a &#10230; (C&#39; &#8882; as &#8773; D &#8882; bs @ d)&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;S&#39; T&#39;. ((C,S&#39;)&#8712; run (a#as) &#8743; (D,T&#39;)&#8712; run bs) &#10230;(S&#39; &#8764; d &#8764; T&#39;)&quot;</span></span></span><span> 
</span><span>          </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>          </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>            </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>S&#39;</span><span> </span><span>T&#39;</span><span>
</span><span>            </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>b0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(C, S&#39;) &#8712; run (a # as) &#8743; (D, T&#39;) &#8712; run bs&quot;</span></span></span><span>
</span><span>            </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>C&#39;</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>b1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(C,C&#39;)&#8712;step a &#8743; (C&#39;,S&#39;)&#8712;run as&quot;</span></span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>relcompEpair</span><span> </span><span>run_Cons</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span> 
</span><span>            </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>a1</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(C&#39; &#8882; as &#8773; D &#8882; bs @ d)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>            </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>b0</span><span> </span><span>b1</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;S&#39; &#8764; d &#8764; T&#39;&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>observ_equivalence_def</span><span class="delimiter">)</span><span> 
</span><span>          </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>          </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>observ_equivalence_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span> 
</span><span>      </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>exec_equiv_both</span><span class="delimiter">:</span><span>
</span><span>   </span><span class="string"><span class="delete"><span class="delete">&quot;&#10214;reachable0 C1; reachable0 C2; &#8704; C1&#39; C2&#39;. (C1,C1&#39;)&#8712;step a &#8743;(C2,C2&#39;)&#8712;step b&#10230; (C1&#39; &#8882; as &#8773; C2&#39; &#8882; bs @ u)&#10215; 
      &#10233; (C1 &#8882; (a # as) &#8773; C2 &#8882; (b # bs) @ u)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>        </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 C1&quot;</span></span></span><span>
</span><span>        </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 C2&quot;</span></span></span><span>
</span><span>        </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704; C1&#39; C2&#39;. (C1,C1&#39;)&#8712;step a &#8743;(C2,C2&#39;)&#8712;step b&#10230; (C1&#39; &#8882; as &#8773; C2&#39; &#8882; bs @ u)&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;S&#39; T&#39;. ((C1,S&#39;)&#8712; run (a # as) &#8743; (C2,T&#39;)&#8712; run (b # bs)) &#10230;(S&#39; &#8764; u &#8764; T&#39;)&quot;</span></span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>          </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>            </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>S&#39;</span><span> </span><span>T&#39;</span><span>
</span><span>            </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>b0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(C1, S&#39;) &#8712; run (a # as) &#8743; (C2, T&#39;) &#8712; run (b # bs)&quot;</span></span></span><span>
</span><span>            </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>C1&#39;</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>b1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(C1,C1&#39;)&#8712;step a &#8743; (C1&#39;,S&#39;)&#8712;run as&quot;</span></span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>relcompEpair</span><span> </span><span>run_Cons</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span> 
</span><span>            </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>b0</span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>C2&#39;</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>b2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(C2,C2&#39;)&#8712;step b &#8743; (C2&#39;,T&#39;)&#8712;run bs&quot;</span></span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>relcompEpair</span><span> </span><span>run_Cons</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>            </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>a2</span><span> </span><span>b1</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b3</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(C1&#39; &#8882; as &#8773; C2&#39; &#8882; bs @ u)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>            </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>b0</span><span> </span><span>b1</span><span> </span><span>b2</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;S&#39; &#8764; u &#8764; T&#39;&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>observ_equivalence_def</span><span class="delimiter">)</span><span> 
</span><span>          </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>          </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>observ_equivalence_def</span><span class="delimiter">)</span><span> 
</span><span>      </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>sources_refl</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 s &#10233; u &#8712; sources as s u&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>induct</span><span> </span><span>as</span><span> </span><span>arbitrary</span><span class="delimiter">:</span><span> </span><span>s</span><span class="delimiter">)</span><span>
</span><span>       </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>sources_Nil</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>sources_Cons</span><span class="delimiter">)</span><span> 
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>enabled</span><span> </span><span>reachableStep</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>metis</span><span> 
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>scheduler_in_sources_Cons</span><span class="delimiter">:</span><span>
</span><span>      </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 s &#10233; the (domain s a) = sched &#10233; the (domain s a) &#8712; sources (a#as) s u&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>unfold</span><span> </span><span>sources_Cons</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>erule</span><span> </span><span>ssubst</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>rule</span><span> </span><span>UnI2</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>clarsimp</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>rule_tac</span><span> </span><span>x</span><span class="delimiter">=</span><span>u</span><span> </span><span class="keyword2"><span class="keyword">in</span></span><span> </span><span>exI</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>safe</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>sched_intf_all</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>enabled</span><span> </span><span>reachableStep</span><span> </span><span>sources_refl</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>noninterference_r</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;bool&quot;</span></span></span><span>
</span><span>      </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;noninterference_r &#8801; &#8704;d as s. reachable0 s &#10230; (s &#8882; as &#8773; s &#8882; (ipurge as d {s}) @ d)&quot;</span></span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>noninterference</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;bool&quot;</span></span></span><span>
</span><span>      </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;noninterference &#8801; &#8704;d as. (s0 &#8882; as &#8773; s0 &#8882; (ipurge as d {s0}) @ d)&quot;</span></span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>weak_noninterference</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;bool&quot;</span></span></span><span>
</span><span>      </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;weak_noninterference &#8801; &#8704;d as bs. ipurge as d {s0} = ipurge bs d {s0}
                                                  &#10230; (s0 &#8882; as &#8773; s0 &#8882; bs @ d)&quot;</span></span></span><span>
</span><span>   
</span><span>    </span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>weak_noninterference_r</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;bool&quot;</span></span></span><span>
</span><span>      </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;weak_noninterference_r &#8801; &#8704;d as bs s. reachable0 s &#8743; ipurge as d {s} = ipurge bs d {s}
                                                  &#10230; (s &#8882; as &#8773; s &#8882; bs @ d)&quot;</span></span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>noninfluence</span><span class="delimiter">::</span><span class="string"><span class="delete"><span class="delete">&quot;bool&quot;</span></span></span><span> 
</span><span>      </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;noninfluence &#8801; &#8704; d as s t . reachable0 s &#8743; reachable0 t &#8743; (s &#8776; (sources as s d) &#8776; t) 
                                &#8743; (s &#8764; sched &#8764; t) &#10230; (s &#8882; as &#8773; t &#8882; (ipurge as d {t}) @ d)&quot;</span></span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>noninfluence_gen</span><span class="delimiter">::</span><span class="string"><span class="delete"><span class="delete">&quot;bool&quot;</span></span></span><span> 
</span><span>      </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;noninfluence_gen &#8801; &#8704; d as s ts . reachable0 s &#8743; (&#8704;t&#8712;ts. reachable0 t) 
                                &#8743; (&#8704;t&#8712;ts. (s &#8776; (sources as s d) &#8776; t)) 
                                &#8743; (&#8704;t&#8712;ts. (s &#8764; sched &#8764; t)) 
                                &#10230; (&#8704;t&#8712;ts. (s &#8882; as &#8773; t &#8882; (ipurge as d ts) @ d))&quot;</span></span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>weak_noninfluence</span><span> </span><span class="delimiter">::</span><span class="string"><span class="delete"><span class="delete">&quot;bool&quot;</span></span></span><span> 
</span><span>      </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;weak_noninfluence &#8801; &#8704; d as bs s t . reachable0 s &#8743; reachable0 t &#8743; (s &#8776; (sources as s d) &#8776; t) 
                                     &#8743; (s &#8764; sched &#8764; t) &#8743; ipurge as d {s} = ipurge bs d {s} 
                                     &#10230; (s &#8882; as &#8773; t &#8882; bs @ d)&quot;</span></span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>weak_noninfluence2</span><span> </span><span class="delimiter">::</span><span class="string"><span class="delete"><span class="delete">&quot;bool&quot;</span></span></span><span> 
</span><span>      </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;weak_noninfluence2 &#8801; &#8704; d as bs s t . reachable0 s &#8743; reachable0 t &#8743; (s &#8776; (sources as s d) &#8776; t) 
                                     &#8743; (s &#8764; sched &#8764; t) &#8743; ipurge as d {s} = ipurge bs d {t} 
                                     &#10230; (s &#8882; as &#8773; t &#8882; bs @ d)&quot;</span></span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>nonleakage</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;bool&quot;</span></span></span><span> 
</span><span>      </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;nonleakage &#8801; &#8704;d as s t. reachable0 s &#8743; reachable0 t &#8743; (s &#8764; sched &#8764; t) 
                                      &#8743; (s &#8776; (sources as s d) &#8776; t) &#10230; (s &#8882; as &#8773; t &#8882; as @ d)&quot;</span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span class="cartouche"><span class="delete"><span class="delete">&#8249; Unwinding conditions&#8250;</span></span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>step_consistent</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;bool&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span>      </span><span class="string"><span class="delete"><span class="delete">&quot;step_consistent &#8801; &#8704;a d s t. reachable0 s &#8743; reachable0 t &#8743; (s &#8764; d &#8764; t) &#8743; (s &#8764; sched &#8764; t) &#8743; 
                              (((the (domain s a)) &#8605; d) &#10230; (s &#8764; (the (domain s a)) &#8764; t)) &#10230; 
                              (&#8704; s&#39; t&#39;. (s,s&#39;) &#8712; step a &#8743; (t,t&#39;) &#8712; step a &#10230; (s&#39; &#8764;d&#8764; t&#39;))&quot;</span></span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>weak_step_consistent</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;bool&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span>      </span><span class="string"><span class="delete"><span class="delete">&quot;weak_step_consistent &#8801; &#8704;a d s t. reachable0 s &#8743; reachable0 t &#8743; (s &#8764; d &#8764; t) &#8743; (s &#8764; sched &#8764; t) &#8743; 
                              ((the (domain s a)) &#8605; d) &#8743; (s &#8764; (the (domain s a)) &#8764; t) &#10230;
                              (&#8704; s&#39; t&#39;. (s,s&#39;) &#8712; step a &#8743; (t,t&#39;) &#8712; step a &#10230; (s&#39; &#8764;d&#8764; t&#39;))&quot;</span></span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>step_consistent_e</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;e &#8658; bool&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span>      </span><span class="string"><span class="delete"><span class="delete">&quot;step_consistent_e a &#8801; &#8704;d s t. reachable0 s &#8743; reachable0 t &#8743; (s &#8764; d &#8764; t) &#8743; (s &#8764; sched &#8764; t) &#8743; 
                              (((the (domain s a)) &#8605; d) &#10230; (s &#8764; (the (domain s a)) &#8764; t)) &#10230; 
                              (&#8704; s&#39; t&#39;. (s,s&#39;) &#8712; step a &#8743; (t,t&#39;) &#8712; step a &#10230; (s&#39; &#8764;d&#8764; t&#39;))&quot;</span></span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>weak_step_consistent_e</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;e &#8658; bool&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span>      </span><span class="string"><span class="delete"><span class="delete">&quot;weak_step_consistent_e a &#8801; &#8704;d s t. reachable0 s &#8743; reachable0 t &#8743; (s &#8764; d &#8764; t) &#8743; (s &#8764; sched &#8764; t) &#8743; 
                              ((the (domain s a)) &#8605; d) &#8743; (s &#8764; (the (domain s a)) &#8764; t) &#10230;
                              (&#8704; s&#39; t&#39;. (s,s&#39;) &#8712; step a &#8743; (t,t&#39;) &#8712; step a &#10230; (s&#39; &#8764;d&#8764; t&#39;))&quot;</span></span></span><span>
</span><span>
</span><span>    
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>local_respect</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;bool&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;local_respect &#8801; &#8704; a d s s&#39;. 
        reachable0 s &#8743; ((the (domain s a)) &#8726;&#8605; d) &#8743; (s,s&#39;)&#8712;step a &#10230; (s &#8764; d &#8764; s&#39;)&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>local_respect_e</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;e &#8658; bool&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;local_respect_e a &#8801; &#8704;d s s&#39;.
         reachable0 s &#8743; ((the (domain s a)) &#8726;&#8605; d) &#8743; (s,s&#39;)&#8712;step a &#10230; (s &#8764; d &#8764; s&#39;)&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>local_respect_all_evt</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;local_respect = (&#8704;a. local_respect_e a)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>local_respect_def</span><span> </span><span>local_respect_e_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>step_consistent_all_evt</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;step_consistent = (&#8704;a. step_consistent_e a)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>step_consistent_def</span><span> </span><span>step_consistent_e_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>weak_step_consistent_all_evt</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;weak_step_consistent = (&#8704;a. weak_step_consistent_e a)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span>weak_step_consistent_def</span><span> </span><span>weak_step_consistent_e_def</span><span class="delimiter">)</span><span>
</span><span>      
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>step_cons_impl_weak</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;step_consistent &#10233; weak_step_consistent&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>step_consistent_def</span><span> </span><span>weak_step_consistent_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span> 
</span><span>      
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>weak_with_step_cons</span><span class="delimiter">:</span><span>
</span><span>      </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>p1</span><span class="delimiter">:</span><span>weak_step_consistent</span><span>
</span><span>        </span><span class="keyword2"><span class="keyword">and</span></span><span>   </span><span>p2</span><span class="delimiter">:</span><span>local_respect</span><span>
</span><span>      </span><span class="keyword2"><span class="keyword">shows</span></span><span>   </span><span>step_consistent</span><span>  
</span><span>      </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>      </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>        </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>d</span><span> </span><span>a</span><span> </span><span>s</span><span> </span><span>t</span><span> </span><span>s&#39;</span><span> </span><span>t&#39;</span><span>
</span><span>        </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 s &#8743; reachable0 t &#10230; (s &#8764; d &#8764; t) &#8743; (s &#8764; sched &#8764; t) &#8743; 
              (((the (domain s a)) &#8605; d) &#10230; (s &#8764; (the (domain s a)) &#8764; t)) &#10230; (s,s&#39;)&#8712;step a &#8743; (t,t&#39;)&#8712;step a
              &#10230; (s&#39; &#8764; d &#8764; t&#39;)&quot;</span></span></span><span> 
</span><span>           </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>           </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>             </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>aa</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 s &#8743; reachable0 t&quot;</span></span></span><span>
</span><span>             </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a0</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;s &#8764; d &#8764; t&quot;</span></span></span><span>
</span><span>             </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;s &#8764; sched &#8764; t&quot;</span></span></span><span>
</span><span>             </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a2</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;((the (domain s a)) &#8605; d) &#10230; (s &#8764; (the (domain s a)) &#8764; t)&quot;</span></span></span><span>
</span><span>             </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a3</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(s,s&#39;)&#8712;step a &#8743; (t,t&#39;)&#8712;step a&quot;</span></span></span><span>
</span><span>             </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; &#8764; d &#8764; t&#39;&quot;</span></span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">proof</span></span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(the (domain s a)) &#8605; d&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>                </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>b0</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;(the (domain s a)) &#8605; d&quot;</span></span></span><span>
</span><span>                </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>aa</span><span> </span><span>a0</span><span> </span><span>a1</span><span> </span><span>a2</span><span> </span><span>b0</span><span> </span><span>p1</span><span> </span><span>weak_step_consistent_def</span><span> </span><span>a3</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span> 
</span><span>                </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>                </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>b1</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;&#172;((the (domain s a)) &#8605; d)&quot;</span></span></span><span>
</span><span>                </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b2</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;(domain s a) = (domain t a)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>a1</span><span> </span><span>sched_vpeq</span><span class="delimiter">)</span><span>
</span><span>                </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>b1</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b3</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;&#172;((the (domain t a)) &#8605; d)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>                </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b4</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;s&#8764;d&#8764;s&#39;&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>aa</span><span> </span><span>b1</span><span> </span><span>local_respect_def</span><span> </span><span>non_interference_def</span><span> </span><span>p2</span><span> </span><span>a3</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span> 
</span><span>                </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b5</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;t&#8764;d&#8764;t&#39;&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>aa</span><span> </span><span>b3</span><span> </span><span>local_respect_def</span><span> </span><span>non_interference_def</span><span> </span><span>p2</span><span> </span><span>a3</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span> 
</span><span>                </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a0</span><span> </span><span>b4</span><span> </span><span>vpeq_symmetric_lemma</span><span> </span><span>vpeq_transitive_lemma</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>              </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>           </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>           </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>           </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>step_consistent_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>      </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span>      </span><span class="keyword1"><span class="command">subsection</span></span><span class="cartouche"><span class="delete"><span class="delete">&#8249; Lemmas for the inference framework &#8250;</span></span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>sched_equiv_preserved</span><span class="delimiter">:</span><span>
</span><span>      </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>1</span><span class="delimiter">:</span><span>step_consistent</span><span>
</span><span>      </span><span class="keyword2"><span class="keyword">and</span></span><span>     </span><span>2</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;s &#8764;sched&#8764; t&quot;</span></span></span><span>
</span><span>      </span><span class="keyword2"><span class="keyword">and</span></span><span>     </span><span>3</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;(s,s&#39;)&#8712;step a&quot;</span></span></span><span>
</span><span>      </span><span class="keyword2"><span class="keyword">and</span></span><span>     </span><span>4</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;(t,t&#39;)&#8712;step a&quot;</span></span></span><span>
</span><span>      </span><span class="keyword2"><span class="keyword">and</span></span><span>     </span><span>5</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 s &#8743; reachable0 t&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; &#8764;sched&#8764; t&#39;&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>case_tac</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;the (domain s a) = sched&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;1&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;2&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;3&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;4&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;5&quot;</span></span></span><span> </span><span>step_consistent_def</span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>blast</span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;1&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;2&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;3&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;4&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;5&quot;</span></span></span><span> </span><span>no_intf_sched</span><span> </span><span>step_consistent_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>      
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>sched_equiv_preserved_left</span><span class="delimiter">:</span><span>
</span><span>      </span><span class="string"><span class="delete"><span class="delete">&quot;&#10214;local_respect; reachable0 s; (s &#8764;sched&#8764; t); the (domain s a) &#8800; sched; (s,s&#39;)&#8712; step a&#10215; 
        &#10233;  (s&#39; &#8764;sched&#8764; t)&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>local_respect_def</span><span> </span><span>no_intf_sched</span><span> </span><span>non_interference_def</span><span> 
</span><span>          </span><span>vpeq_symmetric_lemma</span><span> </span><span>vpeq_transitive_lemma</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span> 
</span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>un_eq</span><span class="delimiter">:</span><span>
</span><span>      </span><span class="string"><span class="delete"><span class="delete">&quot;&#10214;S = S&#39;; T = T&#39;&#10215; &#10233; S &#8746; T = S&#39; &#8746; T&#39;&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>auto</span><span>
</span><span>      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>Un_eq</span><span class="delimiter">:</span><span>
</span><span>      </span><span class="string"><span class="delete"><span class="delete">&quot;&#10214;&#8896; x y. &#10214;x &#8712; xs; y &#8712; ys&#10215; &#10233; P x = Q y; &#8707; x. x &#8712; xs; &#8707; y. y &#8712; ys&#10215; &#10233; (&#8899;x&#8712;xs. P x) = (&#8899;y&#8712;ys. Q y)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>auto</span><span>
</span><span>      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>                                                       
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>sources_eq0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;step_consistent &#8743; (s &#8764; sched &#8764; t) &#8743; reachable0 s &#8743; reachable0 t
                      &#10230; sources as s d = sources as t d&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>induct</span><span> </span><span>as</span><span> </span><span>arbitrary</span><span class="delimiter">:</span><span> </span><span>s</span><span> </span><span>t</span><span class="delimiter">)</span><span>
</span><span>        </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>Nil</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?case</span><span>
</span><span>          </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>sources_Nil</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>        </span><span class="keyword3"><span class="command">case</span></span><span> </span><span class="delimiter">(</span><span>Cons</span><span> </span><span>a</span><span> </span><span>as</span><span class="delimiter">)</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?case</span><span>
</span><span>          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>clarsimp</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>sources_Cons</span><span class="delimiter">)</span><span>
</span><span>          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>rule</span><span> </span><span>un_eq</span><span class="delimiter">)</span><span>
</span><span>          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>only</span><span class="delimiter">:</span><span> </span><span>Union_eq</span><span class="delimiter">,</span><span> </span><span>simp</span><span> </span><span>only</span><span class="delimiter">:</span><span> </span><span>UNION_eq</span><span class="delimiter">[</span><span>symmetric</span><span class="delimiter">]</span><span class="delimiter">)</span><span>
</span><span>           </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>rule</span><span> </span><span>Un_eq</span><span class="delimiter">,</span><span> </span><span>clarsimp</span><span class="delimiter">)</span><span>
</span><span>             </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>metis</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;Cons.hyps&quot;</span></span></span><span class="delimiter">[</span><span>rule_format</span><span class="delimiter">]</span><span> </span><span>sched_equiv_preserved</span><span> </span><span>reachableStep</span><span class="delimiter">)</span><span>
</span><span>             </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>enabled</span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>simp</span><span>
</span><span>            </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>enabled</span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>simp</span><span>
</span><span>          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>clarsimp</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>sched_vpeq</span><span class="delimiter">)</span><span>
</span><span>          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>rule</span><span> </span><span>Collect_cong</span><span class="delimiter">)</span><span>
</span><span>          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>rule</span><span> </span><span>conj_cong</span><span class="delimiter">,</span><span> </span><span>rule</span><span> </span><span>refl</span><span class="delimiter">)</span><span>
</span><span>          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>rule</span><span> </span><span>iff_exI</span><span class="delimiter">)</span><span>
</span><span>          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span class="delimiter">(</span><span>no_types</span><span class="delimiter">,</span><span> </span><span>hide_lams</span><span class="delimiter">)</span><span> </span><span>Cons.hyps</span><span> </span><span>enabled</span><span> </span><span>reachableStep</span><span> </span><span>sched_equiv_preserved</span><span class="delimiter">)</span><span>
</span><span>          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>sources_eq</span><span class="delimiter">:</span><span>
</span><span>      </span><span class="string"><span class="delete"><span class="delete">&quot;&#10214;step_consistent; s &#8764; sched &#8764; t; reachable0 s; reachable0 t&#10215; &#10233; sources as s d = sources as t d&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>sources_eq0</span><span class="delimiter">)</span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>same_sources_dom</span><span class="delimiter">:</span><span>
</span><span>      </span><span class="string"><span class="delete"><span class="delete">&quot;&#10214;s &#8776;(sources (a#as) s d)&#8776; t; (the (domain s a)) &#8605; x; x &#8712; sources as s&#39; d; 
        (s,s&#39;)&#8712;step a&#10215; &#10233; (s &#8764;(the (domain s a))&#8764; t)&quot;</span></span></span><span>
</span><span>       </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span>ivpeq_def</span><span class="delimiter">)</span><span>
</span><span>       </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>erule</span><span> </span><span>bspec</span><span class="delimiter">)</span><span>
</span><span>       </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>subst</span><span> </span><span>sources_Cons</span><span class="delimiter">)</span><span>
</span><span>       </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>rule</span><span> </span><span>UnI2</span><span class="delimiter">)</span><span>
</span><span>       </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>blast</span><span class="delimiter">)</span><span>
</span><span>       </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>sources_step</span><span class="delimiter">:</span><span>
</span><span>      </span><span class="string"><span class="delete"><span class="delete">&quot;&#10214;reachable0 s; (the (domain s a)) &#8726;&#8605; d&#10215; &#10233; sources [a] s d = {d}&quot;</span></span></span><span> 
</span><span>      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>sources_Cons</span><span> </span><span>sources_Nil</span><span> </span><span>enabled</span><span> </span><span>dest</span><span class="delimiter">:</span><span> </span><span>enabled</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>non_interference_def</span><span class="delimiter">)</span><span>
</span><span>    
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>sources_step2</span><span class="delimiter">:</span><span>
</span><span>      </span><span class="string"><span class="delete"><span class="delete">&quot;&#10214;reachable0 s; (the (domain s a)) &#8605; d&#10215; &#10233; sources [a] s d = {the (domain s a),d}&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>sources_Cons</span><span> </span><span>sources_Nil</span><span> </span><span>enabled</span><span> </span><span>dest</span><span class="delimiter">:</span><span> </span><span>enabled</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>sources_unwinding_step</span><span class="delimiter">:</span><span>
</span><span>      </span><span class="string"><span class="delete"><span class="delete">&quot;&#10214;s &#8776;(sources (a#as) s d)&#8776; t; (s&#8764;sched&#8764;t); step_consistent;
        (s,s&#39;)&#8712;step a; (t,t&#39;)&#8712;step a; reachable0 s; reachable0 t&#10215;  &#10233; (s&#39; &#8776;(sources as s&#39; d)&#8776; t&#39;)&quot;</span></span></span><span>
</span><span>       </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>clarsimp</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>ivpeq_def</span><span> </span><span>sources_Cons</span><span class="delimiter">)</span><span>
</span><span>        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>subst</span><span> </span><span class="delimiter">(</span><span>asm</span><span class="delimiter">)</span><span> </span><span>step_consistent_def</span><span class="delimiter">)</span><span>
</span><span>        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>drule_tac</span><span> </span><span>x</span><span class="delimiter">=</span><span>a</span><span> </span><span class="keyword2"><span class="keyword">in</span></span><span> </span><span>spec</span><span class="delimiter">)</span><span>
</span><span>        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>drule_tac</span><span> </span><span>x</span><span class="delimiter">=</span><span>da</span><span> </span><span class="keyword2"><span class="keyword">in</span></span><span> </span><span>spec</span><span class="delimiter">)</span><span>
</span><span>        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>drule_tac</span><span> </span><span>x</span><span class="delimiter">=</span><span>s</span><span> </span><span class="keyword2"><span class="keyword">in</span></span><span> </span><span>spec</span><span class="delimiter">)</span><span>
</span><span>        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>drule_tac</span><span> </span><span>x</span><span class="delimiter">=</span><span>t</span><span> </span><span class="keyword2"><span class="keyword">in</span></span><span> </span><span>spec</span><span class="delimiter">)</span><span>
</span><span>        </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>UnionI</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>       
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>sources_eq_step</span><span class="delimiter">:</span><span>
</span><span>      </span><span class="string"><span class="delete"><span class="delete">&quot;&#10214;local_respect; step_consistent;(s,s&#39;)&#8712;step a; 
        (the (domain s a)) &#8800; sched; reachable0 s&#10215; &#10233;
        (sources as s&#39; d) = (sources as s d)&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>reachableStep</span><span> </span><span>sched_equiv_preserved_left</span><span> </span><span>sources_eq0</span><span> </span><span>vpeq_reflexive_lemma</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span> 
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>sources_equiv_preserved_left</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#10214;local_respect; step_consistent; s&#8764;sched&#8764;t; 
          the (domain s a) &#8713; sources (a#as) s d; s &#8776;sources (a#as) s d&#8776; t; (s,s&#39;)&#8712;step a; 
          (the (domain s a)) &#8800; sched; reachable0 s; reachable0 t&#10215; &#10233; (s&#39; &#8776;sources as s&#39; d&#8776; t)&quot;</span></span></span><span>
</span><span>          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>clarsimp</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>ivpeq_def</span><span class="delimiter">)</span><span>
</span><span>          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>rename_tac</span><span> </span><span>v</span><span class="delimiter">)</span><span>
</span><span>          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>case_tac</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(the (domain s a)) &#8605; v&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>           </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>fastforce</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>sources_Cons</span><span class="delimiter">)</span><span>
</span><span>          </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>            </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>v</span><span> </span><span class="delimiter">::</span><span> </span><span class="tfree">&#39;d</span><span>
</span><span>            </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span> </span><span>local_respect</span><span>
</span><span>            </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a2</span><span class="delimiter">:</span><span> </span><span>step_consistent</span><span>
</span><span>            </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a3</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8764; sched &#8764; t&quot;</span></span></span><span>
</span><span>            </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a4</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;d&#8712;sources (a # as) s d. (s &#8764; d &#8764; t)&quot;</span></span></span><span>
</span><span>            </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a5</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(s, s&#39;) &#8712; step a&quot;</span></span></span><span>
</span><span>            </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a6</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 s&quot;</span></span></span><span>
</span><span>            </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a7</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 t&quot;</span></span></span><span>
</span><span>            </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a8</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;v &#8712; sources as s&#39; d&quot;</span></span></span><span>
</span><span>            </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a9</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#172; ((the (domain s a)) &#8605; v)&quot;</span></span></span><span>
</span><span>            </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>ss</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#39;s &#8658; &#39;e &#8658; &#39;s&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span>              </span><span>f10</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;e. (t, ss t e) &#8712; step e&quot;</span></span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a7</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>meson</span><span> </span><span>enabled</span><span class="delimiter">)</span><span>
</span><span>            </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;e. domain s e = domain t e&quot;</span></span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a3</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>meson</span><span> </span><span>sched_vpeq</span><span class="delimiter">)</span><span>
</span><span>            </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f11</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;d sa e. (t, sa) &#8713; step e &#8744; (t &#8764; d &#8764; sa) &#8744; ((the (domain s e)) &#8605; d)&quot;</span></span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a7</span><span> </span><span>a1</span><span> </span><span>local_respect_def</span><span> </span><span>non_interference_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>force</span><span>
</span><span>            </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; &#8764; v &#8764; (ss t a)&quot;</span></span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>f10</span><span> </span><span>a8</span><span> </span><span>a7</span><span> </span><span>a6</span><span> </span><span>a5</span><span> </span><span>a4</span><span> </span><span>a3</span><span> </span><span>a2</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span class="delimiter">(</span><span>no_types</span><span class="delimiter">)</span><span> </span><span>ivpeq_def</span><span> </span><span>sources_unwinding_step</span><span class="delimiter">)</span><span>
</span><span>            </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; &#8764; v &#8764; t&quot;</span></span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>f11</span><span> </span><span>f10</span><span> </span><span>a9</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>meson</span><span> </span><span>vpeq_symmetric_lemma</span><span> </span><span>vpeq_transitive_lemma</span><span class="delimiter">)</span><span>
</span><span>          </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>ipurge_eq&#39;_helper</span><span class="delimiter">:</span><span>
</span><span>      </span><span class="string"><span class="delete"><span class="delete">&quot;&#10214;s &#8712; ss; the (domain s a) &#8712; sources (a # as) s u; &#8704;s&#8712;ts. the (domain s a) &#8713; sources (a # as) s u;
       (&#8704;s t. s &#8712; ss &#8743; t &#8712; ts &#10230; (s &#8764;sched&#8764; t) &#8743; reachable0 s &#8743; reachable0 t);  t &#8712; ts; step_consistent&#10215; &#10233;
      False&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>cut_tac</span><span> </span><span>s</span><span class="delimiter">=</span><span>s</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>t</span><span class="delimiter">=</span><span>t</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>as</span><span class="delimiter">=</span><span>as</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>d</span><span class="delimiter">=</span><span>u</span><span> </span><span class="keyword2"><span class="keyword">in</span></span><span> </span><span>sources_eq</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">+</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>clarsimp</span><span>  </span><span>simp</span><span class="delimiter">:</span><span> </span><span>sources_Cons</span><span> </span><span class="delimiter">|</span><span> </span><span>safe</span><span class="delimiter">)</span><span class="delimiter">+</span><span>
</span><span>      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>rename_tac</span><span> </span><span>s&#39;</span><span class="delimiter">)</span><span>
</span><span>       </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>drule_tac</span><span> </span><span>x</span><span class="delimiter">=</span><span>t</span><span> </span><span class="keyword2"><span class="keyword">in</span></span><span> </span><span>bspec</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">)</span><span>
</span><span>       </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>clarsimp</span><span>
</span><span>       </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>cut_tac</span><span> </span><span>s</span><span class="delimiter">=</span><span>t</span><span> </span><span class="keyword2"><span class="keyword">in</span></span><span> </span><span>enabled</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">)</span><span>
</span><span>       </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>erule</span><span> </span><span>exE</span><span class="delimiter">,</span><span> </span><span>rename_tac</span><span> </span><span>t&#39;</span><span class="delimiter">)</span><span>
</span><span>       </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>drule_tac</span><span> </span><span>x</span><span class="delimiter">=</span><span class="string"><span class="delete"><span class="delete">&quot;sources as t&#39; u&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">in</span></span><span> </span><span>spec</span><span class="delimiter">)</span><span>
</span><span>       </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>cut_tac</span><span> </span><span>s</span><span class="delimiter">=</span><span>s&#39;</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>t</span><span class="delimiter">=</span><span>t&#39;</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>d</span><span class="delimiter">=</span><span>u</span><span> </span><span class="keyword2"><span class="keyword">in</span></span><span> </span><span>sources_eq</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">+</span><span class="delimiter">)</span><span>
</span><span>          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>fastforce</span><span> </span><span>elim</span><span class="delimiter">:</span><span> </span><span>sched_equiv_preserved</span><span class="delimiter">)</span><span>
</span><span>         </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>fastforce</span><span> </span><span>intro</span><span class="delimiter">:</span><span> </span><span>reachableStep</span><span class="delimiter">)</span><span>
</span><span>        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>fastforce</span><span> </span><span>intro</span><span class="delimiter">:</span><span> </span><span>reachableStep</span><span class="delimiter">)</span><span>
</span><span>       </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>fastforce</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>sched_vpeq</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>drule_tac</span><span> </span><span>x</span><span class="delimiter">=</span><span>t</span><span> </span><span class="keyword2"><span class="keyword">in</span></span><span> </span><span>bspec</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>clarsimp</span><span>
</span><span>      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>rename_tac</span><span> </span><span>v</span><span> </span><span>s&#39;</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>drule_tac</span><span> </span><span>x</span><span class="delimiter">=</span><span>v</span><span> </span><span class="keyword2"><span class="keyword">in</span></span><span> </span><span>spec</span><span class="delimiter">,</span><span> </span><span>erule</span><span> </span><span>impE</span><span class="delimiter">,</span><span> </span><span>fastforce</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>sched_vpeq</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>cut_tac</span><span> </span><span>s</span><span class="delimiter">=</span><span>t</span><span> </span><span class="keyword2"><span class="keyword">in</span></span><span> </span><span>enabled</span><span class="delimiter">[</span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>a</span><span class="delimiter">=</span><span>a</span><span class="delimiter">]</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">,</span><span> </span><span>clarsimp</span><span class="delimiter">,</span><span> </span><span>rename_tac</span><span> </span><span>t&#39;</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>cut_tac</span><span> </span><span>s</span><span class="delimiter">=</span><span>s&#39;</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>t</span><span class="delimiter">=</span><span>t&#39;</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>d</span><span class="delimiter">=</span><span>u</span><span> </span><span class="keyword2"><span class="keyword">in</span></span><span> </span><span>sources_eq</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">+</span><span class="delimiter">)</span><span>
</span><span>         </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>fastforce</span><span> </span><span>elim</span><span class="delimiter">:</span><span> </span><span>sched_equiv_preserved</span><span class="delimiter">)</span><span>
</span><span>        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>fastforce</span><span> </span><span>intro</span><span class="delimiter">:</span><span> </span><span>reachableStep</span><span class="delimiter">)</span><span>
</span><span>       </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>fastforce</span><span> </span><span>intro</span><span class="delimiter">:</span><span> </span><span>reachableStep</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>fastforce</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>sched_vpeq</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>  
</span><span>  
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>ipurge_eq&#39;</span><span class="delimiter">:</span><span>
</span><span>      </span><span class="string"><span class="delete"><span class="delete">&quot;(&#8704; s t. s&#8712;ss &#8743; t&#8712;ts &#10230; (s &#8764;sched&#8764; t) &#8743; reachable0 s &#8743; reachable0 t) &#8743; 
        (&#8707; s. s &#8712; ss) &#8743; (&#8707; t. t &#8712; ts) &#8743; step_consistent &#10230; ipurge as u ss = ipurge as u ts&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>induct</span><span> </span><span>as</span><span> </span><span>arbitrary</span><span class="delimiter">:</span><span> </span><span>ss</span><span> </span><span>ts</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>Nil</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?case</span><span>
</span><span>       </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>ipurge_def</span><span class="delimiter">)</span><span>
</span><span>       </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>      </span><span class="keyword3"><span class="command">case</span></span><span> </span><span class="delimiter">(</span><span>Cons</span><span> </span><span>a</span><span> </span><span>as</span><span class="delimiter">)</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?case</span><span>
</span><span>       </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>clarsimp</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>sched_vpeq</span><span class="delimiter">)</span><span>
</span><span>       </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>intro</span><span> </span><span>conjI</span><span> </span><span>impI</span><span class="delimiter">)</span><span>
</span><span>          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>rule</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;Cons.hyps&quot;</span></span></span><span class="delimiter">[</span><span>rule_format</span><span class="delimiter">]</span><span class="delimiter">)</span><span>
</span><span>          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>clarsimp</span><span>
</span><span>          </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>metis</span><span> </span><span>sched_equiv_preserved</span><span> </span><span>reachableStep</span><span> </span><span>enabled</span><span class="delimiter">)</span><span>
</span><span>         </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>clarsimp</span><span>
</span><span>         </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>drule</span><span> </span><span>ipurge_eq&#39;_helper</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">+</span><span class="delimiter">)</span><span class="delimiter">[</span><span>1</span><span class="delimiter">]</span><span>
</span><span>        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>clarsimp</span><span>
</span><span>        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>drule</span><span> </span><span>ipurge_eq&#39;_helper</span><span class="delimiter">,</span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>vpeq_symmetric_lemma</span><span class="delimiter">)</span><span class="delimiter">+</span><span class="delimiter">)</span><span class="delimiter">[</span><span>1</span><span class="delimiter">]</span><span>
</span><span>       </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="delimiter">(</span><span>rule</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;Cons.hyps&quot;</span></span></span><span class="delimiter">[</span><span>rule_format</span><span class="delimiter">]</span><span class="delimiter">,</span><span> </span><span>auto</span><span class="delimiter">)</span><span>
</span><span>       </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>  
</span><span>      </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>ipurge_eq</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;&#10214;step_consistent; s &#8764; sched &#8764; t; reachable0 s &#8743; reachable0 t&#10215;
                      &#10233; ipurge as d {s} = ipurge as d {t}&quot;</span></span></span><span> 
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>ipurge_eq&#39;</span><span class="delimiter">)</span><span>
</span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">subsection</span></span><span class="cartouche"><span class="delete"><span class="delete">&#8249; Inference framework of information flow security properties &#8250;</span></span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>nonintf_impl_weak</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;noninterference &#10233; weak_noninterference&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>noninterference_def</span><span> </span><span>observ_equiv_sym</span><span> </span><span>observ_equiv_trans</span><span> </span><span>reachable_s0</span><span> </span><span>weak_noninterference_def</span><span class="delimiter">)</span><span> 
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>wk_nonintf_r_impl_wk_nonintf</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;weak_noninterference_r &#10233; weak_noninterference&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>reachable_s0</span><span> </span><span>weak_noninterference_def</span><span> </span><span>weak_noninterference_r_def</span><span class="delimiter">)</span><span> 
</span><span>    
</span><span>    </span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>nonintf_r_impl_noninterf</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;noninterference_r &#10233; noninterference&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>noninterference_def</span><span> </span><span>noninterference_r_def</span><span> </span><span>reachable_s0</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span> 
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>nonintf_r_impl_wk_nonintf_r</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;noninterference_r &#10233; weak_noninterference_r&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>noninterference_r_def</span><span> </span><span>observ_equiv_sym</span><span> </span><span>observ_equiv_trans</span><span> </span><span>weak_noninterference_r_def</span><span class="delimiter">)</span><span>
</span><span>      
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>noninf_impl_nonintf_r</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;noninfluence &#10233; noninterference_r&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>ivpeq_def</span><span> </span><span>noninfluence_def</span><span> </span><span>noninterference_r_def</span><span> </span><span>vpeq_reflexive_lemma</span><span class="delimiter">)</span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>noninf_impl_nonlk</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;noninfluence &#10233; nonleakage&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>noninterference_r_def</span><span> </span><span>nonleakage_def</span><span> </span><span>observ_equiv_sym</span><span> 
</span><span>        </span><span>observ_equiv_trans</span><span> </span><span>noninfluence_def</span><span> </span><span>noninf_impl_nonintf_r</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span> 
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>wk_noninfl_impl_nonlk</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;weak_noninfluence &#10233; nonleakage&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>weak_noninfluence_def</span><span> </span><span>nonleakage_def</span><span class="delimiter">)</span><span> 
</span><span>    
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>wk_noninfl_impl_wk_nonintf_r</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;weak_noninfluence &#10233; weak_noninterference_r&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>ivpeq_def</span><span> </span><span>weak_noninfluence_def</span><span> </span><span>vpeq_reflexive_lemma</span><span> </span><span>weak_noninterference_r_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span> 
</span><span>   
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>noninf_gen_impl_noninfl</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;noninfluence_gen &#10233; noninfluence&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>clarsimp</span><span> </span><span>simp</span><span class="delimiter">:</span><span>noninfluence_gen_def</span><span> </span><span>noninfluence_def</span><span class="delimiter">)</span><span>
</span><span>      
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>nonlk_imp_sc</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;nonleakage &#10233; step_consistent&quot;</span></span></span><span> 
</span><span>      </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>        </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>p0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;nonleakage&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>p1</span><span class="delimiter">[</span><span>rule_format</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;as d s t. reachable0 s &#8743; reachable0 t &#10230; (s &#8764; sched &#8764; t) 
                         &#10230; (s &#8776; (sources as s d) &#8776; t) &#10230; (s &#8882; as &#8773; t &#8882; as @ d)&quot;</span></span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>nonleakage_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>        
</span><span>        </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;a d s t. reachable0 s &#8743; reachable0 t &#10230; (s &#8764; d &#8764; t) &#8743; (s &#8764; sched &#8764; t) &#8743; 
                          (((the (domain s a)) &#8605; d) &#10230; (s &#8764; (the (domain s a)) &#8764; t)) &#10230; 
                          (&#8704; s&#39; t&#39;. (s,s&#39;) &#8712; step a &#8743; (t,t&#39;) &#8712; step a &#10230; (s&#39; &#8764;d&#8764; t&#39;))&quot;</span></span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>          </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>            </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>a</span><span> </span><span>d</span><span> </span><span>s</span><span> </span><span>t</span><span>
</span><span>            </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 s &#8743; reachable0 t&quot;</span></span></span><span>
</span><span>              </span><span class="keyword2"><span class="keyword">and</span></span><span>  </span><span>a1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(s &#8764; d &#8764; t) &#8743; (s &#8764; sched &#8764; t)&quot;</span></span></span><span>
</span><span>              </span><span class="keyword2"><span class="keyword">and</span></span><span>  </span><span>a2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;((the (domain s a)) &#8605; d) &#10230; (s &#8764; (the (domain s a)) &#8764; t)&quot;</span></span></span><span>
</span><span>            </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704; s&#39; t&#39;. (s,s&#39;) &#8712; step a &#8743; (t,t&#39;) &#8712; step a &#10230; (s&#39; &#8764;d&#8764; t&#39;)&quot;</span></span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>              </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>                </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>s&#39;</span><span> </span><span>t&#39;</span><span>
</span><span>                </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>b0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(s,s&#39;) &#8712; step a &#8743; (t,t&#39;) &#8712; step a&quot;</span></span></span><span>
</span><span>                </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; &#8764;d&#8764; t&#39;&quot;</span></span></span><span> 
</span><span>                  </span><span class="keyword1"><span class="command">proof</span></span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(the (domain s a)) &#8605; d&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>                    </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>c0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(the (domain s a)) &#8605; d&quot;</span></span></span><span>
</span><span>                    </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>a2</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8764; (the (domain s a)) &#8764; t&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>                    </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>a0</span><span> </span><span>a1</span><span> </span><span>c0</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8776; (sources [a] s d) &#8776; t&quot;</span></span></span><span> 
</span><span>                      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>sources_step2</span><span class="delimiter">[</span><span>of</span><span> </span><span>s</span><span> </span><span>a</span><span> </span><span>d</span><span class="delimiter">]</span><span> </span><span>ivpeq_def</span><span class="delimiter">[</span><span>of</span><span> </span><span>s</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;sources [a] s d&quot;</span></span></span><span> </span><span>t</span><span class="delimiter">]</span><span>
</span><span>                        </span><span>insert_iff</span><span> </span><span>singletonD</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span> 
</span><span>                    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8882; [a] &#8773; t &#8882; [a] @ d&quot;</span></span></span><span> 
</span><span>                      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p1</span><span class="delimiter">[</span><span>of</span><span> </span><span>s</span><span> </span><span>t</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;[a]&quot;</span></span></span><span> </span><span>d</span><span class="delimiter">]</span><span> </span><span>a0</span><span> </span><span>a1</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>                    </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>b0</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>                      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>observ_equivalence_def</span><span> </span><span class="delimiter">)</span><span> 
</span><span>                  </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>                    </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>c0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#172;((the (domain s a)) &#8605; d)&quot;</span></span></span><span>
</span><span>                    </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>a0</span><span> </span><span>a1</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8776; (sources [a] s d) &#8776; t&quot;</span></span></span><span> 
</span><span>                      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>sources_step</span><span class="delimiter">[</span><span>of</span><span> </span><span>s</span><span> </span><span>a</span><span> </span><span>d</span><span class="delimiter">]</span><span> </span><span>ivpeq_def</span><span class="delimiter">[</span><span>of</span><span> </span><span>s</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;sources [a] s d&quot;</span></span></span><span> </span><span>t</span><span class="delimiter">]</span><span>
</span><span>                        </span><span>non_interference_def</span><span> </span><span>insert_iff</span><span> </span><span>singletonD</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span> 
</span><span>                    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8882; [a] &#8773; t &#8882; [a] @ d&quot;</span></span></span><span> 
</span><span>                      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p1</span><span class="delimiter">[</span><span>of</span><span> </span><span>s</span><span> </span><span>t</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;[a]&quot;</span></span></span><span> </span><span>d</span><span class="delimiter">]</span><span> </span><span>a0</span><span> </span><span>a1</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>                    </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>b0</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>                      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>observ_equivalence_def</span><span> </span><span class="delimiter">)</span><span> 
</span><span>                  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>              </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>          </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;step_consistent&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>step_consistent_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>      </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>sc_imp_nonlk</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;step_consistent &#10233; nonleakage&quot;</span></span></span><span> 
</span><span>      </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>        </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>p0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;step_consistent&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;d as s t. reachable0 s &#8743; reachable0 t &#10230; (s &#8764; sched &#8764; t) 
                         &#10230; (s &#8776; (sources as s d) &#8776; t) &#10230; (s &#8882; as &#8773; t &#8882; as @ d)&quot;</span></span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>          </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>            </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>as</span><span>
</span><span>            </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;d s t. reachable0 s &#8743; reachable0 t &#10230; (s &#8764; sched &#8764; t) 
                         &#10230; (s &#8776; (sources as s d) &#8776; t) &#10230; (s &#8882; as &#8773; t &#8882; as @ d)&quot;</span></span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">proof</span></span><span class="delimiter">(</span><span>induct</span><span> </span><span>as</span><span class="delimiter">)</span><span>
</span><span>                </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>Nil</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?case</span><span>
</span><span>                  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>ivpeq_def</span><span> </span><span>observ_equivalence_def</span><span> </span><span>sources_refl</span><span class="delimiter">)</span><span> 
</span><span>              </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>                </span><span class="keyword3"><span class="command">case</span></span><span> </span><span class="delimiter">(</span><span>Cons</span><span> </span><span>b</span><span> </span><span>bs</span><span class="delimiter">)</span><span>
</span><span>                </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;d s t. reachable0 s &#8743; reachable0 t &#10230; (s &#8764; sched &#8764; t) 
                                    &#10230; (s &#8776; sources bs s d &#8776; t) &#10230; (s &#8882; bs &#8773; t &#8882; bs @ d)&quot;</span></span></span><span>
</span><span>                </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?case</span><span>
</span><span>                  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>                  </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>                    </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>d</span><span> </span><span>s</span><span> </span><span>t</span><span>
</span><span>                    </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>b0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 s &#8743; reachable0 t&quot;</span></span></span><span>
</span><span>                      </span><span class="keyword2"><span class="keyword">and</span></span><span>  </span><span>b1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8764; sched &#8764; t&quot;</span></span></span><span>
</span><span>                      </span><span class="keyword2"><span class="keyword">and</span></span><span>  </span><span>b2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8776; sources (b # bs) s d &#8776; t&quot;</span></span></span><span>
</span><span>                    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8882; b # bs &#8773; t &#8882; b # bs @ d&quot;</span></span></span><span>
</span><span>                      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>exec_equiv_both</span><span> </span><span>sources_unwinding_step</span><span> </span><span>p0</span><span> </span><span>a0</span><span>
</span><span>                        </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>meson</span><span> </span><span>reachableStep</span><span> </span><span>SM_axioms</span><span> </span><span>sched_equiv_preserved</span><span class="delimiter">)</span><span> 
</span><span>                  </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>                  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>                  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>        </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span>        </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;nonleakage&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>nonleakage_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>      </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>sc_eq_nonlk</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;step_consistent = nonleakage&quot;</span></span></span><span> 
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>nonlk_imp_sc</span><span> </span><span>sc_imp_nonlk</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>noninf_imp_lr</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;noninfluence &#10233; local_respect&quot;</span></span></span><span> 
</span><span>      </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>        </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>p0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;noninfluence&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>p1</span><span class="delimiter">[</span><span>rule_format</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704; d as s t . reachable0 s &#8743; reachable0 t &#10230; (s &#8776; (sources as s d) &#8776; t) 
                                &#10230; (s &#8764; sched &#8764; t) &#10230; (s &#8882; as &#8773; t &#8882; (ipurge as d {t}) @ d)&quot;</span></span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>noninfluence_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>        
</span><span>        </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704; a d s s&#39;. reachable0 s &#10230; ((the (domain s a)) &#8726;&#8605; d) &#8743; (s,s&#39;)&#8712;step a &#10230; (s &#8764; d &#8764; s&#39;)&quot;</span></span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>          </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>            </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>a</span><span> </span><span>d</span><span> </span><span>s</span><span> </span><span>s&#39;</span><span>
</span><span>            </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 s&quot;</span></span></span><span>
</span><span>              </span><span class="keyword2"><span class="keyword">and</span></span><span>  </span><span>a1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;((the (domain s a)) &#8726;&#8605; d) &#8743; (s,s&#39;)&#8712;step a&quot;</span></span></span><span>
</span><span>            </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;the (domain s a) &#8800; d&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>non_interference_def</span><span> </span><span>interf_reflexive</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>            </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>a0</span><span> </span><span>a1</span><span> </span><span>p1</span><span class="delimiter">[</span><span>of</span><span> </span><span>s</span><span> </span><span>s</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;[a]&quot;</span></span></span><span> </span><span>d</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a3</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8882; [a] &#8773; s &#8882; (ipurge [a] d {s}) @ d&quot;</span></span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>ivpeq_def</span><span> </span><span>vpeq_reflexive_lemma</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>            </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>a0</span><span> </span><span>a1</span><span> </span><span>a2</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;ipurge [a] d {s} = []&quot;</span></span></span><span> 
</span><span>              </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>sources_step</span><span> </span><span>SM_enabled_axioms</span><span> </span><span>non_interference_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span>
</span><span>            </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>a1</span><span> </span><span>a3</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8764; d &#8764; s&#39;&quot;</span></span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>IdI</span><span> </span><span>R_O_Id</span><span> </span><span>observ_equiv_sym</span><span> </span><span>observ_equivalence_def</span><span> </span><span>run_Cons</span><span> </span><span>run_Nil</span><span class="delimiter">)</span><span> 
</span><span>          </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>          </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;local_respect&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>local_respect_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>      </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>noninf_imp_sc</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;noninfluence &#10233; step_consistent&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>nonlk_imp_sc</span><span> </span><span>noninf_impl_nonlk</span><span class="delimiter">)</span><span>  
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>UnwindingTheorem</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#10214;step_consistent; local_respect&#10215; &#10233; noninfluence_gen&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>      </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>p1</span><span class="delimiter">:</span><span>step_consistent</span><span>
</span><span>      </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>p2</span><span class="delimiter">:</span><span>local_respect</span><span>
</span><span>      </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>        </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>as</span><span> </span><span>d</span><span>
</span><span>        </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;s ts. reachable0 s &#8743; (&#8704;t&#8712;ts. reachable0 t) 
                    &#10230; (&#8704;t&#8712;ts. (s &#8776; (sources as s d) &#8776; t)) 
                    &#10230; (&#8704;t&#8712;ts. (s &#8764; sched &#8764; t)) 
                    &#10230; (&#8704;t&#8712;ts. (s &#8882; as &#8773; t &#8882; (ipurge as d ts) @ d))&quot;</span></span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">proof</span></span><span class="delimiter">(</span><span>induct</span><span> </span><span>as</span><span class="delimiter">)</span><span>
</span><span>            </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>Nil</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?case</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>execute_def</span><span> </span><span>ivpeq_def</span><span> </span><span>observ_equivalence_def</span><span> </span><span>sources_refl</span><span class="delimiter">)</span><span>
</span><span>          </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>            </span><span class="keyword3"><span class="command">case</span></span><span> </span><span class="delimiter">(</span><span>Cons</span><span> </span><span>b</span><span> </span><span>bs</span><span class="delimiter">)</span><span>
</span><span>            </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;s ts. reachable0 s &#8743; (&#8704;t&#8712;ts. reachable0 t) 
                          &#10230; (&#8704;t&#8712;ts. (s &#8776; (sources bs s d) &#8776; t)) 
                          &#10230; (&#8704;t&#8712;ts. (s &#8764; sched &#8764; t)) 
                          &#10230; (&#8704;t&#8712;ts. (s &#8882; bs &#8773; t &#8882; (ipurge bs d ts) @ d))&quot;</span></span></span><span>
</span><span>            </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?case</span><span> 
</span><span>              </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>              </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>                </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>s</span><span> </span><span>ts</span><span>
</span><span>                </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>b0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 s &#8743; (&#8704;t&#8712;ts. reachable0 t)&quot;</span></span></span><span>
</span><span>                  </span><span class="keyword2"><span class="keyword">and</span></span><span>  </span><span>b1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;t&#8712;ts. (s &#8776; (sources (b # bs) s d) &#8776; t)&quot;</span></span></span><span>
</span><span>                  </span><span class="keyword2"><span class="keyword">and</span></span><span>  </span><span>b2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;t&#8712;ts. (s &#8764; sched &#8764; t)&quot;</span></span></span><span>
</span><span>                </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>                  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>t</span><span>
</span><span>                  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>c0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;t&#8712;ts&quot;</span></span></span><span>
</span><span>                  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>c1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;sources (b#bs) s d = sources (b#bs) t d&quot;</span></span></span><span>
</span><span>                    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>b0</span><span> </span><span>b2</span><span> </span><span>c0</span><span> </span><span>p1</span><span> </span><span>sources_eq0</span><span class="delimiter">)</span><span> 
</span><span>                  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>c2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;domain s b = domain t b&quot;</span></span></span><span>
</span><span>                    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>b2</span><span> </span><span>c0</span><span> </span><span>sched_vpeq</span><span class="delimiter">)</span><span> 
</span><span>                  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8882; b # bs &#8773; t &#8882; ipurge (b # bs) d ts @ d&quot;</span></span></span><span>
</span><span>                    </span><span class="keyword1"><span class="command">proof</span></span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;the (domain s b) &#8712; sources (b#bs) s d&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>                      </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>d0</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;the (domain s b) &#8712; sources (b#bs) s d&quot;</span></span></span><span>
</span><span>                      </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>d1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;ipurge (b # bs) d ts = b # ipurge bs d (&#8899;s&#8712;ts. {s&#39;. (s,s&#39;) &#8712; step b})&quot;</span></span></span><span>
</span><span>                        </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>c0</span><span> </span><span>c1</span><span> </span><span>c2</span><span> </span><span>d0</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>                      </span><span class="keyword1"><span class="command">let</span></span><span> </span><span class="var">?ts&#39;</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8899;s&#8712;ts. {s&#39;. (s,s&#39;) &#8712; step b}&quot;</span></span></span><span> 
</span><span>                      </span><span class="keyword1"><span class="command">let</span></span><span> </span><span class="var">?bs&#39;</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;ipurge bs d (&#8899;s&#8712;ts. {s&#39;. (s,s&#39;) &#8712; step b})&quot;</span></span></span><span>
</span><span>                      </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>                        </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>s&#39;</span><span> </span><span>t&#39;</span><span>
</span><span>                        </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>e0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(s,s&#39;)&#8712; run (b#bs) &#8743; (t,t&#39;)&#8712; run (b # ?bs&#39;)&quot;</span></span></span><span>
</span><span>                        </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8707;s&#39;&#39; t&#39;&#39;. (s,s&#39;&#39;)&#8712;step b &#8743; (s&#39;&#39;,s&#39;)&#8712;run bs &#8743; (t,t&#39;&#39;)&#8712;step b &#8743; (t&#39;&#39;,t&#39;)&#8712;run ?bs&#39;&quot;</span></span></span><span>
</span><span>                          </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>relcompEpair</span><span> </span><span>run_Cons</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>                        </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>s&#39;&#39;</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>t&#39;&#39;</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>e2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(s,s&#39;&#39;)&#8712;step b &#8743; (s&#39;&#39;,s&#39;)&#8712;run bs &#8743; (t,t&#39;&#39;)&#8712;step b &#8743; (t&#39;&#39;,t&#39;)&#8712;run ?bs&#39;&quot;</span></span></span><span>
</span><span>                          </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>                        </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;t&#8712;?ts&#39;. reachable0 t&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>b0</span><span> </span><span>reachableStep</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span> 
</span><span>                        </span><span class="keyword1"><span class="command">moreover</span></span><span>
</span><span>                        </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;t&#8712;?ts&#39;. (s&#39;&#39; &#8776; (sources bs s&#39;&#39; d) &#8776; t)&quot;</span></span></span><span>
</span><span>                          </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>b0</span><span> </span><span>b1</span><span> </span><span>b2</span><span> </span><span>e2</span><span> </span><span>p1</span><span> </span><span>sources_unwinding_step</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span> 
</span><span>                        </span><span class="keyword1"><span class="command">moreover</span></span><span>
</span><span>                        </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;t&#8712;?ts&#39;. (s&#39;&#39; &#8764; sched &#8764; t)&quot;</span></span></span><span>
</span><span>                          </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>SM_enabled.sched_equiv_preserved</span><span> </span><span>SM_enabled_axioms</span><span> </span><span>b0</span><span> </span><span>b2</span><span> </span><span>e2</span><span> </span><span>p1</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span> 
</span><span>                        </span><span class="keyword1"><span class="command">ultimately</span></span><span> 
</span><span>                        </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e3</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;t&#8712;?ts&#39;. (s&#39;&#39; &#8882; bs &#8773; t &#8882; (ipurge bs d ?ts&#39;) @ d)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a0</span><span>
</span><span>                          </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>b0</span><span> </span><span>e2</span><span> </span><span>reachableStep</span><span class="delimiter">)</span><span> 
</span><span>                        </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; &#8764; d &#8764; t&#39;&quot;</span></span></span><span>
</span><span>                          </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>UN_iff</span><span> </span><span>c0</span><span> </span><span>e2</span><span> </span><span>mem_Collect_eq</span><span> </span><span>observ_equivalence_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span> 
</span><span>                      </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>                      </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;s&#39; t&#39;. ((s,s&#39;)&#8712; run (b#bs) &#8743; (t,t&#39;)&#8712; run (b # ?bs&#39;)) &#10230;(s&#39; &#8764; d &#8764; t&#39;)&quot;</span></span></span><span>
</span><span>                        </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>                      </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>d1</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span>observ_equivalence_def</span><span class="delimiter">)</span><span>
</span><span>                    </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>                      </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>d0</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;&#172;(the (domain s b) &#8712; sources (b#bs) s d)&quot;</span></span></span><span>
</span><span>                      </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>d1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;ipurge (b # bs) d ts = ipurge bs d ts&quot;</span></span></span><span>
</span><span>                        </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>b0</span><span> </span><span>b2</span><span> </span><span>d0</span><span> </span><span>p1</span><span> </span><span>sched_vpeq</span><span> </span><span>sources_eq</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>                      </span><span class="keyword1"><span class="command">let</span></span><span> </span><span class="var">?bs&#39;</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;ipurge bs d ts&quot;</span></span></span><span>
</span><span>                      </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>                        </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>s&#39;</span><span> </span><span>t&#39;</span><span>
</span><span>                        </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>e0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(s,s&#39;)&#8712; run (b#bs) &#8743; (t,t&#39;)&#8712; run ?bs&#39;&quot;</span></span></span><span>
</span><span>                        </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8707;s&#39;&#39; t&#39;&#39;. (s,s&#39;&#39;)&#8712;step b &#8743; (s&#39;&#39;,s&#39;)&#8712;run bs&quot;</span></span></span><span>
</span><span>                          </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>relcompEpair</span><span> </span><span>run_Cons</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>                        </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>s&#39;&#39;</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>e2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(s,s&#39;&#39;)&#8712;step b &#8743; (s&#39;&#39;,s&#39;)&#8712;run bs&quot;</span></span></span><span>
</span><span>                          </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>                        </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;t&#8712;ts. (s&#39;&#39; &#8776; (sources bs s&#39;&#39; d) &#8776; t)&quot;</span></span></span><span>
</span><span>                          </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>b0</span><span> </span><span>b1</span><span> </span><span>b2</span><span> </span><span>d0</span><span> </span><span>e2</span><span> </span><span>p1</span><span> </span><span>p2</span><span> </span><span>scheduler_in_sources_Cons</span><span> 
</span><span>                          </span><span>sources_equiv_preserved_left</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span> 
</span><span>                        </span><span class="keyword1"><span class="command">moreover</span></span><span>
</span><span>                        </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;t&#8712;ts. (s&#39;&#39; &#8764; sched &#8764; t)&quot;</span></span></span><span>
</span><span>                          </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>b0</span><span> </span><span>b2</span><span> </span><span>d0</span><span> </span><span>e2</span><span> </span><span>p2</span><span> </span><span>sched_equiv_preserved_left</span><span> 
</span><span>                            </span><span>scheduler_in_sources_Cons</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span> 
</span><span>                        </span><span class="keyword1"><span class="command">ultimately</span></span><span> 
</span><span>                        </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>e3</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;t&#8712;ts. (s&#39;&#39; &#8882; bs &#8773; t &#8882; (ipurge bs d ts) @ d)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a0</span><span>
</span><span>                          </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>b0</span><span> </span><span>e2</span><span> </span><span>reachableStep</span><span class="delimiter">)</span><span> 
</span><span>                        </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; &#8764; d &#8764; t&#39;&quot;</span></span></span><span>
</span><span>                          </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>c0</span><span> </span><span>e0</span><span> </span><span>e2</span><span> </span><span>observ_equivalence_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span> 
</span><span>                      </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>                      </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;s&#39; t&#39;. ((s,s&#39;)&#8712; run (b#bs) &#8743; (t,t&#39;)&#8712; run ?bs&#39;) &#10230;(s&#39; &#8764; d &#8764; t&#39;)&quot;</span></span></span><span>
</span><span>                        </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>                      </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>d1</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span>observ_equivalence_def</span><span class="delimiter">)</span><span>
</span><span>                    </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>                      
</span><span>                </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>                
</span><span>              </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>              </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span>noninfluence_gen_def</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>    
</span><span>    
</span><span>    </span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>UnwindingTheorem1</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#10214;weak_step_consistent; local_respect&#10215; &#10233; noninfluence_gen&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>UnwindingTheorem</span><span> </span><span>weak_with_step_cons</span><span class="delimiter">)</span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>noninf_eq_noninf_gen</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;noninfluence = noninfluence_gen&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>UnwindingTheorem</span><span> </span><span>noninf_imp_lr</span><span> </span><span>noninf_imp_sc</span><span> </span><span>noninf_gen_impl_noninfl</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span> 
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>uc_eq_noninf</span><span> </span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(step_consistent &#8743; local_respect) = noninfluence&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>UnwindingTheorem1</span><span> </span><span>step_cons_impl_weak</span><span> </span><span>noninf_eq_noninf_gen</span><span> 
</span><span>        </span><span>noninf_imp_lr</span><span> </span><span>noninf_imp_sc</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>      
</span><span>    </span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>noninf_impl_weak</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;noninfluence &#10233; weak_noninfluence&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>smt</span><span> </span><span>observ_equiv_sym</span><span> </span><span>observ_equiv_trans</span><span> </span><span>ipurge_eq</span><span> </span><span>weak_noninfluence_def</span><span> 
</span><span>          </span><span>noninterference_r_def</span><span> </span><span>noninf_imp_sc</span><span> </span><span>noninfluence_def</span><span> </span><span>noninf_impl_nonintf_r</span><span class="delimiter">)</span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>wk_nonintf_r_and_nonlk_impl_noninfl</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#10214;weak_noninterference_r; nonleakage&#10215; &#10233; weak_noninfluence&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>        </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>p0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;weak_noninterference_r&quot;</span></span></span><span>
</span><span>          </span><span class="keyword2"><span class="keyword">and</span></span><span>  </span><span>p1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;nonleakage&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;d as bs s. reachable0 s &#8743; ipurge as d {s} = ipurge bs d {s}
                                    &#10230; (s &#8882; as &#8773; s &#8882; bs @ d)&quot;</span></span></span><span> 
</span><span>          </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span>weak_noninterference_r_def</span><span class="delimiter">)</span><span>
</span><span>        </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>p1</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;d as s t. reachable0 s &#8743; reachable0 t &#8743; (s &#8764; sched &#8764; t) 
                                      &#8743; (s &#8776; (sources as s d) &#8776; t) &#10230; (s &#8882; as &#8773; t &#8882; as @ d)&quot;</span></span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span>nonleakage_def</span><span class="delimiter">)</span><span>
</span><span>        
</span><span>        </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704; d as bs s t . reachable0 s &#8743; reachable0 t &#8743; (s &#8776; (sources as s d) &#8776; t) 
                                     &#8743; (s &#8764; sched &#8764; t) &#8743; ipurge as d {s} = ipurge bs d {s} 
                                     &#10230; (s &#8882; as &#8773; t &#8882; bs @ d)&quot;</span></span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>          </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>            </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>d</span><span> </span><span>as</span><span> </span><span>bs</span><span> </span><span>s</span><span> </span><span>t</span><span>
</span><span>            </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>b0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 s &#8743; reachable0 t &#8743; (s &#8776; (sources as s d) &#8776; t) 
                        &#8743; (s &#8764; sched &#8764; t) &#8743; ipurge as d {s} = ipurge bs d {s}&quot;</span></span></span><span>
</span><span>            </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>a1</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8882; as &#8773; t &#8882; as @ d&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>            </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>b0</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;ipurge as d {s} = ipurge as d {t}&quot;</span></span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>ipurge_eq</span><span> </span><span>nonlk_imp_sc</span><span> </span><span>p1</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span> 
</span><span>            </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>b0</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b3</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;ipurge bs d {s} = ipurge bs d {t}&quot;</span></span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>ipurge_eq</span><span> </span><span>nonlk_imp_sc</span><span> </span><span>p1</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span> 
</span><span>            </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>a0</span><span> </span><span>b0</span><span> </span><span>b2</span><span> </span><span>b3</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b4</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8882; as &#8773; s &#8882; bs @ d&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>            </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>a0</span><span> </span><span>b0</span><span> </span><span>b2</span><span> </span><span>b3</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b5</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;t &#8882; as &#8773; t &#8882; bs @ d&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>            </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>b1</span><span> </span><span>b4</span><span> </span><span>b5</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8882; as &#8773; t &#8882; bs @ d&quot;</span></span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>b0</span><span> </span><span>observ_equiv_trans</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span> 
</span><span>          </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>          </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span>weak_noninfluence_def</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>nonintf_r_and_nonlk_impl_noninfl</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#10214;noninterference_r; nonleakage&#10215; &#10233; noninfluence&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>        </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>p0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;noninterference_r&quot;</span></span></span><span>
</span><span>          </span><span class="keyword2"><span class="keyword">and</span></span><span>  </span><span>p1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;nonleakage&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;d as s. reachable0 s &#10230; (s &#8882; as &#8773; s &#8882; (ipurge as d {s}) @ d)&quot;</span></span></span><span> 
</span><span>          </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span>noninterference_r_def</span><span class="delimiter">)</span><span>
</span><span>        </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>p1</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;d as s t. reachable0 s &#8743; reachable0 t &#8743; (s &#8764; sched &#8764; t) 
                                      &#8743; (s &#8776; (sources as s d) &#8776; t) &#10230; (s &#8882; as &#8773; t &#8882; as @ d)&quot;</span></span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span>nonleakage_def</span><span class="delimiter">)</span><span>
</span><span>        
</span><span>        </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704; d as s t . reachable0 s &#8743; reachable0 t &#8743; (s &#8776; (sources as s d) &#8776; t) 
                                &#8743; (s &#8764; sched &#8764; t) &#10230; (s &#8882; as &#8773; t &#8882; (ipurge as d {t}) @ d)&quot;</span></span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>          </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>            </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>d</span><span> </span><span>as</span><span> </span><span>bs</span><span> </span><span>s</span><span> </span><span>t</span><span>
</span><span>            </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>b0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 s &#8743; reachable0 t &#8743; (s &#8776; (sources as s d) &#8776; t) 
                        &#8743; (s &#8764; sched &#8764; t)&quot;</span></span></span><span>
</span><span>            </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>a1</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8882; as &#8773; t &#8882; as @ d&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>            </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>b0</span><span> </span><span>a0</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8882; as &#8773; s &#8882; (ipurge as d {s}) @ d&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>            </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>b0</span><span> </span><span>a0</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b3</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;t &#8882; as &#8773; t &#8882; (ipurge as d {t}) @ d&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>            
</span><span>            </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>b1</span><span> </span><span>b2</span><span> </span><span>b3</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8882; as &#8773; t &#8882; (ipurge as d {t}) @ d&quot;</span></span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>b0</span><span> </span><span>observ_equiv_trans</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span> 
</span><span>          </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>          </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span>noninfluence_def</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>noninfl_impl_noninfl2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;weak_noninfluence &#10233; weak_noninfluence2&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>ipurge_eq</span><span> </span><span>wk_noninfl_impl_nonlk</span><span> </span><span>weak_noninfluence2_def</span><span> 
</span><span>        </span><span>weak_noninfluence_def</span><span> </span><span>nonlk_imp_sc</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span> 
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>noninf2_imp_lr</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;weak_noninfluence2 &#10233; local_respect&quot;</span></span></span><span> 
</span><span>      </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>        </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>p0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;weak_noninfluence2&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>p1</span><span class="delimiter">[</span><span>rule_format</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704; d as bs s t . reachable0 s &#8743; reachable0 t &#8743; (s &#8776; (sources as s d) &#8776; t) 
                                     &#8743; (s &#8764; sched &#8764; t) &#8743; ipurge as d {s} = ipurge bs d {t} 
                                     &#10230; (s &#8882; as &#8773; t &#8882; bs @ d)&quot;</span></span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>weak_noninfluence2_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>        
</span><span>        </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704; a d s s&#39;. reachable0 s &#10230; ((the (domain s a)) &#8726;&#8605; d) &#8743; (s,s&#39;)&#8712;step a &#10230; (s &#8764; d &#8764; s&#39;)&quot;</span></span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>          </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>            </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>a</span><span> </span><span>d</span><span> </span><span>s</span><span> </span><span>s&#39;</span><span>
</span><span>            </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 s&quot;</span></span></span><span>
</span><span>              </span><span class="keyword2"><span class="keyword">and</span></span><span>  </span><span>a1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;((the (domain s a)) &#8726;&#8605; d) &#8743; (s,s&#39;)&#8712;step a&quot;</span></span></span><span>
</span><span>            </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;the (domain s a) &#8800; d&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>non_interference_def</span><span> </span><span>interf_reflexive</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>            </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>a0</span><span> </span><span>a1</span><span> </span><span>a2</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;ipurge [a] d {s} = ipurge [] d {s}&quot;</span></span></span><span> 
</span><span>              </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>sources_step</span><span> </span><span>SM_enabled_axioms</span><span> </span><span>non_interference_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span>
</span><span>            </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>a0</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8882; [a] &#8773; s &#8882; [] @ d&quot;</span></span></span><span> 
</span><span>              </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p1</span><span class="delimiter">[</span><span>of</span><span> </span><span>s</span><span> </span><span>s</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;[a]&quot;</span></span></span><span> </span><span>d</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;[]&quot;</span></span></span><span class="delimiter">]</span><span> </span><span>ivpeq_def</span><span> </span><span>vpeq_reflexive_lemma</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span> 
</span><span>            </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>a1</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8764; d &#8764; s&#39;&quot;</span></span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>IdI</span><span> </span><span>R_O_Id</span><span> </span><span>observ_equiv_sym</span><span> </span><span>observ_equivalence_def</span><span> </span><span>run_Cons</span><span> </span><span>run_Nil</span><span class="delimiter">)</span><span> 
</span><span>          </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>          </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;local_respect&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>local_respect_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>      </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>    
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>noninf2_imp_sc</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;weak_noninfluence2 &#10233; step_consistent&quot;</span></span></span><span> 
</span><span>      </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>        </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>p0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;weak_noninfluence2&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>p1</span><span class="delimiter">[</span><span>rule_format</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704; d as bs s t . reachable0 s &#8743; reachable0 t &#8743; (s &#8776; (sources as s d) &#8776; t) 
                                     &#8743; (s &#8764; sched &#8764; t) &#8743; ipurge as d {s} = ipurge bs d {t} 
                                     &#10230; (s &#8882; as &#8773; t &#8882; bs @ d)&quot;</span></span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>weak_noninfluence2_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>        
</span><span>        </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;a d s t. reachable0 s &#8743; reachable0 t &#8743; (s &#8764; d &#8764; t) &#8743; (s &#8764; sched &#8764; t) &#8743; 
                              (((the (domain s a)) &#8605; d) &#10230; (s &#8764; (the (domain s a)) &#8764; t)) &#10230; 
                              (&#8704; s&#39; t&#39;. (s,s&#39;) &#8712; step a &#8743; (t,t&#39;) &#8712; step a &#10230; (s&#39; &#8764;d&#8764; t&#39;))&quot;</span></span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>          </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>            </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>a</span><span> </span><span>d</span><span> </span><span>s</span><span> </span><span>t</span><span>
</span><span>            </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;reachable0 s &#8743; reachable0 t&quot;</span></span></span><span>
</span><span>              </span><span class="keyword2"><span class="keyword">and</span></span><span>  </span><span>a1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(s &#8764; d &#8764; t) &#8743; (s &#8764; sched &#8764; t)&quot;</span></span></span><span>
</span><span>              </span><span class="keyword2"><span class="keyword">and</span></span><span>  </span><span>a2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;((the (domain s a)) &#8605; d) &#10230; (s &#8764; (the (domain s a)) &#8764; t)&quot;</span></span></span><span>
</span><span>            </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a3</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;domain s a = domain t a&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>sched_vpeq</span><span class="delimiter">)</span><span> 
</span><span>                    
</span><span>            </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704; s&#39; t&#39;. (s,s&#39;) &#8712; step a &#8743; (t,t&#39;) &#8712; step a &#10230; (s&#39; &#8764;d&#8764; t&#39;)&quot;</span></span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>              </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>                </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>s&#39;</span><span> </span><span>t&#39;</span><span>
</span><span>                </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>b0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(s,s&#39;) &#8712; step a &#8743; (t,t&#39;) &#8712; step a&quot;</span></span></span><span>
</span><span>                </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s&#39; &#8764;d&#8764; t&#39;&quot;</span></span></span><span> 
</span><span>                  </span><span class="keyword1"><span class="command">proof</span></span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(the (domain s a)) &#8605; d&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>                    </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>c0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(the (domain s a)) &#8605; d&quot;</span></span></span><span>
</span><span>                    </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>a2</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>c1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8764; (the (domain s a)) &#8764; t&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>                    </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>a0</span><span> </span><span>a1</span><span> </span><span>c0</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>c2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8776; (sources [a] s d) &#8776; t&quot;</span></span></span><span> 
</span><span>                      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>sources_step2</span><span class="delimiter">[</span><span>of</span><span> </span><span>s</span><span> </span><span>a</span><span> </span><span>d</span><span class="delimiter">]</span><span> </span><span>ivpeq_def</span><span class="delimiter">[</span><span>of</span><span> </span><span>s</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;sources [a] s d&quot;</span></span></span><span> </span><span>t</span><span class="delimiter">]</span><span>
</span><span>                        </span><span>insert_iff</span><span> </span><span>singletonD</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span> 
</span><span>                    </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>a0</span><span> </span><span>c0</span><span> </span><span>a3</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>c4</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;ipurge [a] d {s} = ipurge [a] d {t}&quot;</span></span></span><span> 
</span><span>                      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>sources_step2</span><span class="delimiter">[</span><span>of</span><span> </span><span>s</span><span> </span><span>a</span><span> </span><span>d</span><span class="delimiter">]</span><span> </span><span>sources_step2</span><span class="delimiter">[</span><span>of</span><span> </span><span>t</span><span> </span><span>a</span><span> </span><span>d</span><span class="delimiter">]</span><span> 
</span><span>                        </span><span>ipurge_Cons</span><span class="delimiter">[</span><span>of</span><span> </span><span>a</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;[]&quot;</span></span></span><span> </span><span>d</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;{s}&quot;</span></span></span><span class="delimiter">]</span><span> </span><span>ipurge_Cons</span><span class="delimiter">[</span><span>of</span><span> </span><span>a</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;[]&quot;</span></span></span><span> </span><span>d</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;{t}&quot;</span></span></span><span class="delimiter">]</span><span> 
</span><span>                        </span><span>ipurge_Nil</span><span> </span><span>insertI1</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>                    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8882; [a] &#8773; t &#8882; [a] @ d&quot;</span></span></span><span> 
</span><span>                      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p1</span><span class="delimiter">[</span><span>of</span><span> </span><span>s</span><span> </span><span>t</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;[a]&quot;</span></span></span><span> </span><span>d</span><span class="delimiter">]</span><span> </span><span>a0</span><span> </span><span>a1</span><span> </span><span>c2</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span> 
</span><span>                    </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>b0</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>                      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>observ_equivalence_def</span><span> </span><span class="delimiter">)</span><span> 
</span><span>                  </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>                    </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>c0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#172;((the (domain s a)) &#8605; d)&quot;</span></span></span><span>
</span><span>                    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>c1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;the (domain s a) &#8800; d&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>non_interference_def</span><span> </span><span>interf_reflexive</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>                    </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>c0</span><span> </span><span>a0</span><span> </span><span>a1</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>c2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8776; (sources [a] s d) &#8776; t&quot;</span></span></span><span> 
</span><span>                      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>sources_step</span><span class="delimiter">[</span><span>of</span><span> </span><span>s</span><span> </span><span>a</span><span> </span><span>d</span><span class="delimiter">]</span><span> </span><span>ivpeq_def</span><span class="delimiter">[</span><span>of</span><span> </span><span>s</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;sources [a] s d&quot;</span></span></span><span> </span><span>t</span><span class="delimiter">]</span><span>
</span><span>                        </span><span>non_interference_def</span><span> </span><span>insert_iff</span><span> </span><span>singletonD</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span> 
</span><span>                    </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>a0</span><span> </span><span>c0</span><span> </span><span>c1</span><span> </span><span>a3</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>c4</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;ipurge [a] d {s} = ipurge [a] d {t}&quot;</span></span></span><span> 
</span><span>                      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>sources_step</span><span class="delimiter">[</span><span>of</span><span> </span><span>s</span><span> </span><span>a</span><span> </span><span>d</span><span class="delimiter">]</span><span> </span><span>sources_step</span><span class="delimiter">[</span><span>of</span><span> </span><span>t</span><span> </span><span>a</span><span> </span><span>d</span><span class="delimiter">]</span><span> 
</span><span>                        </span><span>ipurge_Cons</span><span class="delimiter">[</span><span>of</span><span> </span><span>a</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;[]&quot;</span></span></span><span> </span><span>d</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;{s}&quot;</span></span></span><span class="delimiter">]</span><span> </span><span>ipurge_Cons</span><span class="delimiter">[</span><span>of</span><span> </span><span>a</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;[]&quot;</span></span></span><span> </span><span>d</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;{t}&quot;</span></span></span><span class="delimiter">]</span><span> 
</span><span>                        </span><span>ipurge_Nil</span><span> </span><span>non_interference_def</span><span> </span><span>singletonD</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>                    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8882; [a] &#8773; t &#8882; [a] @ d&quot;</span></span></span><span> 
</span><span>                      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p1</span><span class="delimiter">[</span><span>of</span><span> </span><span>s</span><span> </span><span>t</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;[a]&quot;</span></span></span><span> </span><span>d</span><span class="delimiter">]</span><span> </span><span>a0</span><span> </span><span>a1</span><span> </span><span>c2</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span> 
</span><span>                    </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>b0</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>                      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>observ_equivalence_def</span><span> </span><span class="delimiter">)</span><span> 
</span><span>                  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>              </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>          </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;step_consistent&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>step_consistent_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>      </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>noninfl_eq_noninfl2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;weak_noninfluence = weak_noninfluence2&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>noninf2_imp_lr</span><span> </span><span>noninf2_imp_sc</span><span> </span><span>noninf_impl_weak</span><span> </span><span>noninfl_impl_noninfl2</span><span> </span><span>uc_eq_noninf</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>      
</span><span>    </span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>nonintf_r_and_nonlk_eq_strnoninfl</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(noninterference_r &#8743; nonleakage) = noninfluence&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>nonintf_r_and_nonlk_impl_noninfl</span><span> </span><span>noninf_impl_nonintf_r</span><span> </span><span>noninf_impl_nonlk</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span> 
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>wk_nonintf_r_and_nonlk_eq_noninfl</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(weak_noninterference_r &#8743; nonleakage) = weak_noninfluence&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>wk_noninfl_impl_nonlk</span><span> </span><span>wk_noninfl_impl_wk_nonintf_r</span><span> </span><span>wk_nonintf_r_and_nonlk_impl_noninfl</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>      
</span><span>  </span><span class="keyword2"><span class="keyword">end</span></span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span></pre>

</div>
</body>
</html>
