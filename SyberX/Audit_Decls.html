<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Theory Audit_Decls (Isabelle2019: June 2019)</title>
<link media="all" rel="stylesheet" type="text/css" href="isabelle.css"/>
</head>

<body>
<div class="head"><h1>Theory Audit_Decls</h1>

<span class="command">theory</span> <span class="name">Audit_Decls</span><br/>
<span class="keyword">imports</span> <a href="type_Decls.html"><span class="name">type_Decls</span></a><br/>

</div>
<div class="source">
<pre class="source"><span class="keyword1"><span class="command">theory</span></span><span> </span><span>Audit_Decls</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">imports</span></span><span> </span><span>type_Decls</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">datatype</span></span><span> </span><span>audit_event_type</span><span> </span><span class="delimiter">=</span><span> </span><span>AUDIT_EVENT_T_SYNC</span><span> </span><span class="delimiter">|</span><span>
</span><span>                                 </span><span>AUDIT_EVENT_T_HVC</span><span> </span><span class="delimiter">|</span><span>
</span><span>                                 </span><span>AUDIT_EVENT_T_SMC</span><span> </span><span class="delimiter">|</span><span>
</span><span>                                 </span><span>AUDIT_EVENT_T_IRQ</span><span>
</span><span class="keyword1"><span class="command">datatype</span></span><span> </span><span>audit_event_hvc_oper</span><span> </span><span class="delimiter">=</span><span> 
</span><span>                                </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* SYSTEM *)</span></span></span></span></span><span>
</span><span>                                </span><span>AUDIT_EVENT_HVC_O_SYS_RESET</span><span> </span><span class="delimiter">|</span><span>
</span><span>                                </span><span>AUDIT_EVENT_HVC_O_SYS_OFF</span><span> </span><span class="delimiter">|</span><span>
</span><span>                                </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* VMM *)</span></span></span></span></span><span>
</span><span>                                </span><span>AUDIT_EVENT_HVC_O_VMM_LIST_VM</span><span> </span><span class="delimiter">|</span><span>
</span><span>                                </span><span>AUDIT_EVENT_HVC_O_VMM_GET_VM_STATE</span><span> </span><span class="delimiter">|</span><span>
</span><span>                                </span><span>AUDIT_EVENT_HVC_O_VMM_SHUTDOWN_VM</span><span> </span><span class="delimiter">|</span><span>
</span><span>                                </span><span>AUDIT_EVENT_HVC_O_VMM_REBOOT_VM</span><span> </span><span class="delimiter">|</span><span>
</span><span>                                </span><span>AUDIT_EVENT_HVC_O_VMM_GET_VM_DEF_CFG</span><span> </span><span class="delimiter">|</span><span>
</span><span>                                </span><span>AUDIT_EVENT_HVC_O_VMM_SET_VM_CFG</span><span> </span><span class="delimiter">|</span><span>
</span><span>                                </span><span>AUDIT_EVENT_HVC_O_VMM_GET_VM_ID</span><span> </span><span class="delimiter">|</span><span>
</span><span>                                </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* IVC *)</span></span></span></span></span><span>
</span><span>                                </span><span>AUDIT_EVENT_HVC_O_IVC_UPDATE_MQ</span><span> </span><span class="delimiter">|</span><span>
</span><span>                                </span><span>AUDIT_EVENT_HVC_O_IVC_SEND_MSG</span><span> </span><span class="delimiter">|</span><span>
</span><span>                                </span><span>AUDIT_EVENT_HVC_O_IVC_BROADCAST_MSG</span><span> </span><span class="delimiter">|</span><span>
</span><span>                                </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* DEVICE *)</span></span></span></span></span><span>
</span><span>                                </span><span>AUDIT_EVENT_HVC_O_DEV_LIST_DEVS</span><span> </span><span class="delimiter">|</span><span>
</span><span>                                </span><span>AUDIT_EVENT_HVC_O_DEV_STATE</span><span> </span><span class="delimiter">|</span><span>
</span><span>                                </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* SECURITY *)</span></span></span></span></span><span>
</span><span>                                </span><span>AUDIT_EVENT_HVC_O_SECURITY_SET_CFG</span><span> </span><span class="delimiter">|</span><span>
</span><span>                                </span><span>AUDIT_EVENT_HVC_O_SECURITY_GET_DEF_CFG</span><span> </span><span class="delimiter">|</span><span>
</span><span>                                </span><span>AUDIT_EVENT_HVC_O_SECURITY_GET_CFG</span><span> </span><span class="delimiter">|</span><span>
</span><span>                                </span><span>AUDIT_EVENT_HVC_O_SECURITY_GET_LOG</span><span> </span><span class="delimiter">|</span><span>
</span><span>                                </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* others *)</span></span></span></span></span><span>
</span><span>                                </span><span>AUDIT_EVENT_HVC_O_UNKNOWN</span><span> </span><span class="delimiter">|</span><span>
</span><span>                                </span><span>AUDIT_EVENT_HVC_O_INVALIED</span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">datatype</span></span><span> </span><span>audit_resource_type</span><span> </span><span class="delimiter">=</span><span> 
</span><span>                              </span><span>AUDIT_RESOURCE_T_CPU</span><span> </span><span class="delimiter">|</span><span>
</span><span>                              </span><span>AUDIT_RESOURCE_T_MEM</span><span> </span><span class="delimiter">|</span><span>
</span><span>                              </span><span>AUDIT_RESOURCE_T_INTC</span><span> </span><span class="delimiter">|</span><span>
</span><span>                              </span><span>AUDIT_RESOURCE_T_INTID</span><span> </span><span class="delimiter">|</span><span>
</span><span>                              </span><span>AUDIT_RESOURCE_T_SERIAL</span><span> </span><span class="delimiter">|</span><span>
</span><span>                              </span><span>AUDIT_RESOURCE_T_BLK</span><span> </span><span class="delimiter">|</span><span>
</span><span>                              </span><span>AUDIT_RESOURCE_T_NET</span><span> </span><span class="delimiter">|</span><span>
</span><span>                              </span><span>AUDIT_RESOURCE_T_SYS</span><span> </span><span class="delimiter">|</span><span>
</span><span>                              </span><span>AUDIT_RESOURCE_T_VM</span><span> </span><span class="delimiter">|</span><span>
</span><span>                              </span><span>AUDIT_RESOURCE_T_NONE</span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">datatype</span></span><span> </span><span>audit_result</span><span> </span><span class="delimiter">=</span><span> </span><span>AUDIT_RESULT_T_SUCCEED</span><span> </span><span class="delimiter">|</span><span> </span><span>AUDIT_RESULT_T_FAILED</span><span> </span><span class="delimiter">|</span><span> </span><span>AUDIT_RESULT_T_UNKNOWN</span><span>
</span><span>
</span><span class="keyword1"><span class="command">record</span></span><span> </span><span>Audit</span><span> </span><span class="delimiter">=</span><span> </span><span>event</span><span> </span><span class="delimiter">::</span><span> </span><span>audit_event_type</span><span>
</span><span>               </span><span>oper</span><span> </span><span class="delimiter">::</span><span> </span><span>audit_event_hvc_oper</span><span>
</span><span>               </span><span>res_type</span><span> </span><span class="delimiter">::</span><span> </span><span>audit_resource_type</span><span>
</span><span>               </span><span>res_id</span><span> </span><span class="delimiter">::</span><span> </span><span>u32</span><span>
</span><span>               </span><span>result</span><span> </span><span class="delimiter">::</span><span> </span><span>audit_result</span><span>
</span><span>
</span><span class="keyword1"><span class="command">type_synonym</span></span><span> </span><span>audit</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;Audit list&quot;</span></span></span><span> 
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;write_Audit a b c d e&#8801; &#10631;event=a, oper=b, res_type=c, res_id=d, result=e&#10632;&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>audit_append_event</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot; Audit &#8658; (audit,unit)nondet_monad&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;audit_append_event a0 &#8801; 
  (do
    al &#8592; gets (&#955;&#963;.  &#963;);
    modify (&#955;&#963;. a0#al);
    return ()
  od)&quot;</span></span></span><span>
</span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*
definition audit_append_event :: &quot;audit_event_type &#8658; audit_event_hvc_oper &#8658; audit_resource_type &#8658; u64 &#8658; bool &#8658; (&#39;a, bool) nondet_monad&quot; where
  &quot;audit_append_event e op t rsc res &#8801; (return res)&quot;

term &quot;audit_append_event AUDIT_EVENT_T_HVC AUDIT_EVENT_HVC_O_IVC_UPDATE_MQ
                             AUDIT_RESOURCE_T_VM (64::u64) True&quot;
*)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">record</span></span><span> </span><span>Audit_State</span><span> </span><span class="delimiter">=</span><span> </span><span>a</span><span class="delimiter">::</span><span>nat</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span></pre>

</div>
</body>
</html>
