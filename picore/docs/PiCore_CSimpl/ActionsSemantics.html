<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Theory ActionsSemantics (Isabelle2018: August 2018)</title>
<link media="all" rel="stylesheet" type="text/css" href="isabelle.css"/>
</head>

<body>
<div class="head"><h1>Theory ActionsSemantics</h1>

<span class="command">theory</span> <span class="name">ActionsSemantics</span><br/>
<span class="keyword">imports</span> <a href="Sep_Prod_Instance.html"><span class="name">Sep_Prod_Instance</span></a> <a href="Sep_Heap_Instance.html"><span class="name">Sep_Heap_Instance</span></a> <a href="Sep_Tactics.html"><span class="name">Sep_Tactics</span></a><br/>

</div>
<div class="source">
<pre class="source"><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*
    Author:      David Sanan
    Maintainer:  David Sanan, sanan at ntu edu sg
    License:     LGPL
*)</span></span></span></span></span><span>
</span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*  Title:      ActionSemantics.thy
    Author:     David Sanan, NTU

Copyright (C) 2015-2016 David Sanan 
Some rights reserved, NTU
This library is free software; you can redistribute it and/or modify
it under the terms of the GNU Lesser General Public License as
published by the Free Software Foundation; either version 2.1 of the
License, or (at your option) any later version.

This library is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
Lesser General Public License for more details.

You should have received a copy of the GNU Lesser General Public
License along with this library; if not, write to the Free Software
Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307
USA
*)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">theory</span></span><span> </span><span>ActionsSemantics</span><span>
</span><span class="keyword2"><span class="keyword">imports</span></span><span> </span><span>Main</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;Sep_Prod_Instance&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;../lib/Sep_Algebra/Sep_Heap_Instance&quot;</span></span></span><span> 
</span><span>        </span><span class="string"><span class="delete"><span class="delete">&quot;../lib/Sep_Algebra/Sep_Tactics&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;../Separata/Separata&quot;</span></span></span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span> 
</span><span class="keyword1"><span class="command">section</span></span><span> </span><span class="verbatim"><span class="delete"><span class="delete"><span class="delete"><span class="delete">{* State definition *}</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="verbatim"><span class="delete"><span class="delete"><span class="delete"><span class="delete">{* 
The state is defined as a pair $(global variables\times local variables)$. Separation logic 
functions over the state will restrict it to be of type sep\_algebra*}</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">type_synonym</span></span><span> </span><span class="delimiter">(</span><span class="tfree">&#39;a</span><span class="delimiter">,</span><span class="tfree">&#39;b</span><span class="delimiter">)</span><span> </span><span>action_state</span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#39;a &#215; &#39;b)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">type_synonym</span></span><span> </span><span class="delimiter">(</span><span class="tfree">&#39;a</span><span class="delimiter">,</span><span class="tfree">&#39;b</span><span class="delimiter">)</span><span> </span><span>transition</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;((&#39;a,&#39;b) action_state &#215; (&#39;a,&#39;b) action_state)&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">section</span></span><span class="verbatim"><span class="delete"><span class="delete"><span class="delete"><span class="delete">{* Separation logic operations over the compound state *}</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>the_set</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#39;a &#8658; bool) &#8658;
                     (&#39;a set)&quot;</span></span></span><span>  </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* (&quot;&#8970; _ &#8971;&quot;  [60] 89) *)</span></span></span></span></span><span>
</span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span class="string"><span class="delete"><span class="delete">&quot;the_set a &#8801; {&#963;. a &#963;}&quot;</span></span></span><span> 
</span><span>
</span><span class="keyword1"><span class="command">section</span></span><span class="verbatim"><span class="delete"><span class="delete"><span class="delete"><span class="delete">{* Separation logic actions over transitions*}</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>after</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;((&#39;a,&#39;b) action_state &#8658;bool) &#8658; 
                     ((&#39;a, &#39;b) action_state &#8658;bool) &#8658; ((&#39;a, &#39;b) transition &#8658; bool)&quot;</span></span></span><span>
</span><span> </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">&quot;_ &#8885; _&quot;</span></span></span><span>  </span><span class="delimiter">[</span><span>60</span><span class="delimiter">,</span><span>20</span><span class="delimiter">]</span><span> </span><span>89</span><span class="delimiter">)</span><span>
</span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span class="string"><span class="delete"><span class="delete">&quot;a &#8885; b &#8801; (&#955;(&#963;,&#963;&#39;). (a &#963;) &#8743; (b &#963;&#39;))&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>afterD</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(a &#8885; b) (&#963;1,&#963;2) &#10233; (a &#963;1) &#8743; (b &#963;2)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>after_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>satis</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;((&#39;a, &#39;b) action_state &#8658;bool) &#8658;  
                     ((&#39;a, &#39;b) transition &#8658; bool)&quot;</span></span></span><span>  </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">&quot;&#8968; _ &#8969;&quot;</span></span></span><span>  </span><span class="delimiter">[</span><span>60</span><span class="delimiter">]</span><span> </span><span>89</span><span class="delimiter">)</span><span>
</span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span class="string"><span class="delete"><span class="delete">&quot;&#8968; a &#8969; &#8801; (&#955;(&#963;,&#963;&#39;). (&#963;=&#963;&#39;) &#8743; (a &#963;))&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>satisD</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;((&#8968; a &#8969;) (&#963;,&#963;&#39;)) = ((&#963;=&#963;&#39;) &#8743; (a &#963;))&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>satis_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>satisI</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#963;=&#963;&#39; &#10233; a &#963; &#10233; (&#8968; a &#8969;) (&#963;,&#963;&#39;)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>satisD</span><span class="delimiter">)</span><span>
</span><span>                               
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>Emp</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#39;a::sep_algebra, &#39;b::sep_algebra) transition &#8658; bool&quot;</span></span></span><span>
</span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span class="string"><span class="delete"><span class="delete">&quot;Emp &#8801; (&#955;(a,b). (sep_empty &#8885; sep_empty) (a,b))&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>Emp_iff_sep_empty</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;Emp = sep_empty&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Emp_def</span><span> </span><span>zero_prod_def</span><span> </span><span>sep_empty_def</span><span> </span><span>after_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>tran_True</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#39;a::sep_algebra, &#39;b::sep_algebra) transition &#8658; bool&quot;</span></span></span><span>
</span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span class="string"><span class="delete"><span class="delete">&quot;tran_True &#8801; sep_true &#8885; sep_true&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>tran_True_true</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;tran_True = sep_true&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>tran_True_def</span><span> </span><span>sep_empty_def</span><span> </span><span>after_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>                
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>tran_Id</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#39;a::sep_algebra, &#39;b::sep_algebra) transition &#8658; bool&quot;</span></span></span><span>
</span><span class="keyword2"><span class="keyword">where</span></span><span> 
</span><span class="string"><span class="delete"><span class="delete">&quot;tran_Id &#8801; &#8968; sep_true &#8969;&quot;</span></span></span><span> 
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>tran_Id_eq</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;tran_Id (y&#39;,y&#39;&#39;) = (y&#39; = y&#39;&#39;)&quot;</span></span></span><span>
</span><span>       </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>satis_def</span><span> </span><span>tran_Id_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>tran_Id_idem</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;tran_Id y &#10233; tran_Id (y + (&#963;&#39;,&#963;&#39;))&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>     </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;tran_Id y&quot;</span></span></span><span>
</span><span>     </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>y1</span><span> </span><span>y2</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>y_val</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;y = (y1,y2)&quot;</span></span></span><span> 
</span><span>       </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>surjective_pairing</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>     
</span><span>     </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;y1=y2&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a1</span><span> </span><span>y_val</span><span> </span><span>tran_Id_eq</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>     
</span><span>     </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;y + (&#963;&#39;,&#963;&#39;) = ((y1 + &#963;&#39;),(y1 + &#963;&#39;))&quot;</span></span></span><span> 
</span><span>       </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>y_val</span><span> </span><span>plus_prod_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span>
</span><span>     </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;tran_Id (y + (&#963;&#39;,&#963;&#39;))&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>tran_Id_eq</span><span class="delimiter">)</span><span>        
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>sep_conj_train_Id</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;G s &#10233; (G&#8743;*tran_Id) s&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>sep_add_zero</span><span> </span><span>sep_conj_def</span><span> </span><span>sep_disj_zero</span><span> </span><span>tran_Id_eq</span><span> </span><span>zero_prod_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>sep_conj_train_True</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;G s &#10233; (G&#8743;*tran_True) s&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;G s&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;p. tran_True (p::(&#39;a &#215; &#39;b) &#215; _ &#215; _)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>after_def</span><span> </span><span>tran_True_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">thus</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a1</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>meson</span><span> </span><span>pure_conj_sep_conj</span><span> </span><span>pure_split</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>Satis</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;((&#39;a, &#39;b) transition &#8658; bool) &#8658;
                     ((&#39;a,&#39;b) transition set)&quot;</span></span></span><span>  </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">&quot;&#8970; _ &#8971;&quot;</span></span></span><span>  </span><span class="delimiter">[</span><span>60</span><span class="delimiter">]</span><span> </span><span>89</span><span class="delimiter">)</span><span>
</span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span class="string"><span class="delete"><span class="delete">&quot;Satis a &#8801; Collect a&quot;</span></span></span><span>
</span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>dist_star_after</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;t. ((((p ** p&#39;) &#8885; (q ** q&#39;)) t) = (((p &#8885; q) ** (p&#39; &#8885; q&#39;)) t))&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>sep_conj_def</span><span> </span><span>after_def</span><span>
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span>sep_disj_prod_def</span><span> </span><span>plus_prod_def</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>imp_after</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;(&#8704;t. (p imp p&#39;) t) &#10233; 
                 (&#8704;t. (q imp q&#39;) t) &#10233; (&#8704;t. ((p &#8885; q) imp (p&#39; &#8885; q&#39;)) t)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>after_def</span><span>
</span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>or_after1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;((p or p&#39;) &#8885; q) = ((p &#8885; q) or (p&#39; &#8885; q))&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>after_def</span><span>
</span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>satis_after</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#8704;t. (&#8968; p &#8969;) t) &#10233; (&#8704;t. (p &#8885; p) t)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>after_def</span><span> </span><span>satis_def</span><span>
</span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>satis_id</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;t. (&#8968; p &#8969;) t &#10230; tran_Id t&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>satis_def</span><span> </span><span>tran_Id_def</span><span>
</span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>or_after2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(p &#8885; (q or q&#39;)) = ((p &#8885; q) or (p &#8885; q&#39;))&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>after_def</span><span>
</span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span> 
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>satis_emp</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot; (&#8968; sep_empty &#8969;) = Emp&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Emp_def</span><span> </span><span>sep_empty_def</span><span> </span><span>after_def</span><span>  </span><span>satis_def</span><span>
</span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>action_true</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;a t &#10233; tran_True t&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>after_def</span><span> </span><span>tran_True_def</span><span>
</span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>                   
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>or_sep</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#8704;t. (a<span class="hidden">&#8681;</span><sub>1</sub> imp a<span class="hidden">&#8681;</span><sub>1</sub>&#39;) t) &#10233; (&#8704;t. (a<span class="hidden">&#8681;</span><sub>2</sub> imp a<span class="hidden">&#8681;</span><sub>2</sub>&#39;) t) &#10233; (&#8704;t. ((a<span class="hidden">&#8681;</span><sub>1</sub> &#8743;* a<span class="hidden">&#8681;</span><sub>2</sub>) imp (a<span class="hidden">&#8681;</span><sub>1</sub>&#39; &#8743;* a<span class="hidden">&#8681;</span><sub>2</sub>&#39;)) t)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>sep_conj_def</span><span>
</span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>empty_neutral1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(a &#8743;* Emp) t &#10233; a t&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp_all</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Emp_iff_sep_empty</span><span class="delimiter">)</span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*unfolding  after_def sep_empty_def using Emp_iff_sep_empty
apply (simp only:Emp_iff_sep_empty)
by separata*)</span></span></span></span></span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*unfolding Emp_def after_def sep_empty_def sep_conj_def
apply auto
by (metis sep_add_zero zero_prod_def)*)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>empty_neutral2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;a t &#10233; (a &#8743;* Emp) t&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp_all</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Emp_iff_sep_empty</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*unfolding  after_def sep_empty_def using Emp_iff_sep_empty
apply (simp only:Emp_iff_sep_empty)
by separata*)</span></span></span></span></span><span>
</span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*proof -
  assume a1: &quot;a t&quot;
  have f2: &quot;t ## (0, 0)&quot;
    by (metis sep_disj_zero zero_prod_def)
  have &quot;t = t + (0, 0)&quot;
    by (metis sep_add_zero zero_prod_def)
  thus &quot;&#8707;p pa. p ## pa &#8743; t = p + pa &#8743; a p &#8743; (case pa of (p, pa) &#8658; case (p, pa) of (p, pa) &#8658; p = 0 &#8743; pa = 0)&quot;
    using f2 a1 by blast
qed*)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>empty_neutral&#39;</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(a &#8743;* Emp) t = a t&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Emp_iff_sep_empty</span><span> </span><span>after_def</span><span class="delimiter">)</span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*by (fastforce intro: empty_neutral1 empty_neutral2)*)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>empty_neutral</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(a &#8743;* Emp) = a&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>empty_neutral&#39;</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>star_op_comm</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(a&#8743;*a&#39;) = (a&#39;&#8743;*a)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">by</span></span><span> </span><span>separata</span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*by (simp add: Separation_Algebra.sep.mult.commute)*)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>sep_conj_conj1</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;((&#955;r. (Q r) &#8743; (Q&#39; r)) &#8743;* P) h &#10233; 
                     (((&#955;r. Q r)  &#8743;* P)  and ((&#955;r. Q&#39; r) &#8743;* P)) (h::&#39;a::heap_sep_algebra)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">by</span></span><span> </span><span>separata</span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*using  Separation_Algebra.sep_algebra_class.sep_conj_conj by auto*)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(a ** sep_true) h &#10233; (h,h&#39;&#9657;h&#39;&#39;) &#10233; (a ** sep_true) h&#39;&#39;&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">by</span></span><span> </span><span>separata</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>id_pair_comb</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;((x,x),(y,y)&#9657;(z,z&#39;)) &#10233; z = z&#39;&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">using</span></span><span> </span><span>disj_union_dist2</span><span> </span><span>tern_rel_def</span><span> </span><span>tern_rel_def</span><span>
</span><span class="keyword1"><span class="command">by</span></span><span> </span><span>metis</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>tern_pair</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#963;1, &#963;&#39;&#9657; &#963;1&#39;) &#10233; (&#963;2, &#963;&#39;&#39;&#9657; &#963;2&#39;) &#10233;
  ((&#963;1,&#963;2),(&#963;&#39;,&#963;&#39;&#39;)&#9657;(&#963;1&#39;,&#963;2&#39;))&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">using</span></span><span> </span><span>disj_union_dist2</span><span> </span><span>tern_rel_def</span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#963;1, &#963;&#39;&#9657; &#963;1&#39;)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#963;2, &#963;&#39;&#39;&#9657; &#963;2&#39;)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;((&#963;1,&#963;2),(&#963;&#39;,&#963;&#39;&#39;)&#9657;(&#963;1&#39;,&#963;2&#39;))&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a1</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>disj_union_dist</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>tern_rel_def</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>tern_dist1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;((&#963;1, &#963;&#39;&#9657; &#963;1&#39;) &#8743; (&#963;2, &#963;&#39;&#39;&#9657; &#963;2&#39;)) &#10233;
  ((&#963;1,&#963;2),(&#963;&#39;,&#963;&#39;&#39;)&#9657;(&#963;1&#39;,&#963;2&#39;))&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">using</span></span><span> </span><span>disj_union_dist2</span><span> </span><span>tern_rel_def</span><span>
</span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>tern_pair</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">method</span></span><span> </span><span>comb_du_pair</span><span> </span><span class="delimiter">=</span><span> </span><span class="delimiter">(</span><span>
</span><span>match</span><span> </span><span class="keyword2"><span class="keyword">premises</span></span><span> </span><span class="keyword2"><span class="keyword">in</span></span><span> </span><span>P</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;(?h1, ?h&#39;&#9657; ?h1&#39;) &#8743; (?h2, ?h&#39;&#39;&#9657; ?h2&#39;)&quot;</span></span></span><span> </span><span class="delimiter">&#8658;</span><span> 
</span><span>  </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;insert P, drule tern_dist1&#8250;</span></span></span><span class="delimiter">,</span><span>
</span><span>simp</span><span class="delimiter">?</span><span>
</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;(a &#8743;* tran_Id) (&#963;1,&#963;2) &#10233; 
   ((&#963;1,&#963;2),(&#963;&#39;,&#963;&#39;)&#9657;(&#963;1&#39;,&#963;2&#39;)) &#10233;
   (a &#8743;* tran_Id) (&#963;1&#39;,&#963;2&#39;)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>tran_Id_def</span><span> </span><span>satis_def</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">using</span></span><span> </span><span>id_pair_comb</span><span>
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>separata</span><span>
</span><span class="keyword1"><span class="command">by</span></span><span> </span><span>separata</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>conj_sep_id</span><span class="delimiter">:</span><span> 
</span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(a &#8743;* tran_Id) (&#963;1,&#963;2)&quot;</span></span></span><span> 
</span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>a2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#963;1,&#963;&#39;&#9657;&#963;1&#39;) &#8743; (&#963;2,&#963;&#39;&#9657;&#963;2&#39;)&quot;</span></span></span><span>
</span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(a &#8743;* tran_Id) (&#963;1&#39;,&#963;2&#39;)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>a2</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;((&#963;1,&#963;2),(&#963;&#39;,&#963;&#39;)&#9657;(&#963;1&#39;,&#963;2&#39;))&quot;</span></span></span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span class="delimiter">(</span><span>full_types</span><span class="delimiter">)</span><span> </span><span>tern_dist1</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a1</span><span> </span><span>id_pair_comb</span><span>
</span><span>    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>tran_Id_def</span><span> </span><span>satis_def</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>separata</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*
lemma conj_sep_id: &quot;(a &#8743;* tran_Id) (&#963;1,&#963;2) &#10233; 
  (&#963;1 &#8846;<span class="hidden">&#8681;</span><sub>p</sub> &#963;&#39;) &#963;1&#39; &#8743; (&#963;2 &#8846;<span class="hidden">&#8681;</span><sub>p</sub> &#963;&#39;) &#963;2&#39; &#10233;
  (a &#8743;* tran_Id) (&#963;1&#39;,&#963;2&#39;)&quot;
unfolding sep_conj_def 
proof -
  assume a1:&quot;&#8707;x y. x ## y &#8743; (&#963;1, &#963;2) = x + y &#8743; a x &#8743; tran_Id y&quot;
  then obtain x y where 
        unfold_pr:&quot;x ## y &#8743; 
         (&#963;1, &#963;2) = x + y &#8743; 
         a x &#8743; tran_Id y&quot; by auto
  then have split_x_y:&quot;(x &#8846;<span class="hidden">&#8681;</span><sub>p</sub> y) (&#963;1,&#963;2)&quot; by (simp add: sep_split_def) 
  assume a2:&quot;(&#963;1 &#8846;<span class="hidden">&#8681;</span><sub>p</sub> &#963;&#39;) &#963;1&#39; &#8743; (&#963;2 &#8846;<span class="hidden">&#8681;</span><sub>p</sub> &#963;&#39;) &#963;2&#39;&quot;
  then have &quot;((&#963;1,&#963;2) &#8846;<span class="hidden">&#8681;</span><sub>p</sub> (&#963;&#39;,&#963;&#39;)) (&#963;1&#39;,&#963;2&#39;)&quot;
   by (simp add: disj_union_dist1)
  then have new_split:&quot;(x  &#8846;<span class="hidden">&#8681;</span><sub>p</sub> (y + (&#963;&#39;,&#963;&#39;))) (&#963;1&#39;,&#963;2&#39;)&quot; 
   using sep_split_assoc split_x_y by blast  
  have tran_id_y: &quot;tran_Id (y + (&#963;&#39;,&#963;&#39;))&quot;    
  proof -
     obtain y1 y2 where y_val:&quot;y = (y1,y2)&quot; 
       using surjective_pairing by blast     
     then have &quot;y1=y2&quot; using unfold_pr y_val tran_Id_eq by blast     
     then have &quot;y + (&#963;&#39;,&#963;&#39;) = ((y1 + &#963;&#39;),(y1 + &#963;&#39;))&quot; 
       using y_val plus_prod_def by fastforce
     then show &quot;tran_Id (y + (&#963;&#39;,&#963;&#39;))&quot; by (simp add: tran_Id_eq)       
   qed          
  thus &quot;&#8707;x y. x ## y &#8743; (&#963;1&#39;, &#963;2&#39;) = x + y &#8743; a x &#8743; tran_Id y&quot;  
    using new_split sep_split_def unfold_pr by metis
qed
*)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">section</span></span><span> </span><span class="verbatim"><span class="delete"><span class="delete"><span class="delete"><span class="delete">{* Stability *}</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span class="verbatim"><span class="delete"><span class="delete"><span class="delete"><span class="delete">{* 

 We define an assertion $p$ to be stable with regard an action $a$ if for each $(\sigma,\sigma&#39;)$,
$p\ \sigma$ and $a (\sigma,\sigma&#39;)$ then $p \sigma$

*}</span></span></span></span></span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*definition Sta :: &quot;((&#39;a, &#39;b)action_state &#8658;bool)&#8658;
                   ((&#39;a::sep_algebra, &#39;b::sep_algebra) transition&#8658;bool) &#8658;bool&quot;
where
&quot;Sta p a &#8801; (&#8704;&#963; &#963;&#39;. 
            ((p &#963;) &#8743; (a (&#963;,&#963;&#39;))) &#10230; (p &#963;&#39;))&quot; *)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>Sta</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;((&#39;a, &#39;b)action_state &#8658;bool)&#8658;
                   ((&#39;a::heap_sep_algebra, &#39;b::heap_sep_algebra) transition&#8658;bool) &#8658;bool&quot;</span></span></span><span>
</span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span class="string"><span class="delete"><span class="delete">&quot;Sta p a &#8801; (&#8704;&#963; &#963;&#39;. 
            ((p &#963;) &#8743; (a (&#963;,&#963;&#39;))) &#10230; (p &#963;&#39;))&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span class="verbatim"><span class="delete"><span class="delete"><span class="delete"><span class="delete">{* 
We prove the following lemmas:
*}</span></span></span></span></span><span>
</span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*
lemma &quot;&#8704;a b. (q &#8743;* (&#955;s. &#172; (p &#10230;* (&#955;s. &#172; r s)) s &#8743; &#9633; s)) (a, b) &#10230; r (a, b) &#10233;
       r (a, b) &#10233; p (a, b) &#10233; q (aa, ba) &#10233; (0,0&#9657;0) &#10233; ((a, b),0&#9657;(a, b)) &#10233; (0,(a, b)&#9657;(a, b)) &#10233; r (aa, ba)&quot;
proof -
  assume a0:&quot;&#8704;a b. (q &#8743;* (&#955;s. &#172; (p &#10230;* (&#955;s. &#172; r s)) s &#8743; &#9633; s)) (a, b) &#10230; r (a, b)&quot; and
         a1: &quot;r (a, b)&quot; and 
         a2: &quot;p (a, b)&quot; and 
         a3: &quot;q (aa, ba)&quot; and
         a4:&quot;(0,0&#9657;0)&quot; and
         a5:&quot;((a, b),0&#9657;(a, b))&quot; and
         a6:&quot; (0,(a, b)&#9657;(a, b))&quot;
 then have &quot;(q &#8743;* (&#955;s. &#172; (p &#10230;* (&#955;s. &#172; r s)) s &#8743; &#9633; s)) (aa, ba) &#10230; r (aa, ba)&quot;
 using a0 by auto 
 
 then show &quot;r (aa, ba)&quot;
 using a1 a2 a3 a4 a5 a6
 sorry
qed
*)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>lem1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;r (a, b) &#10233; p (a, b) &#10233; q (aa, ba) &#10233; 
(q &#8743;* (not (p &#10230;* (not r)) and &#9633;)) ((aa::&#39;a::heap_sep_algebra), (ba::&#39;b::heap_sep_algebra))&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">by</span></span><span> </span><span>separata</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> 
</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;Sta r (p &#8885; q) = 
 (&#8704;&#963;. ((((p  &#10230;&#8853; r) and sep_empty) &#8743;* q) imp r) &#963;)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Sta_def</span><span> </span><span>after_def</span><span> </span><span>satis_def</span><span> 
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>auto</span><span>
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>separata</span><span>
</span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>lem1</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*
lemma 
&quot;Sta r ((p &#8885; q)&#8743;*tran_Id) &#10233;
  (((p &#10230;&#8853; r) &#8743;* q) imp r) &#963;&quot;
unfolding Sta_def after_def satis_def tran_Id_def 
proof auto
assume a1: &quot;&#8704;a b aa ba. r (a, b) &#8743; ((&#955;(&#963;, &#963;&#39;). p &#963; &#8743; q &#963;&#39;) &#8743;* (&#955;(x, y). x = y)) ((a, b), aa, ba) &#10230; r (aa, ba)&quot;
assume a2: &quot; ((&#955;s. &#172; (p &#10230;* (&#955;s. &#172; r s)) s) &#8743;* q) &#963;&quot;
show &quot;r &#963;&quot; using a1 a2
  sorry
qed
*)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>l1</span><span class="delimiter">:</span><span>
</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;Sta r (p &#8885; q) = 
 (&#8704;&#963;. ((((p  &#10230;&#8853; r) and sep_empty) &#8743;* q) imp r) &#963;)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Sta_def</span><span> </span><span>after_def</span><span> </span><span>satis_def</span><span> </span><span>sep_conj_def</span><span> </span><span>sep_impl_def</span><span>
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>sep_empty_def</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span class="delimiter">(</span><span>no_types</span><span class="delimiter">,</span><span> </span><span>lifting</span><span class="delimiter">)</span><span> </span><span>sep_add_zero_sym</span><span> </span><span>sep_disj_commuteI</span><span> </span><span>sep_disj_zero</span><span> </span><span>sep_empty_zero</span><span> </span><span>zero_prod_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>l2</span><span class="delimiter">:</span><span>
</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#8704;&#963;.(((p &#10230;&#8853; r) &#8743;* q) imp r) &#963;) &#10233; Sta r (p &#8885; q) &quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Sta_def</span><span> </span><span>after_def</span><span> </span><span>satis_def</span><span> </span><span>sep_conj_def</span><span> </span><span>sep_impl_def</span><span>
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>auto</span><span>
</span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span class="delimiter">(</span><span>no_types</span><span class="delimiter">,</span><span> </span><span>lifting</span><span class="delimiter">)</span><span> </span><span>sep_add_disjI2</span><span> </span><span>sep_add_zero_sym</span><span> </span><span>sep_disj_zero</span><span>  </span><span>zero_prod_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>l31</span><span class="delimiter">:</span><span>
</span><span class="string"><span class="delete"><span class="delete">&quot;Sta r ((p &#8885; q)&#8743;*tran_Id) &#10233;
  (&#8704;&#963;.(((p &#10230;&#8853; r) &#8743;* q) imp r) &#963;)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Sta_def</span><span> </span><span>after_def</span><span> </span><span>satis_def</span><span> </span><span>sep_conj_def</span><span> </span><span>sep_impl_def</span><span> </span><span>tran_Id_def</span><span> </span><span>sep_disj_prod_def</span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>a</span><span> </span><span>b</span><span> </span><span>aa</span><span> </span><span>ba</span><span> </span><span>ab</span><span> </span><span>bb</span><span> </span><span>ac</span><span> </span><span>bc</span><span> 
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;q (ab, bb)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p (ac, bc)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a3</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;aa ## ab&quot;</span></span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a4</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;ba ## bb&quot;</span></span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a5</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;aa ## ac&quot;</span></span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a6</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;ba ## bc&quot;</span></span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a7</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;a b aa ba.
              r (a, b) &#8743;
             (&#8707;ab bb ac bc ad.
                ab ## ad &#8743;
                (&#8707;bd. bb ## bd &#8743;
                      ac ## ad &#8743;
                      bc ## bd &#8743;
                      ((a, b), aa, ba) = ((ab, bb), ac, bc) + ((ad, bd), ad, bd) &#8743;
                      p (ab, bb) &#8743; q (ac, bc))) &#10230;
             r (aa, ba)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a8</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;r ((aa, ba) + (ac, bc))&quot;</span></span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a9</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(a, b) = (aa, ba) + (ab, bb)&quot;</span></span></span><span>  
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>aa</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;(a,b) = (aa + ab, ba + bb)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>plus_prod_def</span><span class="delimiter">)</span><span>   
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>bb</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;a = aa + ab &#8743; b = ba + bb&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>force</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(aa+ac, ba+bc) = (aa,ba)+(ac,bc)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>plus_prod_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;r (aa+ac, ba+bc)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a8</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>a8</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>na8</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;r (aa + ac, ba + bc)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>plus_prod_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>sum</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;((aa+ac,ba+bc),aa + ab, ba + bb) =  ((ac,bc),ab,bb) + ((aa,ba),aa,ba)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>      </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;ba + bc = bc + ba&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>a6</span><span> </span><span>sep_add_commute</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;ba + bb = bb + ba&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>a4</span><span> </span><span>sep_add_commute</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f3</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;aa + ac = ac + aa&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>a5</span><span> </span><span>sep_add_commute</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;aa + ab = ab + aa&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>meson</span><span> </span><span>a3</span><span> </span><span>sep_add_commute</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword3"><span class="command">thus</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>        </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>f3</span><span> </span><span>f2</span><span> </span><span>f1</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>plus_prod_def</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;f fa. &#172;f ## fa &#8744; fa ## f&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>sep_disj_commuteI</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span> 
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;r (aa + ab, ba + bb)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>na8</span><span> </span><span>a7</span><span> </span><span>a6</span><span> </span><span>a5</span><span> </span><span>a4</span><span> </span><span>a3</span><span> </span><span>a2</span><span> </span><span>a1</span><span> </span><span>sum</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>metis</span><span>
</span><span>  </span><span class="keyword3"><span class="command">thus</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;r ((aa, ba) + (ab, bb))&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span class="alt_string"><span class="delete"><span class="delete">`r (aa + ab, ba + bb)`</span></span></span><span> </span><span>plus_prod_def</span><span> </span><span>sep_add_commute</span><span class="delimiter">)</span><span>      
</span><span>   
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>l32</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;(&#8704;&#963;.(((p &#10230;&#8853; r) &#8743;* q) imp r) &#963;) &#10233;
     Sta r ((p &#8885; q)&#8743;*tran_Id)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Sta_def</span><span> </span><span>after_def</span><span> </span><span>satis_def</span><span> </span><span>sep_conj_def</span><span> </span><span>sep_impl_def</span><span> </span><span>tran_Id_def</span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span class="delimiter">)</span><span> 
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>a</span><span> </span><span>b</span><span> </span><span>aa</span><span> </span><span>ba</span><span> </span><span>ab</span><span> </span><span>bb</span><span> </span><span>ac</span><span> </span><span>bc</span><span> </span><span>ad</span><span> </span><span>bd</span><span> 
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p (ab, bb)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;((ab, bb), ac, bc) ## ((ad, bd), ad, bd)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a3</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;((a, b), aa, ba) = ((ab, bb), ac, bc) + ((ad, bd), ad, bd)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a4</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;q (ac, bc)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a5</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;a b. 
             (&#8707;aa ba ab bb. (aa, ba) ## (ab, bb) &#8743; 
                            (a, b) = (aa, ba) + (ab, bb) &#8743; 
                            (&#8707;a b. (aa, ba) ## (a, b) &#8743; 
                                   p (a, b) &#8743; r ((aa, ba) + (a, b))) &#8743; 
                             q (ab, bb)) &#10230; 
              r (a, b)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a6</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;r (a, b)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f7</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;p pa. &#172; (p::(&#39;a &#8658; &#39;b option) &#215; (&#39;a &#8658; &#39;b option)) ## pa &#8744; pa ## p&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>sep_disj_commuteI</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(a, b) = (ab, bb) + (ad, bd) &#8743; 
        (ab, bb) ## (ad, bd) &#8743; (ac, bc) ## (ad, bd) &#8743; 
        (aa, ba) = (ac, bc) + (ad, bd)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a3</span><span> </span><span>a2</span><span> </span><span>dis_sep</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword3"><span class="command">thus</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;r (aa, ba)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>f7</span><span> </span><span>a6</span><span> </span><span>a5</span><span> </span><span>a4</span><span> </span><span>a1</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>sep_add_commute</span><span> </span><span>sep_disj_commuteI</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>l3</span><span class="delimiter">:</span><span>
</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;Sta r ((p &#8885; q)&#8743;*tran_Id) = 
  (&#8704;&#963;.(((p &#10230;&#8853; r) &#8743;* q) imp r) &#963;)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">using</span></span><span> </span><span>l31</span><span> </span><span>l32</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span class="keyword1"><span class="command">section</span></span><span> </span><span class="verbatim"><span class="delete"><span class="delete"><span class="delete"><span class="delete">{* Fence *}</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>Fence</span><span class="delimiter">::</span><span class="string"><span class="delete"><span class="delete">&quot;((&#39;a::heap_sep_algebra, &#39;b::heap_sep_algebra) action_state &#8658;bool) &#8658;  
                     ((&#39;a, &#39;b) transition &#8658; bool) &#8658; bool&quot;</span></span></span><span>  </span><span class="delimiter">(</span><span class="string"><span class="delete"><span class="delete">&quot;_ &#10781; _&quot;</span></span></span><span>  </span><span class="delimiter">[</span><span>60</span><span class="delimiter">]</span><span> </span><span>89</span><span class="delimiter">)</span><span>
</span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span class="string"><span class="delete"><span class="delete">&quot;I  &#10781; a &#8801; &#8704;&#963;1 &#963;2. (&#8968; I &#8969; imp a)(&#963;1,&#963;2) &#8743; (a imp (I &#8885; I))(&#963;1,&#963;2) &#8743; (precise I)
&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>fenceD</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(I  &#10781; a) &#10233; (&#963;1,&#963;2)=(&#963;1,&#963;2) &#10233; (&#8968; I &#8969; imp a)(&#963;1,&#963;2) &#8743; (a imp (I &#8885; I))(&#963;1,&#963;2) &#8743; (precise I)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">using</span></span><span> </span><span>Fence_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span class="delimiter">(</span><span>no_types</span><span class="delimiter">)</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>fence1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;precise I &#10233; I  &#10781; &#8968;I&#8969;&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Fence_def</span><span> </span><span>after_def</span><span> </span><span>satis_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>fence2</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;precise I &#10233; I  &#10781; (I &#8885; I)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Fence_def</span><span> </span><span>after_def</span><span> </span><span>satis_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>fence3</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;I  &#10781; a &#10233; I  &#10781; a&#39; &#10233; I  &#10781; (a or a&#39;)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Fence_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>fence41</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot; I  &#10781; a &#10233; I&#39;  &#10781; a&#39; &#10233;precise (I &#8743;* I&#39;)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Fence_def</span><span> </span><span>precise_sep_conj</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>fence42</span><span class="delimiter">:</span><span> 
</span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot; I  &#10781; a&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span>
</span><span>        </span><span>a2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;I&#39; &#10781; a&#39;&quot;</span></span></span><span> 
</span><span> </span><span class="keyword2"><span class="keyword">shows</span></span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;&#963;1 &#963;2. ((a &#8743;* a&#39;) imp ((I &#8743;* I&#39;) &#8885; (I &#8743;* I&#39;))) (&#963;1,&#963;2)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span>  </span><span class="delimiter">(</span><span>clarsimp</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>aa</span><span> </span><span>b</span><span> </span><span>aaa</span><span> </span><span>ba</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a1e</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;&#963;1 &#963;2. (&#8968; I &#8969; imp a)(&#963;1,&#963;2) &#8743; (a imp (I &#8885; I))(&#963;1,&#963;2) &#8743; (precise I)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a1</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Fence_def</span><span class="delimiter">)</span><span> 
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a2e</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;&#963;1 &#963;2. (&#8968; I&#39; &#8969; imp a&#39;)(&#963;1,&#963;2) &#8743; (a&#39; imp (I&#39; &#8885; I&#39;))(&#963;1,&#963;2) &#8743; (precise I&#39;)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a2</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Fence_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(a &#8743;* a&#39;) ((aa,b), (aaa,ba))&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>x</span><span> </span><span>y</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>sep_conji</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;x ## y &#8743; (((aa,b), (aaa,ba)) = x + y) &#8743; a x &#8743; a&#39; y&quot;</span></span></span><span> 
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>sep_conjD</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>metis</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>x1</span><span> </span><span>x2</span><span> </span><span>y1</span><span> </span><span>y2</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>yv</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;x=(x1,x2) &#8743; y = (y1,y2)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>surjective_pairing</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span> 
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>hpi</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(a imp (I &#8885; I)) (x1,x2)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a1e</span><span> </span><span>sep_conji</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>hpi&#39;</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(a&#39; imp (I&#39; &#8885; I&#39;)) (y1,y2)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a2e</span><span> </span><span>sep_conji</span><span> </span><span>yv</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span> 
</span><span>  </span><span class="keyword3"><span class="command">thus</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;((I &#8743;* I&#39;) &#8885; (I &#8743;* I&#39;)) ((aa,b), (aaa,ba))&quot;</span></span></span><span> 
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>hpi&#39;</span><span> </span><span>hpi</span><span> </span><span>sep_conji</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span class="delimiter">(</span><span>no_types</span><span class="delimiter">)</span><span> </span><span>dist_star_after</span><span> </span><span>sep_conjI</span><span> </span><span>yv</span><span class="delimiter">)</span><span> 
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>fence43</span><span class="delimiter">:</span><span> 
</span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot; I  &#10781; a&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span>
</span><span>        </span><span>a2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;I&#39; &#10781; a&#39;&quot;</span></span></span><span> 
</span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;&#963;1 &#963;2.(&#8968; (I &#8743;* I&#39;) &#8969; imp (a &#8743;* a&#39;))(&#963;1,&#963;2)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span>  </span><span class="delimiter">(</span><span>clarsimp</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>aa</span><span> </span><span>b</span><span> </span><span>aaa</span><span> </span><span>ba</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a1e</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;&#963;1 &#963;2. (&#8968; I &#8969; imp a)(&#963;1,&#963;2) &#8743; (a imp (I &#8885; I))(&#963;1,&#963;2) &#8743; (precise I)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a1</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Fence_def</span><span class="delimiter">)</span><span> 
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>a2e</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;&#963;1 &#963;2. (&#8968; I&#39; &#8969; imp a&#39;)(&#963;1,&#963;2) &#8743; (a&#39; imp (I&#39; &#8885; I&#39;))(&#963;1,&#963;2) &#8743; (precise I&#39;)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a2</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Fence_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>ass1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#8968; (I &#8743;* I&#39;) &#8969;) ((aa, b), aaa, ba)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>x</span><span> </span><span>y</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>pair_split</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;(x,y) = ((aa, b), aaa, ba)&quot;</span></span></span><span>  
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>surjective_pairing</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>ass1split</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#8968; (I &#8743;* I&#39;) &#8969;) (x,y)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>ass1</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>satis_I</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;x = y &#8743; (I &#8743;* I&#39;) x&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>satisD</span><span class="delimiter">[</span><span>of</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(I &#8743;* I&#39;)&quot;</span></span></span><span> </span><span>x</span><span> </span><span>y</span><span class="delimiter">]</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>x1</span><span> </span><span>y1</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> 
</span><span>  </span><span>sep_conji</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;x1 ## y1 &#8743; (x = x1 + y1) &#8743; I x1 &#8743; I&#39; y1&quot;</span></span></span><span> 
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>sep_conjD</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>metis</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(x,y) = (x1 + y1, x1 + y1)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>satis_I</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span> 
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>xy_add</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;(x,y) = (x1,x1)+(y1,y1)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>plus_prod_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>xy_disj</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;(x1,x1)##(y1,y1)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>sep_conji</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>sep_disj_prod_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#8968; I &#8969;) (x1,x1) &#8743; (&#8968; I&#39; &#8969;) (y1,y1)&quot;</span></span></span><span>  
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>satisI</span><span> </span><span>sep_conji</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;a (x1,x1) &#8743; a&#39; (y1,y1)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a1e</span><span> </span><span>a2e</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>  
</span><span>  </span><span class="keyword3"><span class="command">thus</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(a &#8743;* a&#39;) ((aa, b), aaa, ba)&quot;</span></span></span><span> 
</span><span>   </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>xy_add</span><span> </span><span>xy_disj</span><span> </span><span>sep_conj_def</span><span> </span><span>pair_split</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>metis</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>fence4</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot; I  &#10781; a &#10233; I&#39;  &#10781; a&#39; &#10233; (I &#8743;* I&#39;)  &#10781; (a &#8743;* a&#39;)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;I  &#10781; a&quot;</span></span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;I&#39;  &#10781; a&#39;&quot;</span></span></span><span>  
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;u v. (&#8704;a1 a2. u a1 a2) &#8743; (&#8704;a1 a2. v a1 a2) &#10233;  &#8704;a1 a2. u a1 a2 &#8743; v a1 a2&quot;</span></span></span><span>
</span><span>   </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;precise (I &#8743;* I&#39;)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a1</span><span> </span><span>a2</span><span> </span><span>fence41</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">moreover</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;&#963;1 &#963;2. ((a &#8743;* a&#39;) imp ((I &#8743;* I&#39;) &#8885; (I &#8743;* I&#39;))) (&#963;1,&#963;2)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a1</span><span> </span><span>a2</span><span> </span><span>fence42</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">moreover</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;&#963;1 &#963;2.(&#8968; (I &#8743;* I&#39;) &#8969; imp (a &#8743;* a&#39;))(&#963;1,&#963;2)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a1</span><span> </span><span>a2</span><span> </span><span>fence43</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">ultimately</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(I &#8743;* I&#39;)  &#10781; (a &#8743;* a&#39;)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>f1</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Fence_def</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#8707;! x. P x) &#10233; (P x &#10233; (&#8896;y. P y &#10233; y = x))&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">by</span></span><span> </span><span>metis</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;P x &#10233; (&#8896;y. P y &#10233; y = x) &#10233; (&#8707;! x. P x) &quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>sub_state_fence_unique</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;&#963;11 &#8828; &#963; &#8743; &#963;1 &#8828; &#963; &#8743; a (&#963;11,&#963;12) &#8743; I &#963;1 &#8743; I  &#10781; a &#10233; &#963;1=&#963;11&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Fence_def</span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span> </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;&#963;11 &#8828; &#963; &#8743; &#963;1 &#8828; &#963; &#8743; a (&#963;11, &#963;12) &#8743; I &#963;1 &#8743;
          (&#8704;&#963;1 &#963;2.
            ((&#8968; I &#8969;) (&#963;1, &#963;2) &#10230; a (&#963;1, &#963;2)) &#8743;
            (a (&#963;1, &#963;2) &#10230; (I &#8885; I) (&#963;1, &#963;2)) &#8743; 
            precise I)&quot;</span></span></span><span>
</span><span> </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;precise I&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span> </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(I &#8885; I) (&#963;11, &#963;12)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a1</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span>
</span><span> </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;I &#963;11&quot;</span></span></span><span> 
</span><span>   </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>surjective_pairing</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>after_def</span><span class="delimiter">)</span><span>
</span><span> </span><span class="keyword3"><span class="command">thus</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#963;1=&#963;11&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a1</span><span> </span><span>precise_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>metis</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>fence_tran_exists</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#963;1##&#963;2 &#10233; (a &#8743;* a&#39;) (&#963;1+&#963;2,&#963;&#39;) &#10233; I &#963;1 &#8743; I  &#10781; a &#10233;    
   (&#8707;&#963;1&#39; &#963;2&#39;.((&#963;1&#39;, &#963;2&#39; &#9657; &#963;&#39;) &#8743; a (&#963;1,&#963;1&#39;) &#8743; a&#39;(&#963;2,&#963;2&#39;)))&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;&#963;1##&#963;2&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span>
</span><span>         </span><span>a2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(a &#8743;* a&#39;) (&#963;1+&#963;2,&#963;&#39;)&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span>
</span><span>         </span><span>a3</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;I &#963;1 &#8743; I  &#10781; a&quot;</span></span></span><span>  
</span><span>  </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>&#963;11</span><span> </span><span>&#963;12</span><span> </span><span>&#963;&#39;1</span><span> </span><span>&#963;&#39;2</span><span>   
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>sep_split</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;((&#963;11,&#963;&#39;1)+(&#963;12,&#963;&#39;2)) = (&#963;1+&#963;2,&#963;&#39;) &#8743; 
         (&#963;11,&#963;&#39;1)##(&#963;12,&#963;&#39;2) &#8743; a (&#963;11,&#963;&#39;1) &#8743; a&#39;(&#963;12,&#963;&#39;2) &quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a2</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>sep_conjE</span><span> </span><span>surjective_pairing</span><span class="delimiter">)</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>split_sigma12</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;&#963;11+&#963;12 = &#963;1+&#963;2 &#8743; &#963;11##&#963;12&quot;</span></span></span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span class="delimiter">(</span><span>no_types</span><span class="delimiter">)</span><span> </span><span>dis_sep</span><span class="delimiter">)</span><span> 
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#963;11 &#8828; &#963;1+&#963;2 &#8743; &#963;1 &#8828; &#963;1+&#963;2&quot;</span></span></span><span> 
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>sep_substate_def</span><span> </span><span>sep_split</span><span> </span><span>a1</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#963;11=&#963;1&quot;</span></span></span><span> 
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>sep_split</span><span> </span><span>a3</span><span> </span><span>sub_state_fence_unique</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#963;12 = &#963;2&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span class="delimiter">(</span><span>no_types</span><span class="delimiter">)</span><span> </span><span>split_sigma12</span><span> </span><span>a1</span><span> </span><span>sep_add_cancelD</span><span> </span><span>sep_add_commute</span><span> </span><span>sep_disj_commute</span><span class="delimiter">)</span><span>    
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#963;&#39;1, &#963;&#39;2&#9657; &#963;&#39;) &#8743; a (&#963;1,&#963;&#39;1) &#8743; a&#39;(&#963;2,&#963;&#39;2)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span class="delimiter">(</span><span>no_types</span><span class="delimiter">)</span><span> </span><span class="alt_string"><span class="delete"><span class="delete">`&#963;11 = &#963;1`</span></span></span><span> </span><span>dis_sep</span><span> </span><span>sep_split</span><span> </span><span>tern_rel_def</span><span class="delimiter">)</span><span>  
</span><span>  </span><span class="keyword3"><span class="command">thus</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8707;&#963;1&#39; &#963;2&#39;.(&#963;1&#39;, &#963;2&#39;&#9657; &#963;&#39;) &#8743; a (&#963;1,&#963;1&#39;) &#8743; a&#39;(&#963;2,&#963;2&#39;)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>  
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>fence_tran_exists1</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#963;1##&#963;2 &#10233; (a &#8743;* a&#39;) (&#963;1+&#963;2,&#963;&#39;) &#10233; I &#963;1 &#8743; I  &#10781; a &#10233;    
   &#8707;&#963;1&#39; &#963;2&#39;.(&#963;1&#39;, &#963;2&#39;&#9657; &#963;&#39;)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;&#963;1##&#963;2&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span>
</span><span>         </span><span>a2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(a &#8743;* a&#39;) (&#963;1+&#963;2,&#963;&#39;)&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span>
</span><span>         </span><span>a3</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;I &#963;1 &#8743; I  &#10781; a&quot;</span></span></span><span>  
</span><span>  </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>&#963;11</span><span> </span><span>&#963;12</span><span> </span><span>&#963;&#39;1</span><span> </span><span>&#963;&#39;2</span><span>   
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>sep_split</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;((&#963;11,&#963;&#39;1)+(&#963;12,&#963;&#39;2)) = (&#963;1+&#963;2,&#963;&#39;) &#8743; 
         (&#963;11,&#963;&#39;1)##(&#963;12,&#963;&#39;2) &#8743; a (&#963;11,&#963;&#39;1) &#8743; a&#39;(&#963;12,&#963;&#39;2) &quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a2</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>sep_conjE</span><span> </span><span>surjective_pairing</span><span class="delimiter">)</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>split_sigma12</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;&#963;11+&#963;12 = &#963;1+&#963;2 &#8743; &#963;11##&#963;12&quot;</span></span></span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span class="delimiter">(</span><span>no_types</span><span class="delimiter">)</span><span> </span><span>dis_sep</span><span class="delimiter">)</span><span> 
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#963;11 &#8828; &#963;1+&#963;2 &#8743; &#963;1 &#8828; &#963;1+&#963;2&quot;</span></span></span><span> 
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>sep_substate_def</span><span> </span><span>sep_split</span><span> </span><span>a1</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#963;11=&#963;1&quot;</span></span></span><span> 
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>sep_split</span><span> </span><span>a3</span><span> </span><span>sub_state_fence_unique</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#963;12 = &#963;2&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span class="delimiter">(</span><span>no_types</span><span class="delimiter">)</span><span> </span><span>split_sigma12</span><span> </span><span>a1</span><span> </span><span>sep_add_cancelD</span><span> </span><span>sep_add_commute</span><span> </span><span>sep_disj_commute</span><span class="delimiter">)</span><span>    
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#963;&#39;1, &#963;&#39;2&#9657; &#963;&#39;) &#8743; a (&#963;1,&#963;&#39;1) &#8743; a&#39;(&#963;2,&#963;&#39;2)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span class="delimiter">(</span><span>no_types</span><span class="delimiter">)</span><span> </span><span class="alt_string"><span class="delete"><span class="delete">`&#963;11 = &#963;1`</span></span></span><span> </span><span>dis_sep</span><span> </span><span>sep_split</span><span> </span><span>tern_rel_def</span><span class="delimiter">)</span><span>  
</span><span>  </span><span class="keyword3"><span class="command">thus</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8707;&#963;1&#39; &#963;2&#39;.(&#963;1&#39;,&#963;2&#39;&#9657; &#963;&#39;)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>  
</span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>fence_tran_unique</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;(&#963;1 ## &#963;2) &#10233; (a &#8743;* a&#39;) (&#963;1+&#963;2,&#963;&#39;) &#10233; I &#963;1 &#8743; I  &#10781; a &#10233;    
   (&#8707;!&#963;1&#39;. &#8707;!&#963;2&#39;. ((&#963;1&#39;, &#963;2&#39; &#9657; &#963;&#39;) &#8743; a (&#963;1,&#963;1&#39;) &#8743; a&#39;(&#963;2,&#963;2&#39;)))&quot;</span></span></span><span>     
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span> 
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;&#963;1##&#963;2&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span>
</span><span>     </span><span>a2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(a &#8743;* a&#39;) (&#963;1+&#963;2,&#963;&#39;)&quot;</span></span></span><span> 
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>&#963;11</span><span> </span><span>&#963;12</span><span> </span><span>&#963;&#39;1</span><span> </span><span>&#963;&#39;2</span><span>   
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>sep_split</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;((&#963;11,&#963;&#39;1)+(&#963;12,&#963;&#39;2)) = (&#963;1+&#963;2,&#963;&#39;) &#8743; 
         (&#963;11,&#963;&#39;1)##(&#963;12,&#963;&#39;2) &#8743; a (&#963;11,&#963;&#39;1) &#8743; a&#39;(&#963;12,&#963;&#39;2) &quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>sep_conjE</span><span> </span><span>surjective_pairing</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span>   </span><span>a3</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;I &#963;1 &#8743; I  &#10781; a&quot;</span></span></span><span>  
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> 
</span><span>  </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>&#963;1&#39;</span><span> </span><span>&#963;2&#39;</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>exists</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;(&#963;1&#39;, &#963;2&#39; &#9657; &#963;&#39;) &#8743; a (&#963;1,&#963;1&#39;) &#8743; a&#39;(&#963;2,&#963;2&#39;)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a1</span><span> </span><span>a2</span><span> </span><span>fence_tran_exists</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>k1</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;(&#963;1&#39; , &#963;2&#39;&#9657; &#963;&#39;)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>tern_rel_def</span><span class="delimiter">)</span><span>   
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8707;!&#963;1&#39;. &#8707;!&#963;2&#39;. ((&#963;1&#39;, &#963;2&#39; &#9657; &#963;&#39;) &#8743; a (&#963;1,&#963;1&#39;) &#8743; a&#39;(&#963;2,&#963;2&#39;))&quot;</span></span></span><span> 
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span class="delimiter">+</span><span class="delimiter">)</span><span>
</span><span>         </span><span class="keyword1"><span class="command">let</span></span><span> </span><span class="var">?&#963;1&#39;</span><span> </span><span class="delimiter">=</span><span> </span><span>&#963;1&#39;</span><span>
</span><span>         </span><span class="keyword1"><span class="command">let</span></span><span> </span><span class="var">?&#963;2&#39;2</span><span> </span><span class="delimiter">=</span><span> </span><span>&#963;2&#39;</span><span>
</span><span>         </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(?&#963;1&#39;, ?&#963;2&#39;2&#9657; &#963;&#39;)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>k1</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>     </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>         </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;a (&#963;1, &#963;1&#39;) &#8743; a&#39; (&#963;2, &#963;2&#39;)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>exists</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>     </span><span class="keyword1"><span class="command">next</span></span><span> 
</span><span>         </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>&#963;2&#39;a</span><span>
</span><span>         </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a11</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;(&#963;1&#39; , &#963;2&#39;a&#9657; &#963;&#39;) &#8743; a (&#963;1, &#963;1&#39;) &#8743; a&#39; (&#963;2, &#963;2&#39;a)&quot;</span></span></span><span>
</span><span>         </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8707;!&#963;2&#39;.(&#963;1&#39; , &#963;2&#39;&#9657; &#963;&#39;)&quot;</span></span></span><span> 
</span><span>           </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>unique_subheap</span><span> </span><span>k1</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span> 
</span><span>         </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span class="string"><span class="delete"><span class="delete">&quot; &#963;2&#39;a = &#963;2&#39;&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a11</span><span> </span><span>k1</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>          
</span><span>     </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>         </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>&#963;1&#39;a</span><span>
</span><span>         </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f1</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;I a &#963;1 &#963;1&#39;. I &#10781; a &#10233;  a (&#963;1, &#963;1&#39;) &#10233; I &#963;1 &#8743; I &#963;1&#39;&quot;</span></span></span><span>
</span><span>           </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>Fence_def</span><span> </span><span>afterD</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>metis</span><span>
</span><span>         </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8707;!&#963;2&#39;. (&#963;1&#39;a, &#963;2&#39;&#9657; &#963;&#39;) &#8743; a (&#963;1, &#963;1&#39;a) &#8743; a&#39; (&#963;2, &#963;2&#39;)&quot;</span></span></span><span>
</span><span>         </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>&#963;2&#39;1</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>a12</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;(&#963;1&#39;a, &#963;2&#39;1&#9657; &#963;&#39;) &#8743; a (&#963;1, &#963;1&#39;a) &#8743; a&#39; (&#963;2, &#963;2&#39;1)&quot;</span></span></span><span>
</span><span>           </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>         </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>prec1</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;I &#963;1&#39;a&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>a3</span><span> </span><span>f1</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>         </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>prec2</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;I &#963;1&#39;&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>exists</span><span> </span><span>a3</span><span> </span><span>f1</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>         </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>prec</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;precise I&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a3</span><span> </span><span>Fence_def</span><span>
</span><span>           </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Fence_def</span><span class="delimiter">)</span><span>
</span><span>         </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#963;1&#39; &#8828; &#963;&#39; &#8743; &#963;1&#39;a &#8828; &#963;&#39;&quot;</span></span></span><span> 
</span><span>           </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>sep_split_substate</span><span> </span><span>exists</span><span> </span><span>a12</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>                 
</span><span>         </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#963;1&#39;a = &#963;1&#39;&quot;</span></span></span><span> 
</span><span>             </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>precise_def</span><span>  </span><span>prec1</span><span> </span><span>prec2</span><span> </span><span>prec</span><span>
</span><span>             </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span class="delimiter">(</span><span>no_types</span><span class="delimiter">)</span><span class="delimiter">)</span><span>             
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">corollary</span></span><span> </span><span>frame_property_a_star_id</span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#963;1 ## &#963;2 &#8743; (a &#8743;* tran_Id) (&#963;1+&#963;2,&#963;&#39;) &#10233; I &#963;1 &#8743; I  &#10781; a &#10233;
   &#8707;&#963;1&#39;.(&#963;1&#39;, &#963;2&#9657; &#963;&#39;) &#8743; (&#963;1,&#963;1&#39;) &#8712;&#8970;a&#8971;&quot;</span></span></span><span> 
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>  
</span><span>   </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;&#963;1 ## &#963;2 &#8743; (a &#8743;* tran_Id) (&#963;1+&#963;2,&#963;&#39;)&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span>          
</span><span>          </span><span>a</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot; I &#963;1 &#8743; I  &#10781; a&quot;</span></span></span><span>   
</span><span>   </span><span class="keyword1"><span class="command">then</span></span><span> 
</span><span>   </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8707;!&#963;1&#39;. &#8707;! &#963;2&#39;. (&#963;1&#39;, &#963;2&#39;&#9657; &#963;&#39;) &#8743; a (&#963;1, &#963;1&#39;) &#8743; tran_Id (&#963;2, &#963;2&#39;)&quot;</span></span></span><span>
</span><span>     </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>fence_tran_unique</span><span class="delimiter">[</span><span>of</span><span> </span><span>&#963;1</span><span> </span><span>&#963;2</span><span> </span><span>a</span><span> </span><span>tran_Id</span><span> </span><span>&#963;&#39;</span><span> </span><span>I</span><span class="delimiter">]</span><span> </span><span>a1</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fast</span><span>
</span><span>   </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>&#963;1&#39;</span><span> </span><span>&#963;2&#39;</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>res</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;(&#963;1&#39;, &#963;2&#39;&#9657; &#963;&#39;) &#8743; a (&#963;1, &#963;1&#39;) &#8743; tran_Id (&#963;2, &#963;2&#39;)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>   </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#963;2=&#963;2&#39;&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>tran_Id_def</span><span> </span><span>satisD</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>metis</span><span>  
</span><span>   </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8707;&#963;1&#39;.(&#963;1&#39;, &#963;2&#9657; &#963;&#39;) &#8743; (&#963;1,&#963;1&#39;) &#8712;&#8970;a&#8971;&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>Satis_def</span><span> </span><span>res</span><span>  </span><span>mem_Collect_eq</span><span> 
</span><span>     </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span class="delimiter">(</span><span>no_types</span><span class="delimiter">)</span><span class="delimiter">)</span><span>   
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>sta_fence</span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;Sta p a &#8743; Sta p&#39; a&#39; &#8743; (&#8704;&#963;. (p imp I) &#963;)
 &#8743; I  &#10781; a &#10233; Sta (p &#8743;* p&#39;) (a &#8743;* a&#39;) &quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Sta_def</span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>    </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a1</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;(&#8704;&#963; &#963;&#39;. p &#963; &#8743; a (&#963;, &#963;&#39;) &#10230; p &#963;&#39;) &#8743;
            (&#8704;&#963; &#963;&#39;. p&#39; &#963; &#8743; a&#39; (&#963;, &#963;&#39;) &#10230; p&#39; &#963;&#39;) &#8743; 
            (&#8704;&#963;. p &#963; &#10230; I &#963;) &#8743; I &#10781; a&quot;</span></span></span><span>
</span><span>    </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;&#963; &#963;&#39;. (p &#8743;* p&#39;) &#963; &#8743; (a &#8743;* a&#39;) (&#963;, &#963;&#39;) &#10230; (p &#8743;* p&#39;) &#963;&#39;&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span class="delimiter">+</span><span class="delimiter">)</span><span>
</span><span>     </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>&#963;</span><span> </span><span>&#963;&#39;</span><span>
</span><span>     </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>a2</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;(p &#8743;* p&#39;) &#963; &#8743; (a &#8743;* a&#39;) (&#963;, &#963;&#39;)&quot;</span></span></span><span>
</span><span>     </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>&#963;1</span><span> </span><span>&#963;2</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>split_p</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;&#963;=&#963;1 + &#963;2 &#8743; &#963;1##&#963;2 &#8743; p &#963;1 &#8743; p&#39; &#963;2&quot;</span></span></span><span>
</span><span>       </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>sep_conjD</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>     </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>split1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot; &#963;1##&#963;2&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>     </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>sig_sum</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;(a &#8743;* a&#39;) (&#963;1 + &#963;2,&#963;&#39;)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>split_p</span><span> </span><span>a2</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>     </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;I &#963;1 &#8743; I &#10781; a&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a1</span><span> </span><span>split_p</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>     </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8707;! &#963;1&#39;. &#8707;! &#963;2&#39;. (&#963;1&#39;, &#963;2&#39;&#9657; &#963;&#39;) &#8743; a (&#963;1,&#963;1&#39;) &#8743; a&#39;(&#963;2,&#963;2&#39;)&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>split1</span><span>  </span><span>sig_sum</span><span> </span><span>fence_tran_unique</span><span class="delimiter">[</span><span>of</span><span> </span><span>&#963;1</span><span> </span><span>&#963;2</span><span> </span><span>a</span><span> </span><span>a&#39;</span><span> </span><span>&#963;&#39;</span><span> </span><span>I</span><span class="delimiter">]</span><span>  
</span><span>        </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fast</span><span>
</span><span>     </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(p &#8743;* p&#39;) &#963;&#39;&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span class="delimiter">(</span><span>no_types</span><span class="delimiter">)</span><span> </span><span>a1</span><span> </span><span>sep_conjI</span><span> </span><span>tern_rel_def</span><span> </span><span>split_p</span><span class="delimiter">)</span><span>
</span><span>   </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span> </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>fence_G_id</span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>a0</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;(I  &#10781; G)&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span>
</span><span>          </span><span>a1</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;G (s,y)&quot;</span></span></span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;G (s,s)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;case (s, y) of (p, pa) &#8658; I p &#8743; I pa&quot;</span></span></span><span>     
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a0</span><span> </span><span>a1</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Fence_def</span><span> </span><span>satis_def</span><span> </span><span>after_def</span><span> 
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>presburger</span><span>
</span><span>  </span><span class="keyword1"><span class="command">hence</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;case (s, s) of (p, pa) &#8658; p = pa &#8743; I p&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span>
</span><span>  </span><span class="keyword3"><span class="command">thus</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a0</span><span> </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Fence_def</span><span> </span><span>satis_def</span><span> </span><span>after_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>presburger</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span> 
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>fence_I_id</span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>a0</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;(I  &#10781; G)&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span>
</span><span>          </span><span>a1</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;I s&quot;</span></span></span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;G (s,s)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a0</span><span> </span><span>a1</span><span> </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Fence_def</span><span> </span><span>satis_def</span><span> </span><span>after_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span> 
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>fence_I_id1</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>a0</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;(I  &#10781; G)&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span>
</span><span>          </span><span>a1</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;s t. (p imp I) (s,t)&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span>
</span><span>          </span><span>a2</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;p s &#8743; s=(s1,s2)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;G (s,s)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a0</span><span> </span><span>a1</span><span> </span><span>a2</span><span> </span><span>fence_I_id</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>tran_True</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;tran_True t&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>tran_True_def</span><span> </span><span>after_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* declare [[show_types]]
  declare [[show_sorts]]
  declare [[show_consts]] *)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>fence_p_I_G</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>a0</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;(&#8704;s t. (p imp (I&#8743;*sep_true)) (s,t))&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span>
</span><span>          </span><span>a1</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;(I &#10781; G)&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span>
</span><span>          </span><span>a2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p s&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(G&#8743;*tran_True) (s,s)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span>-</span><span>
</span><span>  </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>sl</span><span> </span><span>sg</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>s</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;s=(sl,sg)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a2</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>meson</span><span> </span><span>surj_pair</span><span class="delimiter">)</span><span> 
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>I_true</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;(I&#8743;*sep_true) s&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a0</span><span> </span><span>a2</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>s<span class="hidden">&#8681;</span><sub>1</sub></span><span> </span><span>s<span class="hidden">&#8681;</span><sub>2</sub></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>sep</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s<span class="hidden">&#8681;</span><sub>1</sub> ## s<span class="hidden">&#8681;</span><sub>2</sub> &#8743; s = s<span class="hidden">&#8681;</span><sub>1</sub> + s<span class="hidden">&#8681;</span><sub>2</sub> &#8743; I s<span class="hidden">&#8681;</span><sub>1</sub> &#8743; sep_true s<span class="hidden">&#8681;</span><sub>2</sub>&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>sep_conjD</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>sl<span class="hidden">&#8681;</span><sub>1</sub></span><span> </span><span>sl<span class="hidden">&#8681;</span><sub>2</sub></span><span> </span><span>sg<span class="hidden">&#8681;</span><sub>1</sub></span><span> </span><span>sg<span class="hidden">&#8681;</span><sub>2</sub></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>rel</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;sl=sl<span class="hidden">&#8681;</span><sub>1</sub>+sl<span class="hidden">&#8681;</span><sub>2</sub> &#8743; sg = sg<span class="hidden">&#8681;</span><sub>1</sub> + sg<span class="hidden">&#8681;</span><sub>2</sub> &#8743; s<span class="hidden">&#8681;</span><sub>1</sub>=(sl<span class="hidden">&#8681;</span><sub>1</sub>,sg<span class="hidden">&#8681;</span><sub>1</sub>) &#8743; s<span class="hidden">&#8681;</span><sub>2</sub>=(sl<span class="hidden">&#8681;</span><sub>2</sub>,sg<span class="hidden">&#8681;</span><sub>2</sub>)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>s</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span>Pair_inject</span><span> </span><span>plus_prod_def</span><span> </span><span>surjective_pairing</span><span class="delimiter">)</span><span>    
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;G ((sl<span class="hidden">&#8681;</span><sub>1</sub>,sg<span class="hidden">&#8681;</span><sub>1</sub>),(sl<span class="hidden">&#8681;</span><sub>1</sub>,sg<span class="hidden">&#8681;</span><sub>1</sub>))&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a1</span><span> </span><span>sep</span><span> </span><span>fence_I_id</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>  
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;G (s<span class="hidden">&#8681;</span><sub>1</sub>, s<span class="hidden">&#8681;</span><sub>1</sub>)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>rel</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(G&#8743;*tran_Id)(s<span class="hidden">&#8681;</span><sub>1</sub>, s<span class="hidden">&#8681;</span><sub>1</sub>)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>sep_conj_train_Id</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>G</span><span class="delimiter">:</span><span class="string"><span class="delete"><span class="delete">&quot;(G&#8743;*tran_Id)(s,s)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>s</span><span> </span><span>sep</span><span> </span><span>conj_sep_id</span><span> </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>tern_rel_def</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8704;s. tran_Id s &#10230; tran_True s&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>tran_True</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>   
</span><span>  </span><span class="keyword3"><span class="command">thus</span></span><span> </span><span class="var">?thesis</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>G</span><span> </span><span>sep_conj_commute</span><span> </span><span>sep_conj_impl1</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>metis</span><span> </span><span class="delimiter">(</span><span>no_types</span><span class="delimiter">)</span><span class="delimiter">)</span><span>    
</span><span class="keyword1"><span class="command">qed</span></span><span>                                                                             
</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span></pre>

</div>
</body>
</html>
