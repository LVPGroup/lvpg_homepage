<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Theory PiCore_Syntax (Isabelle2017: October 2017)</title>
<link media="all" rel="stylesheet" type="text/css" href="isabelle.css"/>
</head>

<body>
<div class="head"><h1>Theory PiCore_Syntax</h1>

<span class="command">theory</span> <span class="name">PiCore_Syntax</span><br/>
<span class="keyword">imports</span> <a href="PiCore_Language.html"><span class="name">PiCore_Language</span></a><br/>

</div>
<div class="source">
<pre class="source"><span class="comment">(*
Created by Yongwang Zhao (ywzhao@ntu.edu.sg, zhaoyw@buaa.edu.cn)
School of Computer Engineering, Nanyang Technological University, Singapore
and School of Computer Science &amp; Engineering, Beihang University, China
*)</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">section</span></span><span class=""> </span><span class="cartouche">&#8249;Concrete Syntax of PiCore Language&#8250;</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">theory</span></span><span class=""> </span><span class="">PiCore_Syntax</span><span class=""> 
</span><span class="keyword2"><span class="keyword">imports</span></span><span class=""> </span><span class="">PiCore_Language</span><span class=""> </span><span class="comment">(*PiCore_RG_IFS *)</span><span class="">
</span><span class="">
</span><span class="comment">(*keywords &quot;procedures&quot; :: thy_decl*)</span><span class="">
</span><span class="">
</span><span class="keyword2"><span class="keyword">begin</span></span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">syntax</span></span><span class="">
</span><span class="">  </span><span class="string">&quot;_quote&quot;</span><span class="">     </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;b &#8658; (&#39;s &#8658; &#39;b)&quot;</span><span class="">                </span><span class="delimiter">(</span><span class="string">&quot;(&#171;_&#187;)&quot;</span><span class=""> </span><span class="delimiter">[</span><span class="">0</span><span class="delimiter">]</span><span class=""> </span><span class="">1000</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="string">&quot;_antiquote&quot;</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;(&#39;s &#8658; &#39;b) &#8658; &#39;b&quot;</span><span class="">                </span><span class="delimiter">(</span><span class="string">&quot;&#180;_&quot;</span><span class=""> </span><span class="delimiter">[</span><span class="">1000</span><span class="delimiter">]</span><span class=""> </span><span class="">1000</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="string">&quot;_Assert&quot;</span><span class="">    </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;s &#8658; &#39;s set&quot;</span><span class="">                    </span><span class="delimiter">(</span><span class="string">&quot;(&#10627;_&#10628;)&quot;</span><span class=""> </span><span class="delimiter">[</span><span class="">0</span><span class="delimiter">]</span><span class=""> </span><span class="">1000</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">translations</span></span><span class="">
</span><span class="">  </span><span class="string">&quot;&#10627;b&#10628;&quot;</span><span class=""> </span><span class="delimiter">&#8640;</span><span class=""> </span><span class="string">&quot;CONST Collect &#171;b&#187;&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">parse_translation</span></span><span class=""> </span><span class="cartouche">&#8249;
  let
    fun quote_tr [t] = Syntax_Trans.quote_tr @{syntax_const &quot;_antiquote&quot;} t
      | quote_tr ts = raise TERM (&quot;quote_tr&quot;, ts);
  in [(@{syntax_const &quot;_quote&quot;}, K quote_tr)] end
&#8250;</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">definition</span></span><span class=""> </span><span class="">Skip</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;s prog&quot;</span><span class="">  </span><span class="delimiter">(</span><span class="string">&quot;SKIP&quot;</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="keyword2"><span class="keyword">where</span></span><span class=""> </span><span class="string">&quot;SKIP &#8801; Basic id&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">notation</span></span><span class=""> </span><span class="">Seq</span><span class="">  </span><span class="delimiter">(</span><span class="string">&quot;(_;;/ _)&quot;</span><span class=""> </span><span class="delimiter">[</span><span class="">60</span><span class="delimiter">,</span><span class="">61</span><span class="delimiter">]</span><span class=""> </span><span class="">60</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">syntax</span></span><span class="">
</span><span class="">  </span><span class="string">&quot;_Assign&quot;</span><span class="">    </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;idt &#8658; &#39;b &#8658; &#39;s prog&quot;</span><span class="">                      </span><span class="delimiter">(</span><span class="string">&quot;(&#180;_ :=/ _)&quot;</span><span class=""> </span><span class="delimiter">[</span><span class="">70</span><span class="delimiter">,</span><span class=""> </span><span class="">65</span><span class="delimiter">]</span><span class=""> </span><span class="">61</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="string">&quot;_Cond&quot;</span><span class="">      </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;s bexp &#8658; &#39;s prog &#8658; &#39;s prog &#8658; &#39;s prog&quot;</span><span class="">  </span><span class="delimiter">(</span><span class="string">&quot;(0IF _/ THEN _/ ELSE _/FI)&quot;</span><span class=""> </span><span class="delimiter">[</span><span class="">0</span><span class="delimiter">,</span><span class=""> </span><span class="">0</span><span class="delimiter">,</span><span class=""> </span><span class="">0</span><span class="delimiter">]</span><span class=""> </span><span class="">61</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="string">&quot;_Cond2&quot;</span><span class="">     </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;s bexp &#8658; &#39;s prog &#8658; &#39;s prog&quot;</span><span class="">             </span><span class="delimiter">(</span><span class="string">&quot;(0IF _ THEN _ FI)&quot;</span><span class=""> </span><span class="delimiter">[</span><span class="">0</span><span class="delimiter">,</span><span class="">0</span><span class="delimiter">]</span><span class=""> </span><span class="">62</span><span class="comment">(*56*)</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="string">&quot;_While&quot;</span><span class="">     </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;s bexp &#8658; &#39;s prog &#8658; &#39;s prog&quot;</span><span class="">             </span><span class="delimiter">(</span><span class="string">&quot;(0WHILE _ /DO _ /OD)&quot;</span><span class="">  </span><span class="delimiter">[</span><span class="">0</span><span class="delimiter">,</span><span class=""> </span><span class="">0</span><span class="delimiter">]</span><span class=""> </span><span class="">61</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="string">&quot;_Await&quot;</span><span class="">     </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;s bexp &#8658; &#39;s prog &#8658; &#39;s prog&quot;</span><span class="">             </span><span class="delimiter">(</span><span class="string">&quot;(0AWAIT _ /THEN /_ /END)&quot;</span><span class="">  </span><span class="delimiter">[</span><span class="">0</span><span class="delimiter">,</span><span class="">0</span><span class="delimiter">]</span><span class=""> </span><span class="">61</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="string">&quot;_Atom&quot;</span><span class="">      </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;s prog &#8658; &#39;s prog&quot;</span><span class="">                        </span><span class="delimiter">(</span><span class="string">&quot;(0ATOMIC _ END)&quot;</span><span class=""> </span><span class="">61</span><span class="delimiter">)</span><span class="comment">(*(&quot;(&#10216; _ &#10217;)&quot; 61)*)</span><span class="">
</span><span class="">  </span><span class="string">&quot;_Wait&quot;</span><span class="">      </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;s bexp &#8658; &#39;s prog&quot;</span><span class="">                       </span><span class="delimiter">(</span><span class="string">&quot;(0WAIT _ END)&quot;</span><span class=""> </span><span class="">61</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="string">&quot;_For&quot;</span><span class="">       </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;&#39;s prog &#8658; &#39;s bexp &#8658; &#39;s prog &#8658; &#39;s prog &#8658; &#39;s prog&quot;</span><span class=""> </span><span class="delimiter">(</span><span class="string">&quot;(0FOR _;/ _;/ _/ DO _/ ROF)&quot;</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="string">&quot;_Event&quot;</span><span class="">     </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;[&#39;a, &#39;a, &#39;a] &#8658; (&#39;l,&#39;k,&#39;s) event&quot;</span><span class=""> </span><span class="delimiter">(</span><span class="string">&quot;(EVENT _ WHEN _ THEN _ END)&quot;</span><span class=""> </span><span class="delimiter">[</span><span class="">0</span><span class="delimiter">,</span><span class="">0</span><span class="delimiter">,</span><span class="">0</span><span class="delimiter">]</span><span class=""> </span><span class="">61</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="string">&quot;_Event2&quot;</span><span class="">     </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;[&#39;a, &#39;a, &#39;a] &#8658; (&#39;l,&#39;k,&#39;s) event&quot;</span><span class=""> </span><span class="delimiter">(</span><span class="string">&quot;(EVENT _ THEN _ END)&quot;</span><span class=""> </span><span class="delimiter">[</span><span class="">0</span><span class="delimiter">,</span><span class="">0</span><span class="delimiter">]</span><span class=""> </span><span class="">61</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">translations</span></span><span class="">
</span><span class="">  </span><span class="string">&quot;&#180;x := a&quot;</span><span class=""> </span><span class="delimiter">&#8640;</span><span class=""> </span><span class="string">&quot;CONST Basic &#171;&#180;(_update_name x (&#955;_. a))&#187;&quot;</span><span class="">
</span><span class="">  </span><span class="string">&quot;IF b THEN c1 ELSE c2 FI&quot;</span><span class=""> </span><span class="delimiter">&#8640;</span><span class=""> </span><span class="string">&quot;CONST Cond &#10627;b&#10628; c1 c2&quot;</span><span class="">
</span><span class="">  </span><span class="string">&quot;IF b THEN c FI&quot;</span><span class=""> </span><span class="delimiter">&#8652;</span><span class=""> </span><span class="string">&quot;IF b THEN c ELSE SKIP FI&quot;</span><span class="">
</span><span class="">  </span><span class="string">&quot;WHILE b DO c OD&quot;</span><span class=""> </span><span class="delimiter">&#8640;</span><span class=""> </span><span class="string">&quot;CONST While &#10627;b&#10628; c&quot;</span><span class="">
</span><span class="">  </span><span class="string">&quot;AWAIT b THEN c END&quot;</span><span class=""> </span><span class="delimiter">&#8652;</span><span class=""> </span><span class="string">&quot;CONST Await &#10627;b&#10628; c&quot;</span><span class="">
</span><span class="">  </span><span class="comment">(*&quot;&#10216;c&#10217;&quot; &#8652; &quot;AWAIT CONST True THEN c END&quot;*)</span><span class="">
</span><span class="">  </span><span class="string">&quot;ATOMIC c END&quot;</span><span class=""> </span><span class="delimiter">&#8652;</span><span class=""> </span><span class="string">&quot;AWAIT CONST True THEN c END&quot;</span><span class="">
</span><span class="">  </span><span class="string">&quot;WAIT b END&quot;</span><span class=""> </span><span class="delimiter">&#8652;</span><span class=""> </span><span class="string">&quot;AWAIT b THEN SKIP END&quot;</span><span class="">
</span><span class="">  </span><span class="string">&quot;FOR a; b; c DO p ROF&quot;</span><span class=""> </span><span class="delimiter">&#8640;</span><span class=""> </span><span class="string">&quot;a;; WHILE b DO p;;c OD&quot;</span><span class="">
</span><span class="">  </span><span class="string">&quot;EVENT l WHEN g THEN bd END&quot;</span><span class=""> </span><span class="delimiter">&#8640;</span><span class=""> </span><span class="string">&quot;CONST BasicEvent (l,(&#10627;g&#10628;,bd))&quot;</span><span class="">
</span><span class="">  </span><span class="string">&quot;EVENT l THEN bd END&quot;</span><span class=""> </span><span class="delimiter">&#8652;</span><span class=""> </span><span class="string">&quot;EVENT l WHEN CONST True THEN bd END&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">text</span></span><span class=""> </span><span class="cartouche">&#8249;Translations for variables before and after a transition:&#8250;</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">syntax</span></span><span class="">
</span><span class="">  </span><span class="string">&quot;_before&quot;</span><span class=""> </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;id &#8658; &#39;a&quot;</span><span class=""> </span><span class="delimiter">(</span><span class="string">&quot;&#186;_&quot;</span><span class="delimiter">)</span><span class="">
</span><span class="">  </span><span class="string">&quot;_after&quot;</span><span class="">  </span><span class="delimiter">::</span><span class=""> </span><span class="string">&quot;id &#8658; &#39;a&quot;</span><span class=""> </span><span class="delimiter">(</span><span class="string">&quot;&#170;_&quot;</span><span class="delimiter">)</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">translations</span></span><span class="">
</span><span class="">  </span><span class="string">&quot;&#186;x&quot;</span><span class=""> </span><span class="delimiter">&#8652;</span><span class=""> </span><span class="string">&quot;x &#180;CONST fst&quot;</span><span class="">
</span><span class="">  </span><span class="string">&quot;&#170;x&quot;</span><span class=""> </span><span class="delimiter">&#8652;</span><span class=""> </span><span class="string">&quot;x &#180;CONST snd&quot;</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">print_translation</span></span><span class=""> </span><span class="cartouche">&#8249;
  let
    fun quote_tr&#39; f (t :: ts) =
          Term.list_comb (f $ Syntax_Trans.quote_tr&#39; @{syntax_const &quot;_antiquote&quot;} t, ts)
      | quote_tr&#39; _ _ = raise Match;

    val assert_tr&#39; = quote_tr&#39; (Syntax.const @{syntax_const &quot;_Assert&quot;});

    fun bexp_tr&#39; name ((Const (@{const_syntax Collect}, _) $ t) :: ts) =
          quote_tr&#39; (Syntax.const name) (t :: ts)
      | bexp_tr&#39; _ _ = raise Match;

    fun assign_tr&#39; (Abs (x, _, f $ k $ Bound 0) :: ts) =
          quote_tr&#39; (Syntax.const @{syntax_const &quot;_Assign&quot;} $ Syntax_Trans.update_name_tr&#39; f)
            (Abs (x, dummyT, Syntax_Trans.const_abs_tr&#39; k) :: ts)
      | assign_tr&#39; _ = raise Match;
  in
   [(@{const_syntax Collect}, K assert_tr&#39;),
    (@{const_syntax Basic}, K assign_tr&#39;),
    (@{const_syntax Cond}, K (bexp_tr&#39; @{syntax_const &quot;_Cond&quot;})),
    (@{const_syntax While}, K (bexp_tr&#39; @{syntax_const &quot;_While&quot;}))]
  end
&#8250;</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">colltrue_eq_univ</span><span class="delimiter">[</span><span class="">simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;&#10627;True&#10628; = UNIV&quot;</span><span class=""> </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">auto</span><span class="">
</span><span class="">
</span><span class="keyword1"><span class="command">lemma</span></span><span class=""> </span><span class="">assert_int</span><span class=""> </span><span class="delimiter">[</span><span class="">intro</span><span class="delimiter">!</span><span class="delimiter">]</span><span class="delimiter">:</span><span class=""> </span><span class="string">&quot;x&#8712;&#10627;A&#10628; &#10233; x&#8712;&#10627;B&#10628; &#10233; x&#8712;&#10627;A &#8743; B&#10628;&quot;</span><span class="">
</span><span class="">  </span><span class="keyword1"><span class="command">by</span></span><span class=""> </span><span class="">blast</span><span class="">
</span><span class="">
</span><span class="keyword2"><span class="keyword">end</span></span><span class="">
</span></pre>

</div>
</body>
</html>
